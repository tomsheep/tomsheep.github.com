---
layout: post
category : 儒林外史
title: 屌丝的自我修养（86）
date: 2012-08-25 00:11:20 +08:00
tagline:
tags: 互联网, 盛世, 搜索, 索引, 校正, k-gram
---


1. 互联网中到处鼓吹的“个性化服务”， 早就被门口卖煎饼的大妈融会贯通了——无非就是记住熟客要不要辣椒，来多少香菜，要薄脆还是要油条的问题。

2. 公交车上，一个大爷操着浓厚的京腔向旁边的大妈吹牛，“中国这几千年啊，就出了三场盛世，大唐盛世、康乾盛世，再就是胡温盛世了……”——我顿时觉得自己过去讲的那些笑话都弱暴了。

3. 刚回国的表姐夫问我为什么换工作，我描述了半天也没有说清楚，说着说着自己都有点糊涂了……但最后还是给我抓住了重点：“我说了又不算，还整天让我开会。”

4. 基于词典的容错检索基本思路是对普通的倒排索引中的词典部分再进行了一层索引（可以使用哈希表或者搜索树），找到词项后再通过普通倒排索引最终定位到文档。

5. 通配符查询：
    * 搜索树词典结构对于尾部通配符来说很方便，从上到下遍历就可以了；首部的通配查询可以依靠词典的反向B树（原来B树中每个从根到叶子路径代表的词项全部反过来。比如apple在反向搜索树里就是root-e-l-p-p-a) ；同时使用B树和反向B树，可以处理任意位置的单个通配符查询（前缀和后缀分别查出的结果求交集并去掉前后缀相同时对应的词项）

    * 轮排索引可以用来进行一般的通配符查询（将词项旋转拓展出轮排词汇表），缺点是词典会变得很大。

    * k-gram索引结构中，词典由词汇表中所有词项的所有k-gram形式构成，而每个倒排记录表由包含该k-gram的词项组成。用k-gram进行通配查询时，re\*ve用3-gram就会转换为$re AND ve$。但对于一些查询，k-gram需要额外处理，比如red\*用3-gram会转换为$re AND red，可能会返回retired，这是不满足条件的。所以需要postfiltering，做字符串匹配滤掉部分结果。这种查询很耗时，一般隐藏在“高级搜索”界面下。

6. 拼写矫正

    * 基本原则：选择编辑距离（Levenshtein距离）最近的一个；如果有两个编辑距离相等或相近，选更常见的那个。

    * 词项独立的拼写校正主要有编辑距离法和k-gram重合度法：前者在实际运用中通常使用一些启发式方法提高查找效率（如将搜索限制在与查询词具有相同首字母的字符串上等）；后者实际上是对查询字符串中k-gram的倒排记录表进行单遍扫描的过程，通常为了提高精细度，用Jaccard系数进行修正：|A交B|/|A并B|，A，B分别是查询q和词汇表词项中的k-gram集合。扫描时，如果当前词项t和q的Jaccard系数超过阈值，则将t输出。

    * 上下文敏感的拼写校正更为复杂，一种简单的实现是，即使每个词拼写都正确，仍然对每个词找到可能的拼写正确词，然后尝试对短语中的每个词进行替换。

7. 基于发音的校正：对每个词项进行语音哈希，发音相似的被映射为同一值。这一类算法统称soundex算法。

