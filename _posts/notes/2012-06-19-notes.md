---
layout: post
category : 儒林外史
title: 屌丝的自我修养（63）
date: 2012-06-19 23:40:17 +08:00
tagline:
tags: [出租车司机, 北京, 上地, 五道口, C++, Boost, 内存, 智能指针]
---

1. 早上赶时间打车上班，刚坐定还没开口，司机看了我一眼淡定地来了句，“上地？”——我长得有那么像百度的么？

2. 大五道口地区发言人对此表示强烈不满和坚决反对，此举伤害了宇宙中心全体码农的感情。

3. 我发现一个发人深省的现象：在北京和我私交不错的朋友，无论男女老幼，都有一个惊人的共同点，那就是——没有下限。

4. Boost内存管理：

A. `scoped_ptr`顾名思义， 只在本作用域中使用，不希望被转让。同时，它继承自noncopya ble, 拷贝构造函数与赋值操作符私有。其用法很简单，在原本使用指针变量接受new表达式结果的地方改成用`scoped_ptr`对象，然后去掉那些多余的try/catch和delete操作就可以了。

B. `scoped_ptr`和标准库中的`auto_ptr`很像，但根本区别在于指针的所有权。`auto_ptr`的指针所有权可转移，可在函数间传递，同一时刻只能有一个`auto_ptr`管理指针。由于语义太微妙而实用环境中经常出错。`scoped_ptr`禁止所有权转让。他们俩都不能用作容器元素。

C. `shared_ptr`是引用计数型的智能指针，可以被自由地拷贝和赋值，在任意的地方共享它，也可以安全地放到标准容器中。 `shared_ptr`提供基本的线程安全保证，一个`shared_ptr`可以被多个线程安全读取。

D. `weak_ptr`用于协助`shared_ptr`工作，像旁观者一样观测资源使用情况，并在需要的时候通过lock()获得一个可用的`shared_ptr`。`weak_ptr`的一个重要用途是获得this指针的`shared_ptr`，见`enable_shared_from_this<T>`的实现（这个类的使用场景是，一个成员函数有时会需要返回this的`shared_ptr`）

E. 关于`shared_ptr`的缺点，可以把玩并且思考一下 [这篇文章][1] ，有点意思。

F.  我还是对C++不感冒，很多复杂度完全是因为语言本身特性决定的，这些复杂度甚至经常会侵入式地影响到软件的设计方式与实现方法。程序员不应该过多地“和语言搏斗”，这是编译器的工作。

[1]: http://blog.liancheng.info/?p=85 
