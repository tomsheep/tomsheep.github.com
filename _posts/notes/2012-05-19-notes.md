---
layout: post
category : 儒林外史
title: 屌丝的自我修养（44）
date: 2012-05-19 07:10:37 +08:00
tagline:
tags: [V8, 红黑树, 复仇者联盟, JavaScript, 美国队长]
--- 

1. 项目很可能被取消——这竟然是我这个月听到的最令人振奋的消息。

2. V8没有像其它JS Engine使用词典结构或红黑树实现的map来管理属性，而是在每个对象附加一个指针，指向hidden class（如果第一次创建该类型对象，则新建hidden class）；当对象每添加一个属性时，将新建一个class（记录了每个属性的位移/位置），而原来的class指向新class，即建立起一个hidden class的转换链表。——不使用关联容器来储存属性，而是采用更接近于静态编译的类的形式，将对象中每个属性的相对偏移量记下来，在生成机器码时直接把偏移量写到指令中。这样，访问某个对象的某个属性就只需要很少量的指令就能完成，比起关联容器的方式高效许多。 

3. 我起初以为JS这样动态语言属性大概是hashmap来管理的，仔细想这样对内存浪费比较大，而且在属性量不是非常大的情况下，基于hashing未必比基于比较的计算来的快。

4. STL中的map内部实现为红黑树，因此查找操作时间复杂度为O(logN)而非O(1)。有些STL实现中有`hash_map`数据结构，但仍非标准。

5. 《复仇者联盟》：

    * 我极度缺乏对美国超级英雄体系的背景知识，一些点根本无法得到。

    * 我终于知道小时候非常喜欢的一款红白机游戏主人公原来是“美国队长”了。

    * 把这么多超级英雄揉在一起，还能把人物特点都刻画清楚了，还是比较用心的。

    * 还有15分钟的时候电影院竟然停电了，导致我不知道钢铁侠把核弹扔到外太空后的剧情……但没有关系，用脚后跟都能想出来后面到底发生了什么。

