---
layout: post
category : 儒林外史
title: 屌丝的自我修养（87）
date: 2012-08-25 23:31:38 +08:00
tagline:
tags: [广告, 时钟, 需求, 自制力, 搜索, 索引, BSBI, SPIMI, 索引构建]
---

1. 若干年之后，我一定会问心无愧地说：我为我的雇主做出了突出的贡献。——每刷一次豆瓣页面，我都义无反顾地点一次广告。

2. 菜昕说他是为了方便看美女才学会认时钟的，看，这就是屌丝。为了同样的目的，我学会的是修电脑。

3. 我的小外甥让我对未来抚养小孩这件事产生了很深的阴影：一想到要在很长的时间里和一个完全没有理性和自制力的小鬼斗智斗勇，我就崩溃了。如果竟然苟活下来了，那又是一篇《论持久战》。

4. 其实我自制力也很差，所以做了18年的胖子并且眼睛被电游保送到了600多度。后来大学里好多人夸我自制力强，我挺不好意思的，因为我看上去比较勤奋的原因是这些东西让我觉得自己很酷，这本质上和一个嬉皮少年浑身上下打十八个洞没什么区别。

5. 基于块的排序索引算法：

    * BSBI在排序时尽量减少磁盘随机寻道次数。

    * 实现过程 
    
        1. 将文档解析成词项 ID—文档 ID对，并在内存中一直进行解析处理，直到累积至放满一个固定大小的块空间
        
        2. 排序后的块转换成倒排索引格式后写入磁盘
        
        3. 将若干个块索引同时合并成一个索引文件。

    * 该算法需要在内存中存放词项到词项ID的词典，对于大规模的文档集来说内存占用可能会过大；可以直接用term-文档id对的方式，但这样会使中间文件较大。

6. 内存式单遍扫描索引算法（SPIMI）：

    * 使用term-doc id对而不是term id-doc id对

    * 实现过程： 

        1. 如果词项是第一次出现，那么将之加入词典，同时建立一个新的倒排记录表
        
        2. 如果该词项不是第一次出现则直接在倒排记录表中增加一项，当倒排记录表空间放满的时候，就会申请加倍的空间 
        
        3. 上述步骤每run一次产生一个磁盘块，可以对每个块生成一个完整的倒排索引，为加快最后的合并过程，要对词项进行排序操作，然后写入磁盘形成单块索引

    * 相比BSBI一开始就整理出所有的词项id-文档id对，SPIMI直接在倒排记录表中增加一项，这样 1. 不需要排序操作 2. 保留了倒排记录表对词项的归属关系

7. 分布式索引构建：索引构建应该是MapReduce用的最普遍的场景之一了

    * map阶段r个分析器将输入的数据片映射成词项id-文档id对，输出结果存在本地的分区文件中 
    
    * reduce阶段，倒排器将每个词项分区（一个词项分区对应r个分区文件，分别放在一个分析器上。每个分区文件只需要一次网络顺序读取），最终得到倒排索引表。

8. 动态索引构建：

    * 可以在内存中用一个辅助索引存新文档信息，查询时将磁盘索引和内存中索引的结果合并。时间复杂度是 Θ(T^2/n), T是所有倒排记录的数目，n是辅助索引的大小

    * 引入log2(T/n)个索引块，用类似二项式堆的算法可以将时间复杂度降到 Θ(Tlog2(T/n))

    * 由于上述算法实现的复杂性和维护的难度，一些大兴搜索引擎倾向于从头开始重构索引而不是动态构建索引。

9. 参考《信息检索导论》第四章与 [这篇笔记][1]

[1]: http://www.cnblogs.com/god_bless_you/archive/2012/08/15/2640312.html 
