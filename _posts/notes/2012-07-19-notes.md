---
layout: post
category : 儒林外史
title: 屌丝的自我修养（74）
date: 2012-07-19 23:27:58 +08:00
tagline:
tags: [Yahoo, 北京, 内核, Windows, NT, 对象管理]
---


1. 今天我参加了同事的告别晚餐。他也参加了我的。——这是一个鬼故事的开头。


2. 聊起我今后的去向，我踌躇满志，笑而不语。表示多则三五年，少则个把月，潜心钻研，必有小成。那时节，将成果集结成书，书名就叫：《约炮之美》。—— 腰封必须注明“毕福剑、周杰伦、刘谦联袂推荐”。

3. 我就是个不高兴的孩子。

4. If you happen to be my boss, please push me hard. 

5. 《Windows内核情景分析》第四章：

    * Linux将设备看做特殊的文件，Window内核将文件、设备等等都看做特殊的对象。对于所有的对象，Windows内核提供统一的操作模式，即：打开或创建目标对象，让当前进程和目标对象间建立联系，然后通过别的系统调用进行操作，最后通过系统调用关闭对象（与进程的联系）。

    * 对象的操作有时需要同步，为此，对象类型的*OBJECT_TYPE*结构中有个DefaultObject，指向一个默认的等待对象。比如，File对象以一个Event作为等待对象，WaitablePort以WaitEvent为等待对象。

    * 创建、打开对象的主体是进程。打开对象的其实质是一个进程与一个对象之间建立起一个连接，一个上下文。句柄起到的就是这样的作用。

    * Windows内核中进程的句柄表是一个三维稀疏数组，类似于页面映射表。

    * 句柄在父子进程间可以遗传，也可以在一般进程间进行复制。Linux中可以将fd（打开文件的描述符，即上下文）授予另一个进程（通过socket的一个特殊功能），但这是建立在双方自愿、知情并相互配合的基础上的，第三方进程不能越俎代庖。但Windows就可以通过NtDuplicateObject来在进程间复制句柄，发起方可以是第三方进程。

    * 本进程的句柄并不一定都在本进程的句柄表里，有可能在公共的内核句柄表中。

