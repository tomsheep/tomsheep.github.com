<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
 <title>言之有误</title>
 <link href="http://blog.tomsheep.net/" rel="self"/>
 <link href="http://blog.tomsheep.net"/>
 <updated>2014-08-13T18:35:16+08:00</updated>
 <id>http://blog.tomsheep.net</id>
 <author>
   <name>tomsheep</name>
   <email>tomsheep.cn@gamil.com</email>
 </author>

 
 <entry>
   <title>别让我消失——2013</title>
   <link href="http://blog.tomsheep.net/2013/12/24/dont-let-me-disappear"/>
   <updated>2013-12-24T00:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2013/12/24/dont-let-me-disappear</id>
   <content type="html">&lt;p&gt;即将过去的一年看上去乏善可陈，就像它的许多前任一样。即便如此，我也得感谢它的陪伴，更何况即便在一些暗淡的日子里，它也没有放弃对我的治疗。年初我因为一份幸运的机缘加入算法组，踏上一段旅程，兴奋、怀疑、沮丧、坚持、豁然开朗；年末我因为一个似是而非的故事，踏上一段真实的旅程，冷漠、珍惜、自省、希望、泪流满面。&lt;/p&gt;

&lt;p&gt;“少说话，少装X。”这是上一个新年来临时我给自己立的规矩。据传古希腊Delphi神殿里挂着苏格拉底的三句半，“认识你自己”、“你是”、“勿过”、“别装X”。最后半句这么帅，想想就知道是我给总结的。不得不承认，我是个装X界的天才，专注该领域20年，无师自通那种的。而且和相声圈的情况类似，我也不喜欢同行，他们业务太差。这大概是一种自我保护，反映出内心的孱弱，缺什么装什么，这是基本的规律。只有三分，非要摆出十分的谱来。正如我本身鲁钝慢热，浅薄无知，干什么都事倍功半，却总要装得天赋异禀，博学深刻；本身无聊乏味，却竭力营造出风趣幽默的形象来。装多了自然有人信，但自己总归是骗不过的。虽说“Fake it till you make it”，可我装了这许多年，X还是X，我还是我。我大概自己都开始讨厌这副做派了，我警告自己有三分就说三分，把牛X还给牛。这个操作起来真不容易，因为三分太差劲了，就跟喝白开水一样，总不能整天说自己今天喝了白开水吧。我脸皮薄，怕被人笑话，所以渐渐就不怎么说话了。&lt;/p&gt;

&lt;p&gt;有幸混进算法组之后的很长一段时间里，我其实都一头雾水，书翻了不少，看懂的却没几段，我很沮丧，或者说，我很害怕，我宁愿接受“不努力”，也不愿承认“没能力”。前者是时间问题，后者是智力问题。有一段时间我真的觉得我完了，祖师爷没赏我这口饭吃。我对韩博士说，我看不懂那些论文。韩博士说，你看的太少。说起来像是传奇故事，就在这个对话结束的当天下午，我突然看明白了手上的论文在讲什么，并且在随后的组会上完整地做出了解释。这个奇异的现象一般情况下在我们码农界这么描述的：“我什么都没改，重跑了一遍脚本就好了”。我再去读其他的论文，发现脉络结构也格外清楚。我开挂了。当然了，我是主角嘛。那天我的心情跟抱在电线杆上哭喊“我的病有救了”没什么两样，满脑子都是《麦田里的守望着》主人公的喃喃自语——别让我消失，别让我消失。&lt;/p&gt;

&lt;p&gt;还好，还是时间问题。&lt;/p&gt;

&lt;p&gt;如果这一年就这样结束，我也挺满足了，丢了不少铠甲，少了保护，也少了负重。我依然怯懦、愚钝，但关于浮夸和自负的疗效还算显著。虽然显得无趣，但也不至于让人讨厌。汪老师生来彷徨，我生来无趣还不行么。我努力接受自己的无力，努力和这个世界讲和,关注亲人的“用户体验”，定期买礼物寄回家，关注经济与理财，关注楼市与股市，像个无趣的中年大叔一样——别逗了，你不本来就是么？&lt;/p&gt;

&lt;p&gt;时间也许觉得还欠我点什么，或者我欠他点什么，非要赶在交班之前把我弄哭不可。就在几天前，我因为一个故事奔走千里，故事里是我，又不是我，&quot;I have to go see about a girl”, 如果有人问，我就准备偷马特戴蒙的台词。一些朋友吃饭扯淡的时候有时会八卦我喜欢什么样的姑娘，我的描述从来都没有让他们满意过，有时候是詹妮弗艾莉的伊丽莎白，有时候是贝鲁奇的马莲娜，有时候甚至是《龙纹身》里的鲁妮玛拉。 他们找不出pattern，我也没有答案。我说我也不知道长什么样，但我看见了我能指给你。&lt;/p&gt;

&lt;p&gt;我曾经认识一个姑娘，姑娘算不上漂亮，当然也并不难看，事实上我已经很久没有见过她，记忆里她五官的轮廓都有些模糊。我们的故事并没有美满的结局，她任性地逃走，我也自负地转身，生怕动作不够漂亮。我一直心安理得地觉得我们的人生不会再有交集。在结束这次短暂旅程后的第二天，我在书桌前对着一堆讲义哭得不能自理。我突然发觉原来她对我如此重要。“它曾经击中我内心最柔软的部分，激发我心灵中最美好的东西，这些东西鼓舞我前进，滋养我的梦想，让我不仅爱上触发它的人，也爱上自己，并激励我成为更好的自己。它至今仍然能带给我感动。我像爱惜自己的羽毛一样爱惜它，看到它就不会忘记那颗跳动的赤子之心。” 这段话这么帅，想想就知道是我说的。别让我消失，别让我消失。&lt;/p&gt;

&lt;p&gt;看，我指给你们看，就是这样的。&lt;/p&gt;

&lt;p&gt;这就是我2013年要讲的故事，恐怕蠢得会让你笑出声来。笑就笑吧，《傲慢与偏见》里的班纳特先生是个爱吐槽的老头，他说，“生活无非是我们笑笑别人，然后再让别人笑笑我们。”&lt;/p&gt;

&lt;p&gt;2014，别让我消失，别让我消失。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>关于幽默-G&G沙龙番外篇</title>
   <link href="http://blog.tomsheep.net/2013/06/30/about-humor"/>
   <updated>2013-06-30T00:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2013/06/30/about-humor</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;主讲：tomsheep&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;音频下载：&lt;a href=&quot;https://docs.google.com/file/d/0ByaPRVM5h3fvZzhpM09yclF2bDQ/edit?usp=sharing&quot; title=&quot;音频下载&quot;&gt;humor-64kbps.mp3&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;h3&gt;关于幽默-G&amp;amp;G沙龙番外篇&lt;/h3&gt;

&lt;p&gt;这期因为Bug同学没有准备好，但我们不希望沙龙出现轮空的状态，这样会影响到做一件事的心气，所以我来扯淡一段，扯到哪算哪，作为番外篇。我没有准备文稿，只有&lt;a href=&quot;https://docs.google.com/file/d/0ByaPRVM5h3fvZzhpM09yclF2bDQ/edit?usp=sharing&quot; title=&quot;音频下载&quot;&gt;音频&lt;/a&gt;，我口才比较差，脱稿会相对混乱，大家忍受一下。&lt;/p&gt;

&lt;h3&gt;内容提要&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;幽默及创作手法&lt;/li&gt;
&lt;li&gt;关于相声&lt;/li&gt;
&lt;/ul&gt;

</content>
 </entry>
 
 <entry>
   <title>《迦陵说词讲稿》读书分享</title>
   <link href="http://blog.tomsheep.net/2013/06/19/poem-reading-share"/>
   <updated>2013-06-19T00:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2013/06/19/poem-reading-share</id>
   <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;p&gt;主讲：tomsheep&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;整理：tomsheep&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;音频下载：&lt;a href=&quot;https://docs.google.com/file/d/0ByaPRVM5h3fvTk5VcUZkVHVMWjg/edit?usp=sharing&quot; title=&quot;音频下载&quot;&gt;ci_64kbps.mp3&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;PPT下载：&lt;a href=&quot;https://docs.google.com/presentation/d/1fDL5RCWEibqepy1Zo1yrzaofi-umYV1p-Tz8_HPms8g/edit?usp=sharing&quot; title=&quot;PPT下载&quot;&gt;《迦陵说词讲稿》读书分享.pptx&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;h2&gt;G&amp;amp;G沙龙第1期&lt;/h2&gt;

&lt;p&gt;我们这个沙龙说了快有一年，一直没能组织起来，客观原因是时间不好凑，地点也难选;主观原因是我比较懒，然后又比较矫情，觉得不容易搞，而且搞出来也未必满意。现在我觉得是要先行动起来才好。前天我还和一个同事辩论软件开发尤其是框架开发的演化问题，我还振振有词地反驳他所说的“框架初期需要一定的过度优化”，讲了一套“循序重构，螺旋上升”的大道理。可见道理不是不明白，讲出来也是轻松便宜的，可要真正轮到自己做的时候，就知行不能合一了。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    Now I have come to the cross-roads in my life. I always knew what the right path was. Without exception, I knew, but I never took it. You know why? It was too damn hard.
    ——Scent of a Woman (1992)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2&gt;G&amp;amp;G沙龙：初心&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;    “一个人大脑中从未分享过的知识、经验、见解和判断力，总是另一群人非常想知道的东西。”    ——知乎周源

    “现代人的多数行为（如果不是一切）都可以从内心的孤独感找到原因。”    ——tomsheep
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;既然是第一期，首先总是要有一个楔子一样的综述，来介绍一下我们这个party的愿望以及要怎么玩下去。这是我觉得有必要发起这个活动的初衷，第一句是知乎的创始人周源说的，我觉得这是一个很打动人、至少很打动我的一句话。我的终极理想其实是教育理想，而传统的传道授业的教育模式在去中心化的今天有了全新的生命，信息的获取是如此便捷，每个人脑中都可能有对我有益的东西，“分享”其实只是一个很初级的形式，但我们总要走出第一步，否则永远都不知道最终能走到哪里。第二句话是我说的，我觉得“孤独病”是生活在我们这个时代人的一大症结，反正我是觉得非常孤独，这种感觉是无时无刻不存在的。繁华喧闹五彩缤纷的城市生活丝毫没有减轻这一病症，反而是加重病情的罪因之一。我认为心灵层面的交流、体认、宽容、分享，才是治愈这一顽疾的良药，所谓的“归属感”，恐怕是要从这个层面（或者更深）才能获取得到的。所以，这两点其实就是我要发起这个活动的初衷，简而言之就是：既增长了见识，又锻炼了队伍。&lt;/p&gt;

&lt;h2&gt;G&amp;amp;G沙龙：形式与内容&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;媒介：线上视频&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;时间：原则上一周一次&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;主讲人：原则上更次轮换，不强求;一次活动后讨论确定下次主讲&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;内容：题材不限（举例：读书心得、生活窍门、个人感想、把妹经验、育儿宝典……）只要愿意分享，都可以；篇幅不限，但尽量把一件事将完整&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;h2&gt;本期内容：《迦陵说词讲稿》读书分享&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;词的美感特质&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;词的演化过程&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;词的批评与审美&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;由词发散的思维&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;现在转入这期的内容，本来我想将机器学习心得或者是Linux内核，但是觉得没准备好，还too young，可以再沉淀一短时间再说。正好最近闲时看一本叶嘉莹老师讲古典词作的书，读完觉得特别好，以后我教小孩肯定会有这本。正好来简单分享一下吧，准备的也不是特别充分，有很多点我感受到了可能讲不出来，但主要是为了我们这个活动能kick off，抛砖引玉吧。&lt;/p&gt;

&lt;p&gt; &lt;a href=&quot;http://book.douban.com/subject/2039292/&quot;&gt;《迦陵说词讲稿》&lt;/a&gt; 作者：叶嘉莹&lt;/p&gt;

&lt;p&gt;简单介绍一下这本书和作者，叶嘉莹是目前我国古典诗词学界非常著名的大家之一，在美国、大陆、台湾都任过教，现在大概80多岁了。她从小受过良好的古典教育，之后师从顾随，也是民国时期的诗词学问名家。这本书主要收录的是她在各地教学演讲的讲稿，大约有十六讲。内容上互相有重叠的地方，但每一讲的主题和视角是有所不同的。&lt;/p&gt;

&lt;p&gt;通常我们说到古典文学体裁都是诗词和在一起说，他们都是韵文，写他们的人好像也有很大重合性，但其实这两种体裁有很大不同，这个不同不仅是是形式上的，也是主题和内容上的。中国古代是有“诗以言志，文以载道”的传统的，文章和诗都是有这样的附加属性的文学体裁，就是说士大夫们、文人骚客们写文章是要阐释经国之“道”，诗是要表达自己的意志与情志的。意志就是指理想抱负，情志则是喜怒哀乐。&lt;/p&gt;

&lt;p&gt;而词的诞生完全是另外一回事，最初词就像是流行歌曲的歌词，是六朝到唐代时候逐渐流行起来的一种乐曲叫燕乐，非常好听，通常是由一些歌姬酒女来演唱。所以词有很强的音乐性，诗只是讲究平仄，词是四声都会唱出来的。歌词的内容一般都很直白通俗，敦煌出土的曲子词可以看出这一时期的歌词模样。后来因为这样的乐曲实在是很流行很好听，就逐渐吸引了一批士大夫来写歌词给这些歌女唱，他们都是很有文学修养的饱学之士，写出来的歌词艺术水平自然要高很多，《花间集》序言里就说有这样一句说明词的最初来源：“西园英哲，用资羽盖之欢；南国婵娟，休唱莲舟之引” 意思就是文人学士们在游乐之余为歌女写出一些有文化有美感的歌词，让南国的这些美女们不用在唱庸俗的采莲曲了。&lt;/p&gt;

&lt;p&gt;所以词最初的功用决定了它的主要体裁与内容就是美女与爱情。和诗不同，士大夫们写词的时候完全没有写诗时“言志”的负担，就是为了娱乐嘛，而且是写给歌女的，以她们的口吻来写的，自然就没有了诗的约束。当然写这种体裁就成为有争议的，被认为是掉价的行为，这种观念一直延续到两宋也依然是这样。但写歌词的诱惑力实在太大了，还是有很多士大夫忍不住要去写，他们也有矛盾的地方。黄庭坚就为自己辩护说写词不过是“空中语而”，写着玩，不作数的。晏殊身为宰相，虽然自己也写词，还是要鄙视柳永，柳永说您不是也写词么，我跟您一样啊。晏殊说 闹那，我虽然也写词，可也没写过彩线闲占伴伊坐这样庸俗没品的句子。所以可见词这种以描写美女和爱情为主要内容的题材，虽然大家喜欢写，但主流的意识形态还是认为这是不登大雅之堂的。&lt;/p&gt;

&lt;h3&gt;词：“要眇宜修”的含蓄之美&lt;/h3&gt;

&lt;p&gt;由于主题上的本质不同，造成了诗和词在功用以及美学特质上的不同。张惠言说“意内而言外谓之词。其缘情造端，兴于微言，以相感动；极命风谣里巷男女哀乐，以道贤人君子幽约怨悱不能自言之情，低徊要眇，以喻其致” 道出“贤人君子幽约悱恻不能自言之情”，就是词这种文学体裁的共用了。所谓低回要眇，就是形容女子含蓄、内敛的一种美。所以词的美，也是一种女性化的美。女性形象也是词作当中最典型的形象。我过去看到过一篇微博，挺有意思，说宋词总结起来就是“小资喝花酒，老兵坐床头。知青咏古自助游，皇上宫中愁。剩女宅家里，萝莉嫁王侯。名媛丈夫死得早，mm 在青楼” 还是挺形象的，从中可以看出词的主要体裁和描写对象。&lt;/p&gt;

&lt;h3&gt;词：“感发”之美&lt;/h3&gt;

&lt;p&gt;“他们在为歌女写词的时候，在显意识中并没有打算写自己心中的那些苦恼，可是潜意识却不知不觉之中把心中的这些苦闷流露出来了” 这些潜意识的流露，就给词的读者提供了一种联想的可能性。&lt;/p&gt;

&lt;p&gt;双重性别我们已经提到过，写词的绝大多数都是男性知识分子，最早的花间词集里将近二十位作者全是男的。他们在词中要假托女性的口吻，表达女性的闺怨离愁，这样的双重性别也使得表面的文本有了多一层的联想可能性。&lt;/p&gt;

&lt;p&gt;所谓语码，是西方语言学的符号学中的说法，指的是在同一种传统文化背景下，往往形成了一些起着特殊作用的语汇，一旦你是用了它，就能够带出一大串有关的联想。在中文里尤其是这样，因为我们的文化传统积淀了好几千年，一些词语、一些意象在被经年的使用后产生了一些附加的意义。比如“梅花”总是代表高洁的品格、“簪花照镜”这样的动作常常隐性地表达作者爱惜羽毛之意。这些语码的组合，自然而然给这个文化传统下的读者带来文本之外更宽广的想象空间。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                            蝶恋花 晏殊
    槛菊愁烟兰泣露，罗幕轻寒，燕子双飞去。明月不谙离恨苦，斜光到晓穿朱户。
    昨夜西风凋碧树，独上高楼，望尽天涯路。欲寄彩笺兼尺素，山长水阔知何处。
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;这是写一个闺中寂寞的女子怀念离人的痛苦。上阕写晚间的孤独与寂寞，下阕写第二天早上，昨晚的风把树上的叶子吹落了，我一个人登上高楼，远望天边的路，那就是远方游子的方向。想给他寄一封信，可山高水长不知道要寄到哪里。这是相思的题材。但王国维看了“昨夜”这几句词，从中看出了“古今成大事业、大学问的第一种境界”。他联想到的是诗经里的“我瞻四方，蹙蹙靡所骋”，就是我看看四方，国家越来越狭窄了，危难越来越多了，我想要驰骋有所作为，却没有机会，是一种诗人对自己生不逢时的忧虑。晏殊有没有这个意思呢，我们不知道，这也是词的潜能，是值得玩味的地方所在。&lt;/p&gt;

&lt;p&gt;过于词的吟唱还要说一点，就是词是音乐性很强的，不像诗只分平仄，词是四声都会表现出来。我们今天普通话的读音和古人的读音已经有了很大的区别，比如现在普通话是不发入声的，粤语好像还有，但我不会说。而古人写的词里很多都用入声入韵，所以我们读到有些诗词的时候觉得好像不顺口，没有押韵。其实那是按古音写出来的，是没有错韵的。所以最好的欣赏方式还是按照古音来吟唱诗词。当然我不是很懂，有一小部分我能分辨出来，其他情况下就不会读了。所以我读基本上也是按我们现在的发音来读，个别我很清楚知道的地方改成古音。网上有一些叶嘉莹先生录制过的古诗词吟唱，有兴趣可以去听一下。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                菩萨蛮 温庭筠
    小山重叠金明灭。鬓云欲度香腮雪。懒起画峨眉。弄妆梳洗迟。
    照花前后镜。花面交相映。新贴绣罗襦。双双金鹧鸪。
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;离骚里“众女嫉余之蛾眉兮，谣诼谓余以善淫”，峨眉在屈原这里是一种托喻的说法，象征他的才能和品德的美好。在后代文人的作品中，逐渐就延续了这样的传统，所以当“娥眉”这个语码出现时，常常使读者联想到自珍自爱的托喻。那“懒起画娥眉”呢？晚唐诗人杜荀鹤有句诗“早被婵娟误，欲妆临镜慵。承恩不在貌，教妾若为容” 别人已经不懂得欣赏了，我还有什么心思对着镜子画眉呢？所以温庭筠这里的“懒”字，就给了我们类似的想象空间。当然，到底温庭筠写词的时候是不是有这层意思呢，我们也不能一口认定。但这首表面写闺中少女梳妆打扮的小词，能使读他的人产生非常微妙的联想与感发，这正是这种文学体裁的妙处所在。而能否让读者在言下之意中品味出余味悠长的言外之意，也可以体现出一个作者的创作水平。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                        浪淘沙 李煜
帘外雨潺潺，春意阑珊。罗衾不耐五更寒。梦里不知身是客，一晌贪欢。
独自莫凭栏，无限江山。别时容易见时难。流水落花春去也，天上人间。
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;这首词是李煜写的，非常有余味，在不同的语境下可以有很多联想和解释。来看最后一句，天上人间四个字就可以发散出很多种解释。比如联合上一句，可以理解为一种发问的语气“春天到哪里去了？是天上，还是人间？”还可以联系李煜的身世，和上阕里“梦里不知身是客”结合，理解为对自己遭遇的感慨，昔日如同在天上，而今只堕入人间。还可以结合理解为对“别时容易见时难”的展开，离别像流水落花一般容易，而再相见就像天上人间一样成为奢求。光是这一句就可以引发这么多种联想，这对于文学作品来说其实是一件难得的好事。&lt;/p&gt;

&lt;h2&gt;词的演化过程&lt;/h2&gt;

&lt;h3&gt;花间词&lt;/h3&gt;

&lt;p&gt;下面我们介绍一下词的演化过程。叶嘉莹先生的词学评论系统里，把词的发展主要分成三各阶段，歌词之词、诗化之词和赋化之词。我在这里介绍也就照搬她的主张。
花间集是我国历史上第一部词集，编于五代十国。是词的早期发展形态，这一时期的词以“艳丽香软”为主要特色，所写的对象基本是歌姬酒女，这些女子和之前文学作品中一般的女子形象，比如《诗经》里的女子形象相比，很大的不同在于词里的这些女子在社会家庭伦理关系中是没有归属地位的，他们不是良家妇女，他们存在于这个社会的状态是畸形的。而这一特点也影响了词的内容内涵，这样一来，词里的女子形象在剥离了家庭与伦理的归属之后，成为介于现实与非现实之间的“美色与爱情”的化身。这种抽象也造就了词，使词具有了更多象喻的可能性。
看一首温庭筠的小令，感受一下。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;              南歌子 温庭筠
    倭堕低梳髻，连娟细扫眉。 终日两相思。 为君憔悴尽，百花时。
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;柳永：长调叙写&lt;/h3&gt;

&lt;p&gt;柳永在词的发展中也是一个很重要的人物。和之前的主流词人相比，他擅长写长调，和小令相比，长调更工于细致的描写以及层层递进的铺陈，把场景引入到一个更广阔的空间，各有各的美感。柳永很懂音律，所以他写长调可以很好的把我各种复杂的音律变化。这对歌词之词在语言形式上是一个发展。
我们来欣赏一首柳永的词，《定风波》，非常骚柔，感受一下。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                          定风波 柳永
    自春来惨绿愁红，芳心是事可可。日上花梢，莺穿柳带，犹压香衾卧。暖酥消，腻云亸，终日厌厌倦梳裹。无那，恨薄情一去，音书无个。
    早知恁么。悔当初、不把雕鞍锁。向鸡窗、只与蛮笺象管，拘束教吟课。镇相随，莫抛躲。针线闲拈伴伊坐。和我，免使年少、光阴虚过。
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;诗化之词&lt;/h3&gt;

&lt;p&gt;我们高中的时候学词的时候，老师都会教词有婉约派和豪放派，婉约如李清照、晏几道，豪放有苏轼、辛弃疾。其实，词本身而言，就是婉约的，因为前面我们讲它的起源，之前就是给歌女写的歌词，是没有所谓“豪放派”一说的。后来到苏东坡，他开始用写诗的范儿来写词，让词可以有像诗一样的主题。苏轼比较喜欢和柳永比，他有个朋友就这么评价他和柳永的词，“柳郎中词，只合十七八女孩儿执红牙拍板，唱杨柳岸晓风残月。学士词，须关西大汉，执铁板，唱大江东去。”当然他这样的创新也不是所有人都认可，像一些顽固的原教旨主义词党，比如李清照，就认为苏轼这么写词，就已经不是词了，是“句读不茸之诗尔”。当然不是因为李清照不会抒写豪迈的感情所以才酸葡萄，李清照是写过很霸气的诗的，比如大家很熟悉的“生当做人杰，死亦为鬼雄。至今思项羽，不肯过江东。”她认为诗可以这么写，但词就要有词的范儿。
我们来一首苏轼的《定风波》，这是小令的定风波。和柳永的感觉比较一下。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                定风波 苏轼
    莫听穿林打叶声，何妨吟啸且徐行。竹杖芒鞋轻胜马，谁怕？ 一蓑烟雨任平生。
    料峭春风吹酒醒，微冷，山头斜照却相迎。回首向来萧瑟处，归去，也无风雨也无晴。
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;赋化之词&lt;/h3&gt;

&lt;p&gt;由于诗化之词并不好写，尤其是长调，容易陷入浅白，于是后来就有了用赋的手法来写词，以北宋周邦彦为代表。赋，讲究铺陈，讲究“体物言志”，体物，就是细致的观察、描述，体物言志就是通过铺陈的描写来表达思想。诗是感物言志，短小精悍，掌握的是心中感触的要点。但赋不是，赋要铺开来写。赋化之词以“体物言志”之法作词，抽离直抒感发的主体性，采用理性思索与技巧相组合，借用写赋技法，立意构思，勾勒成文。叶先生有一首诗来形容周邦彦的词“顾曲周郎赋笔新，惯于勾勒见清真”，别人都是越勾勒越淡薄，这个很容易理解，因为一个点反复的说就越来越无味，但周邦彦却可以越勾勒越浑厚。
看一首周邦彦的《兰陵王》，也被称为《渭城三叠》。体会一下这一类型的词作。主题是送别。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                兰陵王 周邦彦
    柳阴直，烟里丝丝弄碧。隋堤上、曾见几番，拂水飘绵送行色。登临望故国，谁识京华倦客？长亭路，年去岁来，应折柔条过千尺。
    闲寻旧踪迹，又酒趁哀弦，灯照离席。梨花榆火催寒食。愁一箭风快，半篙波暖，回头迢递便数驿，望人在天北。
    凄恻，恨堆积，渐别浦萦回，津堠岑寂，斜阳冉冉春无极。念月榭携手，露桥闻笛。沉思前事，似梦里，泪暗滴。
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;无论是柳词、苏词、还是周词，都各自发展出了一种虽不假借女性与双性，但仍然具有花间词之幽微要眇富含言外意蕴的特色相近的另一种双重性质的美。也就是说，这种富含引人联想的多层意蕴为美的美学特质仍然被继承并发扬光大了。在后来的历代的演进中，词的主题也逐渐变得多元，不仅限于美女与爱情了。叶嘉莹老师的这本书里还讲解了很多反应历史沉浮的词作和词人，我不举例了。我之前一直有印象是到了明清，诗词就已近衰落，好作品匮乏，这本书给我长了点见识，发现直到清末，仍然有非常好的词人词作。&lt;/p&gt;

&lt;h2&gt;词的批评与审美&lt;/h2&gt;

&lt;h3&gt;张惠言:文本的联想与感发&lt;/h3&gt;

&lt;p&gt;说到词的评论与审美，这里简单介绍两位影响比较大的词学家，张惠言和王国维。&lt;/p&gt;

&lt;p&gt;张惠言和王国维都提出过词的美感特质在于“低回要眇”，“能言诗之不能言，又不能尽言诗之能言”，是一种含蓄的“潜能”之美。不过张惠言的审美方法更注重文本的联想，从词的文字出发进行推敲比附。前面介绍过张惠言评价温庭筠的菩萨蛮，说“簪花照镜”有离骚“初服”之美。再来回顾一下这首词。他是从哪里读出来的？就是根据文本中的这些娥眉、照花的语码联系到中国的文化传统。有没有道理呢？是见仁见智了。王国维就批评张惠言的这套审美方法，说是“深文罗织”，牵强附会。&lt;/p&gt;

&lt;h3&gt;王国维&lt;/h3&gt;

&lt;p&gt;王国维就比张惠言更进了一步，他也指出了词的美在于“要眇宜修”，含蓄而余味深长，但从审美的方法论上说，他不认可张惠言那种直接从文本进行联想比附，而是要从感情的本质上进行联想与感发。这个抽象层次很微妙，拿言语很难描述清。“词之雅郑，在神不在貌”就是说评价诗词的优良品劣，要看它所表达的意思与情感，而不能仅凭所用的文字来判定。王国维在《人间词话》里还提出评价词的“境界”说，境界有大小之分，有“有我之境与无我之境”之分，当然他的这套东西比较抽象，不好掌握，意会可以，一旦指实，就韵味大减了。他自己批评张惠言“深文罗织”，自己也不是从前人写闺怨离愁的小词中读出“古之成大事者必经的三重境界”，可见词的欣赏解读是一件很微妙的事情。&lt;/p&gt;

&lt;h2&gt;一些感想&lt;/h2&gt;

&lt;h3&gt;理论与创作: 符号与符号背后的内涵&lt;/h3&gt;

&lt;p&gt;下面我谈一些读书过程中的一些零碎的感想。第一个是关于理论和创作的，就像我们今天可以用很多现代的文学理论去解释古人的诗词，从他们的创作手法中挖掘出一些契合文艺理论的东西来，古时的这些大师们，李杜苏辛，他们懂这些理论么？他们在创作时是不是考虑到了这些文艺理论的东西呢？显然没有，他们那个时代文艺理论还没有发展到这一步。但是，能说他们不懂文艺理论么？不能。他们非常懂，他们懂得不是这些被总结阐释后的创作理论，他们懂得是这些理论符号背后的内涵。就像有一些不识谱的优秀音乐人，他们不懂被抽象成符号的音乐理论，但他们对于如何运用节奏如个何让发出来的声音悦耳动人，他们非常懂。所以从这个意义上讲，“大师们不懂理论照样NB，所以理论无价值”这样的论调是站不住脚的。&lt;/p&gt;

&lt;h3&gt;诠释圈与读书:你所得到的，是你已经了解的&lt;/h3&gt;

&lt;p&gt;第二点是关于读书的。读一本书或者文章，你从中能读出什么内容，从中能得到什么启发，起到最重要作用的其实是你已经了解多少。就像牛顿被苹果砸悟出了万有引力，是因为牛顿本身对这个问题了解的足够深入，换个普通人砸完全没有用。再具体到计算机领域，我过去上学的时候也是觉得学一样东西应该只读masterpiece，才能有更高的领悟，是学习的“捷径”。其实现在看来，那些masterpiece是写给懂的人读的，只有懂的人才能从这些巨著中得到更多的灵感与启发，你能读懂多少取决于你已有的深度。一个领域的白丁，指望读masterpiece而“抄近路”成为master，基本是扯淡的。从反面也可以引出另一个观点，就是书，尤其是好书，一定是常读常新的。所以豆瓣除了“想读”、“在读”、“读过”之外，应该加上“读懂了多少”，或者类似武功修为一样“练到了第几层”。&lt;/p&gt;

&lt;h3&gt;艺术形式的流行与没落&lt;/h3&gt;

&lt;p&gt;第三点，是关于艺术的流行与时代的关系。艺术是表达人内心情感的工具。随着时代的发展，人们表达自己情感的方式在不停的演进，从诗经、乐府到唐诗、宋词、元曲，再到现代诗，每一个时代的人都找出更适合自己表达的艺术形式。并不一定说这种演进是对传统的背叛，也不是说哪门艺术是高雅的，哪门是低俗的。就像过去清中期京剧流行的时候大家认为昆曲是雅的，京剧是俗的，但现在呢，又认为京剧是雅的，流行音乐是俗的。说的好像哪门艺术没人听快死掉了，那它就是雅的一样。一门艺术的流行是因为它在表达能力上迎合了这个时代人主流的需求，没落的艺术自然各有自己独特的美，但没有必要所谓刻意去“挽救”、去“拯救”的必要，而且我也丝毫不认为他们会死去。他们会在喜欢他们的人群里活的很好，相信长尾的力量。&lt;/p&gt;

&lt;p&gt;(THE END)&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>淡定是一件礼物</title>
   <link href="http://blog.tomsheep.net/2013/06/01/know-how"/>
   <updated>2013-06-01T00:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2013/06/01/know-how</id>
   <content type="html">&lt;p&gt;说起来奇怪，从春节到现在我一直出乎寻常地淡定。一度我觉得可能是吃错了药（或者吃对了药），否则一个长年焦虑的人何以会毫无征兆地变得平和。在梳理了这几个月到底发生了什么变化之后，我谨慎地认为，就像许多彪炳史册的伟大发明创造一样，这是一个意外的副作用。&lt;/p&gt;

&lt;p&gt;春节的时候我决定做一个实验，一年都不要使用微博，看是否会获得更多可利用的时间。事实证明不会，对我而言每天专注的时间大概是一个稳定的数值，强行训练只会觉得效率低下。但这个决定产生了一些预期之外的效果——在基本脱离了熟人社交网络之后，很长时间里我都感到非常轻松，除了可以免受大量并不感兴趣的消息的轰炸之外，更有益的是发觉大好青春何必被自己的面具绑架：不用摆出一副业内人士的架势言必称“用户”“产品”;也不用装成技术大牛满嘴“语言”“架构”；更不用在一堆无趣的段子里苦苦扫出一条不那么无趣的，转发时搜肠刮肚地把这个包袱从另一个角度再抖一次……可以诚实一点不那么装，沉淀下来的才是本事，况且我还没有老到要（能）靠所谓“impact”混饭的年纪。&lt;/p&gt;

&lt;p&gt;在这样的心态下做事是很令人愉悦的，不会受到反馈——尤其是来自熟人的反馈的干扰，更容易依赖直觉做一些决策。我在IM状态里留了一个二维坐标，表示理论基础与工程能力，从（10000, 10000）开始递减，每天更新有效的付出时间，算作一个简单的激励。我把这个设计解释给一个前同事，他说太坑爹这得更新到猴年马月——其实没有多久，只要十年就可以了。十年前我显然没有这样的耐心。&lt;/p&gt;

&lt;p&gt;工作状况发生的一些变动也有所帮助，两个多月前我申请转入算法组的意愿得到迅速回应，然后一举混入了数据挖掘界。这让我由衷感叹“这是一个神奇的网站”。我入行两年，工种却已经换过好几个，有主动的也有被动的，除去一些微不足道的负面影响，对我而言这更多是种幸运。作为一个资深焦虑症患者，我过去喜欢说“这不是我想要的”，但究竟要的是什么，这真是一个世界级的谜题。从大学到雅虎再到豆瓣，有机会不停地尝试，算是为这道难题寻求一个“启发式”（heuristic）的解答。&lt;/p&gt;

&lt;p&gt;李开复喜欢说一句烂俗但我现在深以为然的话叫“Follow your heart”，把功利的、浮在表面的诉求剥开，找到真正打动自己的那一点，离答案就不远了。你以为自己想要一匹更快的马，实际上你需要一辆三蹦子。以前每听到同学朋友里“某某创业有了自己的买卖”，“某某去了斯坦福、CMU”，“某某拿了大offer去了硅谷”我都有些惆怅，觉得自己好像“落后”了，但又说不清到底“落后”了些什么。现在这种感觉是全然没有了，这大概是我最成功的自我“祛魅”。对我而言，弄清一件事运作的原理才是最大快感的来源，至于这一诉求以什么形式表现出来，倒是很其次的了。&lt;/p&gt;

&lt;p&gt;这几个月读书/读文章方法论上也有收获，据我总结就是始终抓住一条“为什么出问题——问题建模——解决问题”的线索，细节随意剥离或者展开都不会影响理解，能快速有效抓住重点。这不是什么新鲜的奇技淫巧，而是容易被忽视的最基本的阅读方法，几乎所有的非虚构作品都可以这样读，有助于理解内容，一旦理解，就很难遗忘。而且还可以用这个方法来检验一本书或一篇文章的写作质量，因为直接反映了作者头脑的清晰程度和表达能力。想到大学里熬夜死读书的场景，真是蠢哭了。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>《改变心理学的40项研究》笔记</title>
   <link href="http://blog.tomsheep.net/2013/04/07/40-studies-that-changed-psychology"/>
   <updated>2013-04-07T00:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2013/04/07/40-studies-that-changed-psychology</id>
   <content type="html">&lt;p&gt;《改变心理学的40项研究》是近期读过的一本心理学科普著作，收集了心理学研究史上40项具有划时代意义的实验：它们有的挑战权威、在当时引起了重大争议；有的开宗立派，成为后来研究者的理论源泉；有的已经成为已经成为众所周知的常识，而有的直到今天还是研究者们辩论的焦点。感谢这本书的作者耐心讲解和生动的描述，让非专业的读者了解到这个领域中精彩的故事。做一点摘抄：&lt;/p&gt;

&lt;h3&gt;学习和条件反射&lt;/h3&gt;

&lt;p&gt;弗洛伊德精神分析关于人类行为的基本观点是：行为的动力来源于无意识的本能和童年压抑了的内心冲突。但巴甫洛夫和华生为代表的行为主义的观念完全相反，认为行为是通过外在的不同环境和情境刺激产生的，即：情绪是习得的。被称为“行为主义之父”的斯金纳认为所有心理现象本质上都是行为的。所有的行为不管是内部的还是外部的，都可以由它产生的环境后果来解释。斯金纳甚至饲养了一批&lt;a href=&quot;http://book.douban.com/review/1242356/&quot; title=&quot;迷信的鸽子&quot;&gt;迷信的鸽子&lt;/a&gt;来证明自己的假设。&lt;/p&gt;

&lt;h3&gt;智力、认知与记忆&lt;/h3&gt;

&lt;p&gt;罗伯特·罗森塔尔提出的“皮格马利翁效应”就是我们所说的“自我实现的预言”，举个例子，小学老师得到学生的IQ测试分数，会下意识地对某些学生的潜能产生某种期望，给予他们更多的鼓励与鞭策，使学生产生自我实现的预期，从而更有可能获得成功。&lt;/p&gt;

&lt;p&gt;阿希的印象实验则试图向大家证明，在向一群被试描述一个陌生人时，改变一个描述词能引起被试对这个人整体印象的变化。他解释某些性格特征扮演核心角色，某些则相对边缘，个体的思维过程中这些特征是互相关联的。&lt;/p&gt;

&lt;p&gt;托尔曼并不同意传统行为主义严格的“刺激-反应”主张，他认为，经由感觉、注意、思维、期望、记忆和分析对刺激进行智力加工方式如果不比刺激本身更重要的话，也至少与后者同等重要。通过“&lt;a href=&quot;http://student.zjzk.cn/course_ware/zjxlx/experiment/Tolman_study.htm&quot; title=&quot;托尔曼行为实验&quot;&gt;认知地图&lt;/a&gt;”实验，他提出，学习者所学到的东西并不只是简单的机械的运动反应，而是达到目的的符号及其意义。而在之后的研究中，他又指出，对社会环境形成的综合地图对人类是有益的，而内涵单一的序列地图可能会使人陷入消极状态之中。&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;过分强烈的动机或极度压抑的状态，使人类一而再再而三地误入盲目仇视外来者的歧途……我们不该让自己或他人过于情绪化、过于饥饿、过于衣衫褴褛，动机过于强烈，这些只能形成狭隘的序列地图。我们所有人必须保持平和的心态，吸收足够的营养，以便形成真正的综合性的认知地图……简而言之，当我们的孩子或者我们自己面对人类世界这一大迷宫时，我们必须使我们的孩子或我们自己（就像善良的实验者对待他的实验老鼠一样）处于能激发适度动机而没有多余挫败感的最理想状态中。&lt;/p&gt;&lt;/blockquote&gt;

&lt;h3&gt;人的发展&lt;/h3&gt;

&lt;p&gt;让皮亚杰提出，人类认知发展存在四个阶段：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;感觉运动阶段： 0-2岁, 思维与身体运动同步，&lt;a href=&quot;http://baike.baidu.com/view/621278.htm&quot; title=&quot;客体永久性&quot;&gt;客体永久性&lt;/a&gt;概念发展。&lt;/li&gt;
&lt;li&gt;前运算阶段：2-7岁，能进行象征性思维，非逻辑，万物有灵论，自我为中心。&lt;/li&gt;
&lt;li&gt;具体运算阶段：7-11岁，逻辑思维发展，能推断他人感受。&lt;/li&gt;
&lt;li&gt;形式运算阶段：11+ 假设概念、抽象概念，能思考哲学问题。&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;哈罗关于婴儿对母亲依恋的&lt;a href=&quot;http://psychclassics.yorku.ca/Harlow/love.htm&quot; title=&quot;The Nature of Love&quot;&gt;研究&lt;/a&gt;，提出了“接触安慰”的重要性。&lt;/p&gt;

&lt;p&gt;兰格和罗丁关于“控制力”对人影响的解释我个人有切身的体会，他们通过实验试图告诉我们：当我们拥有控制力时，我们便是更快乐和更有成就的人。&lt;/p&gt;

&lt;h3&gt;情绪和动机&lt;/h3&gt;

&lt;p&gt;费斯廷格关于“认知失调”的定义：同时经历两种或以上彼此不协调的心里过程。当你的行为和你的态度发生矛盾时，你的态度将有所改变以与行为保持一致。而引起撒谎行为的压力越大（解释该行为的理由充分），改变原有观点的倾向越弱。&lt;/p&gt;

&lt;p&gt;他进一步指出认知失调的过程：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;这种与态度不符的行为必须导致你不乐于接受的消极影响&lt;/li&gt;
&lt;li&gt;个人需对消极结果承担责任&lt;/li&gt;
&lt;li&gt;生理唤醒&lt;/li&gt;
&lt;li&gt;个体意识到所经历的生理唤醒是由自己所做的与态度不符的行为引起的&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;目前多数心理学家认为有两个基本过程可以改变一个人的原有观点和态度，一是反复劝说， 二是认知失调。&lt;/p&gt;

&lt;h3&gt;人格&lt;/h3&gt;

&lt;p&gt;罗特： 个体所具有的具体学习经历使其对强化是内控还是外控形成一种总体预期。（内控性格的人，深信自己能掌握自己的命运，而外控性格的人倾向于相信命运的安排起决定性作用）如果你已经习惯对自己的行为做内控或外控的解释，这影响到将来你在几乎所有情境中的行为。&lt;/p&gt;

&lt;p&gt;柯尔伯格：&lt;a href=&quot;http://zh.wikipedia.org/wiki/%E6%9F%AF%E5%B0%94%E4%BC%AF%E6%A0%BC%E9%81%93%E5%BE%B7%E5%8F%91%E5%B1%95%E9%98%B6%E6%AE%B5&quot; title=&quot;柯尔伯格道德发展阶段&quot;&gt;道德发展具有阶段性&lt;/a&gt;。在皮亚杰研究的启发下，他将人类道德发展分为6个阶段，并认为&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;每个阶段都有一种独一无二的道德思维方式，而且不是对成人道德概念理解的逐渐深化。&lt;/li&gt;
&lt;li&gt;各个阶段总是以固定的顺序出现，不可能跳过任何一个阶段，也罕有倒退的情况出现&lt;/li&gt;
&lt;li&gt;阶段具有优势性。即儿童理解所有处于他们现有道德阶段以下的道德判断，且至多只能对他们所处阶段以上一个阶段的道德问题有某种程度的理解。&lt;/li&gt;
&lt;/ol&gt;


&lt;h3&gt;心理病理学&lt;/h3&gt;

&lt;p&gt;罗汉森的实验更像是一场恶作剧，他招募了一批正常人来冒充精神病人，让他们去多家医院就诊，并且提供完全真实的信息（除了唯一的耳鸣症状），所有被试表现正常的行为。结果几乎所有医院都被钓鱼，无法分辨出真假病人。&lt;/p&gt;

&lt;p&gt;习得性抑郁：塞里格曼做了一个实验，发现狗在受到既不受他们控制也无法逃脱的一段时间点击后，即便在后来的环境中逃离的机会唾手可得，狗也学不会逃走。即：无助的狗和抑郁的人都从以往的特殊经历中习得自己的行为是徒劳的。这再次印证了“控制力”的重要性。&lt;/p&gt;

&lt;h3&gt;心理治疗&lt;/h3&gt;

&lt;p&gt;行为疗法与精神分析不同，不关心心理障碍的无意识根源和受压抑的冲突。它主张恐惧反应可以通过一个简单的条件反射程序而得到减轻。&lt;a href=&quot;http://zh.wikipedia.org/wiki/%E6%9F%AF%E5%B0%94%E4%BC%AF%E6%A0%BC%E9%81%93%E5%BE%B7%E5%8F%91%E5%B1%95%E9%98%B6%E6%AE%B5&quot; title=&quot;柯尔伯格道德发展阶段&quot;&gt;系统脱敏&lt;/a&gt;就是这样的疗法。我最早听到“脱敏”这个词是在小学看到的一部电视剧里，主人公是警察，对红色有阴影，后来通过脱敏训练，反复练习射击装满红色液体的玻璃瓶来克服心理障碍。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://baike.baidu.com/view/737941.htm&quot;&gt;墨迹测验&lt;/a&gt;和&lt;a href=&quot;http://site.douban.com/120314/widget/notes/4149553/note/178655297/&quot;&gt;TAT测验&lt;/a&gt;是著名的投射型人格测验，让被试自由地看并说出由此所联想到的东西（或联想一个场景），然后将这些反应用符号进行分类记录，加以分析，进而对被试人格的各种特征进行诊断。&lt;/p&gt;

&lt;h3&gt;社会心理学&lt;/h3&gt;

&lt;p&gt;拉皮尔观察到人存在“言行不一”的现象：如果想预测一个人在面对某一真实的特定情景或特定人物时将如何表现的话，对假设性情景的口头回答（即态度问卷）是远远不够的。只有研究真实社会情景中的人的行为，才能可靠地测量一个人的社会态度。（所以，“女友和母亲同时掉河里”的问题意义不大）&lt;/p&gt;

&lt;p&gt;那么，在什么时候，态度能成功预测行为？有研究指出，这些因素起关键作用：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;态度强度&lt;/li&gt;
&lt;li&gt;态度稳定性&lt;/li&gt;
&lt;li&gt;行为与态度的相关性&lt;/li&gt;
&lt;li&gt;态度的显著性&lt;/li&gt;
&lt;li&gt;情景的压力&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;“&lt;a href=&quot;http://baike.baidu.com/view/481678.htm&quot;&gt;旁观者效应&lt;/a&gt;”则提出这样一个观点：围观的人越多，施以援手的人越少（全体中国人表示赞同）。达利和拉特那解释这是因为：提供帮助的责任扩散了，反过来因不提供帮助而受到的良心责备和内疚也扩散了。&lt;/p&gt;

&lt;p&gt;后来的研究有发现，当人们了解了“旁观者效应”后，他们会更乐意向危难中的人伸出援手。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>谈修养</title>
   <link href="http://blog.tomsheep.net/2013/03/31/on-accomplishment"/>
   <updated>2013-03-31T00:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2013/03/31/on-accomplishment</id>
   <content type="html">&lt;p&gt;昨天的一次同学聚会上有朋友要给我介绍对象，问我喜欢什么样的，我说最好是有点“情怀”的。情怀这个词太过抽象，在我看来和人品、眼界、志趣都有关系，但又很难具体描述。很容易让人和“文艺”产生联想，但其实没有本质联系。想到前两天读过朱光潜的一本小书叫《谈修养》，于是我说不如把“情怀”换个词叫“修养”吧——“修养”也不比“情怀”更容易让人理解，不过既然有大师圭臬在前，谈起来就有底气了很多。&lt;/p&gt;

&lt;p&gt;对于这本书我的态度是非常欣赏的，朱先生这本书里所表达的多数观点——尤其是关于教育的部分——很符合我的想法。在这里做一些书摘，也算是把这本书介绍给有缘来到这里的朋友。&lt;/p&gt;

&lt;p&gt;序言里有一句话我十分喜欢:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;我大体上欢喜冷静、沉着、稳重、刚毅，以出世精神做入世事业，尊崇理性和意志，却也不菲薄情感和想像。我的思想就抱着这个中心旋转，我不另找玄学或形而上学的基础。我信赖我的四十余年的积蓄，不向主义铸造者举债。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;无论是表达出的价值取向还是流露出的自信，都让我敬佩。当然我个人还远远做不到这一点，在这里就还要向朱先生“举债”，“盗言窃行”一番，借人之口浇自己心中块垒。这也应了“Fake it till you make it”的西谚，也算是成长的必由途径。&lt;/p&gt;

&lt;h3&gt;谈志气&lt;/h3&gt;

&lt;blockquote&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;从前的青年人病在志气太大，目前的青年人病在志气太小，甚至于无志气。志气太大，理想过高，事实迎不上头来，结果自然是失望烦闷；志气太小，因循苟且，麻木消沉，结果就必至于堕落。所以我们宁愿青年烦闷，不愿青年消沉。烦闷至少是对于现实的欠缺还有敏感，还可以激起努力；消沉对于现实的欠缺就根本麻木不仁，决不会引起改善的企图。但是说到究竟，烦闷之于消沉也不过是此胜于彼，烦闷的结果往往是消沉，犹如消沉的结果往往是堕落。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一是念头或愿望(wish)，一是起一个动作时所存的目的(purpose)，一是达到目的的决心(will，determination)。
“有志者事竟成”的“志”，须包含这三种意义在内：第一要起念头，其次要认清目的和达到目的之方法，第三是抱必达目的之决心。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;这是关于“有志者事竟成”比较好的阐释之一。这句古语表达了一种好的愿望，充满正能量，但可能产生一些反作用，因为有没有“志”和事能不能“成”没有必然的因果关系，受了“蛊惑”的有“志”青年碰壁之后往往投向犬儒主义的怀抱，正像这本书《谈青年的心里病态》一节中所说的，&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;他们由自己个人的生活空虚推论到一般人生的空虚，犯着逻辑学家所谓“以偏概全”的错误。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;因惧怕挫败而否定“志”的价值只能带来更负面的结果。《朝抵抗力最大的路径走》一节中的一番话也是对此的良好诠释：&lt;/p&gt;

&lt;blockquote&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;许多人虽天天在“卑劣意识”中过活，却永不能发“男性的抗议”，只知怨天尤人，甚至于自己不长进，希望旁人也跟发“男性的抗议”，只知怨天尤人，甚至于自己不长进，希望旁人也跟着他不长进，看旁人长进，只怀满肚子醋意。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一个人如果想奋发有为，最好是趁少年血气方刚的时候，少年时如果能努力，养成一种勇往直前百折不挠的精神，老而益壮，也还是可能的。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h3&gt;个体本位与社会本位&lt;/h3&gt;

&lt;blockquote&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;就大体说，中国人以为一个人须先是自己是一个好人，对社会才会是好人，个人好，社会才能好；西方人以为一个人对于社会是好人，才算得是好人，社会好，个人就容易好。他们同以人好与社会好为理想，不过着重点不同，我们可以借用物理学的术语说，中国人的伦理观是“离心的”，由内而外的；西方人的伦理观是“向心的”，由外而内的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;总之，社会转变不出两种方式，或由自变，或由人变。这两种方式也并不必彼此冲突。我们承认社会本身有一个常趋转变的大势，同时，我们也不能否认少数人的努力也往往可以促成、延滞，或移转这个大势。“时势造英雄，英雄亦造时势”，这句老话究竟不错。极端的唯物史观不能使我们满意，就因为它多少是一种定命论，它剥夺了人的意志自由，也就取消了人的道德责任和努力的价值。我们必须承认人力可以改造社会，然后我们遇着环境的困难才不会绝望，而我们的努力也才有意义与价值，我们也才能够说：把这世界安排得较合理想一点，是我们每个人的责任。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;这段关于“唯物史观”和“英雄史观”的调和讲的很精彩，关于英雄崇拜，在《谈英雄崇拜》里另有一段，&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;从教育观点看，我们主张维持一般人所认为过时的英雄崇拜。尤其在青年时代，意象的力量大于概念，与其向他们说仁义道德，不如指点几个有血有肉的具有仁义道德的人给他们看。教育重人格感化，必须是一个具体的人格才真正有感化力。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;关于这一点我是持保留意见的，我不反对作为个人行为的英雄崇拜——那是个人自由——但不赞同在教育中以任何形式宣扬英雄崇拜，即便这么做是良好的初衷，并能带来“不坏”的效果。我认为教育需要保证最大的理性与中立，不主动引导人作出判断，而是将思考、批判与选择的方法与自由教/交给他们。&lt;/p&gt;

&lt;h3&gt;谈处群&lt;/h3&gt;

&lt;blockquote&gt;&lt;p&gt;在中国社会里，小群的活动特别踊跃，而大群非常散漫，意见偶有分歧倾轧冲突便乘之而起，都是因为部落主义在作祟。就表面看，同乡会、同学会、哥老会之类的组织颇可证明中国人能群，但是就事实看，许多不必有的隔阂和斗争，甚至于许多罪恶的行为，都起于这类小组织。小组织的精神与大群实不相容，因为大群须化除界限，而小组织多立界限；大群必扩然大公，而小组织是结党营私。我们中国人难于成立大群，就误在小组织的精神太强烈。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;朱先生认为解决处群问题关键在于教育与政治，要改良现状，必须把教育的着重点由上课读书移到学习做人方面去，而至于政治，则寄望于健全下层政治组织与政治公开。这本书写于抗战年间，距今已有70余年，在这两方面状况非但没有好转，还有每况愈下的趋势。&lt;/p&gt;

&lt;h3&gt;谈冷静&lt;/h3&gt;

&lt;blockquote&gt;&lt;p&gt;一般人欢喜拿文艺和科学对比，以为科学重理智而文艺重情感。其实文艺正因为表现情感的缘故，需要理智的控制反比科学更甚。英国诗人华兹华斯曾自道经验说：“诗起于沉静中所回味得来的情绪。”人人都能感受情绪，感受情绪而能在沉静中回味，才是文艺家的特殊修养。感受是能入，回味是能出。能入是主观的、热烈的；回味是客观的、冷静的。&lt;/p&gt;&lt;/blockquote&gt;

&lt;h3&gt;谈学问&lt;/h3&gt;

&lt;blockquote&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;学是学习，问是追问。世间可学习可追问的事理甚多，知识技能须学问，品格修养也还须学问；读书人须学问，农工商兵也还须学问，各行有各行的“行径”。学问是任何人对于任何事理，由不知求知，由不能求能的一套功夫。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一般学子有两种通弊。一种是聪明人所常犯着的，他们过于相信自己的思考力而忽略前人的成就。其实每种学问都有长久的历史，其中每一个问题都曾经许多人思虑过，讨论过，提出过种种不同的解答，你必须明白这些经过，才可以利用前人的收获，免得绕弯子甚至于走错路。
另外一种通弊是资质较钝而肯用功的人所常犯的。他们一味读死书，古人所说的无论正确不正确，都不分皂白地接受过来，吟咏赞叹，自己毫不用思考求融会贯通，更没有一点冒险的精神，自己去求新发现，这是学而不思，孔子对于这种办法所下的评语是“罔”，意思就是说无用。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;这两种通弊估计很多人都会躺着中枪，我也是深受其害，但我也认为这是不可避免的，所有人都需要在这条路上艰难的探索，螺旋上升。因此，朱先生认为，学校教育只有两个重要的功用：&lt;strong&gt;第一是启发兴趣，其次就是指点门径。&lt;/strong&gt; 而非灌输死板的知识。这也是我理想中的大学教育，不过在今日国内的状况下，似乎还比较遥远。&lt;/p&gt;

&lt;h3&gt;谈读书&lt;/h3&gt;

&lt;blockquote&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;读的书当分种类，一种是为获得现世界公民所必需的常识，一种是为做专门学问。为获常识起见，目前一般中学和大学初年级的课程，如果认真学习，也就很够用。所谓认真学习，熟读讲义课本并不济事，每科必须精选要籍三五种来仔细玩索一番。常识课程总共不过十数种，每种选读要籍三五种，总计应读的书也不过五十部左右。这不能算是过奢的要求。一般读书人所读过的书大半不止此数，他们不能得实益，是因为他们没有选择，而阅读时又只潦草滑过。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;不能通就不能专，不能博就不能约。先博学而后守约，这是治任何学问所必守的程序。我们只看学术史，凡是在某一科学问上有大成就的人，都必定于许多他科学问有深广的基础。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有些人读书，全凭自己的兴趣。今天遇到一部有趣的书就把预拟做的事丢开，用全副精力去读它；明天遇到另一部有趣的书，仍是如此办，虽然这两书在性质上毫不相关。它的好处在使读书成为乐事，对于一时兴到的著作可以深入，久而久之，可以养成一种不平凡的思路与胸襟。它的坏处在使读者泛滥而无所归宿，缺乏专门研究所必需的“经院式”的系统训练，产生畸形的发展，对于某一方面知识过于重视，对于另一方面知识可以很蒙昧。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;我虽然认识到这一点已经很久，但至今也没能完全克服这样的弊病。对此，这本书中还有一段，我认为是很好的药方：&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;读书必须有一个中心去维持兴趣，或是科目，或是问题。以科目为中心时，就要精选那一科要籍，一部一部地从头读到尾，以求对于该科得到一个赅括的了解，作进一步高深研究的准备。读文学作品以作家为中心，读史学作品以时代为中心，也属于这一类。以问题为中心时，心中先须有一个待研究的问题，然后采关于这问题的书籍去读，用意在搜集材料和诸家对于这问题的意见，以供自己权衡去取，推求结论。重要的书仍须全看，其余的这里看一章，那里看一节，得到所要搜集的材料就可以丢手。这是一般做研究工作者所常用的方法，对于初学不相宜。不过初学者以科目为中心时，仍可约略采取以问题为中心的微意。&lt;/p&gt;&lt;/blockquote&gt;

&lt;h3&gt;谈恋爱与婚姻&lt;/h3&gt;

&lt;blockquote&gt;&lt;p&gt;就大体说，我赞成用很自然的方法引导青年撇开恋爱和结婚的路。所谓自然的方法有两种。第一是精力有所发挥，精神有所委托。一个人心无二用，却也不能没有所用。青年人精力最弥满，要他闲着无所用，就难免泛滥横流。假如他在工作里发生兴趣，在文艺里发生兴趣，甚至在游戏运动里发生兴趣，这就可以垄断他的心神，不叫它旁迁他涉。我知道很多青年因为心有所用，很自然地没有走上恋爱的路。第二是改善社交生活，使同情心得到滋养。青年人最需要的是同情，最怕的是寂寞，愈寂寞就愈感觉异性需要的迫切。一般青年追求异性，与其说是迫于性的冲动，毋宁说是迫于同情的需要。要满足这需要，社交生活如果丰富也就够了。一个青年如果有亲热的家庭生活，加上温暖的团体生活，不感觉到孤寂，他虽然还有“遇”恋爱的可能，却无“谋”恋爱的必要。&lt;/p&gt;&lt;/blockquote&gt;

&lt;h3&gt;谈美感教育&lt;/h3&gt;

&lt;p&gt;朱先生认为人类最上的享受是心灵的享受，包括“真善美”三种价值，分别对应学问、道德与艺术。而教育的功用就在顺应人类求知、想好、爱美的天性，使一个人在这三方面得到最大限度的调和的发展，以达到完美的生活。&lt;/p&gt;

&lt;blockquote&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;美育不但不妨害德育而且是德育的基础。而且艺术和美育是“解放的，给人自由的”：第一是本能冲动和情感的解放。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;其次是眼界的解放。我们通常把自己囿在习惯所画成的狭小圈套里，让它把眼界“蔽”着，使我们对它以外的世界都视而不见，听而不闻。比如我们如果囿于饮食男女，饮食男女以外的事物就见不着；囿于奔走钻营，奔走以外的事就见不着。有人向海边农夫称赞他的门前海景美，他很羞涩地指着屋后菜园说：“海没有什么，屋后的一园菜倒还不差。”一园菜囿住了他，使他不能见到海景美。我们每个人都有所囿，有所蔽，许多东西都不能见，所见到的天地是非常狭小的、陈腐的、枯燥的。诗人和艺术家所以超过我们一般人者就在情感比较真挚，感觉比较锐敏，观察比较深刻，想像比较丰富。我们“见”不着的他们“见”得着，并且他们“见”得到就说得出，我们本来“见”不着的他们“见”着说出来了，就使我们也可以“见”着。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;第三是自然限制的解放。在精神方面，人可以跳开自然的圈套而征服自然，他可以在自然世界之外另在想像中造出较能合理慰情的世界。这就是艺术的创造。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
</content>
 </entry>
 
 <entry>
   <title>矫枉过正</title>
   <link href="http://blog.tomsheep.net/2013/03/26/what-the-fork"/>
   <updated>2013-03-26T00:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2013/03/26/what-the-fork</id>
   <content type="html">&lt;p&gt;刚刚结束的&lt;a href=&quot;https://us.pycon.org/2013/&quot; title=&quot;PyCon 2013&quot;&gt;PyCon2013&lt;/a&gt;上出现一条引人注目的新闻，一名女布道师Adria听到坐在身后的两名男工程师的对话中含有“不雅”笑话&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Not cool. Jokes about forking repo&#39;s in a sexual way and &quot;big&quot; dongles. Right behind me.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;于是转身拍下二人的照片公布在twitter上，并在自己的&lt;a href=&quot;http://butyoureagirl.com/14015/forking-and-dongle-jokes-dont-belong-at-tech-conferences/&quot;&gt;博客&lt;/a&gt;中对二人进行声讨。媒体当然不会放过这样的吸引眼球的机会，几轮报道，将两名当事人推到风口浪尖。其中一名工程师旋即被自己的公司解雇。&lt;/p&gt;

&lt;p&gt;这是互联网时代经典桥段：弱势一方受到“不公正待遇”；依靠自媒体将事件公之与众；群情激愤舆论施压；“做坏事者”得到“应有”的惩罚。“正义”得到了伸张。&lt;/p&gt;

&lt;p&gt;当然，如果仅仅是这样，那互联网这个编剧只能算刚刚及格。这个经典模式还有他的下半部分：在PyCon事件中，被解雇的工程师mr-hank在Hacker News上发帖对自己不合时宜的玩笑表示道歉，同时解释Adria所指的两个有性暗示的笑话，关于“Dongles”的是确实是自己低级趣味和身旁工程师讲的三俗段子，但“Fork”一案纯属子虚乌有，真实的上下文是他们对演讲者的项目表示激赏，有兴趣做二次开发（“I would fork his
repo”），AdriaX人X心误解了他们的上下文。自己现如今丢了饭碗，老婆孩子生计都成了问题，非常懊悔。&lt;/p&gt;

&lt;p&gt;这个转变很微妙，mr-hank继Adria之后成为新的弱势一方（舆论总是会选择支持弱者），HN上的群众在跟帖中对mr-hank表示同情，认为他遭受的过分的惩罚，Adria多少有些无理取闹，hank只是在和身边的人扯淡，即便不雅也跟她无关。更有激进者挖坟称Adria是个伪淑女，自己前不久还在twitter上扯&lt;a href=&quot;https://twitter.com/adriarichards/statuses/312265091791847425&quot;&gt;荤段子&lt;/a&gt;……&lt;/p&gt;

&lt;p&gt;这个事件展开到这里，已经有点让人心寒了，这俨然是一个三输的局面，mr-hank因为嘴欠丢了工作，Adria也惹了一身骚，PyCon躺着中枪，出了这样的负面新闻，恐怕形象也会受损。共同点是，他们都遭受了本不应该属于自己的损失。在互联网自媒体时代，“正义”和“真相”变得近在咫尺，却又遥不可及，强大的舆论力量即可以众志成城挽狂澜于既倒，也可以众口烁金让你百口莫辩。给了你百家争鸣的自由，也让你失去思考的习惯。人在抱成一团时总是安全感爆棚，认为自己掌握了真理，不愿再多做哪怕一丝的斟酌；在手中有把刀时，甚至都不会想到其实“给对方一个耳光就可以了”。&lt;/p&gt;

&lt;p&gt;当然，也不必过度惊慌，以为这个时代的另一个特点就是它很健忘——看到有人专门做了&lt;a href=&quot;http://thisispycon.com/&quot;&gt;网站&lt;/a&gt;出来为无辜的PyCon辩解，以免这个优秀的会议遭到大众的误解——其实多虑了，要不了多久，大家就会完全遗忘这件事本身，或许只会留下一两句“What the fork”这样的俏皮话在程序员间流传。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>书同文，车同轨</title>
   <link href="http://blog.tomsheep.net/2013/03/23/blogs-merged"/>
   <updated>2013-03-23T00:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2013/03/23/blogs-merged</id>
   <content type="html">&lt;p&gt;这周用一些业余时间把06年以来在网络上公开发表过的日记、博客等文章整理到了一处，结束了长久以来“一坑未平，一坑又起”的局面。本次整理所得文章共214篇，来源遍及wordpress、diandian、blogbus、renren、QZone等服务。&lt;/p&gt;

&lt;p&gt;整理的过程是又枯燥又有趣的，枯燥的是，需要做大量的脚本工作与不可避免的人工编辑；而浏览这些旧文章则是这项工程中妙趣横生的部分。大体上讲，我是不太“忍心”看旧文章的，这也是我经常换坑的主要原因：每过一段时间，就会觉得过去写的东西非常糟糕，充斥着愚蠢和肤浅，恨不能马上与之划清界限，重新树立牛逼闪闪的品牌。今天也是一样，浏览这些文章时总觉得天雷滚滚，文章的作者真是一朵奇葩。所以整理时偶尔有些顾虑——要不要自己先和谐一遍，出一个“洁本”？&lt;/p&gt;

&lt;p&gt;最后我还是坚持把这些良莠不齐的文字按原貌整理出来，并按照时期与风格划分开来，给自己的网络生涯保留了一份完整的记录。分类名称全部用了四字书名，主要借用了王小波的时代系列：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;黑铁时代: 高中毕业到大学入学左右，基本上是文青风格，感性、敏感，用词比较讲究，文体很奇怪，但结构算比较完整。自我感觉比较良好，喜欢卖弄。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;青铜时代: 转入软件学院后到大三上学期, 有强烈的自我怀疑精神，过度紧张，自命不凡但忧虑会变得平庸。文章有非常统一的风格——就是没有主题，用生命在扯淡。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;白银时代: 大三下半年到毕业，姿态是“自我救赎者”，非常高产，基本是日记体，没有多少有质量的文章，但情感也更真实直接，显得不那么“装”。（感谢那时放下文青身段记了这么多流水帐）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;黄金时代: 毕业后至今的一些零散文章，数量极为有限，励志成分比较多。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;儒林外史: 2012年在点点网开的笔记系列，记一些突发的杂感和读书笔记，风格趋向微博，前期比较有活力。笔记内容质量不高，多数属于入门贴士，但试验出了一种不错的学习方法。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;朝花夕拾: 一些我觉得不太好按时代归类的文章，多数是怀旧主题。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;天工开物: 技术贴，数量很少。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;我（目前）觉得这是挺有意义的一件事，一则是勾画出了一条个人青春时期的成长轨迹，非常有纪念价值（从这个角度讲这些日记与博客的数量不是太多而是太少了）；一则是解放了生产力，中央政府统一了度量衡，有利于产出更多的内容。&lt;/p&gt;

&lt;p&gt;合并后的博客host在Github Pages，对一些访问量比较高的文章url做了映射。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>祛魅（8）</title>
   <link href="http://blog.tomsheep.net/2013/01/15/notes"/>
   <updated>2013-01-15T23:52:31+08:00</updated>
   <id>http://blog.tomsheep.net/2013/01/15/notes</id>
   <content type="html">&lt;p&gt;小结一下近期的ML学习：&lt;/p&gt;

&lt;p&gt;一开始进展非常缓慢，迷失在各种希腊字母和公式里，抓不到核心，也没有贴笔记，因为笔记只有在看懂了的前提下才会起加强理解的作用。后来耐下心查阅遇到的生僻概念，稍微补习了些概率知识，逐渐就没有那么唬人了。&lt;/p&gt;

&lt;p&gt;分析一下这一个多月学习遇到的困难，原因大概有：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;数学尤其是概率论基础比较差，冷启动比较吃力。大学里的《概率论》与《人工智能》课能翘的都翘了……（但这两门课哥都拿了A，哥“混”的能力不是盖的）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;李航的书不适合0基础学员。中国人写书有通病，就是“彪悍不解释”，懂的人怎么看怎么懂，不懂的人怎么看还是不懂。第一遍看到一半就接近天书了，看10分钟书得查2小时wikipedia。后来和Andew Ng的视频以及Tom Mitchell的《机器学习》结合着看，效果就好多了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;学习方法不好，一上来就抓算法，容易浮在表面，看不到模型背后的道理。Andrew Ng教程里有段话，我觉得说的太好，大意是“懂机器学习就像木匠会用工具一样，工具大家都会用，一个好木匠和一般木匠的差别在于知道如何选择工具，并且如何把它运用的更好”。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;这一个多月的笔记暂时不整理了，我觉得还不到时候，等有了所谓sense的时候再总结会更合适。简单列一下各主题的资料：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;生成模型vs.判别模型&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.sciencenet.cn/home.php?mod=space&amp;amp;amp;uid=248173&amp;amp;amp;do=blog&amp;amp;amp;id=227964&quot;&gt;科学网—判别模型 和 生成模型 - 龚书的博文&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/jerrylead/archive/2011/03/05/1971903.html&quot;&gt;判别模型、生成模型与朴素贝叶斯方法 - JerryLead - 博客园&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.gooseeker.com/cn/node/knowledgebase/discriminative_generative_model&quot;&gt;什么是判别模型(Discriminative Model)和生成模型(Generative Model) | GooSeeker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/liliu/archive/2010/11/22/1883702.html&quot;&gt;最大似然估计(Maximum likelihood estimation) - 可乐LL - 博客园&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;逻辑回归&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://52opencourse.com/125/coursera%E5%85%AC%E5%BC%80%E8%AF%BE%E7%AC%94%E8%AE%B0-%E6%96%AF%E5%9D%A6%E7%A6%8F%E5%A4%A7%E5%AD%A6%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%AC%E5%85%AD%E8%AF%BE-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92-logistic-regression&quot;&gt;Coursera公开课笔记: 斯坦福大学机器学习第六课‘逻辑回归(Logistic Regression)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.163.com/liyanhua_08/blog/static/1172002772009927111741738/&quot;&gt;sigmoid函数详解&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/abcjennifer/article/details/7716281&quot;&gt;Stanford机器学习---第三讲. 逻辑回归和过拟合问题的解决&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;人工神经网络：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/wasd6081058/article/details/7909733&quot;&gt;人工神经网络（ANN）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/wasd6081058/article/details/7886697&quot;&gt;线性学习器-----最小二乘法 Rosenblatt感知机 delta法则&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;支持向量机&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/cc198877/article/details/8049203&quot;&gt;SVM入门（七）为何需要核函数&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/cc198877/article/details/8048668&quot;&gt;SVM入门（五）线性分类器的求解——问题的描述Part2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/VC_dimension&quot;&gt;VC dimension - Wikipedia, the free encyclopedia.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/marising/article/details/5888531&quot;&gt;结构风险最小和VC维理论的解释 - 李海波&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://baike.baidu.com/view/5765845.htm&quot;&gt;结构风险最小化_百度百科&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/v_july_v/article/details/7624837&quot;&gt;支持向量机通俗导论（理解SVM的三层境界）&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Boosting&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/szv123_rier/article/details/7963541&quot;&gt;adaboost学习（一）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/LeftNotEasy/archive/2011/01/02/machine-learning-boosting-and-gradient-boosting.html&quot;&gt;机器学习中的数学(3)-模型组合(Model Combining)之Boosting与Gradient Boosting&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;条件随机场&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.zhizhihu.com/html/y2010/2312.html&quot;&gt;随机场-Random Field&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://wenku.baidu.com/view/f32a35d2240c844769eaee55.html&quot;&gt;条件随机场_百度文库&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>祛魅2012</title>
   <link href="http://blog.tomsheep.net/2012/12/21/disenchant-2012"/>
   <updated>2012-12-21T22:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2012/12/21/disenchant-2012</id>
   <content type="html">&lt;p&gt;像我这样恨不得吃个饭都要总结一下的强迫症患者，每年到了岁末当然格外兴奋——又到了回顾与盘点这一年的所作所为所见所想的时候了，反思一下哪些地方做的好，哪些地方做的特别好。&lt;/p&gt;

&lt;p&gt;根据民间的说法，本命年是比较晦气的，诸事不利，需要格外谨慎低调。我妈恨不得把我全身上下都换成血红血红的服饰，武装到牙齿。但这似乎没有起到什么特别有效的制衡效果，全年还是一路磕磕绊绊，颇不顺利；再加上我本身就行为乖张，凭空也自找了很多麻烦。但到今天我写这篇年终报告的时候，我由衷为这些经历感到欣慰与庆幸，感谢它们带给我的成长。我仍然要重复曾经说过无数多次的话，“我大概是这个剧本的主角，每一次都能用很小的代价，换来无价的收获。”&lt;/p&gt;

&lt;p&gt;春节后回到北京没多久，yahoo messenger就被砍了，有些沮丧，而且有些愧疚感，在年前组内技术选型的争执中我也掺和的比较凶，最后项目被砍虽然原因复杂，但总觉得不是滋味，有点阴影，后来很长时间都厌恶参与有关技术优劣的讨论。团队解散后被安插在移动平台组放养了几个月，美国的大佬们忙着换CEO，产品方向飘忽难测，加上之前的解散风波冲得自己有些怨气和倦怠之气，本来已经日渐清晰的道路突然又迷茫了，稍作思索心一横决定离开。当然我还是要说yahoo是值得尊敬的雇主，在我已经决定离开的这段时间里，仍然得到了来自manager和HR的多方关怀与帮助，为此心怀感激。&lt;/p&gt;

&lt;p&gt;很多朋友都问我怎么下决心要走的，出于什么考虑，甚至还要赔户口违约金，我每次回答的都不太一样，因为我也很难搞清楚。我清楚的是我很固执，历史上一旦做了什么决定，基本上我自己都拉不回来。现在我想到一个好的回答，那就是，“让我再掷一次骰子”。我回顾了自己不同时期的很多选择，似乎都是在博一个更大的不确定性。用更装X一点的话，“为了让这个系统的熵更大一点”。&lt;/p&gt;

&lt;p&gt;当时去面了两家公司，知乎和豆瓣。本着“见见世面”的目的，看看这些有点意思的互联网产品是怎么做出来的。后来权衡一下来了豆瓣。有趣的是，当初面试的职位是前端，面试官根据我的履历倾向于安排我做客户端，而真正入职后的工种是Web后台，而实际上我现在最感兴趣的方向是机器学习。这几句戏谑的描述里其实概括了大半年来我对个人发展方向的反思和尝试。&lt;/p&gt;

&lt;p&gt;YM解散之后，原本逐渐清晰的发展方向变得有点模糊，我个人也开始试图做一些新的尝试，当时选的切入点是Web，主要侧重是Web安全与HTML5，原因是YM开发本身就涉及到了这些内容，转型起来比较平滑，后来离开yahoo另谋出路，起初也是试图转这条线的。后来决心去学习ML，则是一段相当长时间的低迷与“技术虚无感”笼罩下的反思结果。目前我无法多说太多，我相信这是一条很长的路，也因此更有魅力，也因此给予人信念。&lt;/p&gt;

&lt;p&gt;4月份开始我在点点上写一份笔记，为了吸引更多人来看，每一篇都会扯很多淡，效果确实很好，很多同事和朋友都成了我的读者——当然他们主要是来看扯淡的。在经历了一段长时间的反思后，我把它改名叫“祛魅”，这个名词的较正式的解释是“曾经一贯信奉的或被追捧的人或物或事或感情或文化或定论，受到新的认识后地位下降”。我觉得真是再贴切不过，这一年的种种成长与收获，无非“祛魅”而已。&lt;/p&gt;

&lt;p&gt;在这篇总结的最后，隆重感谢Girls&amp;amp;Gays（原Beijing Hot）的诸菜，这帮既善良又2B的DS是我在北京最好的朋友，也是我离开yahoo后感到最怀念的部分。“物以类聚”，我越来越相信这个道理。也感谢所有带过我的导师和leader（以及被我祸害过的项目）们、还有所有我喜欢过的和喜欢过我的姑娘们，没能让你们认识更好的我，“在我一生中常常追忆”。&lt;/p&gt;

&lt;p&gt;PS：昨天晚上发现@阿bug游魂野鬼 的签名改成了“想找个性格合适的靠谱妹子”，擦，不愧是基友，一下就说到哥的心槛儿里去了。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>祛魅（7）</title>
   <link href="http://blog.tomsheep.net/2012/12/16/notes-7"/>
   <updated>2012-12-16T23:29:08+08:00</updated>
   <id>http://blog.tomsheep.net/2012/12/16/notes-7</id>
   <content type="html">&lt;h3&gt;Notes on《统计学习方法》(李航)-3：&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;朴素贝叶斯法由训练数据学习联合概率分布P(X,Y), 然后求得后验概率分布，是一种分类+生成学习方法。它有一个强假设，就是输入特征之间满足条件独立性, 比如身高H和体重W为两个特征，他们之间满足&lt;code&gt;P(H=h, W=w|Y=c) = P(H=h|Y=c)P(W=w|Y=c)&lt;/code&gt;。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;先验概率是指根据以往经验和分析得到的概率，如全概率公式，它往往作为“由因求果”问题中的“因”出现。后验概率是指在得到“结果”的信息后重新修正的概率，如贝叶斯公式中的条件概率，是“执果寻因”问题中的“因”。先验概率与后验概率有不可分割的联系，后验概率的计算要以先验概率为基础。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;朴素贝叶斯法的选择0-1损失函数，期望风险最小化即后验概率最大化 &lt;code&gt;f(x)=arg max P(c_k |X=x)&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;朴素贝叶斯法中学习意味着估计先验概率&lt;code&gt;P(Y=c_k)和P(X=x|Y=c_k)&lt;/code&gt;，可以使用极大似然法或贝叶斯法估计。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;最大似然法是要解决这样一个问题：给定一组数据和一个参数待定的模型，如何确定模型的参数，使得这个确定参数后的模型在所有模型中产生已知数据的概率最大。&lt;/li&gt;
&lt;li&gt;在最大似然法中，只考虑了由一个模型产生一个已知数据的概率，而没有考虑模型本身的概率。相对应的考虑了模型本身概率的方法，是贝叶斯估计（在随机变量各个取值的频数上加一个正数 λ）。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>祛魅（6）</title>
   <link href="http://blog.tomsheep.net/2012/12/16/notes-6"/>
   <updated>2012-12-16T23:04:42+08:00</updated>
   <id>http://blog.tomsheep.net/2012/12/16/notes-6</id>
   <content type="html">&lt;h3&gt;Notes on《统计学习方法》(李航)-2：&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;感知机（perceptron）是二类线性分类模型：&lt;code&gt;f(x)=sign(w·x + b)&lt;/code&gt; ，输出为+1或-1；感知机对应于输入空间（特征空间）中的分离超平面&lt;code&gt;w·x + b = 0&lt;/code&gt; w是超平面的法向量，b是截距。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;补一段数学基础：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;仿射空间: 给定的n维空间中，k维仿射空间由空间中的一点P和k个线性无关的向量v1,v2,v3,...,vk决定, 空间中的一条直线是一个1维仿射空间，一个平面是一个2维仿射空间。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;超平面：在给定的N维空间中，超平面由空间中的一点P和一个向量n决定，超平面方程为 &lt;code&gt;n*(i-P)=0&lt;/code&gt;，其中i表示超平面上的任意一点。i,n,p均为N维向量。n为超平面的法向量。若&lt;code&gt;i=(i1,i2,..,iN),n=(n1,n2,..,nN), p=(p1,p2,..pN)&lt;/code&gt;,则超平面方程可以表示成： &lt;code&gt;n1*i1+n2*i2+...nN*iN+d=0&lt;/code&gt;。二维空间的超平面是一条直线，三维空间的超平面是一个平面，而N维空间的超平面则是N-1维的仿射空间。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;点到面的距离：&lt;code&gt;d=|向量AB*向量n|/向量n的模长&lt;/code&gt; d表示点A到面的距离，向量AB是以点A为起点，以平面上任意一点为终点的向量，向量n是平面的法向量。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;感知机的损失函数一般选为误分类点（就是分类错误，&lt;code&gt;wx_i +b&lt;/code&gt;和&lt;code&gt;y_i&lt;/code&gt;符号相反的点）到超平面S的总距离（因为这个函数连续可导，而且符合损失函数的要求）；所以感知机学习策略是极小化损失函数：&lt;code&gt;L(w,b) = -\sum{y_i(wx_i + b)}&lt;/code&gt;, &lt;code&gt;x_i&lt;/code&gt;为误分类点。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;感知机学习算法是基于“随机梯度下降法”对损失函数的最优化算法：随机选取一个超平面，然后一次选一个误分类点使其梯度下降，不断极小化目标函数。这个算法是收敛的，在训练数据集上的误分类次数满足不等式&lt;code&gt;k&amp;amp;lt;=(R/r)^2&lt;/code&gt;, &lt;code&gt;r = min(y_i(wx_i + b))&lt;/code&gt;, &lt;code&gt;R=max||x_i||&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;感知机只能处理“线性可分问题”：即特征空间中，存在某个超平面S：&lt;code&gt;wx+b=0&lt;/code&gt;，使得数据集中的正实例点和负实例点完全正确地划分到超平面两侧。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>祛魅（5）</title>
   <link href="http://blog.tomsheep.net/2012/12/16/notes"/>
   <updated>2012-12-16T22:36:21+08:00</updated>
   <id>http://blog.tomsheep.net/2012/12/16/notes</id>
   <content type="html">&lt;h3&gt;Notes on《统计学习方法》(李航)-1：&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;统计学习的方法是基于数据构建统计模型从而对数据进行预测和分析。统计学习的三要素：模型、策略、算法。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;在监督学习（训练数据既有输入也有输出）中，模型就是所要学习的条件概率或决策函数。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;策略：确定了假设空间后，就需要考虑按照什么样的准则学习或选择最优模型。监督学习的两个基本策略是经验风险最小化和结构风险最小化。风险函数是损失函数的期望，学习的目标就是选择期望风险（泛化误差）最小的模型。期望风险&lt;code&gt;R_exp(f)&lt;/code&gt;是模型关于联合分布的期望损失，经验风险&lt;code&gt;R_emp(f)&lt;/code&gt;是模型关于训练样本集的平均损失。当样本容量趋于无穷时，&lt;code&gt;R_emp(f)&lt;/code&gt;趋于&lt;code&gt;R_exp(f)&lt;/code&gt;. 通常用经验风险估计期望风险。 当样本容量过小时，经验风险最小化容易出现“过拟合”（模型过于复杂，对已知数据预测的好，对未知数据预测过差）；结构风险在经验风险上加上表示模型复杂度的正则化项(regularizer) J(f)，表示了对复杂模型的惩罚。正则化符合奥卡姆剃刀原理：在所有可能选择的模型中，能够很好的解释已知数据并且十分简单才是最好的模型。一句话就是be simple.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;算法指学习模型的具体计算方法。这时学习问题归结为最优化问题。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;交叉验证的基本想法是重复地使用数据，把给定的数据进行切分，将切分数据集组合为训练集与测试集，反复进行训练、测试以及模型选择。常用方法有简单交叉验证（将已知数据随机氛围训练集和测试集）、S折交叉验证（将数据切分为S个大小相同的子集，S-1个用于训练，余下的作为测试集，对S种选择重复进行）、留一交叉验证（S折里S=N的特殊情况）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;监督学习方法可以分为生成方法和判别方法。生成方法由数据学习联合概率分布P(X,Y)，然后求出条件概率分布P(Y|X)作为预测的模型（如朴素贝叶斯法和隐马尔可夫模型）；判别方法由数据直接学习决策函数f(X)或者条件概率分布P(Y|X)作为预测的模型，关心的是给定输入X，应该预测什么样的输出Y。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;生成方法可以还原出联合概率分布P(X,Y)，收敛速度更快&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;判别方法直接面对预测，往往学习的准确率更高。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;输入变量X与输出变量Y均为连续变量的预测问题成为回归问题（学习过程等价于函数拟合）；Y为有限个离散变量的称为分类问题；X，Y均为变量序列的称为标注问题。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>祛魅（4）</title>
   <link href="http://blog.tomsheep.net/2012/12/10/notes"/>
   <updated>2012-12-10T00:03:35+08:00</updated>
   <id>http://blog.tomsheep.net/2012/12/10/notes</id>
   <content type="html">&lt;p&gt;下午约见一位兄台，顺便一道听了一节刘鹏博士的讲座，大部分没有听懂，尴尬得连笔记都不知从何记起。倒是后来和这位兄台一起吃饭聊天，得到很多启发和帮助。&lt;/p&gt;

&lt;p&gt;当初大一初学编程时，曾经在某网站上受过他一些指点，多年后辗转来到北京，就此相识，也算是奇遇。今天又谈了些工作与学习的话题，主要和机器学习有关。故事的背景是我逐渐对这个领域有较深的兴趣，希望能在日常的“工程能力”之外，抓住一条深入发展的主线——用他的话说，就是“能玩一辈子的东西”。而他正好也是机器学习的爱好者，借此交流一下心得。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;他和我年龄相近，出道稍早，在一家网站带一个小团队，做过很多在我看来很有锻炼价值的实践，谈起来让人惭愧又羡慕。这再次让我觉得自己像是实验室里无土栽培的蔬菜，一路风调雨顺，拿着比他高一截的薪水，但不接地气，胸中无货手下没活。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;谈到机器学习，他分享了一些自己的经验，推荐并点评了一些领域里上手书籍的优缺点，告诉我从工程师的角度，从数学学起不是最好的切入点，直接入手机器学习的脉络，需要深挖时再回头来研究数学原理效果好的多。在实践中尤其是这样，跑在线上的东西往往是简单的模型。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;聊天中说到机器学习应用目前最为火热的“广告”，我说这大概是学术变现最好的领域之一了吧，他同意后说了一段我觉得很有见地的话，大意是：“赚不赚其实和领域关系没那么大，和‘人’的关系最大，有的人不论做什么领域，都能很好的变现，性格和气质使然。像我就不太适合，有点像羊。”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我提到我考虑过去读这个领域的博士，他很赞成，但我说青春可能就这么搭进去了，落得孤家寡人晚景凄凉如何是好，大家彼此摇头笑笑。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;他打趣说，“你在线上那么霸气，在线下这么客气”——这个描述真是太有趣了。我觉得评价很到位，也很让人……闹心。所以说，我才像羊，汤姆羊。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>祛魅（3）</title>
   <link href="http://blog.tomsheep.net/2012/12/06/notes"/>
   <updated>2012-12-06T07:46:37+08:00</updated>
   <id>http://blog.tomsheep.net/2012/12/06/notes</id>
   <content type="html">&lt;h3&gt;Notes on Linear Algebra 1:&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;线性代数核心围绕矩阵的四大向量空间的特性以及其相互的关系展开，即列空间C(A), null空间N(A), 行空间C(A&lt;sup&gt;T&lt;/sup&gt;), left-null空间N(A&lt;sup&gt;T&lt;/sup&gt;)。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;若m * n的矩阵A的秩为r，&lt;code&gt;rank(A)=r&lt;/code&gt;, 则几大空间的维度&lt;code&gt;dim(C(A)) = dim(C(A^T)) = r&lt;/code&gt;, &lt;code&gt;dim(N(A)) = n-r&lt;/code&gt;, &lt;code&gt;dim(N(A^T)) = m-r&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;C(A) 和N(A&lt;sup&gt;T&lt;/sup&gt;)互为R&lt;sup&gt;n&lt;/sup&gt;中的正交补, C(A&lt;sup&gt;T&lt;/sup&gt;)和N(A)互为R&lt;sup&gt;m&lt;/sup&gt;中的正交补。（两个子空间A、B正交，即A中任意向量与B中任意向量垂直，即点积为0；互为正交补则还需满足两空间维度和等于母空间维度）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;线性方程组&lt;code&gt;Ax=b&lt;/code&gt;有解当且仅当向量b在C(A)空间中。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;高斯消元在解线性方程组中用途很广&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;A = LU&lt;/code&gt;分解，左乘&lt;code&gt;L^-1&lt;/code&gt;变&lt;code&gt;Ax=b&lt;/code&gt;为 &lt;code&gt;Ux=c&lt;/code&gt;, 其中&lt;code&gt;L^-1&lt;/code&gt;可视作一系列转置矩阵（行变换）的乘积。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;求A的null空间，即解&lt;code&gt;Ax=0&lt;/code&gt;：求&lt;code&gt;rref(A)&lt;/code&gt;,化A为&lt;code&gt;[I F]&lt;/code&gt;形式，则其null空间的一组基为……擦，我打不出来了，脑补吧，阿门。（[-F//I] 发明一个标记//, 表示下面的I是排列在F之下的。）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;Ax=b&lt;/code&gt;若有解，则其解为&lt;code&gt;x = xp + xn&lt;/code&gt;, xp为任一组特解， xn为N(A)的一般表达式。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;消元中主元（pivots）的个数即为A的秩。主元所在的列构成C(A)的一组基；主元所在的行构成C(A&lt;sup&gt;T&lt;/sup&gt;)的一组基；另外，消元后的行也构成C(A&lt;sup&gt;T&lt;/sup&gt;)的一组基，但消元后的列就不是C(A)的基了。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;投影：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;空间C(A)的投影矩阵&lt;code&gt;P=A(A^T A)^(-1) A^T&lt;/code&gt;; 使得向量b投影到空间A中：&lt;code&gt;p=Pb&lt;/code&gt;，则必有向量x使得&lt;code&gt;Ax=p&lt;/code&gt;； 相应的投影到N(A&lt;sup&gt;T&lt;/sup&gt;)中：&lt;code&gt;e=(I-P)b,  e + p = b&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;投影矩阵P具有特性：&lt;code&gt;P^T = P, P^2 = P&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;A^T*A&lt;/code&gt;是个对称的&lt;code&gt;n*n&lt;/code&gt;方阵。&lt;code&gt;A^T*A&lt;/code&gt; 和 A的秩是相等的（通过证明其null空间是相等的获证）。可推出有用的结论：如果A是列满秩的，则&lt;code&gt;A^T*A&lt;/code&gt;满秩。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最小二乘原理: &lt;code&gt;Ax=b&lt;/code&gt;转化为 &lt;code&gt;A^T*Ay = A^T*b&lt;/code&gt;。和利用微积分偏导进行推演殊途同归。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;线性代数在图和网络中的应用：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;用edge-node incidence matrix（我不会翻译）表示n个点，m条边的有向图： 矩阵A，m * n，每一行代表一条边，如果这条边是从j指向k，则j列为-1，k列为+1.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;rank(A) = n - 1&lt;/code&gt;, &lt;code&gt;(1,1,1,1..)^T&lt;/code&gt; 必属于N(A)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果将x看作各点的电势，b则表示每条边两端的电势差，Ax=b有解的条件则可以用来描述Kirchhoffs Voltage Law： 环内电势差之和为0。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A的主元行（有n-1行）构成一个无环图（一棵树）。&lt;code&gt;N(A^T)&lt;/code&gt;的维度表示图有多少个小环（理解方式：&lt;code&gt;A^T y = 0&lt;/code&gt;的含义为： Flow in equals now out at every node。解&lt;code&gt;A^T y = 0&lt;/code&gt;则相当于找一组不汇聚到任一点的电流。）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;（# of nodes) - (# of edges) + (# of loops) = (n) - (m) + (m - n + 1) = 1&lt;/code&gt; ：这货就是欧拉定理。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最后，总结到一点就是：点点的编辑器不适合写公式。Q.E.D.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>祛魅（2）</title>
   <link href="http://blog.tomsheep.net/2012/12/04/notes"/>
   <updated>2012-12-04T22:51:15+08:00</updated>
   <id>http://blog.tomsheep.net/2012/12/04/notes</id>
   <content type="html">&lt;p&gt;我觉得是时候重新开始做笔记了。好像停了很久，以至于再回来时点点网都面目全非了。这是我摸索出的切实有益的习惯之一，好习惯需要坚持。&lt;/p&gt;

&lt;p&gt;有些朋友偶尔问起“怎么看不到你的吐槽了？”，我总是说，“这是个心理问题。” 我对这个外交辞令非常满意，因为如果推而广之的话，几乎所有问题都是心理问题，无懈可击。几周前ccz过生日的时候聊天，问起我近期的感受，尤其是从yahoo到豆瓣的感受。我说：“过去我所吐槽的那些东西真的不见了，但我没有因此变得更加快乐。”我的语言表达能力一向很差，突然说出这么精准的话来，自己都吓了一跳。&lt;/p&gt;

&lt;p&gt;“慵懒”可能是我想到的形容词里和近一段时期我的心理状态最为接近的一个，后来慵懒之下，去看几本党史，发现或许比“慵懒”更恰当的比喻是：文革过后普通国人的心理状态。对技术的狂热顿时无从着落，从降温、疑惑转而生发出犬儒的一点情绪。所幸一份普通工程师的工作并不需要时刻保持对技术的无限热爱，多数情况下凭借惯性与经验就足够应付了。&lt;/p&gt;

&lt;p&gt;我在和BJ Hot的诸菜们聊天时说自己梦想的是“自由的生活状态”，但所有的自由都是建立在财务自由的基础之上的，所以多数的野心和激情也是为了这一目的做出的铺垫。现在梦想没有变，只是执行的人遇到了一点小状况，原因不详，大概只能归因为“心理问题”。&lt;/p&gt;

&lt;p&gt;意识到我如果不做技术再没有别的糊口方案，长成这样恐怕连切糕都卖不了，遑论生活自由了。但这是一个循序渐进的过程，先从这份笔记开始吧。内容涉及的领域我还没有想请楚，两个月前我对组内同事说对Haskell有些兴趣，其实现在已经兴致不高，但对于历史遗留问题，我认为是需要做出交待的。还有，也许不会有太多吐槽内容了，哥在成长，吐槽这种没品的事，还是……还是留给新浪微博吧。更何况我是一个病人，你们也忍心让一个病人讲笑话给你听？&lt;/p&gt;

&lt;p&gt;谁说忍心？好吧，你就是三楼楼长了。&lt;/p&gt;

&lt;p&gt;这是最近看过或正在看的一些有益的书与课程：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;麻省理工公开课： &lt;a href=&quot;http://v.163.com/special/opencourse/daishu.html&quot; title=&quot;线性代数&quot;&gt;线性代数&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Linear Algebra and Its Applications Fourth Edition, by Gilbert Strang&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;哈佛大学公开课： &lt;a href=&quot;http://v.163.com/special/sp/positivepsychology.html&quot; title=&quot;幸福课&quot;&gt;幸福课&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>祛魅（1）</title>
   <link href="http://blog.tomsheep.net/2012/10/22/notes"/>
   <updated>2012-10-22T23:46:56+08:00</updated>
   <id>http://blog.tomsheep.net/2012/10/22/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;读一本书，作者起先大讲“人格失调证”和“神经官能症”，他们的症状分别是“I can not”和“I should have”，这让我很为难，按我这个病情到底应该确诊为哪一类好呢？真是伤脑筋，正一筹莫展之际，作者充分展示出其人文关怀的一面，旋即抛出“人格神经官能症”一词，问题遂解。整个世界都清净了。—— 可见占星术不愧是当世显学，果然是一门有极深奥义的学问。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;Xiping: 什么是“开光”？&lt;/p&gt;

&lt;p&gt;Kang: 就是一种仪式，比如你请（买）了一件法物，找有道行的法师帮你诵经念咒，你的宝贝就有灵性了……&lt;/p&gt;

&lt;p&gt;Xiping: 你直接说“激活”我就懂了。&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在蜂巢看完《两只狗的生活意见》后直赞叹，演员真是好本事。笑料和演技撑起了这部戏，推进的游刃有余。如果把核心单抽出来的话，肯定就拧巴了。立时从一部雅俗共赏人民群众喜闻乐见的话剧变成“人格神经官能症”患者治愈片了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;其实看过这么多喜剧，在我心目中最伟大的喜剧作品人物没有之一一直都是：于谦的父亲。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;看完演出回家的地铁上ccz拿着手机问我他下的小说是不是伪本的《废都》。一看就是假的，都没有“口口口口口口”…… 后来我们就很严肃地探讨《金瓶梅》《觉后禅》等古典文学名著了——笑点是什么？笑点是我们是真 在
很严肃的探讨……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;为什么很久不更新，然后笔记就改名字了？最近一个月都在看小说，看得就要“人格神经官能症”了，觉得还是回来扯扯淡吧。 而且扯淡这么高雅的事情，怎么能让不入流的技术笔记玷污了去呢？ “祛魅”是什么意思？我大概是这么觉得的，当你看到这个标题的时候，肯定会是这个反应：我去，你妹啊。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（95）</title>
   <link href="http://blog.tomsheep.net/2012/09/25/notes"/>
   <updated>2012-09-25T00:46:19+08:00</updated>
   <id>http://blog.tomsheep.net/2012/09/25/notes</id>
   <content type="html">&lt;h4&gt;翻译：Monad是什么鬼东西？&lt;/h4&gt;

&lt;h4&gt;作者：Noel Winstanley, 1999&lt;/h4&gt;

&lt;h4&gt;免责声明：本文翻译自网络文章 &lt;a href=&quot;http://web.cecs.pdx.edu/~antoy/Courses/TPFLP/lectures/MONADS/Noel/research/monads.html&quot; title=&quot;What the hell are Monads?&quot;&gt;What the hell are Monads?&lt;/a&gt; ，版权归原作者所有，译文仅供学习、研究、参考之用。&lt;/h4&gt;

&lt;h3&gt;介绍&lt;/h3&gt;

&lt;p&gt;有不少人请我讲讲关于monad的事情，在邮件列表中我也看到了类似的呼声，于是便有了这篇介绍单子（monad）、单子编程(monadic programming)与IO的文档。这篇文章主要以例程（而非纯理论）示人， 并假定读者对Haskell有初步的了解。Maybe 曾几何时，人们写Haskell程序是通过一种特定的方式把操作序列化起来的。Prelude模块中Maybe类型是这样定义的：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;kr&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Maybe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Just&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Nothing&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;它可以被用来为失败操作建模（用通用的方式处理failure），例如，下面这个类型的函数&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Maybe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;可以接受一个a，其结果要么产生一个b（被Just构造器包装），要么失败返回Nothing。&lt;/p&gt;

&lt;h3&gt;举例&lt;/h3&gt;

&lt;p&gt;一个数据库应用中，查询操作可能具有下面的形式：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;doQuery&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;DB&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Maybe&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Record&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这个函数将一个Query作用于DB之上，它的返回值要么是一个Record，要么失败返回Nothing。如果程序员想运行一系列的query操作，前一个查询的结果作为下一个查询输入的一部分，那他必须在每一个查询之后进行显式的错误检查：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Maybe&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Record&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doQuery&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q1&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;of&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;Nothing&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Nothing&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;Just&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r1&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doQuery&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;of&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;Nothing&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Nothing&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;Just&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r2&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doQuery&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;of&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;Nothing&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Nothing&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;Just&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r3&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;随着嵌套的加深，情况就有些让人恼火了。所以一个有节操、希望重用代码的程序员定义了下面的combinators，用来完成这个模式下的错误检查。&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;thenMB&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Maybe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Maybe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Maybe&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mB&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thenMB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mB&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;of&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;Nothing&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Nothing&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;Just&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;让我们用thenMB这个combinator来重写上面的数据库操作代码：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Maybe&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Record&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doQuery&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;q1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thenMB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r1&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;doQuery&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thenMB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r2&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;doQuery&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;q3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thenMB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;....&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这下代码看上去简洁顺眼多了，无论理解还是读写调试都便利不少，而函数的功能和类型和原来的版本是完全一样的。&lt;/p&gt;

&lt;h3&gt;State&lt;/h3&gt;

&lt;p&gt;另一个常见的计算模型是，通过一系列的函数来“线性”修改状态：每一个函数接受一个状态并返回一个修改后的状态版本。这些函数被称之为状态转换器（State Transformer），我们定义一个类型别名来说明：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;kr&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;StateT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;回到刚才的例子, 还是在数据库应用中，有添加、删除记录的操作：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;addRec&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Record&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;DB&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;DB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;delRec&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Record&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;DB&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;DB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;每一个状态转换器都接受一个Record和旧的数据库实例，返回一个新的数据库，连同一个布尔类型的标识来表明操作是否成功。使用上面我们定义的类型别名，这些状态转换器可以写成：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;addRec&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Record&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;StateT&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;DB&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Bool&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;delRec&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Record&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;StateT&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;DB&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Bool&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;因此addRec和delRec就是被Record参数化了的状态转换器。但是，目前使用这些状态转换器来编程还是有些别扭：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;newDB&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;StateT&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;DB&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Bool&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;newDB&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bool1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;addRec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rec1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bool2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;addRec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rec2&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db1&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bool3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;delRec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rec3&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;db2&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bool1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bool2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bool3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;db3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;上面的代码在数据库中添加、删除了一些记录：返回新数据库和所有操作布尔标识的“合取值”（交）。注意这里每一个状态转换器产生的新数据库和布尔标识必须显式地传给下一个转换器。这会变得很难调试，因为中间步骤中很容易不小心传错值。
又是这个有节操的程序员，吸取了Maybe的经验后，定义了一个combinator来序列化状态转换器：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;thenST&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;StateT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;StateT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;StateT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;st&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thenST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;st&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;thenST把前一个状态转换器的状态结果传入下一个转换器。这里定义另一个combinator，returnST，它的作用是把一个普通的值升格（lift）成一个状态转换器：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;returnST&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;StateT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;returnST&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;使用这些combinator后，上面的例子就可以写作：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;newDB&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;StateT&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;DB&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Bool&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;newDB&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;addRec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rec1&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thenST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bool1&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;addRec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rec2&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thenST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bool2&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;delRec&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rec3&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thenST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bool3&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;returnST&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bool1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bool2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bool3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这里这些combinator负责数据库在状态转换器间的线性传递：这个编程模式和Maybe例子中的thenMB有异曲同工之妙。显然，这个“利用combinators来管理参数传递以及运算流”的编程模型是结构化代码、让程序更清晰的利器。事实上，这个思想还可以用到其他很多计算模型中：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;数据结构：列表、数、集合&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;运算流：Maybe、错误报告、non-determinism&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;传值：StateT、环境变量、输出生成&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;和外部环境交互：IO、GUI、foreign language interfaces&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;另外一些诡异的东东：combinator解析、并行、可变数据结构&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;h3&gt;于是乎，终于轮到Monad出场了&lt;/h3&gt;

&lt;p&gt;如果上面这些模型都可以使用一套combinators那就再好不过了，这样一来不进可以有统一的标记符，还能为这些模型编写通用的类库。幸运的是，monad已经使这一切变成了现实。monad是一种类型，在它之下定义了两个操作符，分别是then和return，这两个操作符满足下列法则：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Monad“类型类”&lt;/h3&gt;

&lt;p&gt;Haskell为Monad定义了一个类型构造器：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;kr&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Monad&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;where&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;中缀操作符&lt;code&gt;&amp;gt;&amp;gt;=&lt;/code&gt;就是所谓的&quot;then&quot;, 而且这里还定义了&lt;code&gt;&amp;gt;&amp;gt;=&lt;/code&gt;的一种特殊情况：&lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;，这种情况下忽略前一个动作(action)的结果。现在，任何实现了这些combinators的类型可以视为Monad类型类的一个实例。举个栗子，Maybe就可以这样定义：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;kr&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Monad&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Maybe&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;where&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thenMB&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Just&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;StateT也可以照猫画虎一般给出定义。&lt;/p&gt;

&lt;p&gt;注意：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Haskell不允许用类型别名作为类型类的实例，所以我们需要重新用data声明语句重新定义StateT，并且调整thenST和returnST的定义以满足类型构造器的需要。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;对于Monad类型类的所有实例，上面的那几条法则必须适用。但Haskell编译器是没办法强制检查那几条法则的，全看程序员的节操。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;现在所有monad都有了一个共同的标识符，通用的combinators可以被定义出来。Prelude模块包含了一些这样的combinators，更多的则位于Monad模块中。其中一个例子是来自Prelude中的sequence：接受一个列表的monadic运算，执行每一个并将他们的结果用一个列表返回。使用Monad类型类中的combinators来定义它：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Monad&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Do标识符&lt;/h3&gt;

&lt;p&gt;Haskell在monadic编程中支持“Do”这个语法糖：Do可以翻译成 &lt;code&gt;&amp;gt;&amp;gt;=&lt;/code&gt;, &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;, &lt;code&gt;then&lt;/code&gt;等combinators, 结合示例更好理解。例如，Prelude中的accumulate这样定义：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;accumulate&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Monad&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;accumulate&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;accumulate&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accumulate&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cs&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;基本的规则是：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;do关键字引入一些列monadic运算，用缩进来间隔（就像let表达式那样）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;&amp;lt;-&lt;/code&gt;用来把一个变量&quot;绑定&quot;到一个monadic运算的结果上。（代替使用&lt;code&gt;&amp;gt;&amp;gt;=&lt;/code&gt;）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;那些忽略运算结果的运算可以直接用间隔来表示（无需&lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;操作符）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;do语句必须以&lt;code&gt;return&lt;/code&gt;或者一个monadic运算（非&lt;code&gt;&amp;lt;-&lt;/code&gt;）结束&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;h3&gt;深入Monadic类型&lt;/h3&gt;

&lt;p&gt;Haskell还包含了许多与monad相关的类型类。这里我们就不详加介绍了。我才不会告诉你他们是Functor和MonadPlus呢。（分别在Prelude和Monad模块中定义）&lt;/p&gt;

&lt;h3&gt;Monadic IO&lt;/h3&gt;

&lt;p&gt;输入/输出是纯函数式编程语言中老生常谈的问题。这些（纯函数式）编程语言的一条神圣不可侵犯的条例是：每一个函数必须可以被它的参数所确定（译者按：即是“引用透明”的，意思是同样的参数必然得到同样的结果）。然而，对于IO操作来说这是不可能的。举例来说，让我们定义一个getChar函数，从一个FileHandle中读出一个字符：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;getChar&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;FileHandle&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Char&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;不幸的是，这个函数每次调用并不一定会返回相同的值。这是因为它取决于读取时文件的状态，每次getChar都会改变这一状态。
一个解决方案是，把状态显式地传给getChar并返回一个新状态。我们把这个状态泛化称作World，于是getChar函数变为：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;getChar&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;FileHandle&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;World&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;World&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;使用这个技巧，每个IO函数传入一个World状态，返回一个改变后的World。看上去不错——似乎实现了“引用透明”。然而，我们需要保证每个World状态只被使用过一次（如果一个World可被使用多次，那意味着程序必须维护所有之前的World状态，这是及其低效的） 一个解决方法（Clean语言就是这样做的）是引入 Uniqueness Types——拓展类型系统来保证World值只被使用一次。但Haskell有自己的高招，它用monad解决了“单次使用”的问题。注意getChar只是一个状态转换器，可以被重写成：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;getChar&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;FileHandle&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;StateT&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;World&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Char&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;现在使用以stateT定义的monadic combinators，我们就能保证每个World只被传入了一个IO函数，并且将新产生的状态传入下一个IO函数。唯一遗留的问题是World可以在这个运算序列的结尾处被访问到，留下了可以被误用的可能性（比如把结果状态传入两个新的StateT运算）这可以用一个被称作IO的ADT来解决，这个ADT是Monad类型类的一个实例：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;kr&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;IO&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;IO&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;StateT&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;World&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;ADT的关键特性在于程序员无法访问其类型的内部组件。这就阻止了IO操作返回的World被程序员任意操作。getChar现在可以写作：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;getChar&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;FileHandle&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;IO&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Char&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;运行IO操作的唯一途径是定义&lt;code&gt;main::IO()&lt;/code&gt;，其中包括一系列IO操作。main函数显式传入world状态到IO操作序列，这样运行顺序就得到了保证。
注意：类型IO()用来标识无返回值的IO操作，言下之意就是只关心其“副作用”(side-effect) 例如&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;putChar&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Char&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;IO&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;IO Monad编程&lt;/h3&gt;

&lt;p&gt;Prelude模块定义了标准输入输出流上的IO函数，IO模块则提供了更高级的针对文件句柄的IO函数。另外，许多通用的Monad combinators在IO编程中也十分有用。
IO函数不仅有针对单个字符的操作，还有更加强大的如：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;n&quot;&gt;getContents&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;IO&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;readFile&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;FilePath&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;IO&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;writeFile&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;FilePath&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;IO&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;getContents和readFile“惰性地”读入一整个输入流，返回一个惰性列表（译者按：只在需要其值时进行运算）writeFile则相反，写入一个（可能是惰性的）列表到文件。
这是一个优雅地实现读取输入到程序、同时保证大部分的程序逻辑是“无Monad”的途径。用一个简单的Unix工具wc作为例子：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;haskell&quot;&gt;    &lt;span class=&quot;kr&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;System&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;getArgs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;IO&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;do&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getArgs&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;of&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fstr&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;readFile&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fname&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nWords&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fstr&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;nLines&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fstr&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;nChars&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fstr&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;putStrLn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unwords&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nLines&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nWords&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nChars&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;putStrLn&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;usage: wc fname&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;其中：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;getArgs :: IO [String]&lt;/code&gt;返回命令行参数列表&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;检查命令行参数是否合法（只包含一个filename）如果不合法则打印帮助信息然后退出；否则文件被惰性地读入并进行统计&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;统计中使用&lt;code&gt;length :: [a] -&amp;gt; Int&lt;/code&gt;来计算单词、行以及字母列表的长度。前两个列表是分别通过 &lt;code&gt;words :: String -&amp;gt; [String]&lt;/code&gt;和 &lt;code&gt;lines :: String -&amp;gt; [String]&lt;/code&gt;两个函数计算出的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;统计结果在putStrLn打印之前被&lt;code&gt;show :: Show a =&amp;gt; a -&amp;gt; String&lt;/code&gt;和&lt;code&gt;unwords :: [String] -&amp;gt; String&lt;/code&gt;格式化。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;注意do代码块的嵌套，以及case、let语句的缩进&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;注意到我们必须在case语句前使用getArgs操作并把其结果传入case，不能直接&lt;code&gt;case getArgs of ..&lt;/code&gt;，因为getArgs具有IO [String]类型，而非[String]，ADT无法用于模式匹配。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;这个解决方案是低效的：它便历了文件内容五遍。一个更高效的实现应该并行进行统计，或者使用自制的遍历函数，或者使用foldr.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;h3&gt;总结与延伸阅读&lt;/h3&gt;

&lt;p&gt;在伟大光荣正确的党的带领下（译者按：信达雅），monads看上去不像当初那么晦涩难懂了呢。一旦对它有所理解，就可以用monad来解决很多问题，它在构建大型系统时很有帮助。实话告诉你吧，monad甚至有一种被过度使用的危险（我不就是一个么），以至于会忘记使用Haskell本身的纯函数范式。
市面上有很多关于monad的公开著作，但是，他们中的很大一部分都是面向理论学者的，而非普通程序员。这里有一些互联网上可以找到的资料：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;理论: Phillip Wadler 是把Monad引入函数式编程的研究人员之一。他维护着一个&lt;a href=&quot;http://cm.bell-labs.com/cm/cs/who/wadler/topics/monads.html&quot; title=&quot;详尽的列表&quot;&gt;详尽的列表&lt;/a&gt;，里面是他关于monad的著作。可能会让你觉得有点难读，标注符号和Haskell也有区别，但绝对值得一看。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Monadic Parser Combinators： Graham Hutton 和 Erik Meijer发表了一篇教程性质的 &lt;a href=&quot;http://www.cs.nott.ac.uk/Department/Staff/gmh/bib.html#pearl&quot; title=&quot;论文 &quot;&gt;论文&lt;/a&gt;，介绍monads在通用结构化编程中的应用。parser combinator类库也有提供，值得拜读。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;其他：Simon Peyton Jones有一个 &lt;a href=&quot;http://research.microsoft.com/Users/simonpj/Papers/papers.html&quot; title=&quot;论文列表&quot;&gt;论文列表&lt;/a&gt; ，收录了他和他的同事的作品。其中相关的有 &lt;a href=&quot;http://research.microsoft.com/Users/simonpj/Papers/papers.html#applications&quot; title=&quot;foreign language integration&quot;&gt;foreign language integration&lt;/a&gt; , &lt;a href=&quot;http://research.microsoft.com/Users/simonpj/Papers/papers.html#monads&quot; title=&quot;monads, state &amp;amp; concurrency&quot;&gt;monads, state &amp;amp; concurrency&lt;/a&gt; , 以及 &lt;a href=&quot;http://research.microsoft.com/Users/simonpj/Papers/papers.html#gui&quot; title=&quot;graphical user interfaces&quot;&gt;graphical user interfaces&lt;/a&gt; .&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（94）</title>
   <link href="http://blog.tomsheep.net/2012/09/23/notes"/>
   <updated>2012-09-23T22:14:43+08:00</updated>
   <id>http://blog.tomsheep.net/2012/09/23/notes</id>
   <content type="html">&lt;p&gt;在硬盘里淘老软件竟有在旧书摊淘旧书的乐趣。这个MAME模拟器告诉我，每一个遥远的游戏都是一段故事：&lt;/p&gt;

&lt;h3&gt;《卡迪拉克与恐龙》&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/dinosaurs.png&quot; alt=&quot;卡迪拉克与恐龙&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Cadillacs_and_Dinosaurs_(video_game)&quot; title=&quot;《卡迪拉克与恐龙》&quot;&gt;这款游戏&lt;/a&gt;在上世纪90年代风靡一时，占据了大小街机店的重要位置。故事改编自漫画《&lt;a href=&quot;http://en.wikipedia.org/wiki/Xenozoic_Tales&quot; title=&quot;Xenozoic Tales&quot;&gt;Xenozoic Tales&lt;/a&gt;》。故事背景设定在26世纪，那是地球污染问题严重，人们建立了大量地下城市来居住，而地面上又成为恐龙们的乐园。反派人物Simon Fessenden博士建立实验基地企图利用恐龙控制世界。游戏有四个主人公，有趣的是真正的主角Jack(白人小伙)和 Hannah（性感能打的美女外交官）并没有得到多数玩家的追捧，反而是图中这个头戴黄帽的工程师Mustapha以其敏捷的身手大受玩家欢迎，成为事实男一号，以至于这款游戏在坊间广泛流传着“工人”“黄帽”等别称。&lt;/p&gt;

&lt;h3&gt;《铁钩船长》：&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/hook.png&quot; alt=&quot;铁钩船长&quot; /&gt;&lt;/p&gt;

&lt;p&gt;也是同时期的流行街机游戏。漫画电影都有原型（看这里电影《&lt;a href=&quot;http://movie.douban.com/subject/1298692/&quot; title=&quot;铁钩船长&quot;&gt;铁钩船长&lt;/a&gt;》），故事主线是彼得潘从大反派Hook船长手中救孩子的故事。我没有看过电影，第一次了解到这个背景（谁又会在八九岁的时候有兴趣了解一款游戏讲的是什么故事？）游戏开场动画第一个镜头是一封信“Dear Peter, your presence is required at the request of your children. Kindest personal regards, Jas. Hook, Capt”，看到电影的剧情介绍里也有完全相同的文案。&lt;/p&gt;

&lt;h3&gt;《吞食天地II-赤壁之战》&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/sanguozhi.png&quot; alt=&quot;三国志&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这款游戏的好处在于故事不需要介绍，几岁的小孩上手就知道怎么回事。三国的几个桥段然后加上各种穿越的人物构成。主角人物是改良后的五虎上将，马超换成了魏延（大概是因为马超形象和赵云过于相近，没有辨识度，所以没有被“蜀国好将军”节目组录用）。截图其实是“世界版”，和通常见到的日文版有一些差别，名字都改的很奇怪，刘备叫做Kuan-Ti, 而真正的“关帝”改名叫做Portor，赵云则叫Subutai。剧情似乎也有出入，最明显的是没有了双结局，印象中是应该有“释放曹操”的选项的。&lt;/p&gt;

&lt;h3&gt;《四国战机3》&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/air_fighter.png&quot; alt=&quot;四国战机3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这款游戏的故事背景我还是没有完全看懂，只搞清四国是美国、日本、英国、瑞典。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（93）</title>
   <link href="http://blog.tomsheep.net/2012/09/19/notes"/>
   <updated>2012-09-19T03:16:55+08:00</updated>
   <id>http://blog.tomsheep.net/2012/09/19/notes</id>
   <content type="html">&lt;p&gt;由于有了看电影的契机，重新来回顾一下小说，关注一下作者是怎么讲故事的的。&lt;/p&gt;

&lt;p&gt;《白鹿原》小说骨架：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;白嘉轩的克妻命：故事的背景介绍是围绕白嘉轩的6个亡妻展开的，白家几辈单传，对延续香火有着急切的愿望。第六任妻子去世后，白嘉轩决定找个阴阳先生。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;找阴阳先生：找阴阳先生的机缘让白嘉轩偶然发现了“白鹿精灵”，通过白鹿引出两点，一是全书的传奇人物朱先生，用了很多笔墨侧面描写其超脱、睿智甚至神奇的特点；二是白鹿原的背景介绍，交待这块土地上的风土人情以及历史传奇。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;换地：白嘉轩希望得到“白鹿精灵”，想方设法用自己的水田和鹿子霖的旱地交换，这里带出白鹿原另一大户鹿家，并通过卖地这一情节逗露出白鹿两家的交情和明争暗斗的关系。换地成功后，白嘉轩将父亲的坟迁到了这块风水宝地，从此时运大转。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;续弦：白嘉轩进山娶会第7任夫人仙草，带回罂粟种子，人财两旺，孝文孝武出生，白家一扫霉运，重新兴旺。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;学堂：恢复实力后，白嘉轩翻修祠堂，修建学堂。交待了白鹿原宗族关系、白家的族长地位。孝文兄弟、兆鹏兄弟以及长工鹿三之子黑娃被送入学堂，这里通过几个小孩的关系从另一面展现出白、鹿两大家的关系和气质特点，并着重点出了鹿三的形象。这里穿插了白灵出生，嘉轩为白灵认鹿三为干爹，再次描述长工鹿三和白家的渊源。小说第一阶段这条线结束.。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;第二条线索——革命：这是小说第一次明确点明时间。皇帝没了，城里闹了革命，原上闹了白狼。朱先生劝退清军——全书对朱先生毫不吝惜笔墨，大量近乎夸张的传说式叙述，这是有用意的，透过朱先生这个人物让整个故事的时代更迭富有厚重感、更耐人寻味。革命打破了原有的社会秩序，朱先生制定《乡约》，白嘉轩鹿子霖用《乡约》订立新规，仁义礼制成为白鹿原新的秩序规范。这里其实体现出了乡土中国的“家族”传统，在社会失灵时仍然有强大的力量。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;新政府：鹿子霖成为革命后政府委任的白鹿村“乡约”（镇级政府首脑）。得势的鹿子霖有些得意忘形，这里写出鹿子霖投机的秉性。在政府强加赋税后，白嘉轩带头反抗，鹿三在白嘉轩被牵制之下率众去县政府散步，县长退让，取消苛税。不久后政府秋后算账，鹿三诸人被捕，白嘉轩设法捞人。事情平息后，县长邀请白嘉轩做县参议员，白嘉轩以及白鹿原的乡民逐渐接触到新的事物。白灵从小表现出不同寻常女孩的潇洒和聪颖，年纪稍长后正值革命兴起，自做主张去县城读书。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;第三条线索——黑娃外出打工：黑娃从小对白嘉轩以及白家即感到敬佩感激，又有点不愿亲近之感，成年后决定外出打工。引出田小娥的故事。黑娃在郭家做麦客时和郭掌柜的小老婆产生感情，二人偷情被郭掌柜发现，黑娃离开郭家，田小娥被休。黑娃找到田家，带田小娥回白鹿原。此举不见容于白鹿原宗族。这里提到白嘉轩的教子之道，坚持传统的“耕读传家”思想，对三个儿子的行为规范要求甚高。这里对孝文的描述是，一身正气，就像腰杆笔直的白嘉轩一样。埋下后手孝文的堕落。还有一笔是孝文由于性的晚熟而演变出一点“贪色”的毛病。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;兆鹏逃婚：接受了新思潮的鹿兆鹏不满旧式包办婚姻，在父族压力下和冷家大女儿成婚。后文中冷氏长期精神压抑，在性幻想与羞愧中疯掉。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;军阀：军阀围困西安，进白鹿原强制征粮，在兆鹏的怂恿下，黑娃和兆鹏一起烧了白鹿仓。西安解围，白嘉轩进城寻找白灵。这里交待白灵在城里读书的际遇，以及和鹿兆海的恋情。国共合作时期，白灵加入国民党，兆海加入XX 党。白鹿原上，身为新学校校长的兆鹏是有国民党身份的 XX党员，在村里大搞农协，黑娃成为骨干。一时间白鹿原鸡犬不宁，祠堂被砸。朱先生说：“白鹿原成了鏊子（你争我夺、翻来覆去之意）。”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;朱先生的县志：自从闹过军阀后朱先生主动申请重编县志，小说便多了一条旁白式的注脚。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;四一二后，国共分裂，农协失势。黑娃逃走。田小娥求鹿子霖设法相救黑娃，鹿子霖趁机与田小娥成奸。鹿子霖和田小娥偷情被村里的嬉皮少年狗蛋撞见，鹿子霖设计拿住狗蛋和田小娥，将二人押至族长处鞭笞。这里鹿子霖再次借田小娥来整治白家，希望诱使白孝文堕落。孝文上套。 黑娃做了土匪，为报复白嘉轩对田小娥的处罚，回乡打断了白嘉轩的腰。本想杀死鹿子霖，错杀了鹿子霖的父亲鹿泰恒。孝文与田小娥偷情败露，白嘉轩几近崩溃，白孝武成为新的伟岸族长形象后继。分家后，孝文彻底堕落，日子难以为继。鹿子霖趁机买下孝文的田产地产，意在羞辱白嘉轩。潦倒至极之下，白孝文受到刺激重鼓信心，此后的人生中成为不折不扣的投机客。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;田小娥之死：田小娥突然被杀，黑娃回乡寻仇，得知凶手是其父鹿三，黑娃一气之下与白鹿原断绝关系。这里穿插了白家的发家史“钱匣”的故事，白家祖辈穷困之时，用只进不出的钱匣惨淡经营，一点一滴拼搏出了一方天地，造就了白家世代相传的坚韧秉性。和后文中介绍的鹿家的发迹史作出对比。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;之后的故事线索不再单一，镜头常常在白鹿原和革命队伍间切换。兆鹏上山找黑娃想让他的土匪队伍加入红军。为首的土匪大拇指并不动心。兆鹏的队伍几经剿灭。白灵在兆鹏的影响下加入XX党，而阴差阳错的是兆海却转入了国民党。二人终难走到一起。白灵和兆鹏在四处逃难式地进行地下工作，生发情感并成婚。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;白鹿原发生瘟疫，疑为田小娥鬼魂作祟。鹿三被田小娥鬼魂上身，出现异常举动。村民开始给田小娥烧香，白嘉轩修塔镇邪。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;XX党内内斗，白灵被活埋。抗日期间国共并不消停，兆海进犯边区，被XX党军队打死。黑娃所在山寨头领被毒死，白孝文上山收编土匪加入保安队。黑娃悔过自新，回乡祭祖。鹿三去世。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;兆鹏策反黑娃起义，白孝文见势投机革命。孝文、黑娃成为正副县长。一年后，白孝文罗织罪名枪毙黑娃。全书完。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（92）</title>
   <link href="http://blog.tomsheep.net/2012/09/15/notes"/>
   <updated>2012-09-15T22:11:09+08:00</updated>
   <id>http://blog.tomsheep.net/2012/09/15/notes</id>
   <content type="html">&lt;p&gt;我在trello上开了个board： &lt;a href=&quot;https://trello.com/board/request-for-challenges/50547639d29e91071c1c1b25&quot; title=&quot;Request for Challenges&quot;&gt;Request for Challenges&lt;/a&gt; ，里面是我想做的事情，难度可高可低，日程可近可远，口味可轻可重。如果你感兴趣，或者有idea想找我一起做，留下你的id，我今年有32个card，邀请你的加入，我们一起分享有趣的事:)&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（91）</title>
   <link href="http://blog.tomsheep.net/2012/09/12/notes"/>
   <updated>2012-09-12T03:43:21+08:00</updated>
   <id>http://blog.tomsheep.net/2012/09/12/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;《&lt;a href=&quot;http://blog.tomsheep.net/1024&quot; title=&quot;http://blog.tomsheep.net/1024&quot;&gt;24&lt;/a&gt;》]&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;这算不算黑帽SEO？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;每次看王垠的文章都让我觉得自己是个傻X，而且是高阶傻X——我们对二阶傻X的定义是，在他认定的傻X眼中，觉得是傻X的人。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《三体》里常说“降维攻击”，我们说“降阶攻击”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最近电影看的比较勤，也好，缓一缓，既然还没有强烈的学习意向。昨天看伍迪艾伦的《安妮·霍尔》，实在惊艳，感觉非常对口，就感觉像是自己拍出来的电影一样。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;X Window:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;X的设计原则之一就是“只提供机制，不提供策略”。所以，X server提供了一个操作窗口的方法（机制），并没有说怎样表现这种机制（策略）。这些机制和策略可以归结为：有一个程序的责任是管理屏幕空间。这个程序决定了窗口的位置，为用户提供了控制窗口外观、位置和大小的机制，通常还会提供一些“装饰”，例如标题、边框和按钮，这些是我们对窗口本身的控制。这个控制窗口的程序称作“窗口管理器”。 &lt;a href=&quot;http://blog.csdn.net/exbob/article/details/7300129&quot;&gt;参考&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;X Window的Server/Client结构严重影响效率，导致Linux桌面的效应速度一直不如Windows、Mac OS X。&lt;code&gt;X Client &amp;lt;-&amp;gt; X Server &amp;lt;-&amp;gt; Compositor&lt;/code&gt;，这三者请求渲染的过程，不是很高效；X Server，Compositor，这两者 做了很多不必要的重复工作和正文切换。&lt;a href=&quot;http://imtx.me/archives/1573.html&quot;&gt;参考&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Wayland只是一个协议（Protocol），就像X Window当前的协议——X11一样，它只定义了如何与内核通讯、如何与Client通讯，具体的策略，依然是交给开发者自己。所以Wayland依然是贯彻“提供机制，而非策略”的Unix程序。&lt;a href=&quot;http://sharecord.net/archives/45781&quot;&gt;参考&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Wayland的“直接渲染架构”彻底结束了传统X Window在渲染图形时需要不停的向Server请求、确认再绘制这个繁琐的过程，理论上响应速度有了“爆发式”增长； Wayland从根本上消除了“Server+Compositor”的重复劳动，仅有且只需要有一个“Compositor”合成器而已。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;它复用了所有Linux内核的图形、输入输出技术：KMS、evdev，因此已支持的驱动可以直接拿来用&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（90）</title>
   <link href="http://blog.tomsheep.net/2012/09/04/notes"/>
   <updated>2012-09-04T22:16:49+08:00</updated>
   <id>http://blog.tomsheep.net/2012/09/04/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;不管我如何努力想要通过阅读理论和视听欣赏提高音乐素养，楼下广场上的大妈们每天晚上都会轻而易举地将我的品位打回《爱情买卖》。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;过敏性神经衰弱。过敏原：5——6岁男童。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我终于把nokia换成了palm veer，除了都是屌丝机之外，两者的用户体验差别还是挺大的——比如后者就不能用来开汽水或者砸核桃。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.ibm.com/developerworks/cn/linux/l-cn-screen/&quot; title=&quot;screen&quot;&gt;screen&lt;/a&gt;个工具 我记得大学里用过，用来切终端。但不知道原来是这个意思：网络断开或终端窗口关闭后，控制进程收到SIGHUP信号退出，会导致该会话期内其他进程退出。screen可以在多个进程之间多路复用一个物理终端的窗口管理器。用户可以在一个screen会话中创建多个screen窗口，在每一个screen窗口中就像操作一个真实的telnet/SSH连接窗口那样。detatch后的窗口中进程可以不受SIGHUP信号影响。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;JavaScript的&lt;a href=&quot;http://weblog.bocoup.com/javascript-object-observe/?utm_source=javascriptweekly&amp;amp;utm_medium=email&quot; title=&quot;Object.observe提议&quot;&gt;Object.observe&lt;/a&gt;提议，监视对象的修改，可以用来改进web app中的data binding模式的实现。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MySQL不再Server层实现transaction，而是交给底层的不同storage engines去实现自己的transaction策略。这意味着不能放心地将不同的storage engine混用在一个transaction中。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;数据库ACID概念中的I为Isolation，即一个transaction在complete之前对其他transaction是不可见的。SQL标准定义了四种Isolation level，更低的level通常更高的concurrency与更小的overhead：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;READ UNCOMMITTED：transaction可以看到未提交的transaction的结果。可能造成脏读。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;READ COMMITTED：大多数的数据库默认Isolation level（MySQL是REPEATABLE READ）。一个transaction只能看到已经提交的其他transaction的结果。避免了脏读，但仍有可能造成“不可重复读”，即在一个transaction内读取目标两次而得到不同的值。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;REPEATABLE READ：同一transaction的对任何行的多次读取保证结果相同。但仍有可能造成phantom read. 即一个transaction中，先读一个range，然后另一个transaction在表中插入了新行，第二次读这个range时，发现新行。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;SERIALIZABLE：强制transaction排序。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（89）</title>
   <link href="http://blog.tomsheep.net/2012/08/31/notes"/>
   <updated>2012-08-31T21:53:12+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/31/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;我哪里在赶潮流，明显每次潮流都在追赶我。——这不，上个月我开始学习IR，没多久360就搞了这么一出；如果你们敢再往前挖坟的话，去年底我在博客里评论了一下韩寒，然后麦田和方老湿就疯了……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我父母在这一点上就比我差多了，他们今天才想要换个电视。——刘强东的服务器都凉了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;听说梅姐最近在yahoo又是发iphone又是搞免费餐饮的——以此来庆祝我的离职。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;你懂什么，自嘲和装X是一枚硬币的正反两面。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt; ——所罗门.阿卜杜勒.康斯特洛夫斯基如是说。这位大师是来自西伯利亚的阿拉伯裔犹太人。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;竟然有人问哪一面是有菊花的那面？我只知道装X的那面印的是国徽——你看，这就反应出眼界和身价了……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;看到网上很多人吐槽《蝙蝠侠》新作，不用看我就知道，这次诺兰终于拍的让他们看得懂了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;inotify是Linux从kernel 2.6.13加入的文件系统监视机制，查看&lt;code&gt;/proc/sys/fs/inotify/&lt;/code&gt;目录的有无以确定内核是否支持inotify。用以监视特定目录与文件的修改、创建、删除、移动、打开、关闭等事件。pyinotify是python封装。&lt;a href=&quot;http://www.codecho.com/pyinotify-monitoring-the-file-system/&quot;&gt;示例&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（88）</title>
   <link href="http://blog.tomsheep.net/2012/08/28/notes"/>
   <updated>2012-08-28T22:36:12+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/28/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;在面对一坨屎的时候，我通常都倾向于选择不吃屎，而不是换个优雅的姿势去吃。——这大概就是我还不够“professional”的原因吧。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;把printscreen放在backspace上面是个非常糟糕的设计，每天我要误截好多张屏——你说这键盘要是落在冠西哥手上还了得？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;北京环保搞不好，大约和鬼节太多有关。——回家路上看着一路冥纸烧过的余烬，心想咱能不能走支付宝啊？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;早上被陶指导逝世的消息惊了一下。这样的故事每天都在发生，多数情况下只是一条无关痛痒的新闻；而突然发生在一个你还算熟悉的人身上，就会带来很大的冲击，产生一种怜惜、也许还有自怜的感觉，觉得上帝开的这门课，指不定什么时候就挂到了你的头上。况且北京坑这么多……我就说我为什么这么不爱看《一站到底》。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;词项数目估计的Heaps定律：词项数目可以估计成文档集大小的一个函数 &lt;code&gt;M = kT^b&lt;/code&gt; 其中M是词项数目，T是文档集合中词条的个数，参数k和b的典型取值为&lt;code&gt;30 &amp;lt;= k &amp;lt;= 100&lt;/code&gt;, b约为0.5&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;对词项分布建模的Zipf定律：如果t1是文档集中出现最多词项，t2是第二多词项，以此类推，那么，排名第i多的词项的文档集频率cfi和1/i 成正比。
也就是说，cf2约是cf1的1/2，cf3约是cf1的1/3……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;词典压缩：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;主要目的是将（大部分）词典放入内存&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;采用定长存储词项一般会比较浪费，一种解决方法是将所有词项存成一个长字符串，并给每个词项加一个定位指针。而且可以进一步压缩，将长字符串中的词项进行分组变成大小为k的块，然后对每个块只保留第一个词项的指针。这种做法需要在压缩率和查找速度间进行tradeoff&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;可以利用front coding技术利用词项之间的冗余信息。识别公共前缀，后续词项中便可以使用一个特殊的字符来代表这段前缀。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果不得不吧词典划分成不同页存在磁盘上，则可以采用B树对每页的第一个词项进行索引。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;倒排记录表的压缩：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;高频词出现的文档ID序列号之间间隔不大。利用这一点，可以使用比序列号最大长度更少的bit数来存储间隔。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;因为间隔可大可小，所以一般需要可变字节来编码（比如用一个字节的7位表示payload，剩下一位留做延续位）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一个和最优编码长度差距在常数倍之内的方法是γ编码。γ编码将间距G表示为长度和偏移两个部分进行变长编码。G的偏移实际上是G的二进制编码去掉前端的1, 长度是指偏移的长度，用一元编码表示。这样，偏移部分长度是log2(G), 长度上限是log2(G) + 1，则全编码上限是2 * log2(G) + 1。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;γ编码较为通用，而且是prefix-free code，一个γ编码不会是另一个的前缀，不需要对γ编码进行切分；γ编码也是parameter free的，其他很多高效的编码方式需要对模型的参数进行拟合使之适应于索引中间距的分布情况，这样会加大压缩和解压缩的复杂性。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（87）</title>
   <link href="http://blog.tomsheep.net/2012/08/25/notes-87"/>
   <updated>2012-08-25T23:31:38+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/25/notes-87</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;若干年之后，我一定会问心无愧地说：我为我的雇主做出了突出的贡献。——每刷一次豆瓣页面，我都义无反顾地点一次广告。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;菜昕说他是为了方便看美女才学会认时钟的，看，这就是屌丝。为了同样的目的，我学会的是修电脑。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我的小外甥让我对未来抚养小孩这件事产生了很深的阴影：一想到要在很长的时间里和一个完全没有理性和自制力的小鬼斗智斗勇，我就崩溃了。如果竟然苟活下来了，那又是一篇《论持久战》。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;其实我自制力也很差，所以做了18年的胖子并且眼睛被电游保送到了600多度。后来大学里好多人夸我自制力强，我挺不好意思的，因为我看上去比较勤奋的原因是这些东西让我觉得自己很酷，这本质上和一个嬉皮少年浑身上下打十八个洞没什么区别。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;基于块的排序索引算法：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;BSBI在排序时尽量减少磁盘随机寻道次数。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;实现过程&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 将文档解析成词项 ID—文档 ID对，并在内存中一直进行解析处理，直到累积至放满一个固定大小的块空间&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 排序后的块转换成倒排索引格式后写入磁盘&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 将若干个块索引同时合并成一个索引文件。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;该算法需要在内存中存放词项到词项ID的词典，对于大规模的文档集来说内存占用可能会过大；可以直接用term-文档id对的方式，但这样会使中间文件较大。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;内存式单遍扫描索引算法（SPIMI）：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;使用term-doc id对而不是term id-doc id对&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;实现过程：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 如果词项是第一次出现，那么将之加入词典，同时建立一个新的倒排记录表&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 如果该词项不是第一次出现则直接在倒排记录表中增加一项，当倒排记录表空间放满的时候，就会申请加倍的空间&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 上述步骤每run一次产生一个磁盘块，可以对每个块生成一个完整的倒排索引，为加快最后的合并过程，要对词项进行排序操作，然后写入磁盘形成单块索引&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;相比BSBI一开始就整理出所有的词项id-文档id对，SPIMI直接在倒排记录表中增加一项，这样 1. 不需要排序操作 2. 保留了倒排记录表对词项的归属关系&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;分布式索引构建：索引构建应该是MapReduce用的最普遍的场景之一了&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;map阶段r个分析器将输入的数据片映射成词项id-文档id对，输出结果存在本地的分区文件中&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;reduce阶段，倒排器将每个词项分区（一个词项分区对应r个分区文件，分别放在一个分析器上。每个分区文件只需要一次网络顺序读取），最终得到倒排索引表。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;动态索引构建：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;可以在内存中用一个辅助索引存新文档信息，查询时将磁盘索引和内存中索引的结果合并。时间复杂度是 Θ(T&lt;sup&gt;2&lt;/sup&gt;/n), T是所有倒排记录的数目，n是辅助索引的大小&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;引入log2(T/n)个索引块，用类似二项式堆的算法可以将时间复杂度降到 Θ(Tlog2(T/n))&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;由于上述算法实现的复杂性和维护的难度，一些大兴搜索引擎倾向于从头开始重构索引而不是动态构建索引。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;参考《信息检索导论》第四章与 &lt;a href=&quot;http://www.cnblogs.com/god_bless_you/archive/2012/08/15/2640312.html&quot;&gt;这篇笔记&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（86）</title>
   <link href="http://blog.tomsheep.net/2012/08/25/notes"/>
   <updated>2012-08-25T00:11:20+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/25/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;互联网中到处鼓吹的“个性化服务”， 早就被门口卖煎饼的大妈融会贯通了——无非就是记住熟客要不要辣椒，来多少香菜，要薄脆还是要油条的问题。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;公交车上，一个大爷操着浓厚的京腔向旁边的大妈吹牛，“中国这几千年啊，就出了三场盛世，大唐盛世、康乾盛世，再就是胡温盛世了……”——我顿时觉得自己过去讲的那些笑话都弱暴了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;刚回国的表姐夫问我为什么换工作，我描述了半天也没有说清楚，说着说着自己都有点糊涂了……但最后还是给我抓住了重点：“我说了又不算，还整天让我开会。”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;基于词典的容错检索基本思路是对普通的倒排索引中的词典部分再进行了一层索引（可以使用哈希表或者搜索树），找到词项后再通过普通倒排索引最终定位到文档。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;通配符查询：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;搜索树词典结构对于尾部通配符来说很方便，从上到下遍历就可以了；首部的通配查询可以依靠词典的反向B树（原来B树中每个从根到叶子路径代表的词项全部反过来。比如apple在反向搜索树里就是root-e-l-p-p-a) ；同时使用B树和反向B树，可以处理任意位置的单个通配符查询（前缀和后缀分别查出的结果求交集并去掉前后缀相同时对应的词项）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;轮排索引可以用来进行一般的通配符查询（将词项旋转拓展出轮排词汇表），缺点是词典会变得很大。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;k-gram索引结构中，词典由词汇表中所有词项的所有k-gram形式构成，而每个倒排记录表由包含该k-gram的词项组成。用k-gram进行通配查询时，re*ve用3-gram就会转换为$re AND ve$。但对于一些查询，k-gram需要额外处理，比如red*用3-gram会转换为$re AND red，可能会返回retired，这是不满足条件的。所以需要postfiltering，做字符串匹配滤掉部分结果。这种查询很耗时，一般隐藏在“高级搜索”界面下。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;拼写矫正&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;基本原则：选择编辑距离（Levenshtein距离）最近的一个；如果有两个编辑距离相等或相近，选更常见的那个。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;词项独立的拼写校正主要有编辑距离法和k-gram重合度法：前者在实际运用中通常使用一些启发式方法提高查找效率（如将搜索限制在与查询词具有相同首字母的字符串上等）；后者实际上是对查询字符串中k-gram的倒排记录表进行单遍扫描的过程，通常为了提高精细度，用Jaccard系数进行修正：|A交B|/|A并B|，A，B分别是查询q和词汇表词项中的k-gram集合。扫描时，如果当前词项t和q的Jaccard系数超过阈值，则将t输出。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;上下文敏感的拼写校正更为复杂，一种简单的实现是，即使每个词拼写都正确，仍然对每个词找到可能的拼写正确词，然后尝试对短语中的每个词进行替换。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;基于发音的校正：对每个词项进行语音哈希，发音相似的被映射为同一值。这一类算法统称soundex算法。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（85）</title>
   <link href="http://blog.tomsheep.net/2012/08/23/notes"/>
   <updated>2012-08-23T00:14:47+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/23/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;我在北京遇到的传教士开场白一般都是，“先生我是信上帝的，有兴趣……”——业务太差了，什么就“信上帝的”，也就是哥为人厚道，要不然还不得让你当场写篇5000字的报告详细对比天主教、摩门教、新教、东正教、犹太教的教义并说明它们对上帝认识的异同？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我都想好了，如果这哥们竟然真的答出来了，那我就祭出豆腐脑的咸甜问题摆平他。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;昨天和一帮长辈吃饭，一大叔语重心长地对另一大叔说，“你儿子花你钱你才有安全感，他要不花你钱你才着急呢”——作为一个供养政府的纳税人，我就没有这样的心态。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;搜索引擎中的document即被索引的内容，粒度可能是整个文本、一个段落、一句话等等，一般索引粒度过小，可能造成正确率高而召回率低，反则反之。term只词项，倒排索引即term到document的索引。xapian开源搜索库中Document包含term, value, data等概念，Values是附加在document上一种元数据，每一个document可以有多个values，这些values通过不同的数字来标识。Values被设计成在匹配过程中快速地访问，它们可以用作排序、排队多余重复的document和范围检索等用途。如果你仅仅是想存储某个字段以便作为结果显示，那么建议您最好将它们保存在document的data中。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Term集合的确定第一步往往是词条化&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;token normalization是将多个词条归为一个等价类的过程，实现时可通过拓展词表，将一个查询中的词项拓展为的多个词，然后将这些词对应的倒排记录表合并；也可以在索引构建时就对词进行拓展，把文档号同时索引在这些词的倒排表里。第一种增加了一个拓展词典，查询时需要更多时间；第二种则需要更多存储空间。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;现代的Web搜索引擎基本不用stop word表。1）采用压缩技术降低常用词索引的存储开销 2）通过常规词的权重计算方法将高频常用词对文档排序影响降低 3）采取在权重变小时，及早停止对倒排记录表的继续扫描，降低开销&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;stemming和lemmatization含义不同，前者通常指一个很粗略的去除单词两端词缀的启发式过程，能提高召回率但会降低正确率，英文最常用的stemming算法是Porter；后者通常指利用词汇表和词形分析来返回词的原型或词典中的词，是一种自然语言处理工具。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;要从词项归一中获得更好的效果，取决于语用分析而不只是词形分析。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;xapian提供了&lt;code&gt;Xapian::TermGenerator::set_stemming_strategy&lt;/code&gt;可以用来定制stemming策略 &lt;a href=&quot;http://xapian.org/docs/stemming.html&quot; title=&quot;Stemming Algorithms&quot;&gt;Stemming Algorithms&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果索引变化不是太快的话，可以采用skip list来加速倒排记录表的合并（布尔查询AND时有用）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;短语查询：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;二元词索引是一个简单并且效果不错的策略，但可能会大大增加词汇表大小。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;positional index在倒排索引表中加入位置信息，可用于k词近邻搜索。会提高倒排记录表合并操作的渐进复杂性。xapian也支持位置索引（&lt;code&gt;Xapian::Document::add_posting&lt;/code&gt;）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一个混合策略是，对某些（热门）查询使用短语索引或二元词索引，而其他短语查询采用位置索引。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;next word index(对每个词项，有个后续词索引记录他在文档中的下一个词项)是另一种混合索引机制，与单纯位置索引相比，增加了索引大小，但查询效率有显著提高。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（84）</title>
   <link href="http://blog.tomsheep.net/2012/08/19/notes"/>
   <updated>2012-08-19T23:33:07+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/19/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;昨天在圆明园里，同学问“你说当下的什么物件有可能在未来成为文物？” 我想了想说，&quot;那必须是越来越少的东西。&quot;——这么说来最有可能成为文物的大概就是……节操了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我的教练见我最喜欢说的是，“你的胸太小了” “今天看上去好像重了两公斤”……这让我疑惑他过去是练的是健美还是选美。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;为了提高个人音乐素养，我买了三表老师的巨著《欧美流行音乐指南》上下两册——买之前我以为是《九阴真经》上册和《九阴真经》下册，买之后发现原来是《新华字典》上册和《新华字典》下册。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;-你为什么写东西都一二三四列出来？&lt;/p&gt;

&lt;p&gt;-这样可以给我一种错觉，就是……我是李开复。&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;靠不靠谱或许需要看环境，但给不给力一定得靠自己。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;爵士乐的定义很宽泛，主要特点是“自由”，一个音乐以很自由的方式展现出来，就可以被广义地归为爵士。也就是除了100%按普演奏的（如古典乐）或节奏固定旋律重复无变化的（如大多数流行乐）音乐，都可以称为爵士。 蓝调必须有固定的作曲模式，而且能使用的音也只限於几个音。一般地，当一首歌以 1111-4411-5411 这种所谓的12 小节蓝调进行作曲,并以蓝调音阶或五声音阶中的音符做旋律，就可称做蓝调。——我一直以为他们是一回事。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;基于布尔代数的搜索的一个普遍问题是，采用AND操作符产生的结果正确率高但召回率低，采用OR操作符召回率高而正确率低。很难找到折中方案。往往需要求助于文本查询（free text query）&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（83）</title>
   <link href="http://blog.tomsheep.net/2012/08/16/notes"/>
   <updated>2012-08-16T23:11:05+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/16/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;据说对于80%的中国用户，电台产品只要分“流行音乐”和“其他”两个频道就可以了——这次我终于不是一小撮了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有没有人离职我不太清楚，不过现在只要我的豆瓣广播里出现大规模的关注刷屏，肯定是有人入职了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;毕业时为了搬家方便，把大学里几乎所有的书都送人了，今天想翻一下APUE，真想挠墙。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Unix中创建一个daemon进程为什么需要fork两次？就像这样：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; void do_fork() {
     int pid = fork();
     if(pid &amp;gt; 0)
         exit(0);
     else if(pid &amp;lt; 0)
         exit(1);
 }

 void init_daemon(void) {
     do_fork();
     setsid();
     do_fork();
     chdir(&quot;/&quot;);
     umask(0);
     return;
 }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt; 整个流程解释如下：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;em&gt;do_fork&lt;/em&gt;做的事情是: 复制一个子进程，然后杀死父进程。第一个&lt;em&gt;do_fork&lt;/em&gt;有两重作用，一是为后面的setsid做准备，因为setsid调用者必须不是一个进程组的首进程；二是，如果daemon进程是由一条shell命令启动的，那么父进程终止使得shell认为这条命令已经完成。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;setsid的作用是建立新的会话(session)。用户登录是一个会话的开始。登录之后，用户会得到一个跟用户使用的终端相连的进程，这个进程被称作是这个会话的leader，会话的id就等于该进程的pid。会话结束，并不意味着在该会话中创建的所有进程都结束了。所谓的daemon进程，正是在某个会话中创建，但是却不依赖该会话，而常驻后台的进程。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一个会话只能有一个控制终端, 产生在控制终端上的输入和信号将发送给会话的前台进程组中的所有进程终端上的连接断开时 (比如网络断开或 Modem 断开), 挂起信号(SIGHUP)将发送到控制进程(session leader)。会话的leader进程很可能是一个shell，它在收到SIGHUP信号后，并不是马上退出，而是会向它所启动的子进程都各自发送一个SIGHUP信号，将它们都杀死，然后自己才退出。不过，如果是这个作为leader进程shell自己退出，而导致终端hangup的话，向其子进程发送SIGHUP信号的事情就不会发生了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;setsid后子进程（这时候父进程已死）成为新会话的领头进程，而为什么要再&lt;em&gt;do_fork&lt;/em&gt;一次呢？这是为了禁止进程重新打开控制终端。因为会话的领头进程打开一个终端之后, 该终端就成为该会话的控制终端，这不是我们想看到的，我们的目的是创建一个daemon进程。这时&lt;em&gt;do_fork&lt;/em&gt;后，产生孙子进程，而子进程死掉，这时孙子进程就不是会话领头进程了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;chdir是在干什么？ 进程活动时，其工作目录所在的文件系统不能卸下。一般需要将工作目录改变到根目录（或者其他目录，用来做一些自己的事情，比如/tmp之类）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;umask(0)将文件创建mask清掉。因为由继承得来的文件方式创建屏蔽字可能会拒绝设置某些许可权。例如，若精灵进程要创建一个组可读、写的文件，而继承的文件方式创建屏蔽字，屏蔽了这两种许可权，则所要求的组可读、写就不能起作用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一般情况下，还会再关掉不需要的继承来的文件描述符（上面的程序没有体现，关哪些描述符和具体的daemon进程有关）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;参考APUE、文章 &lt;a href=&quot;http://blog.csdn.net/tdonald/article/details/1724996&quot; title=&quot;setsid()&quot;&gt;setsid()&lt;/a&gt; 和 &lt;a href=&quot;http://chowroc.blogspot.com/2007_05_01_archive.html&quot; title=&quot;python how to write a daemon&quot;&gt;python how to write a daemon&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（82）</title>
   <link href="http://blog.tomsheep.net/2012/08/13/notes"/>
   <updated>2012-08-13T23:10:21+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/13/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;sync了一个礼拜，都没能把android源码拖下来。——这比“罗永浩都能读懂android内核”更让人崩溃。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;周六我带了本书5号线倒10号线到海淀黄庄，坐在新中关一楼的休息区看了两个小时，然后又若无其事地4号线转13号线坐回来了，就好像什么都没有发生过一样。这TM才是生活。#梁朝伟也不过如此#&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最近有很多书都看“废”了，就是看到中途发现不再感兴趣、或者压根觉得没有能力或精力再读下去，大概和自身状态也有关系。本着书道主义精神公布遇难者名单：它们是马斯洛《动机与人格》、Michael L.Scott 《程序设计语言实践之路》、托克维尔《论美国的民主》&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《冰川时代4》我还是很喜欢的，本想记下几个细节，结果发现已经忘的差不多了，这就是主旋律电影的缺点啊……&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;-Why are you so happy?&lt;/p&gt;

&lt;p&gt;-Because…we are very, very, very…stupid.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt; 我当时觉得这个笑话简直就像是自己讲的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;王小波《我的阴阳两届》：我好像不是第一次看这部中篇小说，感觉很熟悉——我给王小波的小说写作手法起了学术名词，叫： Wanger&#39;s Sexual Function Oriented Writing（面向王二的性功能叙事法）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;修养比幽默重要得多。幽默最多是引人注目，修养功夫好的朋友却会让人自然心生亲近之心。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt; ——知乎 &lt;a href=&quot;http://www.zhihu.com/question/19607512&quot; title=&quot;卢百万&quot;&gt;卢百万&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（81）</title>
   <link href="http://blog.tomsheep.net/2012/08/10/notes-81"/>
   <updated>2012-08-10T22:58:00+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/10/notes-81</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;同事说孙中山北伐失败的原因是他是广东人，普通话说的不好，老百姓都听不懂。——我觉得孙先生肯定还
&lt;a href=&quot;http://video.2012.sohu.com/20120808/n350136371.shtml&quot; title=&quot;配了一个福建翻译&quot;&gt;配了一个福建翻译&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有好多新朋友好奇tomsheep是什么意思，我决定这次找一个NB的出处：Google出的结果让我极度愤慨，“唐武扬”竟然被用作了耽美小说主人公的名字。当初叫“秦舞阳”就好了……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我有一个特殊的技能，就是能把任何功能强大编辑器用成记事本。——今天看了一篇 &lt;a href=&quot;http://lucifr.com/139225/sublime-text-2-tricks-and-tips/&quot; title=&quot;短文&quot;&gt;短文&lt;/a&gt; ，惊诧难以言表，这还是我认识的Sublime吗？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;寂寞是别人不想搭理你，孤独是你不想搭理别人。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt; ——知乎 &lt;a href=&quot;http://www.zhihu.com/question/19756730/answer/12864660?utm_source=weibo&amp;amp;utm_medium=weibo_share&amp;amp;utm_content=share_answer&amp;amp;utm_campaign=share_button&quot; title=&quot;万桃桃&quot;&gt;万桃桃&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Python decorator:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;decorator的作用在于向函数或类中注入、修改代码，改变其行为。可以借此容易地实现AOP的若干pattern。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;decorator要求是一个callable, 当编译器处理形如&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  @myDecorator 
  def aFunction(): 
      print &quot;inside aFunction&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  这样的声明时，aFunction()被编译为一个function object并传入myDecorator, 后者返回一个新的函数对象赋值给aFunction这个名字。完全等价于：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  aFunction = myDecorator(aFunction)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;带参数的decorator多一层，返回一个无参数decorator, 然后这个decorator再作用于被修饰的函数或类：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  @decomaker(argA, argB, ...) 
  def func(arg1, arg2, ...): 
      pass
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  等价于：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  func = decomaker(argA, argB, ...)(func)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;更多用法见 &lt;a href=&quot;http://www.artima.com/weblogs/viewpost.jsp?thread=240808&quot; title=&quot;Introduction to Python Decorators&quot;&gt;Introduction to Python Decorators&lt;/a&gt; 和 &lt;a href=&quot;http://blog.genforma.com/2011/07/28/class-decorator-talk/&quot; title=&quot;class-decorator-talk&quot;&gt;class-decorator-talk&lt;/a&gt; 。 规范见 &lt;a href=&quot;http://www.python.org/dev/peps/pep-0318/&quot; title=&quot;PEP-318&quot;&gt;PEP-318&lt;/a&gt; 和 &lt;a href=&quot;http://www.python.org/dev/peps/pep-3129/&quot; title=&quot;PEP-3129&quot;&gt;PEP-3129&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Python中另外一个常用于实践AOP的工具是Metaclass:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Metaclass是class的class，是type子类，和Java中的Class类概念相近，注意三个函数定义：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; &lt;code&gt;__new__&lt;/code&gt;: 当希望控制“类对象”创建过程时重写这个hook&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; &lt;code&gt;__init__&lt;/code&gt;: 类对像已经创建，控制其初始化过程。一般情况下，&lt;code&gt;__new__&lt;/code&gt;和&lt;code&gt;__init__&lt;/code&gt;重写一个即可。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; &lt;code&gt;__call__&lt;/code&gt;: 当被生成的“类对象”作为模板，有其实例生成时被调用。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Metaclass是比类decorator更强大的工具，可以被后者实现的功能基本都能被前者完成。但Metaclass可以实现一些decorator无法完成的任务，比如metamethods与meta-properties&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最典型的应用就是 ORM层的实现，如 Django的models.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;参考 &lt;a href=&quot;http://eli.thegreenplace.net/2011/08/14/python-metaclasses-by-example/&quot; title=&quot;python-metaclasses-by-example&quot;&gt;python-metaclasses-by-example&lt;/a&gt; 和 &lt;a href=&quot;http://www.vrplumber.com/programming/metaclasses.pdf&quot; title=&quot;metaclasses.pdf&quot;&gt;metaclasses.pdf&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（80）</title>
   <link href="http://blog.tomsheep.net/2012/08/10/notes"/>
   <updated>2012-08-10T00:19:23+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/10/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;我找了个健身教练。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;立秋那天晚上我住的小区里到处都是鞭炮声，大伙还真讲究。但凡环保也能成为习俗，还要美帝使馆做甚？——古往今来 要成事，都得往悬乎了整，才能让人有敬畏心，连造反都是这样。科学解释的太清楚，反而没人畏惧，要是俗话说“乱扔垃圾死舅舅”、古人云“贴小广告张疥疮”这就好了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在贴笔记之前我一定要讲个笑话，这是原则。咦，好像第一条讲过了啊？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Redis是一个基于key/value的数据结构服务器(data structures server)，提供字符串、列表、set、sorted set、hash五种数据结构接口：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Redis 将数据存储于内存中,或被配置为使用虚拟内存。通过两种方式可以实现数据持久化&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; snapshot: 按XX时间内多少次写入为限，将内存中的数据不断写入磁盘。性能较高,但是可能会引起一定程度的数据丢失&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; AOF(Append Only File) 记录每次操作日志，性能较低。当不使用snapshot时，一定需要AOF写入RAID array中或者至少配置一个redis slave以供发生灾难时恢复。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;目前只有主从复制，还没有集群功能，计划在3.0版本加入。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于持久化，一个写操作完整的过程是：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 客户端向服务端发送写操作（数据在客户端的内存中）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 数据库服务端接收到写请求的数据（数据在服务端的内存中）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 服务端调用write系统调用，将数据往磁盘上写（数据在系统内存的缓冲区中）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 操作系统将缓冲区中的数据转移到磁盘控制器上（数据在磁盘缓存中）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 磁盘控制器将数据写到磁盘的物理介质中（数据真正落到磁盘上）&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;  发生数据库server错误时，只要保证步骤3完成就是安全的；但当断电时，只有步骤5完成才是安全的。见文章 &lt;a href=&quot;http://antirez.com/post/redis-persistence-demystified.html&quot; title=&quot;redis-persistence-demystified&quot;&gt;redis-persistence-demystified&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Redis提供多种数据结构接口：相较于将对象的每个字段存成单个 string 类型, 将一个对象存储在 hash 类型中会占用更少的内存,并且可以更方便的存取整个对象。省内存的原因是新建一个 hash 对象时开始是用 zipmap来存储的。这个 zipmap 其实并不是 hash table,但是 zipmap 相比正常的 hash 实现可以节省不少 hash 本身需要的一些元数据存储开销。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;redis 没有使用操作系统提供的虚拟内存机制，而是自己在实现了自己的虚拟内存机制。因为OS虚存交换单位最小是4k，redis需要更小粒度。另外redis 可以将被交换到磁盘的对象进行压缩。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;更多使用可以参考 &lt;a href=&quot;http://book.douban.com/subject/6782272/&quot; title=&quot;The Redis Cookbook&quot;&gt;The Redis Cookbook&lt;/a&gt; .&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于磁盘缓存：在磁盘中嵌入的一块高速的内存，用来保存经常访问的数据从而提高读写效率。Linux 下用&lt;code&gt;hdparam -i &amp;lt;磁盘设备文件&amp;gt;&lt;/code&gt;可看到详细内容。磁盘缓存和磁盘控制器缓存的作用都是缓存读、预读、回写（写缓存很多情况下会被关掉，以免出现数据丢失）。此外磁盘缓存有保存IO命令队列的功能，单个的磁盘一次只能处理一个IO命令，但却能接收多个IO命令，这些进入到磁盘而未被处理的命令就保存在缓存中的IO队列中。参见 &lt;a href=&quot;http://www.dbabeta.com/2009/io-performence-02_cache-and-raid.html&quot; title=&quot;缓存和RAID如何提高磁盘IO性能&quot;&gt;缓存和RAID如何提高磁盘IO性能&lt;/a&gt; 和 &lt;a href=&quot;http://www.360doc.com/content/12/0307/00/1309227_192357112.shtml&quot; title=&quot;浅谈磁盘控制器驱动&quot;&gt;浅谈磁盘控制器驱动&lt;/a&gt; 。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（79）</title>
   <link href="http://blog.tomsheep.net/2012/08/04/notes"/>
   <updated>2012-08-04T21:28:14+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/04/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;过去我认为炒肝口味太重，完全是因为没有吃过卤煮。——#猪大肠里的北京#&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在书店里无聊瞎翻，一本看上去很山寨的关于投资的书把我彻底搞毛了，因为它有两章的主题分别是：“业余投资者不要把鸡蛋放在同一个篮子里”和“散户要集中投资而不是分散投资”——你到底想怎样？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我看出来了，作者是个卖基金的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;前天吃饭的时候几个同事在比谁大学里挂科多，气氛热烈，我回来一直很感慨，如果自己早年没有花太多无谓的时间去拼GPA，现在能力会不会强一些？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://memcached.org/&quot; title=&quot;memcached&quot;&gt;memcached&lt;/a&gt;，顾名思义，是内存中的cache，它不是数据库，不是文件系统，通常用于数据库前，利用locality来加速数据库的读取。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;memcached就是一个单纯的key/value cache，相当于存在内存里的hashtable，c/s架构，一个memcached集群中读写需要两次hashing，一次是客户端通过对key进行哈希决定存储在哪个server节点上，第二次是服务器节点中对key进行hashing来完成真正存储。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;memcached客户端的哈希算法通常采用modula hashing或consistent hashing，简单的取余哈希缺点在于如果集群中添加或者减少节点，会造成hashing chaos，基本上会影响到所有节点。而一致性哈希只会影响相邻的一个节点。详细内容参考文章 &lt;a href=&quot;http://blog.csdn.net/sparkliang/article/details/5279393&quot; title=&quot;一致性hashing算法&quot;&gt;一致性hashing算法&lt;/a&gt; 和 &lt;a href=&quot;http://jianzi0307.blog.163.com/blog/static/208120020104170361734/&quot; title=&quot;memcached研发测试&quot;&gt;memcached研发测试&lt;/a&gt; 。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;memcached 不提供冗余，也不提供fail over策略。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;memcached 可以走TCP/UDP/Unix socket ，不提供认证。这一点比较危险，需要使用者自己解决安全问题。一般的实践是只监听内网端口、加防火墙。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;缓存策略是LRU，内存分配策略是slab。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;按我的理解，memcached是不直接参与逻辑数据“写”操作的，也就是程序直接写数据库，而多数情况是数据库在写入时通过UDF或类似机制来触发memcached数据更新。不会存在（我想也不应该存在）有关键应用逻辑数据写入了memcached但数据库没有更新的情景。（依赖memcached来做这样的事是不合适的，它只是cache而已）所以，断电不应该破坏应用的数据完整性，只需要让memcached 重新 “热”起来就好了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;更多使用方法请见 &lt;a href=&quot;http://code.google.com/p/memcached/wiki/NewStart&quot; title=&quot;官方wiki&quot;&gt;官方wiki&lt;/a&gt; 、mysql提供的配合memcached使用文档 &lt;a href=&quot;http://downloads.mysql.com/docs/mysql-memcached-en.a4.pdf&quot; title=&quot;mysql-memcached-en.a4.pdf&quot;&gt;mysql-memcached-en.a4.pdf&lt;/a&gt; 、文章 &lt;a href=&quot;http://blog.csdn.net/madding/article/details/5753870&quot; title=&quot;memcached原理应用及问题&quot;&gt;memcached原理应用及问题&lt;/a&gt; 以及 &lt;a href=&quot;http://xiezuo8.net/?p=273&quot; title=&quot;memcached实践&quot;&gt;memcached实践&lt;/a&gt; 。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（78）</title>
   <link href="http://blog.tomsheep.net/2012/08/03/notes"/>
   <updated>2012-08-03T01:16:41+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/03/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;地铁上看见一个几乎和我装束完全一样的哥们，吓了一跳，这年头品味这么差的人真是不多了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;令人伤感的是，好不容易在雅虎培养出的重口味，眼看着就要这样湮没在一片二次元与小清新的海洋里了……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;令人欣慰的是，哥加入了炮组。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;setuptools目前几乎是python中模块管理的标准库，针对distutils的不足做了相应增强，&lt;em&gt;easy_install&lt;/em&gt;和pip都是在它基础上的工具，用来方便安装、管理python模块。pip相比于&lt;em&gt;easy_install&lt;/em&gt;有这些异同：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;pip的安装过程是原子的&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;pip有更明确易读的提示信息&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;pip有uninstall功能&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;pip没有很好解决模块多版本共存的问题，但实际中pip几乎总是和virtualenv配合使用，所以基本规避了这样的需求。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于setuptools的更多解释可以参考 &lt;a href=&quot;http://www.ibm.com/developerworks/cn/linux/l-cppeak3.html&quot; title=&quot;IBM的教程文章&quot;&gt;IBM的教程文章&lt;/a&gt; 和 &lt;a href=&quot;http://hongqn.livejournal.com/11289.html&quot; title=&quot;hongqn老师早年的笔记&quot;&gt;hongqn老师早年的笔记&lt;/a&gt; 。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;python的模块搜索路径构成为：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;当前目录&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;PYTHONPATH目录&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;标准链接库目录&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;搜索路径中遇到的所有.pth文件中指定的目录: python模块机制一直存在不能直观使用namespace的问题，因为python的模块搜索是找到第一个匹配就返回，也就是说不能像其他语言（如C++）一样不同的模块可以共享同一命名空间，使模块间可以灵活组合与发布。setuptools和pkgutil各自提供了一套解决方案，在namespace package根下的 &lt;code&gt;__init__.py&lt;/code&gt; 定义：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  try: 
      __import__(&#39;pkg_resources&#39;).declare_namespace(__name__) 
  except ImportError: 
      from pkgutil import extend_path 
      __path__ = extend_path(__path__, __name__) 
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;更多详细内容猛击这里 &lt;a href=&quot;http://www.python.org/dev/peps/pep-0402/&quot; title=&quot;PEP-402&quot;&gt;PEP-402&lt;/a&gt; 。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;把python模块当脚本来执行，最常用的就是这个例子：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; python -m SimpleHTTPServer &amp;lt;port&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt; 这个规范请见 &lt;a href=&quot;http://www.python.org/dev/peps/pep-0338/&quot; title=&quot;PEP-338&quot;&gt;PEP-338&lt;/a&gt; 。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（77）</title>
   <link href="http://blog.tomsheep.net/2012/08/01/notes"/>
   <updated>2012-08-01T23:46:04+08:00</updated>
   <id>http://blog.tomsheep.net/2012/08/01/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;我的员工编号是286，这很适合我，看来他们也知道我喜欢用低端机。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;生活就如同在烈日骄阳下的柏油马路上行走，脚底粘了一只嚼过的口香糖。——若非亲身体验，谁TM能写出这么NB的比喻。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;这届奥运会场上运动员的年龄普遍都比自己小了——以前我喜欢YY自己作为奇兵入选国奥男足，然后主力前腰和主力前腰的替补都在一场比赛中报废了，我临危受命力挽狂澜，场均2传2射，决赛帽子戏法豪取冠军……结果，不幸的是，现在哥都超龄了，国奥也没能出线。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于wsgi, 这个 &lt;a href=&quot;http://archimedeanco.com/wsgi-tutorial/&quot;&gt;slides&lt;/a&gt; 不错：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;一个WSGI app就是一个具有以下签名的callable，&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  def application(environ, start_response) 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  environ是环境变量、http头、wsgi变量等的集合，&lt;em&gt;start_response&lt;/em&gt;是用来处理status和headers的回调，这个接口设计的其实没有必要，wsgi2.0会去掉。这个application的返回值是一个iterable，是返回的http body内容。另外，&lt;em&gt;start_response&lt;/em&gt;的签名是&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;      start_response(status, response_headers, exc_info=None)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;这几乎就是wsgi最核心的内容了，wsgi是server和app之间的约定，只要web framework支持这样的调用方式，这样的framework就可以被实现了wsgi调用的web server支持。而web server如何实现对wsgi的支持呢？一般来讲，可以直接支持，很多python实现的web server就是；可以通过现有web server embed的方式支持，如&lt;em&gt;mod_wsgi&lt;/em&gt;； 可以通过scgi或fcgi容器实现，如flup，因为scgi和fcgi都是web server普遍支持的和外部程序交互的接口，flup向下实现了scgi和fcgi的交互方式，向上实现了wsgi application的调用方式。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于wsgi、scgi、fcgi、web server之间的关系，我觉得 &lt;a href=&quot;http://blog.linluxiang.info/2011/03/03/wsgi-learn/&quot;&gt;这篇文章&lt;/a&gt; 是讲的比较清楚的一篇。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;web.py code review：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;web.py是一个轻量级的python web框架，代码不到10000 LOC， 其中包括了一个轻量http server&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;application.py: application类是程序主体，保存url mapping和环境参数。processor的概念相当于middleware，用一个列表储存所有注册的processor（通过&lt;code&gt;app.add_processor&lt;/code&gt;注册），每个processor有这样的签名：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  def processor(handle)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  其中handle相当于nodejs connect middleware中的next，通过&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;      def handle_with_processors(self): 
          def process(processors): 
              try: 
                  if processors: 
                      p, processors = processors[0], processors[1:] 
                      return p(lambda: process(processors)) 
                  else: 
                      return self.handle() 
                  …… 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  这样的方式实现顺序执行，最后的&lt;code&gt;self.handle()&lt;/code&gt;调用就是filter过后url匹配的逻辑。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;app.wsgifunc()&lt;/code&gt;函数返回一个wsgi callable（之前说过），用以和支持wsgi的server集成。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当调用&lt;code&gt;app.run(*middleware)&lt;/code&gt;时，实际是调用&lt;code&gt;wsgi.runwsgi(self.wsgifunc(*middleware))&lt;/code&gt;： 其中的middleware是wsgi middleware，原理就是把wsgi包装一层返回一个新的wsgi callable，和web中熟悉的filter概念是一致的&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;web.py的wsgi模块中提供了三种run的模式，fcgi, scgi, 还有http server：其中http server是直接用了CherryPy中的web server实现。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（76）</title>
   <link href="http://blog.tomsheep.net/2012/07/25/notes"/>
   <updated>2012-07-25T23:34:00+08:00</updated>
   <id>http://blog.tomsheep.net/2012/07/25/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;和对面的同学正讨论技术问题，换口气的当口，他突然面不改色幽幽地来了一句，＂刚才过去~的~那个~女~孩子~的胸~好~平~啊~＂// 我就应该随身带面镜子，这样我就能看到自己当时是什么表情了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;耐心长点本事吧。没有修炼到以一当五、以一当十的境界前，我觉得还是不要去祸害创业小团队了。怪不好意思的，搞不好还伤感情。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Node.js开发指南》没有宣传中的那么好，有点浅，有点窄，并没发现多少比网络中的各路博文更高明的地方。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;看淡点儿，有些事太累就没必要了。我很喜欢一同学的签名：＂总有些随风，有些入梦。＂&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在朋友们对MBP异口同声的推荐下，我还是订了低端PC，真够用了。我对自己需求的把握还是相当准的。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（75）</title>
   <link href="http://blog.tomsheep.net/2012/07/23/notes"/>
   <updated>2012-07-23T23:04:51+08:00</updated>
   <id>http://blog.tomsheep.net/2012/07/23/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;离开雅虎后最大的感受是什么？孤独，发自内心的孤独。来北京一年多，还是头一次真正觉得自己是个北漂。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我很纳闷，很多人看了我上一篇笔记后还在不停地问我去哪儿了。// 原来一千个读者眼中有一千个约炮网站。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有些朋友揣测我肯定是被下家用钱砸晕了，我多希望这是真的⋯⋯事实上我连劳什子的户口违约金都是自己赔的，疼晕了⋯⋯&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我很难说清为什么这么坚决地要离开，这是一个很复杂的心理学问题。如果非要把它简化千百倍的话，那我觉得可以这么概括，＂我没有觉得自己很重要＂。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;欢迎推荐实用的dev笔记本型号给我，你们这些用PC灌水的怎么可能知道用ipad发帖的蛋疼？&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（74）</title>
   <link href="http://blog.tomsheep.net/2012/07/19/notes"/>
   <updated>2012-07-19T23:27:58+08:00</updated>
   <id>http://blog.tomsheep.net/2012/07/19/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;今天我参加了同事的告别晚餐。他也参加了我的。——这是一个鬼故事的开头。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;聊起我今后的去向，我踌躇满志，笑而不语。表示多则三五年，少则个把月，潜心钻研，必有小成。那时节，将成果集结成书，书名就叫：《约炮之美》。—— 腰封必须注明“毕福剑、周杰伦、刘谦联袂推荐”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我就是个不高兴的孩子。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;If you happen to be my boss, please push me hard.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Windows内核情景分析》第四章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Linux将设备看做特殊的文件，Window内核将文件、设备等等都看做特殊的对象。对于所有的对象，Windows内核提供统一的操作模式，即：打开或创建目标对象，让当前进程和目标对象间建立联系，然后通过别的系统调用进行操作，最后通过系统调用关闭对象（与进程的联系）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;对象的操作有时需要同步，为此，对象类型的&lt;em&gt;OBJECT_TYPE&lt;/em&gt;结构中有个DefaultObject，指向一个默认的等待对象。比如，File对象以一个Event作为等待对象，WaitablePort以WaitEvent为等待对象。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;创建、打开对象的主体是进程。打开对象的其实质是一个进程与一个对象之间建立起一个连接，一个上下文。句柄起到的就是这样的作用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Windows内核中进程的句柄表是一个三维稀疏数组，类似于页面映射表。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;句柄在父子进程间可以遗传，也可以在一般进程间进行复制。Linux中可以将fd（打开文件的描述符，即上下文）授予另一个进程（通过socket的一个特殊功能），但这是建立在双方自愿、知情并相互配合的基础上的，第三方进程不能越俎代庖。但Windows就可以通过NtDuplicateObject来在进程间复制句柄，发起方可以是第三方进程。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;本进程的句柄并不一定都在本进程的句柄表里，有可能在公共的内核句柄表中。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（73）</title>
   <link href="http://blog.tomsheep.net/2012/07/17/notes"/>
   <updated>2012-07-17T23:41:59+08:00</updated>
   <id>http://blog.tomsheep.net/2012/07/17/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;我刚刚更新了#雅虎CEO 8.2.7 beta 3 build 9527 夏日清凉版#，全新推出18小时续航省电模式，多套精美女神壁纸，买一赠一~清凉夏日版，快来和我一起开启新能量吧！记得App Store给五星哦亲~&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我现在可喜欢理发了。——这样一来就又可以到处冒充王兴了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;Qing：打工没前途，快点创业吧！到时候别忘了招我去做行政主管。&lt;/p&gt;

&lt;p&gt;Kang：放心，不会忘的，创业的时候一定记得找你借钱。&lt;/p&gt;

&lt;p&gt;Yi：“借”多不好，还要还的，算风投吧~&lt;/p&gt;

&lt;p&gt;Kang：有道理，不如今天这顿你们俩就结了吧，算融个A轮~&lt;/p&gt;

&lt;p&gt;Yi：原来风投的要义在于首先让创业者吃饱……&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Windows内存管理》第三章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;分清楚哪些是硬件特性哪些是软件特性是理解操作系统运作方式的关键。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MMU的特性很大程度上决定了OS的分页内存管理实现，MMU负责将虚拟地址映射到物理地址：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 根据虚拟地址算出地址所属页面；&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 基于CR3寄存器找到页面映射表，计算出页面表项所在的物理位置&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 在TLB中查找表项内容&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 如果miss，发起额外的内存访问将表项载入TLB&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 检查表项相应的标志位，看是否已经映射到了物理内存，或者映射到某swap文件，或page fault。 除此之外，MMU还承担了检查内存访问权限的责任。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Windows和Linux在x86上都绕过了“段式内存管理”，将段寄存器都置为0，程序中的虚拟地址都成为“线性地址”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;所有进程的系统空间几乎都是公共的，除了PAGETABLE_MAP（不同进程内存映射表自然不同）和HYPERSPACE（某些物理页面临时映射到内核虚存空间）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;page fault多发生在用户空间，但由于Windows允许swap部分系统空间页面，所以也有可能发生在系统空间。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;页面swap行为的主体是内核线程MiBalancerThread, 被周期性时钟唤醒。swap策略为LRU（最近最少被用到）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;可以通过共享映射区将一个物理页面映射到多个进程的用户空间，之所以需要，主要是因为：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 进程间用以交换信息。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 共享页面可以被映射到一个磁盘文件，以该文件问倒换文件，利用页面倒换机制实现文件读写，可以省去文件读写的系统调用。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;  在实际应用中，第二种用法非常普遍，以至于共享映射区更多地被称作“文件映射区”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;用户空间是从Heap分配缓冲区的，在系统空间，也有类此的机制，叫做Pool：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; Heap是属于进程的，Pool是全局的&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; Heap属于批发/零售模式，卖完了可以向内核继续进货；但Pool的大小基本上是固定的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; Windows中有特色的是“可倒换页面池”——因为Windows内核比Linux大的多（图形服务也在内核），如果坚持内核页面不能swap的话，就会对物理内存配置提出过高的要求。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（72）</title>
   <link href="http://blog.tomsheep.net/2012/07/13/notes"/>
   <updated>2012-07-13T08:41:03+08:00</updated>
   <id>http://blog.tomsheep.net/2012/07/13/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;《轩辕剑》的50步踩雷打怪策略对有强迫症的人是一种折磨。——不过北京的司机们可能都已经习惯了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;继续Node.js的code review：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;预定义的C++模块都是用&lt;em&gt;NODE_MODULE&lt;/em&gt;这个宏来定义，并且放在&lt;em&gt;node_extention&lt;/em&gt;.h中的一个链表里。 &lt;em&gt;NODE_MODULE&lt;/em&gt;彻底展开之后其实是定义了一个结构体的元素，这个结构提是：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  struct node_module_struct { 
      int version; 
      void *dso_handle; 
      const char *filename; 
      void (*register_func) (v8::Handle&amp;lt;v8::Object&amp;gt; target); 
      const char *modname; 
  }; 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  &lt;code&gt;NODE_MODULE(node_XXX, func)&lt;/code&gt;，通过这样的声明，会定义一个模块(&lt;em&gt;mod_name&lt;/em&gt;)名为XXX，而注册函数(&lt;em&gt;register_func&lt;/em&gt;)为func的模块。而调用&lt;code&gt;process.binding(&quot;XXX&quot;)&lt;/code&gt;时，是通过调用&lt;em&gt;node_extention&lt;/em&gt;.cc中的&lt;code&gt;get_builtin_module(const char *name)&lt;/code&gt;来在list中寻找内置模块的，根据名字匹配找到对应结构体后，调用相应的&lt;em&gt;register_func&lt;/em&gt;，就达到了模块加载的目的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;em&gt;register_func&lt;/em&gt;的签名为 &lt;code&gt;void FuncName(v8::Handle&amp;lt;Object&amp;gt; target)&lt;/code&gt;, 在process.binding调用的时候传入的target就是“模块本身”对应的js对象。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在用户编写C++ addon（编译后为.node文件）时也是使用
&lt;em&gt;NODE_MODULE&lt;/em&gt;这个宏来声明模块注册函数的，而加载是通过Module模块的require来调用process.dlopen来完成。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;node::ObjectWrap这个对象在编写模块时也很有用，他封装了一个C++对象到一个v8对象（也就是JS对象）的映射，通过继承这个类会简化你的映射工作。看一下两个函数就知道它是怎么做到的了：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  inline void Wrap (v8::Handle&amp;lt;v8::Object&amp;gt; handle) { 
      assert(handle_.IsEmpty()); 
      assert(handle-&amp;gt;InternalFieldCount() &amp;gt; 0); 
      handle_ = v8::Persistent&amp;lt;v8::Object&amp;gt;::New(handle); 
      handle_-&amp;gt;SetPointerInInternalField(0, this); 
      MakeWeak(); 
  } 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  还有UnWrap：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  static inline T* Unwrap (v8::Handle&amp;lt;v8::Object&amp;gt; handle) { 
      assert(!handle.IsEmpty()); 
      assert(handle-&amp;gt;InternalFieldCount() &amp;gt; 0); 
      return static_cast&amp;lt;T*&amp;gt;(handle-&amp;gt;GetPointerFromInternalField(0)); 
  } 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  就是把这个wrapper对象的指针保存到了对应的v8对象的InternalField中，所以在拿到一个v8对象后，可以在InternalField中找到wrapper，而这个wrapper通常就是你的C++对象，Wrap和UnWrap就是对这个操作正向和反向的封装。可以参考 &lt;a href=&quot;http://nodejs.org/docs/latest/api/addons.html#addons_wrapping_c_objects&quot;&gt;这个例子&lt;/a&gt; 获得一个直观的认识。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;node::HandleWrap道理相似，但它要更复杂一些，因为它连接了三方：C++对象，v8对象，还有libuv的handle。实现原理和ObjectWrap是一样的，把wrapper指针既存在v8对象的InternalField中，也存在libuv的handle对象的data中，架起一座从用户C++到v8到libuv的桥梁。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;内置模块中到处可见对ObjectWrap和HandleWrap这个模式的拓展和应用。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Windows内核情景分析》第二章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;内核的主动面和被动面分别通过“进程调度”和“系统调用”来体现。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;应用软件直接按照系统调用接口（一般通过自陷指令）来进行系统调用往往不方便，一般都会在外面包一层，Linux的系统调用通过POSIX的C语言库来包装，和实际的系统调用一一对应，参数、类型、次序都基本相同。而Windows则没有将系统调用直接暴露出来，而是通过更高层的库函数提供给应用程序（Win32 API），这些函数和系统调用没有直接对应关系，微软也没有将系统调用接口公开，所以理论上微软可以随意对系统调用借口进行更改，只要保持高层API兼容即可。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;对比从用户态到内核态的三种途径：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 中断：外部设备发起，被动而不可预测，中断只发生在两条指令之间，不会使正在执行的指令半途而废。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 异常：执行指令失败会引起一次异常，CPU也会因此转如系统空间（如果原来不在系统空间的话）；和中断很相似，但异常是发生在执行一条指令的过程中，所以当前指令已经半途而废。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 自陷：对于x86来说就是int指令，是主动设计发起的，通常用来实现系统调用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 除此之外，一些CPU还提供了快速系统调用机制。如x86中的sysenter和sysexit指令。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;无论中断、异常还是自陷，内核入口处基本是一样的，都是通过共用的“中断向量表”IDT来跳转到相应的地方的。x86的设计愿意是0x30以上的中断向量（总共256）都给设备中断，但实际上Linux就没有遵守，用的是int 0x80，Windows是int 0x2e来实现系统调用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;每个线程都有自己的系统堆栈，保存在TSS（任务状态段中），TR段寄存器指向TSS，当从用户空间进入系统空间时，CPU自动根据TR指向的TSS中获得当前进程的SS和ESP寄存器值。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Linux不允许从内核里进行系统调用，必须去调用实现这个系统调用的底层函数。而Windows是允许在内核里进行系统调用，比如NtReadFile对应的用户态和内核态都可以调用的系统调用版本为ZwReadFile。这样的目的可能是：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 不愿意暴露底层函数入口&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 让内核和用户空间可以通过Zw系函数统一启动系统调用，对调试可以带来一些便利。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 早期Windows内核边界不清晰。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;WinNT基本的系统调用有200多个，和Linux差不多，但后来加入了图形界面服务，增加了一批“扩充系统调用”（win32k.sys）。系统调用从中断向量出来后到达系统调用表，通过eax寄存器存储的系统调用号来区分不同调用。不同的线程可以有不同的系统调研表。（实际上要么是KeServiceDescriptorTable，要么是KeServiceDescriptorTableShadow，前者是基本系统调用，后者也可用于扩充系统调用）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;系统调用返回用户空间时，会检查是否有APC请求，APC机制和Linux的Signal机制比较类似（二者也有很大区别），相当于内核向用户空间发出的中断请求。而当CPU降低运行级别到&lt;em&gt;DISPATCH_LEVEL&lt;/em&gt;之下时，就可能引起线程切换。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;快速系统调用不涉及堆栈操作，依赖一组MSR寄存器，预先设置好他们在sysenter时就可以进入系统空间并从预定的地址开始执行程序，同时开始使用系统空间堆栈，不需要从中断向量表获取程序入口位置。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（71）</title>
   <link href="http://blog.tomsheep.net/2012/07/12/notes"/>
   <updated>2012-07-12T00:20:29+08:00</updated>
   <id>http://blog.tomsheep.net/2012/07/12/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;我时常想在如此严酷的社会环境里，我应该从哪里寻找耐心。结论是对市场的信任：就是不管大环境如何变幻，始终相信市场不会亏待牛人，这就有了一个虽然遥远但相对固定而且容易衡量的目标。如果有一天连这一点都不能相信了，那才会让我感到绝望和恐慌。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Windows内核情景分析》第一章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;有传闻说Win8之后要干掉WinNT内核了，我不大相信。这反倒让我对仔细了解一下NT技术重新产生了兴趣。这本书三年多前在实验室用过，看得我十分沮丧，觉得自己实在不是搞OS的料。现在再重新补补课吧。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;WinNT内核初衷是“微内核”的设计，但后来发现由服务进程来提供服务效率太差，逐渐又移回内核，甚至把图形功能也加入了内核。所以，目前的WinNT内核包括了两部分，一部分是传统意义的OS内核（ntoskrnl.exe），另一部分是系统空间内的视窗服务（win32k.sys）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;微软并不依照传统把系统空间的所有代码统称为Kernel，微软术语中的Kernel指的是较底层、靠近硬件最核心的一部分（包含设备驱动底层中断处理、异常处理等相关功能）。而将同在系统空间但在“Kernel”之上的部分称为Executive，包括内存管理、对象管理、IO管理、进程/线程管理等等。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;应用软件看不见内核，他们通过Win32 API获得系统支持。微软通过一系列dll来实现Win32 API，其中几个比较靠近内核的dll（ntdll.dll, kernel32.dll, user32.dll）称为系统dll。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;用户空间和系统空间的分界，也是ABI的分界。ABI既是系统调用的接口，规定系统调用如何进行（Windows的系统调用接口是不公开的，现有知识多来自逆向工程），另一方面也规定了可执行文件的格式与结构。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CPU进入内核态只有三种途径：系统调用、中断、异常。中断和异常的入口都在内核底部（系统调用入口在内核顶部），因为中断和异常都来自于硬件。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Windows内核规定只有从Kernel（不是整个系统空间）出来时才能进行线程切换，就是说中断处理时不允许线程切换。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;和Linux不同，Windows内核一部分是可以使用分页内存的，这部分指的是Kernel层以上的系统空间页面。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Windows为CPU定义了IRQ级别，0——31，数值越大权越高。来标识某时刻什么可以做什么不可以做。IRQL在x86中没有硬件支持，就是一个变量，CPU自行设置，全靠自觉。用户空间代码和Executive层都运行在最低的&lt;em&gt;PASSIVE_LEVEL&lt;/em&gt;上，比起略高的是&lt;em&gt;APC_LEVEL&lt;/em&gt;（用于软件中断），再高是&lt;em&gt;DISPATCH_LEVEL&lt;/em&gt;, Kernel层在这个level上运行。照应一下G和H，线程切换只发生在CPU从&lt;em&gt;DISPATCH_LEVEL&lt;/em&gt;向下迁移时；而&lt;em&gt;DISPATCH_LEVEL&lt;/em&gt;及以上都不允许使用分页内存。IRQL 3以上用于硬件中断。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;看了一下午Node.js源码，觉得设计很简单很清楚。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;入口在node::Start:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 初始化v8&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 创建process对象，node::SetupProcessObject&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 在全局空间绑入Typed Array，加载所有native模块（包括src中的C++模块和lib中的js模块，所有js模块会被js2c.py预处理成&lt;em&gt;node_natives&lt;/em&gt;.h，来加快速度，在binding中所有js模块用“natives”这个symbol标识load进node）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; node::Load 这一步最有意思，是通过v8运行node.js来完成的。在node.js文件中，定义了NativeModule对象，它的require方法用来加载一个native module。这里需要提一下process.binding这个函数（即node.cc中的node::Binding函数，在第2步是绑到process对象）。它先在所有内置C++模块中找，如果发现是natives，则从加载node_natives.h加载，即所有的js内置模块。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 在node.js文件中，会调用Module.runMain（lib/module.js），而我们所熟悉的用户代码中的require，也就是Module模块中提供的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; libuv的message loop开启。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;所以，NativeModule.require加载的是js内置模块；而process.binding是c++内置模块，同时它把所有js模块同一认为是一个叫做&quot;natives&quot;的模块。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;不管是内置js模块还是用户的js模块，都会打一层wrapper，&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  (function (exports, require, module, __filename, __dirname) { });
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  不同的是传给内置js模块的require是NativeModule.require, 而传给用户js模块的是Module中定义的require。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有空再整理一下做更多的code review。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（70）</title>
   <link href="http://blog.tomsheep.net/2012/07/09/notes"/>
   <updated>2012-07-09T23:24:39+08:00</updated>
   <id>http://blog.tomsheep.net/2012/07/09/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;“世界在卸妆，而在你心里它还是小时候画片里的模样。”&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt; ——知乎用户卡卡&lt;a href=&quot;http://www.zhihu.com/question/20016608/answer/14801484&quot;&gt;如是说&lt;/a&gt;。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;好像我已经有一段时间没有正经看过书、写过程序了，这从我的笔记的质量和频率就看得出来。但我的雇主似乎没有发现这一点。FML&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;微博解除关注了近200人，顿时世界就清净了，约炮的、约架的、量身高的、验DNA的都不见了，就好像从来就不存在一样。——我发现一个规律，每当我对一样东西审美疲劳的时候，不多久就会有新的玩法出现。所以，结论是，新浪要警惕。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《汽车总动员》：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;如果让我来起个副标题的话，那会是《从66号公路看美国的乡镇自治》——哥的视角一向很独特。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;其余没什么，故事很主旋律，看个二十多分种差不多就知道全剧是怎么回事了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果迪士尼/皮克斯有一天拍了一部《Yahoo! Messenger》, 窃以为最好的中文译名是《蔬菜总动员》。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《搜索》：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;题材选的不错，但在这个题材下讲这么一个故事，觉得浪费了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;和我一起看电影的菜猪菜昕以及菜昕媳妇儿一直认为高圆圆很好很漂亮，但我觉得这部大体正常的戏里最不正常的就是她的这个角色……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“真有soso这么一个网站吗？”这是我后排观众在多次植入广告后的反应。——我该为腾讯感到高兴还是悲哀呢。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（69）</title>
   <link href="http://blog.tomsheep.net/2012/07/05/notes-69"/>
   <updated>2012-07-05T23:09:44+08:00</updated>
   <id>http://blog.tomsheep.net/2012/07/05/notes-69</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;History doesn&#39;t repeat itself, but it rhymes.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;  ——马克吐温老师肯定听过这段单弦：“上世号三皇，岁月茫茫。定礼乐，正天常，五帝治世，德被遐方；唐虞揖让圣人邦，汤武争诛道已伤。周室东迁纲纪紊，五霸七雄各逞强……” 溥心畬《&lt;a href=&quot;http://www.douban.com/group/topic/17981982/&quot; title=&quot;溥心畬《历史》&quot;&gt;历史&lt;/a&gt;》&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;听说&lt;a href=&quot;http://sports.sohu.com/20120705/n347340978.shtml&quot;&gt;湖人要从尤文图斯挖来皮尔洛&lt;/a&gt;，而且德罗巴也要来，全力备战明年的汤姆斯杯。可是，申花的全国场地锦标赛该怎么办？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;为女青年解答人生困惑是我近年来开发的第二职业。——哥毁就毁在太敬业上了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我反省了一下自己对“平台”的偏见，最典型的就是Win32，几乎是没有道理的；而我也不知道为什么会对Web充满信心，虽然Web App始终也没能牛X起来；同样的偏见存在于对C++语言的看法，当然这种偏见是相互的，不同阵营的程序员的论战通常以互称傻逼结束。——同样有这个症状的同学帮我去回答一下&lt;a href=&quot;http://www.zhihu.com/question/20332245&quot;&gt;这个问题&lt;/a&gt; 。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;“我们认为下面这些真理是不言而喻的：人人生而平等，造物者赋予他们若干不可剥夺的权利，其中包括生命权、自由权和追求幸福的权利。为了保障这些权利，人类才在他们之间建立政府，而政府之正当权力，是经被治理者的同意而产生的。”&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;  ——本来应该昨天来发，但昨天讲的人太多，我一害羞就没好意思。今天复习一下。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（68）</title>
   <link href="http://blog.tomsheep.net/2012/07/05/notes"/>
   <updated>2012-07-05T00:29:05+08:00</updated>
   <id>http://blog.tomsheep.net/2012/07/05/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;你们都不懂周正龙，他是在赌Apple的未来。——“雪豹”什么的都弱爆了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《牯岭街少年杀人事件》：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;可以代表一个时代的大电影。我联想到的是《美国往事》和《阳光灿烂的日子》，但《牯岭街》更有质感，用大段大段平实的长镜头来叙事，时代感彰显到极致。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我有点惊奇，片中的小四的许多特征在我身上都能找到。这是某一类人共有的特质？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;篇幅很长，但故事不复杂，节奏慢的让人有点出戏。不过静下来看，到处都是发人喟叹的细节。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最后的部分小翠、小明分别对小四说的两段话非常犀利，我甚至觉得导演在这里是不是把她们设计的超出了她们自身的水准：&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;-小翠：“你是不是现在很想改变我？……你想把我当生物实验课啊？你好像有很多大道理耶？……我这样子天天都很自在，而你呢？……如果我不改呢？如果我不照你的想法去做，你是不是就不理我了？……你好自私耶，你凭什么啊？”&lt;/p&gt;

&lt;p&gt;-小明：“你的意思是要帮助我来改变我,是不是?你怎么跟别人一样啊,我看错你了,你原来和那些人一样.对我好,只是想要跟我交换我对你的感情.这样你就安心了,是不是?你太自私了.要改变我?我就跟这个世界一样,这个世界是不会变的.你以为你是谁啊?”&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我直到大学毕业后才克服“交换安全感”的障碍。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;小四的父亲是让我最难过的一个角色，一个理想主义者向现实妥协，出现任何地方都会让我感到无限伤感。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;影片总是让我想到我的初中同桌，有一天他带了一把水果刀来堵另一个同学，因为刀钝而且没敢使劲，结果只蹭掉了对方一层皮。这个结局很欢乐，但真是一段让人唏嘘的过往。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Metro 中初始化WinJS control的过程：（WinJS.UI.process）&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;把有data-win-control属性的元素data-win-options属性解析为一个options对象。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;找到data-win-control属性指定的控件constructor，使用new操作符创建对象，参数传options。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;constructor创建出的对象将被储存在控件根元素的winControl属性下。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AppJS是一个使用Node.js+CEF 的跨平台native＋Web混合架构应用开发框架。通过Node.js提供的C++ addon机制将CEF绑入Node进程。目前支持win32、linux与macx.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;手段不新鲜，在CEF之上包装出app和window对象暴露给Node；app作为EventEmiter可以供应用程序员在程序生命周期中挂载handler，window就是一个webview，UI由HTML/CSS/JS的web技术实现，UI与Node的交互则通过hook特殊scheme（http://appjs/）来完成，这样app就像是一个本地服务器一样（当然他不是，没有走网络栈）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Node.js C++ addon 开发参考：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; &lt;a href=&quot;http://nodejs.org/docs/latest/api/addons.html&quot; title=&quot;官方指南&quot;&gt;官方指南&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;a href=&quot;http://izs.me/v8-docs/main.html&quot; title=&quot;V8 API&quot;&gt;V8 API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt; &lt;a href=&quot;http://code.google.com/apis/v8/embed.html&quot; title=&quot;V8 Embed文档&quot;&gt;V8 Embed文档&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（67）</title>
   <link href="http://blog.tomsheep.net/2012/07/03/notes"/>
   <updated>2012-07-03T07:33:15+08:00</updated>
   <id>http://blog.tomsheep.net/2012/07/03/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;回家的路上，遇见一小伙非常投入地边走边背《开粥厂》：“二两玫瑰、二两木樨、二两青丝、二两红丝、二两葡萄干儿……”周围的人都很诧异不知道啥意思——顿时我觉得自己老渊博了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;于千万年之中，时间的无涯的荒野里，没有早一步，也没有晚一步，刚巧赶上了，没有别的话可说，惟有轻轻地问一声——还有二两桂元肉……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在学校的时候，因为教学楼每一层的男女厕所分布都很莫名其妙，有时候左边有时候右边，像我这么喜欢思考人生的少年一不留神就走错。直到后来有一位先知点拨我说“靠近楼梯出入口的一定是男厕”，顿时醍醐灌顶，屡试不爽至今。——现在我把这一人生哲理分享给你们，也分享给当当网的产品经理。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使用HTML/JS/CSS开发的Metro app打成包后是一个后缀为appx的zip文件，解压后可以看到源码；开发时的Package.appxmanifest文件被转成了AppxManifest.xml（在第一次build时生成）。另外可以在dependencies下看到Microsoft.WinJS.1.0.RC.appx，解压后可以得到WinJS的源码：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;WinJS是一个JS库，包装了一些常用pattern以及HTML controls，包括base.js和ui.js两个JS文件以及ui-dark.css、ui-light.css两个css文件，近5万行代码。试了一下，把他们当成普通的库引入到一个Web页面在IE10里可以正常工作。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;其他浏览器会出一些错，但应该移植过去也不难。微软是不是考虑把这个修一修贡献给Web界，顺便让自己的Metro UI有更多市场？&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（66）</title>
   <link href="http://blog.tomsheep.net/2012/07/01/notes"/>
   <updated>2012-07-01T21:29:33+08:00</updated>
   <id>http://blog.tomsheep.net/2012/07/01/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;我一直觉得聚会时互相打听薪水是一件非常没劲的事情，因为对于提问者来说结果无非两种：一个是“嘿，这个傻逼，果然没我赚的多”；另一个是“操，这个傻逼，居然比我赚得都多”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;找了《大逃杀》来看，果然非常精彩，在人性剖析的路上飚了近两个小时，最后还回归到了人文关怀的层面；《饥饿游戏》从结构上细节上内涵上都显得逊色很多，但两部电影虽然框架很像，我仍然认为他们所表达的主题重合度不高。《大逃杀》重心在游戏之中，《饥饿游戏》的闪光点在游戏之外。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“Future generations will thank us for our care, and curse us for our haste.” ——来自Node.js社区领袖Issac对未来
&lt;a href=&quot;http://blog.izs.me/post/25906678790/on-es-6-modules?utm_source=javascriptweekly&amp;amp;utm_medium=email&quot; title=&quot;ES6模块加载机制的讨论&quot;&gt;ES6模块加载机制的讨论&lt;/a&gt;。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;上周Node.js 0.8.0 发布，前天更新到0.8.1 stable，主要变化有：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;读写、并发访问性能提升&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使用gyp替代waf作为build系统&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;让&lt;a href=&quot;http://nodejs.org/api/cluster.html&quot; title=&quot;cluster&quot;&gt;cluster&lt;/a&gt;模块更好用：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; cluster在0.6之后就已经存在，主要用于负载均衡，它可以让多个worker进程共享socket端口。如果一个worker请求监听一个端口，这个请求会被序列化发给master进程，如果master发现已经有一个相应的端口在监听，就会直接把handle传给worker；如果没有，就创建一个新的，把handle传回去。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 当多个进程都在accept()这个端口时，node通过OS会帮你做负载均衡，应用程序员的代码中不会出现routing有关的逻辑，多个worker中没有共享状态数据（要求程序设计不能过多依赖session一类的in-memory对象）。非常方便地让你通过Node利用多核计算资源，我尝试了一下，只用十多行代码就为我的博客添加了多个worker进程（当然这没什么用，因为压根没有那么大个并发量）&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;添加&lt;a href=&quot;http://nodejs.org/api/domain.html&quot; title=&quot;domain&quot;&gt;domain&lt;/a&gt;模块： domain用“group”来管理多个不同的IO操作，一个domain里的任一个event emitter抛出异常，domain对象都会受到通知。能够更好地track异常的上下文。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;release文档中提到在Node未来的版本中，会逐渐用Typed Array替代Buffer：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; Typed Array目前几乎已经是JS语言级的标准，用来访问原始的二进制数据。Typed Array比传统数组快的多，具有非常好的性能。因为类型数组实际上是作为一个固定的内存块来进行访问的，而传统的普通JavaScript数组使用的是Hash查找方式（因为元素长度不定）。类型数组可以广泛的应用于JavaScript图像以及视频的处理和压缩。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; ArrayBuffer是一种general的缓冲区，以明确的长度创建并且长度不可变，其中的内容不能被直接访问，而需要通过一系列具体的ArrayBufferView（包括Int8Array、UInt8Array、Int16Array、UInt16Array、Int32Array、UInt32Array、Float32Array、Float64Array）来访问内容。另外，DataView可以对来自底层的ArrayBuffer的字节的基础数据类型的任意的索引读写。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 可以参考两篇文章，&lt;a href=&quot;http://sd.csdn.net/a/20111231/309963.html&quot; title=&quot;一个二进制的Web新世界&quot;&gt;一个二进制的Web新世界&lt;/a&gt; 与 &lt;a href=&quot;http://blog.csdn.net/hfahe/article/details/7421203&quot; title=&quot;遇见Javascript类型数组(Typed Array)&quot;&gt;遇见JavaScript类型数组(Typed Array)&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（65）</title>
   <link href="http://blog.tomsheep.net/2012/06/30/notes"/>
   <updated>2012-06-30T00:31:30+08:00</updated>
   <id>http://blog.tomsheep.net/2012/06/30/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;为了纪念某个数字，我把上一篇笔记置顶了一个礼拜。——好吧，这是个冷笑话。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我一直在反思最近发生的一系列变化以及自己的一些作为，反思的结果用两个词可以高度概括：傲慢与偏见。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;作为一个糟糕的赌徒，我通常玩着玩着就会把手中的牌全亮给别人看。但这往往会造成一个有趣的误会，他们总会认为我肯定憋了什么后招，手里藏着两猫四个二——这真是一个美好的祝愿。更有趣的是，有时候我都差点以为这是真的……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使用JS/HTML5/CSS开发Win 8 Metro style apps：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;微软为这套技术栈提供两种运行上下文，local context和web context。local context可以访问WinRT所提供的系统API，可以发送跨域请求，可以访问远端数据，但不能加载远端脚本；web context不能访问WinRT API，更接近浏览器脚本行为。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一个app的初始页面（以及通过一系列navigation到达其他页面，通常通过 ms-appx:/// scheme）是local context的，在local context中可以使用iframe来嵌入local(ms-apps:///)后者web context(本地ms-appx-web:///， 远程http[s]://)的页面。在web context中不能引入local context。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;不同context的页面之间可以通过postMessage标准API来进行互相通信。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;每个app都有一个受限的存储目录，中有local、roaming（会同步到store的数据）、temp子目录。除了WinRT提供的系统API外，在页面中可以通过ms-appdata:// 来直接载入其中的数据（通过相应的html标签链入图片、audio、video等）。但不能通过它来加载JS、html、CSS等代码文件。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;和其他两套技术栈C++/Cx、C#/VB相比，JS解决方案中的“并发”编程模型略有不同：C#通过语言级别的await（C++中通过delegate）为并发编程提供方便的支持，当然这一语言特性并不能保证你的task确实是在background thread中执行的，可以通过Task.Run来实现这一点。Metro for JS的模型是单线程+事件驱动的，这我们毫不感到意外，语言级别没有await这么给力的异步编程支持，WinJS提供了Promise pattern的封装。如果确实有并发需求，可以通过Web Worker API实现（在local和web context下都可用）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当一个metro style app被激活时，实际上是一个名为wwahost.exe的进程作为“app host”启动了。这个app host一定程度像一个chrome-less的的IE 10 浏览器，和一个标准浏览器环境大致有以下区别：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 一部分DOM API经过了修改或者不可用，比如一些可以引起UI线程阻塞的方法如window.alert等是被禁用的（可以用系统提供的Windows.UI.Popups.MessageDialog来替代）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 一些元素有额外的功能，如audio、video、canvas等。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; local context和web context之分&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于app container这个沙箱：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 存储数据的访问如D所述。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; metro style app不能通过应用名或路径来启动其他apps，但可以通过文件协议关联来启动其他应用。但文件协议关联是用户可以掌握的，所以没有方法保证一定会启动某个应用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 对于系统设备API的访问是通过用户授权限制的。可以在appmanifest文件中配置所需权限，除此之外在首次访问时需要动态获得用户授权。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;  metro style apps之间以及他们和desktop app之间的直接进程交互是被禁止的。他们只能通过cloud或者contract（apps之间不需要知道彼此的细节）来通讯。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于一个metro style app的生命周期：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 有running、suspended、terminated几种状态。和iOS的设计很像，一个被挂起的程序仍然在内存里，但它可能会在系统认为“合适”的时候，比如内存紧张的时候，被自动终止掉。所以在编写程序时，需要在suspend时触发的事件handler或者checkpoint（系统提示你做状态保存）中做状态保存处理。而且，terminate是没有通知程序的event的，因为如果有，就形成一个矛盾的状况：就是terminate的发生通常处在系统内存吃紧的时候，如果发event激活app让他去做善后处理，本身又是需要更多内存的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 传统的desktop app中，一个不活跃的进程多多少少都会消耗一些CPU时间，为了预防偶尔需要部分重绘的情况；metro style app进入后台则完全不会被分配CPU时间。一些特殊应用如音乐播放器、通讯工具等会有例外。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一个Metro style app（全新）启动时的流程：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 展示splash screen，这时程序可以做初始化工作，最长可以延至15秒（可以通过一些手段延长）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 启动app host。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 读取appmanifest中的初始页设定。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 加载初始页面与页面所引用的资源。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; document.DOMContentLoaded事件触发。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; Windows.UI.WebUI.WebUIApplication.onactivated事件触发，通常程序的初始化代码写在这个handler里，包括初始化WinJS和custom控件，初始化状态等等。初始化WinJS控件通过WinJS.UI.processAll调用来完成，它返回一个promise，通常在activated handler中用args.setPromise()来把它包起来，意思是等这个promise被fullfill之后再处理下一个event。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 当activated事件handler返回时（除非用了setPromise来等一个promise的完成），splash screen消失，这时认为你的app初始化工作已经完成。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; body.onload触发。这个事件通常很少用在metro style app中，可能会被引入的第三方库用到。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（64）</title>
   <link href="http://blog.tomsheep.net/2012/06/23/notes"/>
   <updated>2012-06-23T01:45:22+08:00</updated>
   <id>http://blog.tomsheep.net/2012/06/23/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;“初阶程序员是最没创意的群体之一，基本是属于既没有学生的锐气，也没有成人的深度，被工作压迫到失去自我还偏偏自以为有梦想的一群。”&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;  ——来自知乎用户&lt;a href=&quot;http://www.zhihu.com/people/ryan_gao&quot; title=&quot;狼大人&quot;&gt;狼大人&lt;/a&gt;。我可耻地点了“赞同”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;忘了哪里看到的，&lt;code&gt;Array.prototype.push.apply&lt;/code&gt;， 他们是通过这样的方式来进行in-place的数组拼接的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://read.douban.com/reader/ebook/220919/page/27/&quot;&gt;这篇文章&lt;/a&gt; 的作者引用戈登.图洛克（《特权和寻租经济学》作者）的观点：权力寻租会间接抑制生产。与扩大再生产的投入相比，贿赂政府的投入自然会小得多。大部分生产者会选择与政府进行政治交易。这于经济发展十分有害。而且，在这样的环境下，获得的“政治权利”也并不牢靠，前一个寻租者随时可能被无情抛弃（如赖昌星之流），而每个人都希望成为潜在的“下一个”寻租者。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;电影《饥饿游戏》我觉得不错，可圈可点，不料又站在了广大人民群众的对立面：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;从开场字幕起我脑子里就已经条件反射出“今亡亦死，举大计亦死，等死，死国可乎”了——可见反动青年浑身都是G点，这能怪谁呢。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我认为这部影片在“压迫与反抗”“自由意志”“多数人的暴政”等主题上的表达是很不错的，我尤其喜欢其中两部分，一是lu死后女主角像镜头敬礼，11区民众从沉默到暴动，很到位；二是脱口秀主持人在场的所有戏份，是对荒诞规则反讽最精彩的几个段落。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;从“人性”主题的角度来看，这部影片亮点不多，有太多的大作在这方面有出色的诠释，《饥饿游戏》的表现只能算中规中矩。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在持不同意见的观众里有一部分认为同类型的《大逃杀》要出色的多，我没看过，完全有理由相信确实如此。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我看到还有人吐槽爱情戏莫名其妙的——咦，这片有爱情么？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有趣的是，在一个相对健康的社会里，美日作家总是喜欢YY出一些变态的统治制度，然后以此来反思自由；而生活在荒诞社会里的观众往往得不到共鸣，多数的反应是，擦，没几下就死了，这破剧情太不给力了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;&quot;我瞄准公众的良心，一不留神却击中了他们的胃&quot;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;  ——《屠场》作者 厄普顿辛克莱。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（63）</title>
   <link href="http://blog.tomsheep.net/2012/06/19/notes"/>
   <updated>2012-06-19T23:40:17+08:00</updated>
   <id>http://blog.tomsheep.net/2012/06/19/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;早上赶时间打车上班，刚坐定还没开口，司机看了我一眼淡定地来了句，“上地？”——我长得有那么像百度的么？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;大五道口地区发言人对此表示强烈不满和坚决反对，此举伤害了宇宙中心全体码农的感情。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我发现一个发人深省的现象：在北京和我私交不错的朋友，无论男女老幼，都有一个惊人的共同点，那就是——没有下限。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Boost内存管理：&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;scoped_ptr&lt;/code&gt;顾名思义， 只在本作用域中使用，不希望被转让。同时，它继承自noncopya ble, 拷贝构造函数与赋值操作符私有。其用法很简单，在原本使用指针变量接受new表达式结果的地方改成用&lt;code&gt;scoped_ptr&lt;/code&gt;对象，然后去掉那些多余的try/catch和delete操作就可以了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;scoped_ptr&lt;/code&gt;和标准库中的&lt;code&gt;auto_ptr&lt;/code&gt;很像，但根本区别在于指针的所有权。&lt;code&gt;auto_ptr&lt;/code&gt;的指针所有权可转移，可在函数间传递，同一时刻只能有一个&lt;code&gt;auto_ptr&lt;/code&gt;管理指针。由于语义太微妙而实用环境中经常出错。&lt;code&gt;scoped_ptr&lt;/code&gt;禁止所有权转让。他们俩都不能用作容器元素。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;shared_ptr&lt;/code&gt;是引用计数型的智能指针，可以被自由地拷贝和赋值，在任意的地方共享它，也可以安全地放到标准容器中。 &lt;code&gt;shared_ptr&lt;/code&gt;提供基本的线程安全保证，一个&lt;code&gt;shared_ptr&lt;/code&gt;可以被多个线程安全读取。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;weak_ptr&lt;/code&gt;用于协助&lt;code&gt;shared_ptr&lt;/code&gt;工作，像旁观者一样观测资源使用情况，并在需要的时候通过lock()获得一个可用的&lt;code&gt;shared_ptr&lt;/code&gt;。&lt;code&gt;weak_ptr&lt;/code&gt;的一个重要用途是获得this指针的&lt;code&gt;shared_ptr&lt;/code&gt;，见&lt;code&gt;enable_shared_from_this&amp;lt;T&amp;gt;&lt;/code&gt;的实现（这个类的使用场景是，一个成员函数有时会需要返回this的&lt;code&gt;shared_ptr&lt;/code&gt;）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于&lt;code&gt;shared_ptr&lt;/code&gt;的缺点，可以把玩并且思考一下 &lt;a href=&quot;http://blog.liancheng.info/?p=85&quot;&gt;这篇文章&lt;/a&gt; ，有点意思。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我还是对C++不感冒，很多复杂度完全是因为语言本身特性决定的，这些复杂度甚至经常会侵入式地影响到软件的设计方式与实现方法。程序员不应该过多地“和语言搏斗”，这是编译器的工作。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（62）</title>
   <link href="http://blog.tomsheep.net/2012/06/16/notes"/>
   <updated>2012-06-16T23:48:10+08:00</updated>
   <id>http://blog.tomsheep.net/2012/06/16/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;Kang：我想什么时候去趟欧洲，去意大利，看米兰德比。不过好像挑费挺高，机票就很贵。&lt;/p&gt;

&lt;p&gt;Zhu：你沿丝绸之路过新疆穿哈萨克斯坦一路步行过去呗……&lt;/p&gt;

&lt;p&gt;Kang：那多不安全，我在路上还得收三个徒弟。&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最近不自觉地积蓄了很多戾气——干啥呢，没让你闻——今天晚上坐在出租车上，一路堵车听着司机不住的京骂， 倒是有点豁然开朗的感觉。——就跟洗了澡似的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;人生需要正能量的不断鞭策。为了巩固疗效，学@青年老黄历 给开一方子：壬辰年夏，宜读书、宜专注细节、宜和老板1:1，宜反复抠腚、宜洗手；忌恶意吐槽、忌刷微博、忌思考人生、忌调戏大龄女青年、忌IE浏览器。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;细心的网友指出，学得一点都不像黄叔，连宜交配都没有。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;你知道昨天的公司的三周年庆祝活动我最大的收获来自于哪个环节吗？ 不是爬山、不是团队文化show、不是party、不是蛋糕……是照相——哼哼，我终于数清楚公司的男女比例了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我是个路盲，在北京打车，司机总是喜欢问“咱怎么走啊？”这个时候我就抓狂了，说“不知道”多土鳖，说“随便”又学不来高帅富的气质，一准露怯。而且他要是真“随便”了怎么办……后来我都回答：“哪儿不堵走哪儿。”——这下就轮到他抓狂了。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（61）</title>
   <link href="http://blog.tomsheep.net/2012/06/13/notes"/>
   <updated>2012-06-13T08:32:45+08:00</updated>
   <id>http://blog.tomsheep.net/2012/06/13/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;邵佳一今天全猜对了。——买彩票的人你们就哭去吧。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;事情一复杂我就头疼。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果一本英文书被翻译成中文，结果篇幅竟然差不多，那我第一印象会觉得译者挺失败的。《Hadoop权威指南》差不多属于这个情况。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《JavaScript语言精粹与编程实践（第2版）》看的断断续续，庆幸自己之前做了笔记。这本书写的相当有深度，第二大部分关于非函数式、函数式、动态语言特性的章节质量超过任何一本我看过的JavaScript书籍。喜欢琢磨编程语言本身的人应该会觉得这本书非常有价值。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;（磁盘）数据访问的瓶颈往往在于seek time而非tranfer time，MapReduce之于RDBMS+更多磁盘的优势在于：&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;For updating a small proportion of records in a database, a traditional B-Tree (the data structure used in relational databases, which is limited by the rate it can perform seeks) works well. For updating the majority of a database, a B-Tree is less efficient than MapReduce, which uses Sort/Merge to rebuild the database.&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MapReduce对于处理非结构化或半结构化数据有优势，因为它被设计为运行时处理分析数据。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Combiner用于减少map与reduce任务间的数据传输量。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Map的中间结果并不存入HDFS，因为这些结果最终会被扔掉，没有必要让HDFS来带来冗余。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;虽然Hadoop框架基于Java，但使用Hadoop的Map/Reduce应用可以有多种语言选择：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Hadoop Streaming is a utility which allows users to create and run jobs with any executables (e.g. shell utilities) as the mapper and/or the reducer.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Hadoop Pipes is a SWIG- compatible C++ API to implement Map/Reduce applications (non JNITM based).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;为了降低seek time，HDFS的block块要比磁盘block大得多，通常64M/128M. HDFS is optimized for delivering a high throughput of data, and this may be at the expense of latency. HBase is currently a better choice for low-latency access.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（60）</title>
   <link href="http://blog.tomsheep.net/2012/06/11/notes"/>
   <updated>2012-06-11T07:58:17+08:00</updated>
   <id>http://blog.tomsheep.net/2012/06/11/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;先有民主还是先有法治？回答哪一面都不合适，这是个鸡生蛋蛋生鸡的问题。通常见到的辩论中持前者观点的人通常纠结于论证“民主会带来法治”，但我总认为这是不可证实的。对己方更有利的思路应该是强调二者在实践中是不可割裂的，否定这个问题本身的合理性；持后者观点的人往往带有莫名其妙的优越感，我建议周鸿祎做个软件，每天提醒他们“您今天的装逼指数击败了全国99%的用户，注意保持哦~”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;下次西班牙要是再打不开局面，卡西利亚斯应该主动摆个乌龙，这样全队就相当于打了鸡血了。——跟无崖子的珍珑棋局道理一样一样的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;贺炜在讲解“皮尔洛是个自我实现的富二代”时，夹带了很正面的价值观，给他鼓一下掌。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;类比往往是让语言幽默起来的捷径，但事实上绝大多数的类比都是不恰当的，因为现实中很难找到“可比”的两件事物，因此“越理性的人越无趣”，我想这也是其中的原因之一。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Robert O’Callahan认为，CSS transitions 和 animations的优势在于浏览器知道哪些动画将会发生，所以得到正确的间隔来刷新UI。而传统javascript动画(基于setTimeout/setInterval)，浏览器不知道动画正在发生。 requestAnimationFrame() 实现动画相比传统setTimeout/setInterval的好处在于，减少了大量定时器的开销，让浏览器统一进行帧管理。而且放在浏览器层面做，还可以带来很大的优化空间。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Google Analytics常出现中organic和referer的区别，原因多在于对本地搜索引擎的URL规则支持不完善，比如百度首页中搜索的wd参数就会被记作organic，而第三方网站中的百度搜索框参数word就不会记入organic，只作为referer。解决方法是在ga配置代码中加入诸如&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; _gaq.push([&#39;_addOrganic&#39;, &#39;baidu&#39;, &#39;word&#39;]);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt; 这样的语句。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Asking the right questions》第二个问题，What are the reasons?&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Reasons are beliefs, evidence, metaphors, analogies, and other statements offered to support or justify conclusions.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;One of the best ways for you to determine whether you have discovered a reason is to try to play the role of the communicator.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;作者建议在阅读中标记区分出conclusion和reasons，有助于读者理解文章观点。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（59）</title>
   <link href="http://blog.tomsheep.net/2012/06/09/notes"/>
   <updated>2012-06-09T21:04:29+08:00</updated>
   <id>http://blog.tomsheep.net/2012/06/09/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;People come people go. That happens everyday. ——听着像是赵丽蓉老师说的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;葛志福说，大家普遍认为理科学生的逻辑要比文科生好，这是有误区的：理科生擅长“推理”，但缺乏“质疑前提”的习惯，因为数学公理不会经常受到challenge。而“质疑前提”往往是驳论的关键点。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;平时一些朋友喜欢和我聊“怎么把一件事情做/学好”，其实在这个话题上我不是很有发言权，关于“怎样做会把事情搞糟”我倒是有丰富的经验。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《马达加斯加3》是个不错的卡通片，价值观一如既往的普世，细节永远精致，即便剧情已经让你找不到任何新鲜感，观众还是觉得得到了试听的享受。PS：最近看得几部电影字幕都翻译得很俏皮，应该是年轻的翻译人开始崭露头角了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《数学之美》7——29章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;我觉得这本书可以这样来读，先读目录，如果你是相关章节的专家，可以草草浏览一下这一章的脉络，看看作者的思路，思考一下如果你来写这个话题会怎么展开；如果对相关主题不甚了解但很感兴趣，可以按照吴军的介绍，找到入门的线索，配合大量文中提到的资料来进一步理解问题；如果不了解也不太感兴趣，那粗读一遍留个印象也是极好的，拓宽知识面，出去吹牛也是个帮助。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;然后过一段时间，可以再拿出来，只看目录，如果还能回忆出相关章节的来龙去脉，那一定会相当有收获。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有一个感觉，就是你在给别人credit的同时，其实也是在给自己张脸。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;作者说数学的发展实际上是不断地抽象和概括的过程，这些抽象了的方法看似离生活越来越远，但他们最终能找到适用的地方。比如搜索引擎索引的本质就是布尔代数。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;网络爬虫主要考虑这几点：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; 用BFS还是DFS&lt;/li&gt;
&lt;li&gt; 页面分析与URL提取&lt;/li&gt;
&lt;li&gt; 记录哪些网页已经爬过。&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;  第三点通常会成为整个系统的瓶颈，解决思路一般是:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; 将URL映射到相应的服务器&lt;/li&gt;
&lt;li&gt; 批处理询问（是否下载过某URL）&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;PageRank（网页排名算法）高明之处在于把整个互联网当做一个整体来对待，而之前的信息检索大多把每一个页面当做独立的个体对待，只注意网页内容和查询语句的相关性，忽略了网页间的联系。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;确定网页和查询的相关性一般以TF-IDF为量度：TF是单文本词频，即某词在本页面出现的频率，此外每个词有一个权重，一个词预测主题的能力越强，权重越大，停止词（的地得等）权重为0；IDF是逆文本频率指数，这个值和“含有某词的网页数/所有网页数”负相关。一个网页在查询中的综合排名大致由相关性和网页排名的乘积决定。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;地图搜索一般被抽象为有限状态机；导航算法则多用到动态规划。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;新闻分类算法背后是：用余弦定理计算出的不同新闻特征向量（主题词）之间的相关程度。在规模不是非常大时（可以处理百万量级）是很高效并且简洁的。规模巨大时常利用矩阵运算中的奇异值分解解决。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;信息指纹通常可以用作判断集合相同（误差概率工程上可以忽略），反盗版算法等等。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;公钥系统的好处有：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; 简单，就是乘除&lt;/li&gt;
&lt;li&gt; 可靠，产生的密文是统计独立而且分布均匀的。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一个正确的模型一开始可能还不如一个精确琢磨过的错误模型来的准确。但是，如果大方向是对的，就应该坚持下去。举例是日心说与地心说。PS：给我科普了一下今天的日历系统，即格力高里日历的来源。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“不要把所有鸡蛋放在同一个篮子里”，是最大熵原理的朴素说法。即保留全部的不确定性，将风险降到最小。这个模型常被对冲基金所用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果用哈希表来过滤垃圾邮件，内存耗费会过大，布隆过滤器提供了更有效率的方案，缺点是有一定的“false positive”概率，通常用白名单补偿。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;为CDMA技术前身的发明者海蒂拉马尔挺漂亮的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有几章没太看进去，兴趣也不太大。不过这本书可以常看常新。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（58）</title>
   <link href="http://blog.tomsheep.net/2012/06/06/notes"/>
   <updated>2012-06-06T08:42:13+08:00</updated>
   <id>http://blog.tomsheep.net/2012/06/06/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;就是微软拿枪指着我我也依旧觉得Metro UI实在是太2了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;糖衣炮弹也没用……美人计？恩……其实Metro也不是完全没有可取之处……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Windows Runtime官方的定义是&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;“The Windows Runtime is a set of APIs developed for Windows 8 Release Preview that provide networking functionality, better XML parsing, access to the system and devices, and more.”&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt; 支持JS/HTML5 开发，同时也支持.NET和C++，使用C#和VB.NET时，使用的是.NET一个子集。微软的技术栈变化的真频繁，也不知道MS阵营的程序员吃不吃得消。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;JS的API采用Promise模式做为异步基础。WinRT中的HTML/CSS/JS和标准用法有差异，详见 &lt;a href=&quot;http://msdn.microsoft.com/en-us/library/windows/apps/hh465380.aspx&quot;&gt;这里&lt;/a&gt; 和 &lt;a href=&quot;http://msdn.microsoft.com/en-us/library/windows/apps/hh700404.aspx&quot;&gt;这里&lt;/a&gt; 。App中的JS会被首先编译为引擎可读的二进制码以获取性能提升。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;吴军新作《数学之美》1——6章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;感谢@车东 老大赠书。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;吴军是少有的能把一件事情的原委讲的很清楚、让读者看得清脉络的技术人。很适合做老师。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;他是这么解释我过去提到过的白话和文言体系脱离现象的，这个“最短编码原理”的思路很有意思： 讲话是一个宽信道，无需压缩；书写来得慢是一个窄信道，需要压缩。将日常的白话口语写成精简的文言文是信道压缩的过程，训诂则是解压缩过程。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;校验和是犹太人为抄写圣经发明的……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;人工智能上个世纪70年代以来从“人脑模拟”走向“数学模型与统计”，大大提高了人工智能的“能力”。但我觉得，现在就下结论（或者任何时候下结论）说统计就是人工智能的正道似乎是不合理的。我没有太多人工智能背景，但我基于直觉认为基于统计的人工智能在未来很有可能会走到瓶颈，因为这不是“智能”。那时，过去被否定掉的思路被重新拿回来，并不是什么罕见的事情。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;马尔科夫假设：假设任意一个词wi出现的概率只和它前面的词wi-1有关，大大简化了计算复杂度的同时，产生结果可以令人接受。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当自然语言处理的问题回归到通信中的解码问题时，很多难题都迎刃而解了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;信息量等于不确定性的多少。网页搜索的本质是利用信息消除不确定性的过程。因此，偏离了“信息”本质的机器学习和算法都是缘木求鱼。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（57）</title>
   <link href="http://blog.tomsheep.net/2012/06/05/notes"/>
   <updated>2012-06-05T07:39:11+08:00</updated>
   <id>http://blog.tomsheep.net/2012/06/05/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;一切不以提高生产效率为目的的“敏捷”与“测试驱动”都是耍流氓。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;祖国来大姨妈，最好别惹她。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Asking the right questions》第一个问题：What are the issue and the conclusion?&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Descriptive issues are those that raise questions about the accuracy of descriptions of the past, present, or future.  (Who, What, How...)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Prescriptive issues are those that raise questions about what we should do or what is right or wrong , good or bad. (Should, Must, Ought to be...)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;寻找issue： 有时文章的主题并不会直接了当的给出，查看标题、段首、查阅背景信息都是不错的帮助，最准确的途径是locate the conclusion.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;寻找conclusion: 作者总是希望通过论证让读者相信他的结论，一个“劝说式”的对话，常见的结构有&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; This because of that.&lt;/li&gt;
&lt;li&gt; This refers to the conclusion; that refers to the support for the conclusion.&lt;/li&gt;
&lt;li&gt; This structure represents the process of inference.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;conclusion必须是被推导出来的，无论据支持的论断只能是“opinion”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Clues of how to find the conclusion:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; Ask what the issue is.&lt;/li&gt;
&lt;li&gt; Look for indicator words. (shows that, prove that, etc.)&lt;/li&gt;
&lt;li&gt; Look in likely locations&lt;/li&gt;
&lt;li&gt; conclusion不是example, defination, evidence, background information, etc.&lt;/li&gt;
&lt;li&gt; 查看上下文以及作者的背景信息。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当写作时，注意强调结论，帮助读者便利地找到文章主题。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《JavaScript语言精粹与编程实践》前一阵子读了一半，拿起来继续，JS的动态语言特性：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;这一章涉及的大量偏门内容在生产中多数情况下是不需要接触的，有人故意这么写你可以枪毙他5分钟。但当你遇到难以理解的bug时，这些知识会给你带来帮助。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;构造器的原型创建自系统内部的对象系统，不是可被外部覆盖的标识符Object。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;元类型只有值类型和引用类型两种。而只有函数与对象是引用类型的。JS的对象系统衍生自元类型object，函数式语言特性基于元类型function。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在参与运算时:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; 如果数据是值类型，则直接参与值运算（值运算可能会有隐式转换）&lt;/li&gt;
&lt;li&gt; 如果valueOf()返回一个值类型数据，则以该数据参与值运算&lt;/li&gt;
&lt;li&gt; 使用toString()返回的字符串参与运算。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（56）</title>
   <link href="http://blog.tomsheep.net/2012/06/04/notes"/>
   <updated>2012-06-04T07:38:44+08:00</updated>
   <id>http://blog.tomsheep.net/2012/06/04/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;今天是一个值得纪念的日子——复旦软院成立十周年了（想什么呢你）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我讲几句，吃完这个棒棒糖，我们就回去反思。院庆是里程碑，我知道这看起来是件大事。但我们的使命不是成为一所乌烟瘴气的学院。我们的使命是让学术更独立、思想更自由。你们曾经打造了让我自豪的社区。我等不及要看你们未来会做得怎样。——我是不是很有院长范儿？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;院庆之际有同学重新挖出了我摄影生涯中的代表作：《&lt;a href=&quot;http://weibo.com/1653960970/ezmn3whu3WE&quot; title=&quot;《冥想》&quot;&gt;冥想&lt;/a&gt;》 。最让我吃惊的是，在转发的人群中，有几个女ID纷纷写下这样的转发理由：“本科室友……”——这让我久久不能平静。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;周末看了好多电影，没什么评论，《龙纹身的女孩》、《触不可及》非常推荐，《哈七下》和《雨果》凑合着看吧。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“我喜欢&lt;em&gt;_____&lt;/em&gt;的北京。”这个填空题让我来做，那肯定是“降雨量达10到20毫米、雨过天晴5到10分钟这个节骨眼”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Let&#39;s fight.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（55）</title>
   <link href="http://blog.tomsheep.net/2012/06/02/notes"/>
   <updated>2012-06-02T07:26:31+08:00</updated>
   <id>http://blog.tomsheep.net/2012/06/02/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;周汝昌先生修文地下，祝愿他在另一个世界读到《红楼梦》的全本。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;高中时喜欢看他的一些考证为主的作品，btw，他对史湘云大概是“真爱”吧。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Google现在实在是太贴心了，为了防止你撞墙（从而会导致被锁几分钟），现在有这样的提示&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;We&#39;ve observed that searching for [XX] in mainland China may temporarily break your connection to Google. This interruption is outside Google&#39;s control.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt; XX就是主动提示你这是敏感的字/词。——这真是我梦寐以求的feature。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果无意中造成一个误会，而误会客观上有一定几率对你是有利的，澄清它或者不澄清它都有可能引出更多的麻烦，这是一个比较蛋疼的情景。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如何看待最近自身暴露出的一系列问题？要接受自己有时候也不那么“帅”——留5分钟你们先吐一会儿。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《精通CSS》是少有的能让我耐心读下去的CSS书：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;内容不算新，但不会让你时刻都有“这点是不是过时了”的顾虑。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;篇幅控制的很好——这一点很多技术书籍编著者都没有重视——在读者崩溃之前就让他读完这本书，是一个很重要的用户体验。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CSS三种基本定位机制：普通流、浮动、绝对定位。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 普通流遵从元素在html中的位置，relative的元素会出现在它现在所在的位置上+偏移量，元素仍然占据原来的空间（可视为普通流定位的一部分）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;  绝对定位与文档流无关，因此不占据空间，就像不存在一样。绝对定位的元素相对于最近的已定位的祖先元素，如果没有已定位（relative或absolute）的祖先元素，那么相对于最初的包含块（html或canvas） fixed是绝对定位的一个子类别，固定元素的包含块是viewport&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 浮动的框可以左右移动，直到它的边缘碰到包含框或者另一个浮动框的边缘。浮动框不在普通流中。行框围绕浮动框，块框无视浮动框。阻止浮动可对框用clear，表示框的哪些边不应该挨着浮动框。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;浮动在布局中经常会被用到，但它本身会造成一些混乱，比如当一个元素是浮动的，如果没有关闭浮动时，其父元素不会包含这个浮动元素，因为此时浮动元素从文档流中脱离。通常解决方法是用相邻元素clear来消除浮动，或者container的overflow置为hidden或auto。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;清除浮动的本质就是产生一个块级格式化范围，它会自动清除内部的浮动。参考 &lt;a href=&quot;http://blog.csdn.net/hedong37518585/article/details/6645919&quot;&gt;这篇文章&lt;/a&gt; 和 &lt;a href=&quot;http://www.cnblogs.com/javashi/archive/2011/03/21/1990096.html&quot;&gt;这篇文章&lt;/a&gt; 。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有6种情况会发生“包裹”（尺寸由包容的元素决定）：行内框（比如span包含文字），浮动（未设宽高），display:inline-block的行内框（比如a），display:inline的块框（未设宽高），overflow:hidden，position:absolute&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（54）</title>
   <link href="http://blog.tomsheep.net/2012/05/31/notes"/>
   <updated>2012-05-31T08:26:05+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/31/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;近日获知一些让我唏嘘不已的消息，我尝试带入地想，人格破产、被孤立、不被信任对于一个社会人来说，是否是一种毁灭性的惩罚？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;方……方舟子？靠，你想到哪里去了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一个群体或组织中的个人作出损害社会道义甚至违反法律的行为，但行为本身与组织无直接关系，该群体或组织是否应该为此承担一定责任？我认为是需要的，就像SAP的VP在超市偷东西，SAP应该出来道歉；就像雅虎的CEO……不提这事，当我没说；这一点就连我党都知道，“开除党籍，移送司法机关依法处理”——咦，我是不是太敏感了，觉得这两句话之间隐含了这样一层意思，就是“依法处理”总是要在“开除党籍”之后？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最近状态非常差，难以接受的差，我觉得应该冷静地思考一下。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我一直是个怂人，但是在努力地变得有那么一点点担当。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;YUI和JQuery的API设计（DOM方面）哪一个更合理？我比较赞同 &lt;a href=&quot;http://hax.iteye.com/blog/850778&quot;&gt;这篇文章&lt;/a&gt; 的看法：对于方法（函数）的重载来说，应该坚守这个原则：重载方法（函数）干的事情应该是相同的。相比attr，setAttr和getAttr虽然多了几个字符，但是能确保程序的可读性。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;看张克军的一个分享，复习页面加载时的规则：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;body里的资源文件要等到前面的JS执行完才开始下载&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;body要等到head里的CSS和JS下载并执行完才开始渲染&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;资源文件每域名并行下载数高低端浏览器差异大&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;遇到外联JS，渲染会停止到JS下载并执行完&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;遇到内联JS，渲染会停止直到执行完&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;无论外联或内联JS，要等到它前面最慢一个CSS下载完才执行&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DOMContentReady要等最后一个JS执行完&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;因此, 理想文件组织：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;head最轻：1）head里不放任何JS，同时仅有inline css 或2）head里放尽量少的JS，同时JS放在CSS前面，接近最轻&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;所有页面初始化阶段的JS都放在文档最后&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;非初始化阶段JS按需加载&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;对于大规模网站文件组织，性能不是最重要的&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;前后端共同形成一套静态文件管理体系&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;文件组织尽量自然&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;web应用区别对待： web应用（单页面，功能集中）采用CommonJS标准的模块化组织，上线打包合并为单一文件&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我其实不是特别喜欢研究这些东西，包括Yahoo!的&lt;a href=&quot;http://developer.yahoo.com/performance/rules.html&quot;&gt;best practices&lt;/a&gt; ，都是一种吊诡的“术”，而不是软件设计的“道”，随着web应用观念的变化与浏览器的发展，这些practices会变得无用，甚至会禁锢你的思维。但必须看到的是，“道”往往是隐藏在各种各样的变幻莫测的“术”之中的。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（53）</title>
   <link href="http://blog.tomsheep.net/2012/05/29/notes"/>
   <updated>2012-05-29T07:18:39+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/29/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;余平生三恨，一恨鲥鱼多刺，二恨海棠无香，三恨纱窗上有洞。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;早上很多人都说北京有震感——你确定不是你旁边的哥们在抖腿？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有件事我一直没想明白，让我再想想。不过以我这个智商可能是想不明白了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一群没有自信的人聚在一起很容易有民粹倾向，互相找安全感，烂事做得心安理得，借口找的冠冕堂皇。小到八十人的粉丝团，大到八千万人的黑社会，都是这样。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Asking the right questions》(总论)：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;作者总结，critical thinking有以下三层含义：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; awareness of a set of interrelated critical questions;&lt;/li&gt;
&lt;li&gt; ability to ask and answer critical questions at appropriate times ; and the&lt;/li&gt;
&lt;li&gt; desire to actively use the critical questions.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sponge式思维和Panning-for-Gold式思维：前者吸收信息快而易，相对被动，要求信息本身生动明确，对不同观点缺乏分辨力；后者是一个互动的过程，有时富有挑战性而且枯燥，强调信息获取过程中的主动思辨能力。两者是互补的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;critical thinker需要有开放的心态，随时准备挑战自己的观点。&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Weak-sense critica l thinking is the use of critical thinking to&lt;/p&gt;

&lt;p&gt;defend your current beliefs . Strong-sense critical thinking is the use o f the&lt;/p&gt;

&lt;p&gt;same skills to evaluate all claims and beliefs , especially your own.&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（52）</title>
   <link href="http://blog.tomsheep.net/2012/05/28/notes"/>
   <updated>2012-05-28T07:43:26+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/28/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;欧洲杯转眼就要来了，而上一届似乎才刚刚结束；希腊夺冠好像也是不久之前的事情；特雷泽盖的绝杀也仿佛发生在昨天——生在一个能被四整除年份的悲剧就在于，不停地有这样的故事来提醒你的年龄。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我又多了一个小侄子，不出意外几天后又会多一个，我感到压力很大：在家族中，每当不愿意处理复杂人际关系的时候，我的对策就是卖萌——看来路线改革已经迫在眉睫了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;葛志福认为中国民主进程需要自上而下，否则会付出难以承受的代价，一旦有变，上层阶级会毫不犹豫卷钱走人，最终接盘的仍然是无能为力的升斗小民，为此可能会付出几代人的代价——这和我的观点的一部分比较相近，我同时认为自下而上的推动是必不可少的，只有更多的人觉得这个国家机器无比荒谬的时候，自上而下的变革才会有基础。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;中国的右派其实很可怜，不仅同时包揽了正常社会里左派和右派的活，（你很难想象主张“私权、自由”和“社会公平”的是同一拨人），而且每天都生活在矛盾中：一方面希望尽快摆脱荒淫无度的政权，一方面又投鼠忌器，希望有一个温和的渐变。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;左派就轻松多了，只要反人类就可以了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;天生的牛人是有的，但概率小到可以忽略，多数人成为牛人一个重要的原因是他们有反思的精神，他们在生活中不断反思调整让自己走向NB——葛志福举的例子是罗永浩，但老罗一直向大家吹牛说自己是个神童 XD&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;昨天下午回来睡了十多个小时，做梦无数，现在它们的影像还十分清晰，并且我清楚地知道为什么会做这样的梦，充分地体现了我的蛋疼。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（51）</title>
   <link href="http://blog.tomsheep.net/2012/05/27/notes"/>
   <updated>2012-05-27T07:22:42+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/27/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;龙德广场里看到一则培训班广告，“教你如何使用iphone/ipad”——这大概是Google搞出来恶心苹果的吧？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;健康的网络环境是什么样子的？&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;-A: 你是个傻逼。因为blabla……&lt;/p&gt;

&lt;p&gt;-B: 你说得对。&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;咦，这不就是奥巴马和马英九关于人权报告的对话么？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;民主的核心精神不是一人一票，而是包容。——这一点经常遭到官方的恶意曲解。当然，右派中部分不学无术的人也有这样狭隘的认识，“民主后杀你全家”就是这种让人哭笑不得言论。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于逻辑，有空看看这篇文章，有病治病，没病防CCTV： &lt;a href=&quot;http://article.yeeyan.org/view/65452/28581&quot; title=&quot;常见逻辑谬误&quot;&gt;常见逻辑谬误&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我决定不再吐槽我的雇主了，它已经够倒霉的了。同时，也不能将所有的问题都归结于环境，这不是一个负责的态度。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《黑衣人3》：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;美国人民该是多想拯救地球？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;很惊讶，纽约这次居然没被炸掉。有新意。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;还不错，什么都敢吐槽。乐呵乐呵得了。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（50）</title>
   <link href="http://blog.tomsheep.net/2012/05/26/notes"/>
   <updated>2012-05-26T07:34:52+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/26/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;“ 随着技术被普遍的接受，技术终于将回归谦卑的姿态。任何技术终将可以被其它相似的技术取代，人们会重新定义自己的需求，而不是被工具去限制和教育。技术不会继续限制用户，用户和信息将可以在技术和产品之间自由迁徙，开放标准的重要性被更广泛的接受。”&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt; ——知乎上看到这样一段，很有感触，我甚至忘了记录他在回答什么问题，但是这有什么关系，“大师兄说得对”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我也想像yuanchen一样给自己放个小长假，心太累了。但是我已经没有什么假期了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一转眼笔记的index已经到了50，每天固定有200多PV，我很高兴有这么多人愿意看我扯淡，同事甚至开始叫我“屌总”。当时把这份笔记放在这里而不是&lt;a href=&quot;http://blog.tomsheep.net&quot; title=&quot;言之有误&quot;&gt;博客&lt;/a&gt;中，我的理由是我的博客里不应该出现阴暗的情绪。其实我多虑了，因为真正阴暗的东西我文字能力有限写不出来。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一腔热血，洒在地上。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（49）</title>
   <link href="http://blog.tomsheep.net/2012/05/24/notes"/>
   <updated>2012-05-24T06:42:52+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/24/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;我知道要moving forward，但实在不清楚哪边是forward。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Mozilla的JavaScript 1.7 （Firefox 2+支持）加入了yield语句，所以通过这样的方式开启隐藏特性：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; &amp;lt;script src=&quot;xxx.js&quot; type=&quot;text/javascript;version=1.7&quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Callback和Coroutine两种编程范式之争由来已久，前者的弊端在于逻辑碎片化，而后者则需要额外的栈来保存状态，内存开销大。NodeJS选择了Callback，其创始人Ryan Dahl在邮件列表中这样说，&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Yes, there have been discussions. I think, I won&#39;t be adding&lt;/p&gt;

&lt;p&gt;coroutines. I don&#39;t like the added machinery and I feel that if I add&lt;/p&gt;

&lt;p&gt;them, then people will actually use them, and then they&#39;ll benchmark&lt;/p&gt;

&lt;p&gt;their programs and think that node is slow and/or hogging memory. I&#39;d&lt;/p&gt;

&lt;p&gt;rather force people into designing their programs efficiently with&lt;/p&gt;

&lt;p&gt;callbacks.&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;项目&lt;a href=&quot;https://github.com/laverdet/node-fibers&quot; title=&quot;node-fibers&quot;&gt;node-fibers&lt;/a&gt;（V8/C++实现）事实上为node加入了coroutine支持。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在一门语言中实现&lt;a href=&quot;http://en.wikipedia.org/wiki/Call-with-current-continuation&quot; title=&quot;call/cc&quot;&gt;call/cc&lt;/a&gt;的必要条件是：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;支持闭包&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;把程序写成&lt;a href=&quot;http://en.wikipedia.org/wiki/Continuation-passing_style&quot; title=&quot;CPS&quot;&gt;CPS&lt;/a&gt;（Continuation Passing Style）风格。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; 而把程序写成CPS风格，要点是：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;每个function接受一个continuation作参数（continuation在很多语言中多表现为function）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;function通过调用continuation返回。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://blog.kghost.info/index.php/2011/10/callcc-and-node-js/&quot; title=&quot;call/cc and nodejs&quot;&gt;这篇文章&lt;/a&gt;的作者用node-fibers实现call/cc：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; var call_cc = function(cont) { 
     var fiber = Fiber.current; 
     cont(function (a) { 
         fiber.run(a); 
     }); 
     return Fiber[&quot;yield&quot;](); 
 }; 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt; (最后一句不直接用Fiber.yield()是因为yield是JavaScript的一个保留关键字，有些lint工具会complain)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;NodeJS有vm模块，可以动态编译/执行JS代码，meteor在加载模块时就使用了vm.runInThisContext()。效率比较差，但好处是这个方法是同步的，让代码编写比较简单。与eval不同之处在于，runInThisContext 相当于一个全新的环境中执行代码，不会影响当前作用域的对象。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;这位妇女，你心思又活络了是吗？&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（48）</title>
   <link href="http://blog.tomsheep.net/2012/05/23/notes"/>
   <updated>2012-05-23T07:11:01+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/23/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Bagholder简直是对“临时工”这个词的完美英译。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;奥巴马在最近的Your Weekly Address中说，&amp;quot;We can’t afford to go back to that brand of ‘you’re-on-your-own’ economics.&amp;quot; ——美国人还是太穷了，我们就afford起。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我意外养成了早睡早起的习惯：23点睡到5点和2点睡到8点的不同在于，每天要早三个小时面对YHOO惨淡的股价。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;某VP的棋下的越来越大，我快要扛不住了——不如你来中国我教你搓麻将吧？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Coroutine：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;coroutine和thread主要的区别在于，thread调度是抢占式的，而coroutine是协作式的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Fiber 就是一种 coroutine 的实现，而 coroutine 其实是一种常见的算法表达方式。只是 C 语言和其衍生的基于一个环境堆栈的语言并没有直接支持。所以才少为人知。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Fiber不存在真正的parallelism，仍然是单线程的，不能利用多核。因此对CPU-intensive的工作没有直接帮助。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;因为是协作式的，Fiber可以减轻critical section加锁的顾虑。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;subroutine其实可以看做没有yield的coroutine。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;coroutine可以解决JavaScript里callback层次过深，逻辑结构凌乱的问题（这篇文章称之为callback pyramid of doom ），以前我在博客里提到过这个问题，以后有机会再讨论一下。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Python中的Coroutine：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;python有一个关键字yield，过去基本用于生成generator。在2.5版本之后，yield可以被用作expression，来生成coroutine。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;generator和coroutine看上去比较像，但却是相差比较大的两个概念。前者“产生”数据，后者多用于“消费”数据。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;coroutine的用途多在于data processing，filter，event handling，multi-task等等。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;这里有一份非常精彩的关于coroutine的slides（dabeaz的教程），作者也很幽默。关键的部分讲的非常到位而且深入浅出，尤其是用yield在构建python上的OS，让人印象深刻。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;dabeaz总结使用yield的三种范式：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 产生数据，即generator&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 消耗数据，coroutine的多数用法&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 类似操作系统中的trap。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（47）</title>
   <link href="http://blog.tomsheep.net/2012/05/21/note-47"/>
   <updated>2012-05-21T23:03:54+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/21/note-47</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;Xin：（哼唱）我们是共产主义接班人……&lt;/p&gt;

&lt;p&gt;Kang：你是哪门子接班人，你明明就是接盘人……&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我一直纳闷英文中“干爹”是怎么表达的，结果Google告诉我的是：Godfather——这是对影迷赤裸裸的挑衅。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;而英文中“cry uncle”这个俗语也让我十分困惑，为什么不是cry mummy，cry daddy或者cry godfather?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;buckets.js 是一个JavaScript实现的基本数据结构库，我认为阅读价值远大于使用价值。源码加注释2k行，包括了array，dictionary，set，multi-dictionary，heap，queue，BSTree等数据结构。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;读代码时，1000行里能读到一句有所收获的就很不易。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  buckets.arrays.copy = function(array) { 
      return array.concat(); 
  };
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Python社区一直强调要把代码写得Pythonic，但JavaScript好像就没有JavaScriptic一说。我觉得是设计思路就不一样，JS非常开放，无论语法还是build-in的工具都非常简单灵活，限制极少，拿来改头换面一下就几乎包装成了另外一门语言。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;buckets.js为了兼容性，实现中几乎没有用到ES5的新特性。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（46）</title>
   <link href="http://blog.tomsheep.net/2012/05/21/notes"/>
   <updated>2012-05-21T07:39:52+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/21/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;新中关的教室里，我的左手边的同学，一个是林大的学生，另一个是完美时空的美工；前排的姑娘手边书的封面上若隐若现地露出“复变函数”四个大字，让人为之一凛；而不远处捧着笔记本的妹子，眼前的界面不是Visual Studio又是什么。 ——我的观察力越来越好的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;葛志福的蛋有时候扯得比较离谱，戏剧性过强而信服力不足，不如老罗扯出来的圆润。夹带私货的功底也不够，略嫌生硬。个中差别就如同年轻一代的武侠小说家与金庸之间的差距一样。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;到现在还有人认为JavaScript不是“严肃”的编程语言。唉，现今找优越感的成本实在太低了——说着说着我都快有优越感了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;用Kindle读书的一大弊病是整理笔记的成本过高，或许触屏的、而且与PC交互更方便的iPad会好点，但整体阅读体验又不如Kindle，续航力不好，还怪沉的。市场上需要一个综合两者优点的产品。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;阅读理解：根据上文的内容，下列哪个选项最贴切作者想表达的意思：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;iPad比Kindle沉，但是比后者好用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;iPad是渣，Kindle最好用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;小米手机比他们两个都好用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;作者今天不想整理笔记。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（45）</title>
   <link href="http://blog.tomsheep.net/2012/05/20/notes"/>
   <updated>2012-05-20T07:21:35+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/20/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;下次在书店要是再有人不声不响地溜到我背后，鬼魅一样地来一句&quot;先生，对圣经感兴趣么？&quot; 为了配合这个语境，我一定得把“我去”换成“Jesus”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;现在的传教团队真是越来越不注重用户体验了——想当年在fdu的时候，我遇到的传教士可都是一票面目姣好声音悦耳的师姐师妹啊。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Irving Howe认为所有左翼集权社会都会经历三个阶段&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;乌托邦，令人心醉神迷的天堂理想，它诱发了狂热，而狂热则导致了&lt;/li&gt;
&lt;li&gt;大规模的恐怖和人间地狱，然后，狂热与恐怖被耗尽，于是:&lt;/li&gt;
&lt;li&gt;人们变得玩世不恭，“看透一切”，政治冷感，即犬儒主义&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;今天课堂上罗永浩扯了无数的蛋，但回来后我几乎一个都不记得了——我觉得这才是扯蛋的最高境界。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;罗在分析&quot;Few of us take the pains to study our cherished convictions; indeed, we almost have natural repugnance to doing so.&quot; 时对“cherished convictions”做了一番讨论，举例如被灌输的“没有什么，就没有什么”“只有什么，才能救什么”，以及对“乱伦”的天然反感。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《赛德克巴莱》：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;这是一部很奇特的电影，表达内容之多，视角之复杂足以让持不同价值观的人读出完全不同甚至相反的主题。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;种族仇恨、自由、原始的英雄主义、人与自然、社会伦理与道德……这些都是影片所表达并且反思的内容。我如果非让我总结，那我只能说，这是一部反战片。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我不喜欢最后3分钟的内容。我认为在溪水里两个赛德克部落青年生死相博最终一个砍下另一个的头颅，溪水浸染，镜头一黑，影片就应该结束了。因为到此导演所要表达的主题都已经表达清楚了，而最后几分钟的内容则是导演对自己影片进行了一次狭隘——至少我认为是狭隘——的解读。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我很推荐这部电影，btw，你们谁能提供一种有效地记住这个坑爹名字的方法？&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（44）</title>
   <link href="http://blog.tomsheep.net/2012/05/19/notes"/>
   <updated>2012-05-19T07:10:37+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/19/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;项目很可能被取消——这竟然是我这个月听到的最令人振奋的消息。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;V8没有像其它JS Engine使用词典结构或红黑树实现的map来管理属性，而是在每个对象附加一个指针，指向hidden class（如果第一次创建该类型对象，则新建hidden class）；当对象每添加一个属性时，将新建一个class（记录了每个属性的位移/位置），而原来的class指向新class，即建立起一个hidden class的转换链表。——不使用关联容器来储存属性，而是采用更接近于静态编译的类的形式，将对象中每个属性的相对偏移量记下来，在生成机器码时直接把偏移量写到指令中。这样，访问某个对象的某个属性就只需要很少量的指令就能完成，比起关联容器的方式高效许多。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我起初以为JS这样动态语言属性大概是hashmap来管理的，仔细想这样对内存浪费比较大，而且在属性量不是非常大的情况下，基于hashing未必比基于比较的计算来的快。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;STL中的map内部实现为红黑树，因此查找操作时间复杂度为O(logN)而非O(1)。有些STL实现中有&lt;code&gt;hash_map&lt;/code&gt;数据结构，但仍非标准。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《复仇者联盟》：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;我极度缺乏对美国超级英雄体系的背景知识，一些点根本无法得到。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我终于知道小时候非常喜欢的一款红白机游戏主人公原来是“美国队长”了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;把这么多超级英雄揉在一起，还能把人物特点都刻画清楚了，还是比较用心的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;还有15分钟的时候电影院竟然停电了，导致我不知道钢铁侠把核弹扔到外太空后的剧情……但没有关系，用脚后跟都能想出来后面到底发生了什么。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（43）</title>
   <link href="http://blog.tomsheep.net/2012/05/17/notes"/>
   <updated>2012-05-17T22:42:07+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/17/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;“自己找吧。”卖煎饼的大叔淡淡地说，一丝余光也不屑施舍。身旁的众屌丝只觉得一股难以抵挡的从容与霸气扑面而来。——一句话影响人生观。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;地铁上听到两个“网络审帖员”的对话，高手在民间：&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;A：你是网站里做什么的？&lt;/p&gt;

&lt;p&gt;B：……就是只有中国才有的那个……做“字段”的……&lt;/p&gt;

&lt;p&gt;A：哦，明白了，我以前也做这个的，怪累的，还老挨骂，后来不做了。&lt;/p&gt;

&lt;p&gt;B：……恩……不过时间一长你就摸出门道了，比如到了六月份，有些字段就要加进来，到了七月份，上一批就没事了，又换另一些字段……&lt;/p&gt;

&lt;p&gt;A：没错，诶，XX大要延期是吧？&lt;/p&gt;

&lt;p&gt;B：不清楚，其实啥XX大啊，人大啊，都不重要，每届权利分配的场所是北X河会议，绝对的寡头会议，大佬们坐地分赃，划好地盘，完事然后才开XX大……&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pragma: no-cache 其实是request头。有多少人会用错？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;对于分布式系统，Consistency、Availability和Partition tolerance选其二。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MapReduce通过把对数据集的大规模操作分发给网络上的每个节点实现可靠性（Map）；每个节点会周期性地把完成的工作和状态的更新报告回来（Reduce）。大多数分布式运算可以抽象为MapReduce操作。Map是把输入Input分解成中间的Key/Value对，Reduce把Key/Value合成最终输出Output。这两个函数由程序员提供给系统，下层设施把Map和Reduce操作分布在集群上运行。典型用例有：log数据统计、搜索引擎indexing、数据挖掘等。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;解决高访问量、海量数据规模时，去状态化使请求可以分配到任意服务器单元，去中心化可避免单点瓶颈。尽量使系统可线性拓展。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;各种Cache的使用原则是，让数据离CPU最近，避免磁盘IO。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我不明白为什么大公司都喜欢费很大的劲、定很高的标准来招人，却不懂得把他们安排在合适的位置做合适的事情，反而习惯用屎一样的工作内容让这些年轻人荒废青春。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（42）</title>
   <link href="http://blog.tomsheep.net/2012/05/16/notes"/>
   <updated>2012-05-16T23:16:11+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/16/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;靠，说好的报警呢？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我告诉你们，我是身经白战的，哪个被搞掉的CEO我没见过？你们也知道雅虎的云博士陈豪，比你们不知高到哪里去了，我跟他谈笑风生！&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我后来不怎么用qq，因为每次登录都要纠结到底是在线好还是隐身好。用gtalk就完全没有这个顾虑——这真是个人性化的设计。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;自从发现自己越来越像笑话之后，我就再也讲不出笑话来了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有多少人觉得上一条影射了罗素悖论？……好，把手放下来，你们离精神病不远了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;物理主义（physicalism）认为思想心理活动来源于神经的物理活动；二元论（dualism）认为意识离开物质而独立存在，强调物质和精神是同等公平地存在的。认为世界的本原是意识和物质两个实体。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Philosophy 176 of Yale 第二集：
Shelly Kagan在此节主要引出三个问题：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;灵魂是否存在？&lt;/li&gt;
&lt;li&gt;If so, can we &amp;quot;survive&amp;quot; our deaths?&lt;/li&gt;
&lt;li&gt;如果可以survive，那么可以survive多久？&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  以及引申出的“灵魂是否可以通过一系列物理过程被毁灭”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;对了是谁推荐我看这么蛋疼的课程来着？&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（41）</title>
   <link href="http://blog.tomsheep.net/2012/05/14/notes"/>
   <updated>2012-05-14T23:20:40+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/14/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;“你们公司炒了多少CEO了？”——这是今天我听到最让人伤感的问题。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;就在大凡绘声绘色地向我描述上次ycheng是怎么载他回家然后把他抛弃在芍药居的经历时，我们俩2B地从五道口
反方向
坐到了西直门。——为了在地铁上抢个座容易么？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;表姐和表姐夫为了“朋友家的客厅窗户是朝西还是朝南”争辩了整整半个小时，更让我无法理解的是他们后来僵持不下居然打电话去求证了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我相当喜欢iTunes U：苹果在教育领域向公众提供如此多的精致的免费内容，善莫大焉。我顿时觉得美国企业真是有追求——当然也是只是有些美国企业。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;突然发现现在自己对很多事情都看得很淡，觉得生活中发生什么都是可以接受的——这让我很意外，我大概是老了。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（40）</title>
   <link href="http://blog.tomsheep.net/2012/05/13/notes-40"/>
   <updated>2012-05-13T23:13:26+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/13/notes-40</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;帝都丐帮与时俱进的素养令人肃然起敬：今天主推的业务是“母亲节”系列套餐。——我已经迫不及待要迎接他们“复活节”的真人秀了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我5岁的表外甥整日为所欲为，稍不顺意立马鬼哭神嚎——我当年也是这样，但一想到哥今天居然能自我修正到如此理性的地步，我就不由得自恋起来。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;葛志福说，common sense，就是那些你使用起来丝毫不会有优越感的知识。——从新浪微博的情况来看，显然不是这样的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;JavaScript拾遗：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;在MDN中关于ES5的array新增函数如filter、map、every等的shim实现中，经常看到&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  var len = this.length &amp;gt;&amp;gt;&amp;gt; 0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  这样的用法，无符号右移符的作用是&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 将所有非数值转换为0。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 所有非负数取整。这里主要是第一种功用。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;Array.prototype.sort&lt;/code&gt;默认是字典序，即便对于数字数组而言。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（39）</title>
   <link href="http://blog.tomsheep.net/2012/05/13/notes"/>
   <updated>2012-05-13T00:33:31+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/13/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;我告诉理发店的小哥要理个光头，然后他问我在这里有没有比较熟悉的师傅。——现在法源寺的业务面已经铺的这么广了？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;葛志福推荐了一些书，Asking the Right Questions 和 Common Sense (by Thomas Paine)我比较感兴趣。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;葛认为所谓“联想记忆”会破坏词语本身承载的文化，而且是一种低效杂乱无规律的记忆方式。这个我比较认同。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;葛对阅读选材的建议是：短、有趣、有多媒体辅助更佳。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;今天比较意外的是见到了活的罗永浩。感觉他在课堂上比在公众媒体面前对中国社会的未来要更悲观一些。可能和受众不同也有一定关系。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我突然觉得拥有一个小型企业真是一件让人
愉悦
的事情，在这里才能深切感受到“志同道合”是多么美妙。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;新中关大厦以及海淀黄庄站的建筑设计师们让我几乎抓狂，一天被迷宫折磨的疲惫不堪。下午刚睡醒在IM上发生一次让我更加意外的会话，整个一天我觉得都生活中戏剧中。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我发现近一年多自己对生活中的一些问题的看法更加敞亮了。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&amp;nbsp;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（38）</title>
   <link href="http://blog.tomsheep.net/2012/05/11/notes"/>
   <updated>2012-05-11T22:19:54+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/11/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;黄岩岛风雷有变，吕宋岂是罗宋；赤发鬼云雨无常，刘唐怎及冯唐。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《北京日报》最近频频发表奇文，大有舍身为《环球时报》吸引火力的架势。——你们哪里懂得梅宁华对胡锡进那深沉的爱。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;久违了的地铁卖唱小哥，竟像是一位故人。——让人遗憾的他仍旧只会唱三首歌。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;于我而言，宁可冒险让事情打架，也不能为了避免冲突而闲着。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;NodeJS目前仍然不能很好的处理stdio，这让希望用JS做Code Jam的人十分遗憾。理论上目前可以通过以下方法读取标准输入流：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; var rl = require(&#39;readline&#39;); 
 var i = rl.createInterface(process.stdin, process.stdout, null); 
 i.on(&#39;line&#39;, function (line) { 
  // do something with line 
 }); 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt; 这种方式在重定向输入流时存在bug（&lt;a href=&quot;http://groups.google.com/group/nodejs/browse_thread/thread/9a6b9214722e526f/f97ab94445f3bf3e?lnk=raot&quot;&gt;点我&lt;/a&gt;），最新的发行版仍然不可用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;继续JavaScript语言拾遗。这些细节看上去琐碎，但把时间花在其上是值得的，是提高生产效率的有效准备：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;GMT（格林尼治平时）和UTC（协调世界时）的区别在于前者是一个天文上的概念，而后者是基于一个原子钟。在编程中二者差别很小，JS中GMT接口已被标为deprecated。而UTC和local time的API各成一套。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ES5的Date支持ISO8601格式时间(YYYY-MM-DDThh:mm:ssZ)，有toISOString方法。同样Date构造器也支持反向转换。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Date.UTC方法和Date构造器可以接受同样的一组参数（year, month, date, h, m, s），区别在于：1）前者构造的是UTC时，后者是localtime 2）前者返回是一个数字(距1970-01-01T00:00Z的毫秒数)，后者当然是Date对象。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Math的三角函数接受参数均为radians。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（37）</title>
   <link href="http://blog.tomsheep.net/2012/05/10/notes"/>
   <updated>2012-05-10T23:12:33+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/10/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;第三十七回：牛刀小试少将作法崇文殿，兽性大发老外施暴宣武门。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;刘鹏说雅虎倒霉就倒在“作为一只虎，总部却设在了阳谷县（Sunnyvale）”——华人创业者由此应该得到警示，一定不能学Google把总部放在景山（Mountain View）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最近几个月体重涨势喜人，按照这个趋势，很快我的大学同学们就该认不出我了。不过让人略感欣慰的是，我的中小学同学们一定会感到无比亲切。——2012引领时尚复古潮流。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;前天看了我的笔记后我的同事问为什么Underscore的类型判断用全局的toString而不用typeof? 今天重新补充了一下JS基础知识：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;首先，JS中primitive literal（字符串、数字、布尔值）和对象类型是不同的，而这些primitive又都有对象wrapper（String, Number, Boolean），比如字符串字面量&quot;tomsheep&quot;和new String(&quot;tomsheep&quot;)是不同的，前者typeof为string，后者为object。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;但你仍然可以在前者的字面量上调用本应属于后者的String对象方法，是因为JS引擎在这时先创建一个String wrapper对象，在wrapper上调用方法，调完后把这个wrapper扔掉。这样这两种值在使用时差别不大，都可以认为是“字符串”。所以在我们判断一个变量储存的是否为一个字符串时，无论是字面量字符串还是String对象，我们都希望返回true。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;这样单单使用typeof(obj) === &quot;string&quot;只能判断出字面量字符串，而不能判断出String对象。我们知道JS所有对象都有valueOf方法，这个方法对于wrapper对象来说会返回对应的primitive值，对于其他对象（primitive或非wrapper对象）则返回自身。所以，我们可以用valueOf来达到目的：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  (obj != null) &amp;amp;&amp;amp; typeof(obj.valueOf()) === &quot;string&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  这样显然不如&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  toString.call(obj) === &quot;[object string]&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  来的更简洁。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;JS的RegExp.prototype.exec和String.prototype.match关系：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;当正则表达式没有g标识时，二者效果是一样的，即返回第一个匹配（只含一个元素的数组）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当有g标识时，前者用于循环找出所有匹配，搜索完毕时返回null。后者一次性返回所有匹配&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于MVC、MVP以及MVVM，这篇文章（&lt;a href=&quot;http://russelleast.wordpress.com/2008/08/09/overview-of-the-modelview-viewmodel-mvvm-pattern-and-data-binding/&quot;&gt;点我&lt;/a&gt;）的观点是：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;MVC：View在顶层，controller在其下，model在controller之下。在model更新时，view受到通知。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MVP：Presenter和View在同一层，Presenter同时监听View和Model的事件，并转发其间的交互。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MVVM：ViewModel在UI层之下，把View层需要的一些数据和方法暴露出来。而ViewModel本身从其下层的Model拉数据。典型的例子是WPF。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（36）</title>
   <link href="http://blog.tomsheep.net/2012/05/09/notes"/>
   <updated>2012-05-09T23:03:33+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/09/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;虽然Let&#39;s go和Let go看上去像是孪生兄弟，但从语境和语义上来看，简直就是高帅富和屌丝的区别。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;舟子十分欢喜，拿出海藏看时，原来两头是两个金箍，中间乃一段乌铁；紧挨箍有镌成的一行字，唤做“如意桌球棒”，高一百四十七厘米。心中暗喜道：“想必这宝贝如人意！”一边走，一边心思口念，手颠着道：“再短细些更妙！”——《瓜洲渡韩林儿显圣，水晶宫方舟子封神》&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;JavaScript获取Unix timestamp：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; Math.round((new Date()).getTime() / 1000);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于土地使用权期满之后如何处理： 1）1990年颁布的《城镇国有土地使用权，出让、转让暂行条例》中规定，国有土地使用权到期以后，土地使用权和土地上的建筑物、附属物，无偿由国家收回，这种无条件无偿收回制，对房屋所有权采取完全剥夺的办法。2）1994年的《城市房地产管理法》中，改为到期前可以提出申请，申请以后如果是因为公共利益需要，那么政府就收回，如果没有公共利益的需要，就可以批准续期，批准续期以后再签订新的土地出让合同。并且如果政府要收回，对土地上的建筑物要给予补偿，即“申请续期收回补偿”制。3）而2007年《物权法》出台，规定“住宅建设用地使用权期间届满的，自动续期”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于客户端Web App的架构，有这么两张图可以有一纵览：&lt;a href=&quot;http://addyosmani.com/resources/toolschart/chart.pdf&quot;&gt;JQuery apps architecture&lt;/a&gt; 和 &lt;a href=&quot;http://zetafleet.com/i/4d75a4efc33d4.png&quot;&gt;Dojo apps architecture&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于JS namespacing方案，&lt;a href=&quot;http://michaux.ca/articles/javascript-namespacing&quot;&gt;这篇文章&lt;/a&gt;很有见地：作者对比了prefix namespacing, single object namespacing(最为流行)和nested object namespacing(YUI就是), 其中第二种被多种类库广泛使用，作者认为第三种基本上是over engineering.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MDN中有一段对Function.prototype.bind的shim实现：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; Function.prototype.bind = function(obj) {
     var slice = [].slice, 
         args = slice.call(arguments, 1), 
         self = this, 
         nop = function() {}, 
         bound = function() { 
             console.log(this instanceof nop); 
             return self.apply(this instanceof nop ? this : (obj || {}), 
             args.concat( slice.call(arguments) ) ); 
         }; 
     nop.prototype = self.prototype; 
     bound.prototype = new nop(); 
     return bound; 
 };
&lt;/code&gt;&lt;/pre&gt;

 这段代码的要点有三：

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;this instanceof nop所在语句为何意？是为了应对这种情况：一个函数bind了context之后（即返回的是bound）被当做constructor使用（new操作符），这个时候，不应该使用被绑定的context作为this，this仍将是“正在被创建的对象”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最后几行的效果在于，将nop插入到原函数和bound的继承链（prototype链）之间，即bound继承自nop继承自原函数。为什么要加一个nop，而不是直接让bound.prototype = self.prototype呢？stackoverflow上有人说是为了让bound有自己的prototype属性。当然也不能让bound.prototype = new self，因为这样会直接运行原函数，显然不是bind的目的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;这个实现也可以保证“一个函数只能被bind一次，后继的bind无效”的语义。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（35）</title>
   <link href="http://blog.tomsheep.net/2012/05/08/notes"/>
   <updated>2012-05-08T22:54:27+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/08/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;第三十五回：寻旧爱孟昕魂断幽州城，结新欢朱颢机关峨眉山——古典文学名著《搅基山伯爵》&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;-Zhu： 菜昕，我上个月欠你20块钱。&lt;/p&gt;

&lt;p&gt;-Xin：哎呀，我都忘了，Cool~&lt;/p&gt;

&lt;p&gt;-Zhu：我没打算还你，就是让你知道一下。&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;上次见到的代码注释文档是由docco.coffee生成的。Underscore.js的文档也用它生成。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Webkit trunk近日加了Web Intents实现, 类似Android的Intents概念。对Web应用间的交互方式是一种全新的尝试，解放了生产力。Web Intents详细介绍可以参考&lt;a href=&quot;http://paul.kinlan.me/web-intents-a-fresh-look/&quot;&gt;这篇文章&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Underscore是一个相当好用的JS工具库，实现代码不到一千行，目的在于补充JS语言中缺失的内置工具。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;官方文档里有一句对Underscore的介绍很有趣：It&#39;s the tie to go along with jQuery&#39;s tux, and Backbone.js&#39;s suspenders.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;包含了大量Collection相关的函数，使JS的函数式语言范式更易于使用。如forEach,map, reduce, reduceRight, filter, every, some等等（其中有一些在ES5里有native实现）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;用void 0来代替undefined, 我想了半天除了少打几个字符外实在找不出别的原因。你这下知道程序员们有多懒了吧。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Primitives and their corresponding object wrappers are equivalent.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Underscore中的类型判断方法：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; 判断a是否为NaN: a!==a&lt;/li&gt;
&lt;li&gt; 判断obj是否为object对象：obj === Object(obj)&lt;/li&gt;
&lt;li&gt; 判断是否为String, Function, Array, Number, Date, RegExp, Arguments等，都使用toString来判断其字符串表达形式是否为[object XXX].&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（34）</title>
   <link href="http://blog.tomsheep.net/2012/05/07/notes"/>
   <updated>2012-05-07T22:42:57+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/07/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;如果连续48小时我都没有更新笔记，你们一定要记得报警。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;熊培云特别喜欢说“不能只看到时代在交媾，而没看到时代在孕育”——为什么每次看到这句话我第一时间想到的总是……第八套广播体操。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;今天接到一个猎头的电话，上来第一句就是“你是做什么的工程师？”我纠结了好一会，说“我也不清楚……”为此我伤感了一下午——我还真不是很清楚我是什么品种的工程师。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Pantry里的foosball比赛就是现实版的《罗生门》：从这几个2B青年赛后的表情和言论来看，观众根本不知道到底是谁赢了。——国际政治似乎也是这样的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;昨晚失眠了半宿，感慨生命的脆弱。今天整日头昏脑胀，体验生命的脆弱。一天无甚进展。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;经常记混JavaScript/Python/Java/PHP的内置函数与属性名，JS对象无内置clone：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; Object.prototype.clone = function() { 
     var newObj = (this instanceof Array) ? [] : {};

         for (var i in this) {
             if (i == &#39;clone&#39;) continue;
             if (this[i] &amp;amp;&amp;amp; typeof this[i] == &amp;amp;quot;object&amp;amp;quot;) {
                 newObj[i] = this[i].clone();
             } else {
             newObj[i] = this[i];
         }
     } 
     return newObj;
 }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt; 也可以使用JQuery的extend:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; // Shallow copy
 var newObject = jQuery.extend({}, oldObject);
 // Deep copy
 var newObject = jQuery.extend(true, {}, oldObject);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（33）</title>
   <link href="http://blog.tomsheep.net/2012/05/06/notes-33"/>
   <updated>2012-05-06T23:53:23+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/06/notes-33</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;一个半小时前就在我整理笔记的时候，菜昕突然说菜猪失踪了。我们俩折腾了一晚上，跟踪他的5月3号就断线的微博，然后把HR和他家人朋友都骚扰了一遍，就差报警了。就快崩溃的时候，这小子大摇大摆回来了。我觉得此时的心情可以用菜猪最经典的台词来形容：日后再说。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;微博中的市场经济：这段时间每天都有大量僵尸粉follow我，有8块一千粉的，6块一千粉的，还有4块一千粉的——我是不是不应该直接拉黑，而是介绍他们互相认识一下？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有哥们说跟不上我跳跃的思维。没关系，我也跟不上。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;这次回家后有个想法，如果若干年后，我已经不用再担心自己的生计，而又没有足够的能力实现宏伟的办学理想，可以回到这个县城来讲学普法。当然，我更希望看的的情况是，那时他们根本不再需要我了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《重新发现社会》（自由与民主、开放的传统）：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;宪政面对的是人性悲观的一面、恶的一面，目的就是通过制度建设约束人类。而民主所面对的则是人性乐观的一面、善的一面，相信通过民主参与人类将有美好的未来。民主强调着眼未来，关系到变化与进步，具有动态的视角；而宪政限制公权，保障民权，为民主设立底线，防止多数人的暴政。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;作者认为，我国基层（村一级）经常出现贿选，“民主不值600元”，究其根本原因不是农民贪占小便宜，而是这个社会没有让选民看到600元以上的民主的好处。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;几百年来，人类文明中最具代表性的权利制衡方式：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 洛克和孟德斯鸠为代表的“以权力制衡权力”，后者提出三权分立。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 以贡当斯为代表的“以权利制衡权力”，提出五权分立（世袭制议院、选举制议院、中立的王权、行政权、司法权）。贡当斯认为卢梭的契约论错误在于个人将所有权利让渡给国家。一旦主权不受限制，个人在政府面前无处可逃。因此提出公民拥有独立于任何政治权力之外的个人权利，包括个人自由、宗教自由和言论自由。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 以托克维尔为代表的“以社会制约权力”。托克维尔同样认为仅仅三权分立不足以保证民主自由，独立的、自由的社团组成的多元社会，可以对权力构成一种社会的制衡。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;从孟德斯鸠到贡当斯再到托克维尔，他们的主张中暗含了两种三权分立：一种是孟德斯鸠的国家权力内部的三权分立，另一种则是国家权力对于个人权利（贡当斯）和社会权利（托克维尔）之间的权界分立。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;明恩傅在《中国人的素质》中说，“中国政治家的生活和国事文件，好像卢梭的忏悔一样，充满着最崇高的情感和最卑劣的行为。他杀了一万个人，然后引用孟子的一段话，讲人的生命是神圣的。他把修河堤的钱装进自己的腰包，结果全省惨遭洪水之害，然后他悲叹耕者失其田”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;传统只有不断被改造、被发明，更以人为本，做历史的加法，才有其价值。 胡适的主张中和理性，提出“研究问题、输入学理、整理国故、再造文明”，提倡精神独立与思想宽容，主张以评判的态度重估一切价值，寻找传统文化与西方文明的结合点。而非全盘推翻。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;重新发现社会的价值在于重新发现个体在历史创造中的价值，在于尊重个人思想与人生价值。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于民族主义，中国人广泛认同的是一种文化民族主义，而非有进攻性的政治民族主义。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（32）</title>
   <link href="http://blog.tomsheep.net/2012/05/06/notes"/>
   <updated>2012-05-06T08:59:56+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/06/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;“11号下人来了没？”——你大爷的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一想到马上就要回到那个风景如抽象画的伟大首都，我就兴奋地不能自已。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我发现我对喜欢读书的女性有特别的偏爱——对面的姑娘上车后一直在读书，举止优雅。不知道一生中会和多少这样的人擦肩而过。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我原以为大学对于我这样四年一直耗在图书馆与实验室的工科宅男来说，无非是一个获取知识与拓广人脉的生活驿站。而这次从帝都回到这个县城，再到再次离开，短短数天，却发现原来“自由而不为所用”的思想早就嵌进了我的价值观。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《重新发现社会》（物权与税权）：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;作者认为民法典的核心应以权利为主导，而非国家防控民事活动。如果物权不能高于并独立于政权存在，物权就会因为政权的倒塌而受到伤害，契约随时可能焚毁，推倒重来。——我想这也是中国人普遍焦虑的深层原因。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;所谓宪政，就是让政治服从于法律，法律服务于生活。而非正好相反。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;作者指出在中国，财产性收入很难征税，而这恰恰是富人主要的收入来源。导致税收不仅没有起到平衡财富的作用，反而有劫贫济富的效果。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;纳税人通过选出自己的代表，按照立法程序制定各项税收法律，除此之外的一切征收行为都是无效和非法的。如果政府“天生”就有权自定税收章程，就等于承认政府对纳税人的财产拥有支配权。作者指出目前中国的多数税收立法是违宪的，也是违反《立法法》的，比如税收行政法规没有明确的授权。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“无理由不纳税”有两层含义：1）纳税不应有豁免权。中国具有奇特的现象，即权贵阶级、上流社会免税，这一观点甚至得到了广泛的认同。这是对税收认识的严重偏差。随着越来越多的人挤入上层，出现更多的免税者，而庞大的国家机器需要更多的财政收入，越来越多的税收负担便落到第三等级肩上。2）无理由，不纳税。即上一条所说的内容&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;从当今无数的青年挤破头想进入公务员系统，可知政府部门有着何种诱人的待遇。——我的判断是，公务员在可见的未来并不是一个让人艳羡的职业。无论未来的社会是发生渐进改革还是暴力革命，只要前进的方向是健康的、人性的、尊重公民价值的，官僚阶层生活会让挤破头的年轻人大失所望。如果情况没这么乐观呢？那在一个公民无基本产权的社会，无论是哪个阶层，在朝在野，都是牺牲品。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;为什么有这么多人趋之若鹜？我认为，因为庸才只相信多数庸才的判断，从不相信常识。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;土地权是最基本的产权，也是人权的基础。讽刺的是，某党当年因土地私有化改革而发家，却在赢得政权后利用公有化运动对农民的土地进行了再次掠夺。而90年代出台的《城镇国有土地使用权出让和转让暂行条例》，让全体城镇居民的住宅都变成了所谓“小产权”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;作者持支持“土地私有化”的观点，针对反对者的主要两种论调&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; 土地是农民生活的保障，不能私有&lt;/li&gt;
&lt;li&gt; 农民一旦有了所有权就会发生土地兼并，产生两极分化&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;作者引用秦晖的话对这两点进行了批驳：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; 所谓土地保障不能私有化，本省讲的是“社会保障义务不能私有化”，主张把所有权给农民反而农民的保障少了的说法，无异于在说自耕农无保障，而佃农有保障。&lt;/li&gt;
&lt;li&gt; 第二种论调则和中国民主缓行论如出一辙，认为农民会滥用自己的土地，就如滥用选票一样。而事实上造成农民失地的主要原因是行政垄断部门的“权利市场化”。官权过剩，而民权衰落。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;（PS：2012-05-05记于T232 西安开往北京的列车上）&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（31）</title>
   <link href="http://blog.tomsheep.net/2012/05/04/notes"/>
   <updated>2012-05-04T23:28:11+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/04/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;很多网友都异常激动，跳着脚骂刘为民睁着眼说瞎话——就像他们中学里没见过政治老师似的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;原来公务员有15个level，我比较关心的是，band几可以转manager啊？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;你说要是公务员系统也有猎头的话，那是不是隔三差五就得收到这样的邮件：某知名有关部门司局级职位，要求10年以上工作经验，精通领导排位学，熟练掌握读稿技能，有县级行政部门一把手经验者优先考虑。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;这是这个假期在家的最后一天。这次回家有一些不同的思考，对不同阶层的人在这个社会中的生存法则更多了一些理解。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;郝杰的《光棍儿》是为数不多的把镜头对准食物链底层，把二元社会中的另一元不加修饰地展现出来的影片，我不做太多评论，这个导演我很看好。有兴趣的自己去看。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我决定带走我爸的税法书。我总可以知道他党是怎么玩我的吧。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（30）</title>
   <link href="http://blog.tomsheep.net/2012/05/03/notes"/>
   <updated>2012-05-03T20:58:27+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/03/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;你发现了没有，以前是有广场就有毛主席，现在是有广场就有凤凰传奇——我觉得这是个阴谋。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我敢打赌，那些丧心病狂的大妈们的最终目标一定是天（）安（）门。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我总觉得从小到大我都像个游客：在榆林时他们认为我是关中汉，回到关中他们认为我是陕北蛋；在咸阳时他们觉得我是泾阳来的，去上海不用说我自然是外地人；现在你也知道，我是一个北漂——为此我一直耿耿于怀。直到今天，我居然第一次发现县城的孔庙原来是个博物馆。然后我就觉得其实一点都不冤枉。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;熊培云《重新发现社会》第一章末至第二章（经济与社会）：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;在一个政治压到一切的社会里，统治者和被统治者都容易变为犬儒，没有理想、玩世不恭、冷嘲热讽，对现实不满却又远离政治与社会运动，带着一种自命清醒的虚无主义，从不与强权对抗。——看我干啥？哥才没有中枪呢，你们不懂哥。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;无社会主义的严重性甚于无政府中国历代中央政府为了统治国家，切断了其他所有社会纽带后，国家（政府）与社会高度一体化，社会生活高度政治化。
社会的弱不禁风常被强大的政权所掩盖。
以至于社会凡事都指望中央政府，社会层面的自救很难展开。转型期中国值得思考的是，如何建立起一种制度文化，使社会能够充分自治，从容面对政府危机，即便权力无主时，权利归属还在。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;转型国家政治改革的成败得失取决于如何将Leviathan关进笼子：政府如同Leviathan一样具有双面性格，由人组成，也由人来运作，具有了人性那种半人半兽的品质，在保护人的同时，又在吃人。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;为什么社会不公几近极限，中国社会仍然没有出现大幅崩溃？一个重要原因在于，家族作为一种“组织”部分化解了政府失灵或者市场失灵时所带来的种种弊病与危机。即中国式自救——这一点在西部感受尤其明显。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;作者引用黄仁宇对“关系文化”的分类与解读：生存关系问达尔文，性关系问弗洛伊德，经济关系问马克思。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;社会资本的本质也是“关系”，人们倾向于将其理解为公民之间互信互惠，合作成长的良性社会网络。社会资本虽已自治方式出现，但同时应具有开放性，否则可能异化为官商勾结的“关系”。但作者认为社会资本的真正短板在于，在一个社会中，有些人可以建立自己的社会资本，而另一些人却处于被禁止状态。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;中国的转型方向在于，国家（政府）向公民社会和市场的退让。国家有义务承认公民的个体价值优先于国家的价值，而公民能够遵照自己的权利而不是政治或权力设定的纽带来缔结自己的关系，或者说开拓社会资本，并在此基础之上是一个国家的社会资本达到最大值。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;改革的契机稍纵即逝。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（29）</title>
   <link href="http://blog.tomsheep.net/2012/05/02/note-29"/>
   <updated>2012-05-02T23:09:31+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/02/note-29</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;鉴于关中地区盗匪猖獗，我爸比较关心北京的治安情况。虽然没有数据支持，但我觉得应该会好很多——技艺再精湛的蟊贼，在公交地铁里也抽不出手来。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;同样，我认为广州飞车党在北京也没有生存土壤——即便侥幸得手，一骑绝尘扬长而去，出不了4环就给堵路上了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;三分逗，七分捧——这是有道理的，“捧哏”这个角色其实是个吐槽的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;别看我的同事菜猪长着一张2B的脸，却有着很多很文艺的爱好：喜欢摄影，喜欢一个人满世界到处旅游，还爱在火车上数星星。——我挺欣赏这种生活状态的。当然，如果他不要总发一些催人尿下的诗，我就更欣赏了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;微博真是个不错的媒体，我经常因为一段精彩的微博而去了解其作者，从而接触到他的其他作品。熊培云的《重新发现社会》就是这样: （第一章）&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;左右之争其实是上下之争：社会若无法自主自存，左右之分也无意义。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;人是时间单位，而非空间单位。“爱国”应该是通过物质和精神契约实现的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;每个人都是天生的自由思想者，但在其成长过程中，（出于趋利避害，）一个人随时可能失去自由思想的活力与动力。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;理论上说，降低劳动成本对抑制通胀有一定作用，但让农民无条件地为国家工业化负担巨额成本是毫无公正可言的。这也是城乡二元分治的肇始。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“民为贵，社稷次之，君为轻。”是“人权高于主权，主权高于政权”的理论表达。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（28）</title>
   <link href="http://blog.tomsheep.net/2012/05/02/notes"/>
   <updated>2012-05-02T08:34:53+08:00</updated>
   <id>http://blog.tomsheep.net/2012/05/02/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;希望马云早日收购Yahoo!——这样我就可以不用再解释我不是阿里巴巴员工了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我第一次觉得这个县城其实挺干净的。——北京在下一盘很大的棋。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;顺利地将iphone移交给我爸，但他的一个念头是要给它贴个膜并且加个壳儿。——哪里有什么癌症，乔布斯其实是被气死的对吧？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有人群的地方就有政治。不是我看不明白，是不想参与。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;感冒的时候面对一堆胶囊，这个场景怎么这么熟悉？我耳边似乎有一个声音在说：“大人，皇上让您有个了断。”&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;（PS：5-1下午突然感冒，一直躺倒今日清晨，在此补记。）&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（27）</title>
   <link href="http://blog.tomsheep.net/2012/04/30/notes-27"/>
   <updated>2012-04-30T22:19:38+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/30/notes-27</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;为什么女性普遍表现出比男性更多的耐心？我不相信这是造物主的设计或者自然选择的结果，而更倾向于认为这是一种“用进废退”原理的体现。但多年来一直困扰我的是，她们的这种技能到底是从哪里习得的——直到我看到火车站外公厕的排队情况为止。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;下午路上偶遇我的初中班主任，寒暄的时候她的表情很不自然——我觉得她的灵魂一定在忏悔，当初用“好好学习就能出人头地”骗了我好些年。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;从很久以前开始我就在尝试改变父母的生活方式，或者让他们了解并理解我的。效果一直很差：下午看到我妈在《杀生》扣人心弦的剧情下竟睡得如此安逸，我开始怀疑这个事情本身的意义与合理性：为什么要去改变他们所习以为常的生活？我想我自己也不会喜欢别人对我的生活指手画脚。价值观、生活方式、笑点不同，可以不相为谋，但也可以相安无事并且生活的很好，甚至出于不同的目的可以去做同一件事。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;他们看重物质，但却对生活品质要求很低，因为在这个社会中需要更多的安全感；我也看重物质，但我认为这是精神独立与生活自由的必要前提；他们更愿意将高质量的生活物化为一些可量化的形式，而非精神的愉悦；习惯遵循自己熟知的思维方式解释全新的、复杂的、“五千年未有之变局”的事情，而非接受新的视角——其实不必刻意改变这些，我可以满足这些。还是那句话，不同的人出于不同的目的可以去做同一件事，而且做得大家都开心。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《杀生》影评（剧透）：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;总体来说，我很满意。之所以把这个故事用这么奇技淫巧的方式讲出来，是因为这个故事本身不那么“炫”，子曰：“面不够，蒜来凑”，凑得非常有味道。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;剧中的马寡妇是个哑巴，她就应该是个哑巴。这一点把握的很好，和长寿镇的寓意配合的很到位。我想原著《设计死亡》中应该也是这样。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;快结尾的时候，可能是受到昨天宁浩的刺激，有好几处我都在默念，“OK，就在这里结束，perfect！”但管虎就是不结束，一段过后还要再玩一段。不过加的都不错，我很欣慰。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（26）</title>
   <link href="http://blog.tomsheep.net/2012/04/30/notes"/>
   <updated>2012-04-30T16:58:39+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/30/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;居然还有比我还不会聊天的：下铺的大叔一直在试图跟两个韩国九零后姑娘陶瓷，开始时是盛赞鬼斧神工的韩国整容术，后来频道转回CCTV，一再宣扬中韩两国的世代友谊，从明朝一直追溯到了成吉思汗，就差重申白头山的主权了。听得我惊心动魄，开始担忧全车人的生命安全。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;万幸这俩姑娘都是无脑型的，女子无才便是德啊——古之人诚不余欺。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;其实读书是一种挺低效的知识获取方式，但至今这仍然是我的主要学习手段。也许是资质所限，也许是未得其法，我还没有找到更适合我的高效学习途径。——这份笔记其实是个不错的尝试。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《黄金大劫案》影评（剧透）：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;太可惜了，就差一点，这部电影就可以成为一部绝对的佳作了。前80%的部分无论从讲故事的方式方法还有故事内涵来说都非常出色，台词很讲究，细节也挺到位，我一直觉得在国内导演中玩黑色幽默没有人能超得过宁浩。但这次《黄金》high出来了，最后却没能收的回来。故事到最后有点讲不下去的感觉，于是只能用更加荒诞的手法来庸俗化处理。我感到非常遗憾，与其这样，不如将最后10多分钟删去，小东北被枪毙，镜头给到那群卖军火的土匪，他们“变”成了下一波的革命党，故事就这样结束。断臂虽不完整，但好过续貂的狗尾。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我曾经感慨国内的导演都不会拍感情戏，宁浩也够呛。茜茜那个角色的若干场戏都很不协调，但没有她故事又讲不下去了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我还是相信宁浩是有实力的，这部戏的前大半部分更让我坚信这一点。但评判一部电影没有这么简单。我还是觉得可惜——最让人扼腕的往往不是在资格赛就被淘汰，而是一路高歌猛进结果决赛毫无征兆地遭遇滑铁卢。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果《黄金》打磨的更精致一些，我想是有机会比《让子弹飞》还要精彩的。——《让子弹飞》是一个简单的故事，更容易出彩。但宁浩不是一个习惯讲简单故事的人，他的故事一定要一波好些折。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;草船借箭什么最重要？不是箭，也不是计谋。是罗贯中。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;（PS： 2012-04-29记于T43北京开往西安的火车上）&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（25）</title>
   <link href="http://blog.tomsheep.net/2012/04/28/notes"/>
   <updated>2012-04-28T22:23:35+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/28/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;菜猪向大家科普：《下一站天后》中的“天后”其实是香港的一处地名。——作为大五道口地区偶像天团“北京热乐队”的主唱和主要负责人，我决定本乐队的首张单曲专辑就叫：《下一站上帝》。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我觉得有必要澄清一下，这个三俗的乐队名字的始作俑者仍然是菜猪。作为一个有品位有情调上档次的小清新，我坚持认为我们的风格应该向台湾的“苏打绿”靠拢，所以其实我一直觉得“咖喱红”或者“孜然黄”是更好的选择。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;-Kang：菜昕，我计划写一本小说，主人公是你。&lt;/p&gt;

&lt;p&gt;-Xin：真的？&lt;/p&gt;

&lt;p&gt;-Kang：没错。这样我就可以把你写死了。&lt;/p&gt;

&lt;p&gt;-Xin：……&lt;/p&gt;

&lt;p&gt;-Kang：我都构思好了，要倒叙的，开头就这样：“那是十多年前的一个夏日，聒噪的集市传出阵阵刺耳的叫卖声。熙熙攘攘的人群背后，菜昕孤独地蜷缩在墙角，略带不屑地瞥了一眼身前的小贩，舔了舔自己那……诶，对了，你喜欢沙皮的还是卷毛的？”&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《SEO实战密码》5——8章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;外链为王：外链在SEO中的作用极大，Google bomb是一种极端的情况，指大量的外部链接（特定关键字作为锚点文字）指向某URL，即便该URL和该关键字没有半点关系，仍然会导致该URL在该关键词下搜索排名极高。美国网友恶搞白宫的“miserable failure”即为此例。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;外链诱饵：指站长通过发布容易被外站转发、引用的内容，
自发形成外链。
比如热门话题啊，“XXX的10大理由啊”，资源搜集贴等等。文艺青年可能嗤之以鼻，但SEO效果很好。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;作者是否会想到，Yahoo!有一天会放弃自己的搜索，而Yahoo! Site Explorer这样好用的站长工具也不复存在了呢？（现已并入Bing的webmaster tools）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;不同类型的网站SEO的方向是不同的，比如，对于信息新闻类网站，主要靠流量赚取展示广告，追求PV，内容分页比较常见。而这样的SEO并不适用于电子商务网站，后者主要追求业务转化。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;常见的黑帽SEO有隐藏文字（让用户看不见但搜索引擎看得见）、隐藏链接（通常黑掉别人网站添加指向自己网站的外链，肉眼不易发现）、垃圾链接、买卖链接、有指向劣站的链接、隐藏页面（区别对待爬虫）、PR hijacking（先301到高PR的站使自己也有相同PR，之后取消跳转）、Doorway Page（充斥关键字的无意义网页，跳转到欲推广的网站）、关键词堆积等等。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（24）</title>
   <link href="http://blog.tomsheep.net/2012/04/27/notes"/>
   <updated>2012-04-27T22:27:49+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/27/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;中午吃饭的时候同事们讨论到在家做饭的话题，我表现的很低调。他们不知道其实我对烹饪也很有研究，精通各种烹饪技法，会做红烧的、麻辣的、三鲜的……当然最拿手的还得说是汪涵代言的老坛酸菜的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;燕赵之地多慷慨悲歌之士——都是来上访的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;昨天晚上发生一件让我感到十分难堪的事情，虽然无伤大雅，我还是反思了一个晚上，从学龄前反思到了大学毕业，顺便还review了一下最近几个月发生的变化。我一直在努力做一个优秀的人，讽刺的是有些最基本的东西却一直没有做到。这个桥段可能会出现在很多年后我写的小说里。——我怎么觉得氛围全让最后一句软广告给毁了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;让信任你的人看到你丑陋的一面，感觉就像在长安街上裸奔一样——而且是国庆节的长安街。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我觉得html标准应该加入“修改日期”这样的标签或属性，或者让搜索引擎完成类似的功能，对于一些网络中的技术doc尤其有用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Chromium中，资源访问、IO等操作都是由单一的Browser进程完成的。这样的好处主要有&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;便于Cookie和cache的管理&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;可以减少每host的连接数，更符合HTTP 1.1的精神。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Windows中提供的网络库：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;winsock和&lt;code&gt;ws2_32&lt;/code&gt;是传输层（TCP/UDP）的网络库，前者比较接近BSD socket，后者是更新的库，提供&lt;code&gt;WSA*&lt;/code&gt;系列API。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;WinInet和WinHTTP是应用层网络库，但是他们都不依赖上面提到的两种传输层库，有独立实现。WinInet和IE绑定较紧，必须和IE共享cache。WinHTTP是现在用的比较多的HTTP库（chrome早期版本也曾使用，后来换成了自己的实现）&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Chromium中的IPC：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Chromium中的进程类型主要有browser、render、plugin、utility等几种，通常说IPC主要关注browser和render之间的通信，他们之间也是最频繁的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Browser进程中有若干种线程，IPC相关的主要有UI线程和IO线程。IPC channel和ResourceMessageFilter生存在IO线程中，负责和render进程通信；而RenderProcessHost、RenderViewHost等组件（和render进程中的组件对应）生存在UI线程。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Render进程也可分作Main线程（处理IO）和render线程。RenderProcess生存在Main线程，可以对应render线程中的多个RenderView，webkit自然是跑在render线程的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;以render向browser发起一个请求为例，由RenderView发起Send操作，首先由render线程交给Main线程中的RequestHost，通过IPC通道交给browser进程的IO线程，这时Resource MessageFilter判断其是否是一个资源加载的request，如果是，那IO线程就处理，不需要转给UI线程。如果不是，那么会由IPC channel转发给UI线程中对应的RenderProcessHost::OnMessageReceived, 这是一个分发器，可以直接处理，也可以继续转给合适的RenderViewHost。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;从render到browser的flow基本上是反过来的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在Chromium最新的Content API中，实现embeder定制的IPC message要更简便一些，以Content Shell为例，使用&lt;code&gt;IPC_MESSAGE_ROUTED&lt;/code&gt;系列宏自定义IPC message，重写RenderViewHostObserver和RenderViewObserver中的分发器函数即可。前者的hook是在browser进程中的UI线程被调用，后者是在render的render线程中被调用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果想直接在browser IO线程就hook掉，需要使用IPC Channel系列的组件，还没有细看。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Chrome避免通过互斥锁的方式来实现对象的线程安全，而是让对象只在一个线程里访问，并通过消息在线程之间进行通讯。每个线程有Message loop，线程间通过post task方式通讯。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（23）</title>
   <link href="http://blog.tomsheep.net/2012/04/26/notes"/>
   <updated>2012-04-26T22:38:04+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/26/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;五道口附近有家卖枣糕的极受欢迎，排队盛况让人误以为苹果又出了新产品。同事说让他难以理解的是路对面就有另一家枣糕店。——考虑到当地的路况，他们可能觉得排队比过马路要更快一些。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;大宋朝文彦博，幼儿倒有灌穴浮球之智；司马温公，倒有破瓮救儿之谋；汉孔融，四岁让梨，懂得谦让之礼；十三郎五岁朝天；唐刘晏，七岁举翰林；金正恩，八岁开悍马，九岁能射移动靶，虽不及乃父手枪打飞机之勇，可也算得上小孩子中之魁首也。 ——依我看《八扇屏》得这么改。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“礼失求诸野”，野失求诸啥呢？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“潜意识”“下意识”“歇斯底里”“自我”等今天中文里已经习以为常的词语都来自弗洛伊德，诞生距今不过一百多年。有点意思&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;想到之前有人说：文言文是中国古代读书人的创举，让书面语言体系独立于日常口语，所以几千年前的古籍，再过几千年也有人读得懂；而几十年前的口语，再过几十年就未必有人听得明白了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《SEO实战密码》1——4章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;纠正了我一些错误的概念，meta keywords其实对SEO是无用的，不会对权重造成影响。description也是，但可以在搜索结果中起到对用户友好的作用，提高点击率。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;404就应该返回404，用200是不对的，301重定向到首页对SEO也有害，也不宜使用10秒以内的meta fresh跳转。合理的做法是定制相应的404页面并用404头返回。&lt;a href=&quot;http://blog.tomsheep.net&quot;&gt;我的博客&lt;/a&gt;当时为了偷懒，not found直接重定向回了首页。这样会使搜索引擎误认为不存在的URL和主页有同样的内容，重复内容会让权重降低。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;用JS、flash处理链接是对SEO不友好的，有时这种用法是故意的，比如about页面、contact us页面、login页面等等对SEO价值不大，但却通常频繁出现在首页和其他内链中，用JS、flash、或者nofollow来取消权重传递。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;canonical 标签可以有效减少因url参数引起的重复。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;meteor里瞄到一句shell，用来完成“拷贝目录，除ABC外”：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; tar -c --exclude ABC &quot;$1&quot; | tar -x -C &quot;$2&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（22）</title>
   <link href="http://blog.tomsheep.net/2012/04/25/notes"/>
   <updated>2012-04-25T21:54:27+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/25/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;IE上个月的市场份额回升了一个百分点，微软随即高调预测4月份IE仍将保持上涨势头——我觉得让微软如此乐观的主要原因是，最近发生在中国大陆的含铬毒胶囊事件对Chrome实在是一个不小的冲击。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在人教版的中小学教材里，能和杜甫相抗衡的喜剧super star，我觉得只有甲乙二人了：这两个SB最大的爱好就是竞走，还总搞不清楚他们自己是在哪相遇的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;方校长的团队目前研究的一个重要课题是：如何应对汉字的资源耗尽问题。即将召开的十八大使这一问题显得更加棘手。参考IPv4的一些解决方案，我觉得可以从GB2312划出几个子段，规定省部级以上领导的名字必须从这些字里取。或者，可以考虑用Unicode作为合法的名字字符集。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;要把有限的生命投入到无限的会议当中去。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我虽然经常犯二，但遗憾的是一点都不傻。这样的后果就是享受了2B的reputation，却没有获得SB的inner peace。在高兴的时候，我喜欢看一些书；失落的时候，喜欢看另外一些书。这看起来没有什么区别。冷静的时候，喜欢说None of my business；犯二的时候，喜欢讲None of your business. 这看上去仍然没什么差别。——我想说什么？记不清了，反正这条挺严肃的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Meteor的一大设计哲学是：Data on the Wire。网路中尽可能只传送有意义的数据，而非大量的markup。让客户端来决定怎样来使用 数据 以及渲染界面。虽然Google Wave最终做死了，但我认为realtime web这条路是未来正确的方向。作为一个想要有大作为、企图改变游戏规则的框架，“未来”才是应该去赌博的东西，而不是在设计之初就把自己限死在“兼容”的窠臼里。Meteor这样的设计决定了不太可能很好的支持无JavaScript环境，但我不觉得有太大的问题。如果你问我如果用户disable了JavaScript怎么办，那我的答案是，让他们鬼叫去吧。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;或许将来某一天，disable了JS的客户端就好像disable了TCP的终端一样让人无法想象。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Meteor使用NodeJS的方式让我有点惊诧，居然放弃使用Node强大的event-based IO，而是引入了fiber，每个request起一个“线程”。原因暂时不明，我先不瞎喷。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（21）</title>
   <link href="http://blog.tomsheep.net/2012/04/24/notes"/>
   <updated>2012-04-24T22:18:33+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/24/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;天哪，今天是莱温斯基和克林顿相识15周年纪念日！——早上看到Google的拉链主页我就知道了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;今天早上我在备忘录里写了一个“雅”字，晚上看了半天也想不起来当时到底想要说啥。是提醒我注意品位么？——开什么玩笑，你还能找出来把三俗段子讲得这么文雅的么？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Backbone.js是一个client端的MVC Web框架:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Model以及Collection（即model的集合）有sync server的能力，也就是说，MVC还是那个MVC，只是他们这次都部署在前端，数据存储本身在后台，通过前端的Model封装了存取过程。默认的sync行为是REST风格的HTTP请求。可以通过重写Backbone.sync来更换存储行为，比如替换为websocket接口，或者干脆用client端的localstorage做存储（这样就是一个纯客户端应用了）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Backbone本身的源码很少，一千多行，有逐行注释版的doc（我很喜欢一边是源码，一边是注释的文档格式，不知道是用什么工具生成的）需要underscore和jquery（或者zepto）的支持。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;第一次看到JS中用&quot;数字| 0&quot; 来截断小数位&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;将JS库写的前后台通用的good practice：1）用变量统一（如root）指代window与global &amp;nbsp;2）判断exports是否为undefined，是则将lib暴露的对象挂入root，否则将其指向exports 3）引用第三方库时，判断require是否为undefined。以引入underscore为例：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  if (!_ &amp;amp;&amp;amp; (typeof require !== &#39;undefined&#39;)) _ = require(&#39;underscore&#39;);
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Backbone中的主要组件有Model、View、Route（基于URL hash）、History（可基于pushState）、Collection、Events&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;model.cid 即Client id，和id的不同在于后者对应的是数据库中的主键，而前者存在的价值在于有些model还没有被存入数据库（因此没有id）而这时可能又需要其UI可见。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;发现一个新框架Meteor，颠覆了现有的Web站点/应用server-side driven架构，client变得更聪明，或者说，更准确地讲，是大大模糊了server和client之间的界限。以后有空去了解。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（20）</title>
   <link href="http://blog.tomsheep.net/2012/04/23/notes"/>
   <updated>2012-04-23T22:41:31+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/23/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&quot;Brain always works faster than mouth&quot;——让我们以冯诺依曼体系建个模：如果把显意识和潜意识当做主存，这句话揭示了高速的CPU和低速的IO之间的关系。而我们通常说的“说话不过脑子”，其实是一次高效的DMA操作。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;难以置信又开了一天的会。恍惚中有种体制内稳拿的错觉。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我终于明白为什么每到3月份就会冒出那么多SB了——都是开会开傻的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;前几天在优酷上看到曹雪敏校友的讲座，有一段大意是：在人类以狩猎为生的远古时代，视力好也是择偶的基因优势之一，而这一优势在现代已经不存在了。她显然不知道，就在刚才回家的地铁上，如果我的视力再好一点，我就可以看见前面那个姑娘的微博ID是多少了……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;地铁上有一搭没一搭地看《弗洛伊德传》：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;弗洛伊德是犹太人，从小生活在民族歧视的氛围中。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;像多数的书呆子一样，佛洛依德也有着偏执、小家子气等性格缺陷，但他具有很强自我反省意识和自我分析能力。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;弗洛伊德的精神分析理论受到了柏拉图唯心主义哲学的很多影响，但佛对柏拉图学说做了很多为我所用的修正，比较意外。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;弗洛伊德对人类精神的分析是从生物本身出发的，即从人类本身、而非从虚无的“彼岸”来解释人类精神本质。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（19）</title>
   <link href="http://blog.tomsheep.net/2012/04/22/notes"/>
   <updated>2012-04-22T22:16:30+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/22/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;小时候我最讨厌的两个地方，一个是湖北黄冈，另一个是北京海淀。——现在只有北京海淀。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在大学里不止一个老师给我讲过“沃尔玛把啤酒和尿布放在一起”的故事，他们都说这是很高端的数据挖掘结果。那谁能解释一下龙德广场的书店把“计算机技术”和“人体艺术”放在一起是什么意思？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《疯狂的赛车》：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;宁浩的讲故事能力很强，一个故事扯出好几条线最终还能巧妙地串回来。和《疯狂的石头》路数一致，而且感觉更耐看。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有些影片因为过于现实而让人看不到希望，有一些因为过于荒诞而让人难以产生共鸣。这部电影是在用荒诞的故事认真地观察现实，处处透着黑色幽默。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有一些导演的小聪明让人记忆犹新，比如：1）耿浩做梦被警察包围的那个桥段吐槽地真精彩 2）两个陕西笨贼的戏很出彩，很&amp;quot;professional&amp;quot; 3）快结尾处那个“男人都超不行”的文字游戏玩的挺好&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;宁浩这个系列的电影风格决定了植入广告基本不需要担心产生违和感。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Agile Web Development with Rails 4th ed》第20章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Rails提供两种制定route规则的方法：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; convenient方式即面向resource，适用于REST风格（rails默认提供7种增删改查路径）&lt;/li&gt;
&lt;li&gt; comprehensive方式，即URL和controller action对应的方式，和其他框架中的routing类似。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;rake routes命令查看映射规则&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果一个url没有对应的route规则，&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; 查看controller是否实现method_missing&lt;/li&gt;
&lt;li&gt; 查找对应路径的template 3）抛出Unkonwn Action错误&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;响应一个request可以有几种方式:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; render一个template，也是默认的方式&lt;/li&gt;
&lt;li&gt; 直接返回一个string（render方法传:text参数），不渲染页面&lt;/li&gt;
&lt;li&gt; 返回无内容的response，只有一堆headers 4）返回非HTML的其他data&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;redirect_to(:back)&lt;/code&gt;是通过&lt;code&gt;HTTP_REFERER&lt;/code&gt;实现的&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Session Storage在rails中提供了多种实现方式：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; 基于cookie，简单，server端负担轻，但不适于存放敏感信息（书中讲rails3.0是默认的，最新的还没有求证过）&lt;/li&gt;
&lt;li&gt; PStore&lt;/li&gt;
&lt;li&gt; 基于AR，存在数据库&lt;/li&gt;
&lt;li&gt; DRbStore，用单独的DRb server，web app通过DRb协议访问&lt;/li&gt;
&lt;li&gt; 基于memcached，功能强大但也更复杂&lt;/li&gt;
&lt;li&gt; 放在内存里&lt;/li&gt;
&lt;li&gt; 基于文件&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;建议session过期处理方式为：直接在server删掉，无需再客户端做expire提示标记。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Flash是特殊的跨request存储，只在后续一个request中生存。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Rails也有controller filter（分before和after）的概念，可以借此实现诸如auth、logging等功能。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（18）</title>
   <link href="http://blog.tomsheep.net/2012/04/21/notes"/>
   <updated>2012-04-21T23:40:03+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/21/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;为什么总趋向于把简单的事情搞得很复杂以至于常人无法理解呢？——这一定是他写毕业论文时留下的后遗症。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;北京的交通大概是姚壮宪设计的，但是他显然忘了在每个路口设一个存档点。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在工体附近游荡，误入使馆区，走了一阵才发觉，周围路上一个行人都没有，每几十米就有两三个武警结伴执勤。心中一凉，觉得随时都有可能被击毙，心说今天就交待在这儿了。后来一个声音告诉我：“bug还没有修完，product还没有release，怎么能就这么不明不白地去了”，脑中闪出无数英雄形象，不知哪儿来的一股勇气，心一横在他们的注目礼下一直慢慢踱出了路口。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;晚上看点经典的，《教父》：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;开始一直抓不住导演的点，后来慢慢有点感觉了，这才是how this world works.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;老Corleone、Michael和Tom是全篇主要刻画的三个人，Tom觉得藏得比较深，戏没有出来，不知道续集里有没有什么动作。Michael的心路历程是戏核，和老Corleone殊途同归，这是社会和人生的残酷与无奈。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Make them an offer they cannot refuse. ——HR应该多看看这部片子。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Michael在意大利避难时的妻子开车引爆的那个桥段，立马让我想起了《无间道》里有类似的一幕，不出意外后者的灵感应该源出于此。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Agile Web Development with Rails 4th ed》第18——19章：Active Record&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Active Record为Rails的成功出力不少，和其他ORM有一点很大的不同，就是AR讲table schema当做model定义的一部分，这样一来，就少了一层映射关系，不过似乎这样耦合也会强一些（我还不知道rails是怎么支持非关系型数据库的），程序员会舒服一些。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Rails默认认为两个model对象之间的equal关系（==操作符）是“来自同一class并有相同的primary key”。在比较unsaved objects（没有数据库行对应）时要注意。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AR的一对一、一对多、多对多关系表达非常方便，通过model中的简单声明（函数调用）实现，对于不喜欢和关系型数据库打太多交道的程序员很友好。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ruby的动态语言特性使得AR能够提供强大的因schema而异的find操作。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使用这些动态的find操作而不是sql语句有助于预防sql注入。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;AR定义了20个callback供程序员来hook model对象的生命周期。另外Observer可以在不修改model class本身的前提下对model进行hook。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（17）</title>
   <link href="http://blog.tomsheep.net/2012/04/20/notes"/>
   <updated>2012-04-20T22:38:27+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/20/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;尽管是药学院出身，但我至今还是经常搞混阿莫西林、阿司匹林还有福尔马林。——对于我转行做码农这件事请，你们会不会感到一丝劫后余生的庆幸？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;打电话回家告诉我妈：阿莫西林不能吃了，其他胶囊的也尽量别吃，非要吃的话可以把壳拧开下饭吃。——我觉得我简直在搞笑，但搞笑的是你们知道我没有。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;包袱是经不起解构的。如果把你认为有趣的段子都一一分解，你会发现其实幽默的手法无非那么几种。这让我越发觉得喜剧行业的不易：门槛很低，但发挥空间也很有限，创作过程就是一个和观众斗智斗勇的过程，得用简单的原理
玩出各种各样漂亮的花活来。火候的拿捏也得恰到好处，增一分往往流于媚俗，减一分则索然无味。宁财神说“有些包袱因恶毒而响亮，有些因温吞而无趣”，正是这个道理。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Agile Web Development with Rails 4th ed》第5章——17章：是一个增量迭代的demo，跟着做了一遍，非常顺手，以至于我不知道应该记些什么&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;unit test主要关注model（逻辑规则），functional test关注controller（work flow），这个划分让开发人员更容易理解MVC。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;对数据库的修改通过migrate脚本完成，每一步都有迹可循，对程序员非常友好。哪里不对rollback哪里，PM再也不用担心我的build break了~&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;良好的test、dev、product的环境划分，test环境对fixture的支持，都是极大简化开发的设计。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;rails 3.1 之后就默认用jquery替代rjs了，这本书这一点是显得过时了点。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;很容易上手，我觉得对于RoR程序员来说，了解了基本原理和组织结构后，剩下的就是：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 通过实践熟悉rails的各种helper&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 深入理解被rails隐藏掉的底层原理（无非是从HTTP角度出发理解框架的实现）&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（16）</title>
   <link href="http://blog.tomsheep.net/2012/04/19/notes"/>
   <updated>2012-04-19T22:17:23+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/19/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;孙海平绞尽脑汁想遍了各种办法，都无法让刘翔跑得更快一点。其实我觉得大可不必——只要他在比赛的时候拿一个二手的扩音器在赛道旁边单曲循环“行人车辆请注意，火车就要开过来了，不要抢行，不要翻栏杆……”就可以轻易达到这个目的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;微信4.0华丽地整合了Instagram的功能，这让我对腾讯的敬仰无以言表。我现在最大的愿望就是Facebook尽快高价收购东京热，这样微信就可以……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;又一个同事离职创业了。大家应该为此感到高兴——因为这意味着，下次当你离职的时候，就又可以少请一个人吃饭了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我发现这年头，不创业，都不好意思离职。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如果你在地铁上看见一个人姿态诡异，背靠栏杆，手中托着电子书眼睛却丝毫不往上瞟一眼，双眉紧锁，表情中透出一种淡淡的忧伤，你说这是为什么？他很可能刚刚参加完同事的散伙饭，由于喝了太多水而现在很想上厕所。——我是怎么知道的？你说我是怎么知道的！&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;早上成功错过了一场旷日持久的会议。但上帝是公平的，下午都给找补回来了。这导致今天笔记里实在找不出什么有营养的东西。但是你以为我会因为没有干货而不好意思更新笔记么？Naive。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（15）</title>
   <link href="http://blog.tomsheep.net/2012/04/18/notes"/>
   <updated>2012-04-18T22:32:18+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/18/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&quot;I know how this world works.&quot; Titanic里Jack这么对Rose说。我觉得他一准儿在扯淡。——I bet he doesn&#39;t even know how my code works.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Neither do I.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;-Zhu：我觉得这个lib有点大。&lt;/p&gt;

&lt;p&gt;-Kang：没关系，用户不care。&lt;/p&gt;

&lt;p&gt;-Zhu：也是啊。用户一定觉得400M的应用比100M的来的更有内涵。&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;间离效果：也称陌生化效果。在戏剧表演理论中指让观众看懂剧情却又不带入剧情，提示观众这是在剧中。这一技法经常被用在影视作品中来获得一种幽默的效果。这和文学理论中的“浪漫主义的反讽”手法如出一辙（比如《苏菲的世界》通篇都可看做是这一技巧的运用）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《JavaScript语言精粹与编程实践》第四章：JS的函数式语言特性&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;编程风格与习惯往往受到语言环境的制约。命令式编程世界中“不提倡连续求值运算”这一风格是为了更加符合冯诺依曼计算机体系（实现图灵机模型）的设计。而“连续求值”恰恰是函数式语言的基本特征。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;丘奇的Lambda形式系统（与图灵机模型等价）则更趋近于“运算才是本质”的观点，修改内存只是side effect。Lambda演算的基础是一些“以函数为参数和返回值”的函数。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;不能将函数式语言中的“函数”概念等同于JS中的“函数”，虽然JS是支持函数式编程范式的（它同时也支持其他范式）。前者的“函数”可以认为就是Lambda，包含以下特征：1）函数是运算元 2）在函数内保存数据 3）函数内的运算无side effect。JS中的“函数”对第一点是直接支持的，因为JS中函数是一等公民；第二点通过closure支持；第三点没有强制限制，要想符合“函数式”，需要通过开发人员的习惯来实现。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;JS的expression子集可以完全与自身等价（也就意味着支持expression的CSS也是一门图灵完备的语言），在这个子集里，只有“连续运算求值”和“函数调用”的支持。但这两个特性足以模拟出分支、判断、循环等语句（其中循环需要依靠函数的递归调用模拟）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;JS中Closure的概念是对应于运行期的“函数实例”而言的。不是对应函数代码块的。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（14）</title>
   <link href="http://blog.tomsheep.net/2012/04/17/notes"/>
   <updated>2012-04-17T22:59:24+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/17/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;这是四点零八分的北京，&lt;/p&gt;

&lt;p&gt;一片手的海洋翻动；&lt;/p&gt;

&lt;p&gt;这是四点零八分的北京，&lt;/p&gt;

&lt;p&gt;一声雄伟的汽笛长鸣。&lt;/p&gt;

&lt;p&gt;北京车站高大的建筑，&lt;/p&gt;

&lt;p&gt;突然一阵剧烈的抖动。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt; ——著名诗人食指在五道口城铁站等车时这么写道。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;晚饭后pantry里居然还有宝矿力拿，我觉得我已经找到上一轮裁员的内幕了。真相只有一个：裁掉那些每天喝掉最多免费饮料的员工。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Chromium进程模型重访：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;仔细读google的paper，process-per-tab更准确的名字应该是process-per-browsing-instance。 Browsing instance是指一些列有浏览关系的页面，通过A打开B，或A以iframe嵌入B等等。一个Browsing instance中的页面可以来自多个site。而一个site instance则是粒度更细的划分，是指一个browsing instance中来自同一site的页面。因此，对于一个site来说，在一个给定的browsing instance里，最多只有一个site-instance。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;因此，process-per-site-instance是相较之下最合适和“app边界划分”，因为理论上，两个site-instance如果是在一个browser instance中的，那他们肯定不是来自同一site（上一条最后一句），因此受同源策略限制，他们之间是不通讯的（不一定哦，见下一条）。如果不是在同一browser instance中的，哪管他是不是来自同一site，也都不需要通讯，因为压根拿不到对方的reference。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在实际的chromium实现中，默认的模式process-per-site-instance的行为和
process-per-browsing-instance很接近，没有强制把一个browsing instance中的不同site instance拆开。Google说，非不能也，哥不为也。主要原因是一小撮DOM API并不遵循同源策略，同一browser instance中不同site instance的页面之间是可以通过这种方式互调的，比如location、history等对象还有blur、focus等方法。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于App Isolation，ACM CCS 2011的有&lt;a href=&quot;http://www.ece.cmu.edu/~ericc1/appisolation-camera_ready.pdf&quot;&gt;另一篇paper&lt;/a&gt;，主要关注App Isolation的security问题，是Google的人和其他大学合作的，也以Chromium为实现蓝本：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;很多基于浏览器的攻击都可以通过一种强大的方法解决，那就是……用两个浏览器——一个只访问有风险的站点以及连接，涉及敏感信息的，如credential，用另一个。好吧，你赢了。（这得是多么NB的用户）带来的好处很多，可以缓解几乎所有的Cross-origin的攻击方式（Relected XSS, Session Fixation, CSRF, Click-jacking等等）。当然same-origin的攻击是无效的（如persistent XSS）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;本文的目的为在单一浏览器里通过App Isolation的策略来达到使用多个浏览器的安全效果。作者将这些安全问题归结为两个关注点：entry-point restriction和state isolation.提出的基本思路是，禁止不被信任的第三方向网站的特定部分发起请求、隔离不同站点的persistent和in-memory state。为了兼容性，这些策略是opt-in形式发起的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;entry-point restriction: 一个app可以通过限制自己的entry points来达到一下目的：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 允许来自同一app其他页面的访问&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 外部app想要load本app的URL resource, 必须是指定的entry points。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;state isolation: 浏览器为不同的app创建隔离的persistent storage; 通过app隔离限制第三方以加载子资源的方式携带本app的credential。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;MozilliaLabs有一个浏览器prism，是面向app的浏览器，通过用户指定站点的方式，限制用户活动在本站点内。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CSP协议也可以解决本文中提到的大部分安全问题，但不能防御直接对rendering engine的攻击（从而越权访问敏感数据）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;chrome://crash&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（13）</title>
   <link href="http://blog.tomsheep.net/2012/04/16/notes"/>
   <updated>2012-04-16T22:27:28+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/16/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;你们这些在金凤成祥买早餐的，永远都不懂煎饼馃子的忧伤。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;Xin：昨天晚上做梦一直在写代码，我记得好多task都做完了。今天起来一看，靠，白写了！&lt;/p&gt;

&lt;p&gt;Kang：你当时写完就应该check in到svn，今天来了直接check out就好了。&lt;/p&gt;

&lt;p&gt;Xin：有道理&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;昨天风刮的挺大，今天空气质量果然好多了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Chromium进程模型：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Web网站趋于应用化，使得浏览器有了“操作系统”的职责，单进程模型已经无法满足应用之间的隔离、安全等需求。Google在eurosys2009的&lt;a href=&quot;http://www.charlesreis.com/research/publications/eurosys-2009.pdf?attredirects=0&quot;&gt;paper&lt;/a&gt;对此有详细论述。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;如何“划分应用边界”（即哪些pages需要被分入同一进程）没有万全之策。“每个tab一个进程”会导致应用被严重割裂，页面间通讯overhead过大。产生过多进程，memory footprint也很可观；“利用Origin划分”也并不理想，在一个应用中subdomain间的通讯是很常见的，严格按Origin划分则通讯也会受阻。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Chromium引入多进程架构的同时，并没有break既有的Web世界的规则，比如同源策略、跨域交互等等。Chromium进程模型中 包含Browser进程和Render进程，前者负责网络通讯、文件访问等高权限功能，只有一个。后者主要负责渲染页面，可有多个。关于Render进程的分配Chromium提供了4套策略：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; Process-per-site-instance： 默认策略。Site被定义为，拥有相同主域的一系列Origins，而一个site-instance则是来自同一site的一系列相互“关联”的页面，这里“关联”可以理解为有navigation关系（比如通过A页面中指向B的连接打开B页面，则AB相关联。这是有意义的，在web应用中这样的页面相互之间是可以通信的，比如postmessage或者通过window的某些属性，将他们放入同一进程则省去了进程间的通信）。但是Chromium在实现的时候并没有完全遵循site的划分，比如，即便属于不同site，两个有navigation关系的页面还是会被指定到同一进程。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; Process-per-site： 和第一种策略相似，区别是没有instance划分，即：属于同一site的诸多页面肯定会被merge到同一进程。而Process-per-site-instance允许同一site下有多个instance。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; Process-per-tab： 为一系列script-connected的页面分配同一进程。可以对应到HTML5的browsing context概念。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; Single-process：即单进程。最新的chromium browser和Google Chrome都已经不再支持单进程模型，理由是产生的bug过多。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我用Google Chrome-18 stable做测试，上述几中模式行为如下：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 默认模式：右键打开新连接不会产生新进程，即便是不同site的页面；正常的Navigation也在同一进程下；在地址栏输入网址，如果是不同site的，则打开新进程。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; --process-per-site：和默认模式相似；区别在于，无论何时，打开的页面如果属于同一site，将会被merge指定到同一进程。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; --process-per-tab：和默认模式最大的不同在于，右键打开新页面产生新进程，即便是同一site的页面。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; --single-process：已不再支持。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Chromium的render进程运行在Sandbox环境中，不能直接访问关键资源（如本地文件），都需要通过与Browser进程通讯，使后者代为完成。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;插件（不是拓展）运行在单独进程中，每个插件一个进程，但不运行在Sandbox环境，有直接访问资源的权限。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Chromium browser和Google Chrome是两个不同的浏览器，后者基于前者，但有很多修改。具体不列了，内幕很可怕，不细说。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;今天下午突然挺压抑的，现在也想不起来原因是什么。那就别想了，就这点破人生有啥可怀疑的。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（12）</title>
   <link href="http://blog.tomsheep.net/2012/04/15/notes"/>
   <updated>2012-04-15T22:08:16+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/15/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;“要以维护半岛和平稳定为出发点和落脚点……”——既是“出发点”又是“落脚点”，这好像是个圈哎？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;这么久了，我相信你们应该都没有发现，实际上我是个做浏览器外壳的。——一个不想做backend的中间件开发者不是一个好前端。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;而我的另一个不为人知的隐藏职位，是……公司的CTO——Chief Tucao Officer（首席吐槽官）。XD&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《泰坦尼克号》3D版观影：好电影永远都是好电影，非常打动人心。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;分辨英式发音和美式发音其实很简单——说话的同时在憋气的那个是英国人。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;影片中有几处微妙的技法，暗示titanic的沉船悲剧，一处是Jack在初识Rose时说自己小时候掉进冰窟，水冷到极点；还有在船上的教堂，乘客合唱赞美诗《Eternal Father, Strong to Save》，其中的歌词&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Oh, hear us when we cry to Thee,&lt;/p&gt;

&lt;p&gt;For those in peril on the sea!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;  脂砚斋批《红楼梦》时将这种手法称为“草蛇灰线，伏脉千里”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在很多影片中，导演都需要解决一个“minimal surprise”(别查了，这个名词是我编的)的问题，即让观众在合适的时候知道一些背景信息。在Titanic里做的还是很精细的，比如:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 探险队员劝阻队长和老年Rose见面时，其实起到的主要作用是向观众介绍Rose的生平，尤其是沉船之后的部分；&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 探险队员用电脑模拟还原当年的沉船过程，像Rose讲述，实际上是导演在给观众做“预习”, 让观众带着一些pre-knowledge ，这样后面宏大的海难场景与之呼应并对比，心理冲击力更强，也更有带入感；&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; Rose在上船时和Titanic设计师的谈话，让观众预先了解“救生艇不够”这一信息。 这些细节都可以看出一个导演的自我修养。为了达到同样目的，我看到过国内最让人喷饭的解决方法是：人物特写，定格，画面出N行字幕——“入云龙，公孙胜……”&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;观影过程中我一直在想，Rose到底是什么时候爱上Jack的？&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt; 初次相遇在甲板上的意外事故&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; Jack向Rose介绍自己的游历以及作品&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 在晚宴上Jack面对上流社会精彩地诠释自己的人生观&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 在三等舱轻松愉悦的party时光&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 广电总局友情提示的那部分&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt; 掉入海中Jack的自我牺牲。我觉得很难分辨——I guess that is why I am still single.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;但同作为一个屌丝，我觉得我大概还是知道Jack是何时彻底爱上Rose并终能够做出自我牺牲的：在Jack被锁在小黑屋里，Rose赶到，房间已经1/3进水，但Jack这时关心的问题是“How did you find out I didn&#39;t do it?”(指被诬陷偷走海洋之心) 这时Rose的回答是“I feel it. I realized I already knew.”这个回答杀伤力太强了，任何屌丝都抗不住这样的“信任”。（实际上Rose是通过Cal临上船时的话得知的，不过不影响这个回答的分量）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;即使是在Cal采用最卑劣的手段时，我也不觉得这是一个烂人。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我们提到“人性”的时候，通常侧重的是基因中的动物本能，还是文明社会中的道德伦常？答案是，看情况。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;让老船长心理崩溃、丢到最后一丝尊严的一幕是，一个怀抱幼儿的落魄妇人焦虑而带有期盼地问他：“Where should we go now, Captain?”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;导演为了达到“人们在灾难中的恐慌和舒缓的背景
音乐
形成强烈对比”这一效果，安排了不太现实的“甲板上的乐队”这一桥段。尽管如此，我也认为值得这样设计。冲击力很强。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;影片最后部分，镜头划过Rose随身携带的生活照，是Rose后半生经历的缩影——Jack彻底的改变了这个姑娘的人生观。从这一点来说，Jack实在是一个气场强大的屌丝。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（11）</title>
   <link href="http://blog.tomsheep.net/2012/04/14/notes"/>
   <updated>2012-04-14T22:01:56+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/14/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;有比看到Google Code Jam资格赛最后一题后直接跪了更没有节操的事情吗？——有。那就是，在跪之前还跑去维基上搜了一下“平面镜成像的原理”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;党&amp;lt;!--Fix me--&amp;gt;中&amp;lt;!--Fix me--&amp;gt;央，你就从了CCTV吧。——观近期央视新闻中的高频率肉麻表白有感。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;由于没有持久化层，Mojito MVC中Model的职能比较怪异。Mojito的作者（们）认为Mojito app的数据都应该来自Web service，推崇YQL作为统一的数据接口。因此我觉得目前的Mojito app都不是一个完整的Web应用，而只是前端部分。Mojito本身更适合来做Mashup应用，比如Flipboard啊、Flipboard啊、还有Flipboard啊，等等。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;NodeJS在Web领域与RoR相比，优势有：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;性能好（有评测称快10倍左右）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;JavaScript语言是Web前端的事实标准，前后台的编程体验能够一致，对开发人员是不小的诱惑。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; 劣势有：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;刚刚起步，还没有成型的一揽子解决方案出现。（其实拿NodeJS和RoR比本身不是很恰当，因为后者包含了整套的Web框架）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;还没有像样的成功案例。虽然Node一直号称在高并发、大规模的应用场景下优于其他技术，但目前还真没有什么大规模的应用采用Node，这个没办法，得慢慢来。倒是性能差的出名的RoR成果显著。由此也可以看出，“效率”“性能”等问题虽然重要，往往不能从平台的角度一刀切地看问题，需要根据综合因素作出权衡。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一般来说，Node更适合的领域：大量并发请求应用、real-time web应用。 RoR更适合的领域：业务逻辑复杂的应用、并发请求不是关键因素的应用。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《Agile Web Development with Rails 4th ed》1——4章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;强烈要求Mojito加入scaffolding工具。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Model是包含了业务规则的data store。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ActiveRecord作为ORM层，突出体现了Rails的“Convention over Configuration”理念。支持成熟的validation机制。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Rails支持的三种生成动态内容方式： ERb、XML Builder、RJS views&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ruby中的symbol是个相对独特的设计，其他语言中大多用string来“兼职”负责这一功能，但string也是拥有自身职能的对象，把他们分开是合理的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ruby中的closure真是很丑，而且引入了Block、Proc、yield等一堆概念，不及JavaScript“函数即一切”的简洁设计。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;YAML是Rails中使用的数据表达格式，来自Ruby标准库，地位类似JSON，功能更多一些，语法也更复杂一些。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ruby的Marshalling类似Java的Serializable概念。Rails用它来存储session data。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;目前为止我对Node保持乐观，个人更喜欢JavaScript，用最小的知识集去解决问题。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（10）</title>
   <link href="http://blog.tomsheep.net/2012/04/13/notes"/>
   <updated>2012-04-13T21:53:04+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/13/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;昨天晚上做梦自己被当众攻讦，百口莫辩，气氛异常紧张。濒临崩溃之际，一位仁兄仗义执言出头为我拔闯，当时就给感动醒了。醒来后顿时对其本人好感剧增。——后来我纳闷了一整天，他到底想让我解散哪家公司？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;有同学说动辄夹带英文是一种装B恶习，我陷入了深深的羞愧与自责。在一番激烈的思想斗争之后，我发自肺腑地觉得不能同意他更多。来，给我一个五！&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;事实上，我也是一个民族文化的坚定爱好者，在Someone Like You之流的欧美流行歌曲大行其道的今天，我始终坚守着心中那一片清新脱俗的中国风的净土。我记得其中有一首是这么唱的：“苍茫的天涯是我的爱……”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;为了更好地理解Mojito的精髓，我决定开始学习RoR。（此处不是冷笑话，谢谢配合）&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Ruby的语法……挺难形容的，但的却很精练。
我觉得Mojito的易用程度或多或少受到了稍显繁琐的JS语法的影响（Coffee可能会好些？）。还有我一直都觉得YUI的语法也有些笨重。程序员都很懒，你让他敲那么多大括号，他会骂娘的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Rails把Web应用抽象得太厉害了，因此我觉得它反而不适合用于Web课程的教学。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;从Mojito和Rails命令集的对比来看，Mojito有明显抄袭痕迹（会不会被要求下架？），但Mojito还是更麻烦一些。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我至今也想不通为什么Mojito没有持久化的支持。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;Xin：你的九点钟方向有个小清新。&lt;/p&gt;

&lt;p&gt;Kang： 我的三点钟方向有个SB。&lt;/p&gt;

&lt;p&gt;Xin：Zhu，他说你是SB。&lt;/p&gt;

&lt;p&gt;Zhu：瞎说，他的三点钟方向明明是你。&lt;/p&gt;

&lt;p&gt;Xin：这是条射线好不好，我们俩都在这条线上。&lt;/p&gt;

&lt;p&gt;Zhu：他用的是单数，又不是SBs，只有你了。&lt;/p&gt;

&lt;p&gt;…… （5分钟后）&lt;/p&gt;

&lt;p&gt;Xin：你觉得我们俩争这个名额有意思么？&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（9）</title>
   <link href="http://blog.tomsheep.net/2012/04/12/notes"/>
   <updated>2012-04-12T23:14:16+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/12/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;菜毅大概是我们三俗小团体中最内敛最腼腆最有气质的一个：每次被我们吐槽时，他总是会将双手优雅地 插在上衣口袋，伴随着脚步的节奏微微颤抖；羞赧地将头偏向一边，眉眼之间流露出一抹不易察觉的微笑，朱唇微启，幽幽地吐出一个字来：“操。”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一直有同事和朋友问我为什么要给这份笔记起这样一个恶俗的名字——哎，你们怎么总是只看到“屌丝”，都不注意“自我修养”……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“屌丝”一词所承载的文化往往被视为犬儒主义、 充斥着消极的人生观。但本屌丝认为恰恰相反，它反映的是乐观、隐忍、自嘲、渴望自我实现的精神状态。这也是我对这份笔记内涵的期许。No matter how tough life gets, stay strong and laugh broadly. 这就是我眼中的“屌丝的自我修养”。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《自私的基因》1——2章：作者废话很多，基本的观点可以归纳为：自然选择的基本单位既非个体，更非种群，而是生命周期远远长于它们的基因。以种群延续来解释生物有时的“利他”行为实乃缘木求鱼。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;每接触一种新的Server实现技术，我首先关注的总是其部署方式，遗憾的是虽然web技术的文章和书籍漫天都是，关于这方面的介绍却少的可怜，而且CGI、FastCGI、servlet、WSGI、Rack、Phusion Passenger等等不同层面的概念经常被揉在一起讲，比较混乱：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;以服务器端来讲，归根到底在原理上并不复杂，无非HTTP request的解析与HTTP response的构造返回而已。但因为实现这一目的的方式被玩出了很多花活，因此出现了如此繁多的、彼此可能还overlap的技术名词。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;通常地，除去持久化层不说，server端的组件被顺序地分为三块：Web服务器、Application服务器、Web应用。其中Web服务器与Client直接通讯，说“普通话”HTTP；Web服务器将请求分发到App服务器，他们之间说普通话HTTP可以（这时web服务器更像一个反向代理），说其他方言也行，比如CGI。App服务器和Web应用之间的通讯方式通常是一种编程约定（因为通常App server是作为Web应用的“容器”出现的，处于同一运行环境中），比如Java 的servlet、Python的wsgi等等。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;并不是每种server端技术实现都存在这三种组件（J2EE的部署方式是最符合这一划分的），可能会有以下这些变种：&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Web server作为App server来管理web应用，比如通过Apache的mod_php来部署php应用&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;没有明确的app server概念，web server直接和web应用交流，比如通过fastcgi来部署php应用（这时通常会使用一些进程管理工具来维护fastcgi进程，但不能称之为app server）。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Web应用直接作为Web server，nodejs的绝大多数部署方式属于此类（可能是裸的，更有可能前面会用nginx或apache加一层反向代理）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;RoR的Phusion Passenger更像上面的第二种变种。Passenger是一个Rails应用服务的管理工具，可以统一管理Rails进程的数量、生命周期、请求队列等等。Passenger不说HTTP，进程间如何通信暂时没研究。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Rails的接受请求的模型是一个进程处理一个请求。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（8）</title>
   <link href="http://blog.tomsheep.net/2012/04/11/notes"/>
   <updated>2012-04-11T22:34:07+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/11/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;为什么媒体每次都比我先读到CEO发给全体员工的信？一定是我对“Confidential”这个词的理解有问题。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;点点的客服将昨天的封禁归因为“被举报多次发送spammer”，假设这条信息成立的话，那从中至少可以读出两点：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;举报的那孩子情商得有多低啊。&lt;/li&gt;
&lt;li&gt;点点的安全逻辑存在严重漏洞，恶意用户可以轻易对其他用户进行block。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;他们总共花了6个小时来恢复我的账户，这让我很震惊。我觉得有必要向点点的技术团队推荐本屌丝的技术博客，希望对你们有帮助。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于IO模型，“同步/异步”、“阻塞/非阻塞”的概念在网络上资料中被严重混用。我看到最奇葩的一点是对select/poll模型的解释，一部分人认为是“同步非阻塞”的，还有一部分认为是“异步阻塞”（这个提法好奇特）的。后者主要来源于IBM developer流传甚广的&lt;a href=&quot;http://www.ibm.com/developerworks/linux/library/l-async/?S_TACT=105AGX52&amp;amp;S_CMP=cn-a-l&quot;&gt;一篇文章&lt;/a&gt;。出现这两种看法的原因在于双方根本不在一个位面上讨论问题：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;第一种观点对”异步“的理解为Where I/O really happens(是发起IO的进/线程还是其他)，这里的I/O有时可以狭义地指把数据从内核读到用户态，而”阻塞“则指发起I/O行为本身的调用（即read、write等） 是否立即得到就绪状态。因此按照这种理解，阻塞/非阻塞的概念只在”同步“的语义下make sense。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;而第二种观点，所持“异步”观念大致可以概括为“应用程序与内核交互是否基于notification”至于这个notification是针对“ 获取IO就绪状态”还是“发生真实IO”，就比较含糊了，甚至是混为一谈的。这种观点之所以认为select/poll是“异步阻塞”，因为select确然是基于异步notification来通知socket就绪状态的，而“阻塞”则是因为select系统调用是阻塞的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;本屌丝个人认为第二种观点比较混乱，偏离了对“真实I/O如何发生”的论题。当然，去争辩select模型是同步异步、阻塞非阻塞本身就很蛋疼。按照第一种原教旨主义的IO定义，select作为一个阻塞的系统调用，其之后发生的“真实IO”可以阻塞，也可以非阻塞（当然非阻塞更make sense）。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;epoll和poll外观相似, 用户层的代码也须调用read/write, 但因为其采用 mmap, 使得 内核socket buffer和用户buffer共享,省去了从内核到用户态的额外拷贝, 当调用返回时，read/write之前，数据已经在用户态了， 因此虽然epoll也是“当事件资源满足时发出可处理通知消息”，但简单地讲其归为“同步”是不合适的。IOCP是Windows下的纯异步IO模型，是当IO完成时发出完成通知消息。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;和socket描述符不同，一般文件系统文件是不支持non-blocking IO的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;其实今天早上编排了好多嘲讽diandian的段子，打算写进今天的笔记。结果证明本屌丝脾气太好了，对方说几句台面话，我就不好意思了。所以，正如你们看到的这样，我欣然地接受了客服“上传一个头像以免被误杀”的建议。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（7）</title>
   <link href="http://blog.tomsheep.net/2012/04/10/notes"/>
   <updated>2012-04-10T22:06:11+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/10/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;blockquote&gt;&lt;p&gt;&quot;看我点的这道菜多好：红得像火，粉的像霞，白的像云，黑的像屎……&quot;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;——你说我整天跟这样的同事吃饭，能学出什么好儿来？ @mengxxin&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;我终于可以自豪地宣布Agile已经融入了我的全部工作与生活：每次去地铁站售票口充值，我就知道，新的一个sprint就要开始了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我不知道这份日记可以坚持更新多久，不过说真的，当初我可是按新闻联播那么设计的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;说唱歌手整天&quot;check it out&quot;，从来都不&quot;check in&quot;，我们一致觉得是没有做code review的缘故。所以，在吃饭回来的路上， 本屌丝给自创的rap歌词里都加了&quot;ship it&quot;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;判断解空间大小是否为2&lt;sup&gt;n&lt;/sup&gt;的几个hints：大小为n的集合的子集数为2&lt;sup&gt;n&lt;/sup&gt;、深度为n的完整二叉树的叶子数为2&lt;sup&gt;n-1&lt;/sup&gt;、(1+1)&lt;sup&gt;n&lt;/sup&gt;的二次项展开。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;DP的基本特征：independent subproblems（一个子问题的解不影响其他子问题的解）、overlapping subproblems。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CLRS中描述的DP基本步骤：找出optimal substructure、递归定义optimal solution、计算（通常bottom-up）optimal solution、构造最优解（通常需要在上一步记录额外信息）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《白帽子讲Web安全》16——18章：这部分是作者的运营经验，比较难得。但我觉得写得一般，没有预期的好。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;“提高密码复杂度”这一安全需求的本质为：如何对抗暴力破解、如何防止密码中包含个人信息。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;账号失窃的主要途径：网络嗅探、客户端木马、被钓鱼、暴力破解、密码取回流程漏洞、XSS、SQL注入导致的账户信息泄露。防御的优先级：登录时安全&amp;gt; 网站实现安全&amp;gt;用户使用环境安全。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;防御垃圾注册与垃圾信息的思路：1）针对“批量”、“自动化”行为方式 ； 2）针对垃圾内容分析；3）针对与业务相结合的特征。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;SMTP协议是可以由用户伪造发件人邮箱的。针对这一点，比较成熟的方案有SPF、Yahoo!的DomainKeys，微软的Sender ID等。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;网购流程的缺陷：流程中每个平台都有一套自己的账户体系，他们之间缺少对应关系，因此平台之间只能通过“订单”信息作为唯一的判断依据。解决的方法是：找到一个唯一的客户端信息，贯穿整个支付流程的所有平台，保证订单是由创建者支付的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;战略层面安全运营的发展蓝图中的不同方向：1）Find and Fix（漏洞跟踪、分析、定期查漏） 2）Defend and Defer（安全监控、入侵检测、紧急响应流程） 3）Secure at the Source（遵循安全开发流程，如SDL）&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（6）</title>
   <link href="http://blog.tomsheep.net/2012/04/09/notes"/>
   <updated>2012-04-09T20:46:31+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/09/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&quot;你的屌丝系列更新到第几季了？&quot;——从同事豪哥今天见到我的第一句话来看，他肯定不是一个合格的美剧爱好者。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;程序员在RoR下获得了海底捞式的服务。——观RoR的anti-CSRF解决方案有感。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;和兴趣没有什么交集的朋友聊天，谈完天气和饮食习惯之后，我能想出来的下一句基本上就是“给您拜个早年”了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当人们都对yahoo的裁员策略表示不解并纷纷追问“为什么”的时候，&lt;a href=&quot;http://tech.qq.com/a/20120407/000115.htm&quot;&gt;这则新闻&lt;/a&gt;
告诉了我们答案：Because we can。——天呐，Scott一定是《TBBT》的粉丝。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Levenshtein distance，也常称作Edit distance，是用来衡量字符串相似度的标准。即一个字符串需要几次edit操作（增加字符、删除字符、替换字符）来转变为另一字符串。可使用DP实现其算法，这里是我的&lt;a href=&quot;http://jsfiddle.net/tomsheep/32jTD/&quot;&gt;一个JS版本&lt;/a&gt;。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我的大学导师曾经对我说，一个领域往往会涉及到过多的子系统，知识点错综复杂而使初学者难以抓住头绪。选择一个切入点延展开去，通过一个横切面来逐渐窥探到他的全貌，从而触类旁通，是一条可行的捷径。——我觉得此处应该有掌声。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《白帽子讲Web安全》12——15章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Again, “在正确的地方，做正确的事”：这次的示例是，SQL注入是Model层面需要解决的问题，因此magic_quotes_gpc等view层面的解决方案没有抓住问题实质。同样，XSS的形成于页面渲染阶段，发生在view层，因此output encoding是更加合理的防御。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;output encoding需要根据细分场景使用不同的encoding方式：比如在html标签、html属性、script标签、css、url等不同上下文中，应采取相应的encoding策略。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;完整的CSRF防御方案包括：在session中绑定token、在form表单自动填入token字段、在ajax中自动添加token（通常通过header）、在服务器端比对参数中的token于session中绑定的token。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;凡是资源“有限”的地方，都可能发生资源滥用，导致DOS攻击。无论是网络层还是应用层。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;本书的PHP安全和Web Server安全两章不好，过于泛泛，表述也不流畅。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（5）</title>
   <link href="http://blog.tomsheep.net/2012/04/08/notes"/>
   <updated>2012-04-08T21:00:38+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/08/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;PHP：Code即实现；ROR：Convention即实现；Java：Configuration即实现。 ——Web世界的普文二。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“黑名单是种很不安全的防御方式。”——Thank God，方校长并不这么认为。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;为什么码农大多数都是政治上的持异见者？我是这么认为的：对任何阶层的人来说，政治即利益，个人的政治倾向取决于政府利益和自身利益的趋同程度。从这一点来说，码农显然是中国政治社会中的弱势群体。更让人沮丧的是，马化腾至今也没有提交入党申请书。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;坏人总是比好人勤奋的多。——越多地接触Web Security领域，越是觉得这就是这个世界的规则。Fair enough.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;兴趣是最好的驱动。从行动上看，我早就做出了决定。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《白帽子讲Web安全》7——11章：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;注入攻击，无论是XSS还是SQL注入，甚至传统的stack overflow，本质都是违反“数据域代码分离”原则所致。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;浏览器的MIME Sniff实际上是通过读取文件的前256字节来推断的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;无论机制多么复杂，认证实际是一个验证credential的过程。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;登陆完成后，需重写sessionID，以避免session fixation攻击；就像装修完要换锁一样。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;根据访问客体的不同，常见的web控制访问可分为“基于URL”、“基于HTTP method”、“基于数据”几种。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于加密的Good practices：使用CBC模式的AES256用于加密、HMAC-SHA512用于摘要完整性检查、带salt的SHA-256或SHA-512用于hashing。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于加密的Bad practices: 使用ECB模式（改变分组密文顺序或替换某分组密文不会影响其他分组，给黑客带来便利）、使用流密码（易受到Reused Key和Bit-flipping攻击）、使用md5做散列算法（length extension attack，建议使用HMAC-SHA1代替）、使用相同的key做不同的事情（oauth分两个token也可以从这个角度解释）、salts和IV非随机生成、过度依赖系统的保密性。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（4）</title>
   <link href="http://blog.tomsheep.net/2012/04/07/notes"/>
   <updated>2012-04-07T20:46:22+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/07/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;让人伤感的是，方舟子老湿深入阅读了韩寒这么多有趣的文章，自己却丝毫没有因此变得幽默一点。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;最大的悲剧不是因为拼命工作结果最终挂掉，而是拼命为别人工作结果最终自己挂掉。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我有预感，微软也要裁员了。——最近几天win7总是不停地推给我一些乱七八糟补丁，我觉得他们是在刻意体现自己的工作量。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;C++真是门让人恶心的语言。但看来我是摆脱不了它了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;Most companies (including web startups) are looking to &quot;wow&quot; with their products, when in reality what they should be looking for is an &quot;of course&quot; reaction from their users.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;——HN上瞥到一句。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;为什么OAuth既要有request token又要有access token？ 从设计哲学上说，access token是consumer用来直接与service provider交流访问资源的，user不需要感知到他的存在；而request token在认证过程中暴露给了user。他们被设计存在于两条channel中。——去年我和两位同事讨论过这个问题，现在他们都已经不在……不在公司了。让人惊诧的是，当我今天在stackoverflow上偶然看到&lt;a href=&quot;http://stackoverflow.com/questions/3584718/why-is-oauth-designed-to-have-request-token-and-access-token&quot;&gt;同样的问题&lt;/a&gt;
时，发现提问者竟然是另一位ex同事。顿时我对这个问题肃然起敬。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（3）</title>
   <link href="http://blog.tomsheep.net/2012/04/06/notes"/>
   <updated>2012-04-06T20:57:15+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/06/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;你们就不能把刘翔曝光的恋情看成是一个女屌丝的励志故事么？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;让保洁阿姨收走桌上的三十几个可乐罐后，整个一天都觉得不对劲，总有种似乎丢了三块多钱的感觉。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;任你帝都有再大的风，也丝毫吹不乱我的发型。——
我终于明白当初为什么要剃光头了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;现在的人都可讨厌了，总爱问一些敏感的问题。我决定不再正面回答，请在下列链接里寻找答案：关于十八大的，都看 &lt;a href=&quot;http://www.wyzxsx.com/&quot;&gt;这里&lt;/a&gt; (十八大前夕乌有之乡网站被关——2013-3-22 tomsheep整理时按)；关于中国互联网的，都看&lt;a href=&quot;http://tech.hexun.com/2012-04-06/140128689.html&quot;&gt;这里&lt;/a&gt;；关于yahoo的，都看&lt;a href=&quot;http://weibo.com/2286596853/ydlFWukc9&quot;&gt;这里&lt;/a&gt;。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;——屌丝：我觉得作为技术书籍，每一章都应该维持一个良好的结构，开篇阐明需要解决的问题，介绍landscape与scenario，然后针对问题，细化每个横切面，层层剖析，提出不同思路的解决方案。最终对照最初的问题，对比不同解决方案的优劣，加深对整个问题的宏观理解。&lt;/p&gt;

&lt;p&gt;——屌丝的小学语文老师：把书翻到404页，按“总-分-总”结构给课文划分一下段落。&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;《白帽子讲Web安全》第2——6章（客户端安全），亮点不多，中规中矩：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;CORS跨域安全方案的基础在于信任“JS无法控制相关HTTP头”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;IE8+中的XSS Filter基于URL模式匹配，会修改其中关键字符使得攻击失败。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CSP草案是Firefox首先提出的，看来是我冤枉它了。草案想法很好，但推广起来需要多方配合，反而不如XSS Filter见效快。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;之前看过《Cross Site Scripting Attacks》，本书的第三章就显得太草率了，只能作为历史介绍与综述。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“第三方cookie”这个名词竟然迷惑了我这么多年，原来就是和session cookie相对的本地cookie。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;P3P 头允许跨域访问隐私数据，从而可以跨域Set-Cookie（如在iframe中）成功。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CSRF漏洞的本质在于重要操作的所有参数都可以被攻击者猜测到，（因此主要的防御手段是随机token）而攻击过程往往是在用户不知情的情况下构造了网络请求。（因此captcha防御也有效，但不实用）&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;和CSRF避免用户交互相反，clcikjacking利用的恰恰就是“与用户产生交互的界面”。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（2）</title>
   <link href="http://blog.tomsheep.net/2012/04/05/notes"/>
   <updated>2012-04-05T21:34:58+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/05/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&quot;No patch for stupid.&quot; ——原因是他们已经蠢到连diff也不会用了吗？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;layoff这件事吧，真是被裁了也憋屈，不被裁也憋屈。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;韩寒公然在博客里自称屌丝，我很愤慨。对于这种高帅富企图打入革命队伍的丧心病狂的
恶劣行径应该坚决予以抵制，保持屌丝队伍的纯洁性。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一位美国的yahoos在博客里写，“...all of whom, great people aside, have been doing more planning than doing.”说到本屌丝的心坎里去了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“事先把库的位置信息等保存起来(.pc)，需要的时候再通过特定的工具将其中有用的 信息提取出来供编译和连接使用。这样，就可以做到编译和连接界面的一致性——pkg-config”第一次知道Linux下的库管理工具是这么玩的，屌丝的脸都给丢尽了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;翻完《白帽子讲Web安全》第一章，感觉不错。很欣慰地发现现在国内有一小撮的技术书籍质量也上来了。而且相比之下，如果质量过关，我还是愿意多读些国内技术人的作品，因为可以看到其中的一些思考，往往会有更多的共鸣。（我才不会告诉你是本屌丝的英文太差的缘故呢。）&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;举个例子，同样是讲Defense in Depth，作者用XSS的input filtering和output encoding两种方案作一对比，深入浅出地阐述了“在正确的地方做正确的事情”这样形而上的思想。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;数据从高等级信任区域流向低等级区域无需安全检查，反之需要，类似机场安检。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;定义一个feature是否是漏洞，视角应该是结果导向的。漏洞只是对破坏性功能的统称。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（1）</title>
   <link href="http://blog.tomsheep.net/2012/04/04/notes"/>
   <updated>2012-04-04T22:47:02+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/04/notes</id>
   <content type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;据说最适合屌丝的编程语言是Lua，以后要是自己搞一编程语言，一定要叫Mua，听着多肉头儿。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在书店里“偶遇”自己喜欢的书的概率基本上比在大街上邂逅自己喜欢的姑娘的概率还低。我甚至觉得大部分书就是用来摆着做装饰的，摆到书店倒闭都不会有人买。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;刚做完扫除就有访客，简直比刚整顿过市容就有领导来视察还要有成就感。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;两个屌丝在一起聊天，最投机的部分一定是抨击政府揭露社会阴暗面的话题。TMD，其实我很阳光的。BTW，我越发不会聊天了，看来本屌丝只能从前天看的文章Why smart people are not social来自我安慰了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;老同学回忆说本屌丝当年被老师点名去他们班做经验分享，一顿神侃，让人觉得巨有思想。现在廉颇老矣……wait！本屌丝现在也可很有思想了，思想老多了……&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;阅读周爱民的大作《Javascript语言精粹与编程实践》第三章，大开眼界：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;结构体的设计直接面向存储，正是这种过低的抽象层次使重用性大大降低。而对象只是更高层次的数据抽象。命令式语言关注于数据结构，本质是基于结构的运算。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Javascript支持三种编程规范：函数式、命令式以及基于原型的面向对象。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;关于语法作用域的介绍非常到位，其中举的例子throw语句“穿透”函数的语句作用域一段极妙。“高级别的流程变更子句/语句可以跨越低级别的作用域”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;语法作用域不等于变量作用域。如你所知，JS没有语句级别的变量作用域。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;函数的原型总是一个标准额、系统内置的Object()构造器的实例。函数与构造器的区别在于原型prototype是不是一个有意义的值。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;内部原型链是JS的原型继承机制所需的。而通过constructor与prototype所维护的构造器原型链，则是用户代码要回溯时才需要的。醍醐灌顶，显/隐式原型链在一年前初学JS时没绕死本屌丝，作者只用两句话+一段代码就讲清楚了。这也解释了我一直疑惑的诸多JS类库中inherit utility的实现方式。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;构造原型继承关系的唯一方法是用new语句创建子类的原型。是唯一一种影响内部原型链的形式。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;“类抄写”式继承成员访问效率高，但内存占用较大，不维护内部原型链。原型继承相反。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;blockquote&gt;&lt;p&gt;-有一个好消息和一个坏消息，你要听哪个？&lt;/p&gt;

&lt;p&gt;-坏的吧。&lt;/p&gt;

&lt;p&gt;-Yahoo! 裁员了。&lt;/p&gt;

&lt;p&gt;-好的呢？&lt;/p&gt;

&lt;p&gt;-Yahoo! 裁员了。&lt;/p&gt;

&lt;p&gt;-然后呢？&lt;/p&gt;

&lt;p&gt;-然后……然后就没有然后了……&lt;/p&gt;&lt;/blockquote&gt;
</content>
 </entry>
 
 <entry>
   <title>屌丝的自我修养（0）</title>
   <link href="http://blog.tomsheep.net/2012/04/03/notes"/>
   <updated>2012-04-03T21:26:24+08:00</updated>
   <id>http://blog.tomsheep.net/2012/04/03/notes</id>
   <content type="html">&lt;p&gt;作为一个屌丝，我竟然是有洁癖的：写在博客中的文字必须有趣并且有营养，否则宁可暂付阙如。但在现实中我无法保证每一刻的思绪都是理性的、睿智的。恰恰相反，更多的时候，它是消极的、无趣的、武断的、支离破碎的、玩世不恭的，甚至邪恶的。我希望在这里记录下这些支离破碎的片段，或许毫无文采，或许不知所云。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;昨天在微博里感慨，生活就像《大富翁》一样，你永远不知道下一秒会抽到什么卡片。更要命的是你遇到一个变态的AI。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Yahoo! Mojito开源了，终于可以看看业界是什么反应了，也许会被喷的很惨。更乐观一点的估计是：Nobody gives a shit. 我因为这个奇葩的框架而开始学习NodeJS并大量使用Javascript，从这一点来说还是从中获益不少的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;不到一年的时间，在web stack中，我从做中间件到做前端再到回头来做中间件，然后发现自己对后台产生了浓厚的兴趣，这真是一个匪夷所思的过程。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;connect是一个设计简洁的NodeJS middleware框架，接口清晰，源码简洁，已经成为业界的事实标准。起初我试图将其对应到其他后台技术栈，比如Servlet之于Java等等，但不恰当。由于设计思想、语言特点以及部署方式的不同，不同体系的技术栈中的部分很难完全一一对应。比如部署perl与php站点，通常会涉及web server与application的交互规范，如CGI或者FCGI等等。但NodeJS通常的部署方式并不需要这些，因为web server和application是一体的（NodeJS内置了http server，而现今多数的框架都直接build在其上），都生活在同一环境，交互无非function call而已。我看到最靠谱的类比是将connect for Node比作rack for Ruby，奇怪，我并不了解Ruby，为什么这么轻易相信这个类比？&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;express建立在connect之上，是一个轻量的web框架，提供routing、template rendering，源码也很简洁。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Mojito建立在Express之上，强调MVC，基于YUI3。最大亮点是前后端全是JS并且可以尽可能相互复用，组件灵活部署在前端或后端（nb吧……），不怎么简洁，有些设计比较反人类。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;自从3月初团队调整后状态一直不佳，有点两年前的感觉，我谨慎地觉得我也是有生理周期的。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>春节答亲朋好友问</title>
   <link href="http://blog.tomsheep.net/2012/01/29/faq"/>
   <updated>2012-01-29T00:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2012/01/29/faq</id>
   <content type="html">&lt;p&gt;原本以为春节会过的很惬意，为此还多请了几天假。后来发现这个想法是何其幼稚——虽然终于有了正当的理由拒收各种红包，也不必再像复读机一样回答“多大了”“学的啥专业啊”“啥时毕业啊”“成绩怎么样啊”这些我每年都要满脸堆笑耐心回答若干遍恨不得把答案刻在脸上的问题；但人民群众的智慧岂是可以小觑的，问题马上与时俱进更新换代，让你觉得没有提前做好功课是多么的愚蠢。&lt;/p&gt;

&lt;h2&gt;高频率常规及大规模杀伤性问题集&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Q：在哪工作？&lt;br/&gt;
A：“在一家互联网企业。”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：你在里边干啥？&lt;br/&gt;
A：这个问题的答案相对随意，“做软件”“搞网站”“修电脑”都可以。提问者的真实意图是过渡到下一小问。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：一个月赚多少钱？&lt;br/&gt;
A：提问者会根据你回答的数字回显不同的表情和语气助词。我感到很后怕，暗自庆幸自己从事并且热爱的行业的平均收入还不错。倘若我当初热爱的是研究蝌蚪文，现在心理素质稍差一点的话恐怕要被这个问题挤兑得神经衰弱。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q: 公司在啥地方？&lt;br/&gt;
A：“在北京。”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：北京，北京好啊，我XXX的XXX的XXX的XXX，也就是你的XXX的XXX的XXX的XXX，就在北京，去了多联系联系，帮得上忙。&lt;br/&gt;
A：“是，是。一定，一定。”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：单位分配住房吗？&lt;br/&gt;
A：每次听到这个问题我都热泪盈眶，想抄送给我虎的HR。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：（这个问题是定制给我爹的）啊呀，现在你的任务就是候着给你娃在北京买房哩么？  &lt;br/&gt;
A：通常这个时候我已经被雷的外焦里嫩了，而更让我脊背冒冷汗的是，往往我爸都会很认真地附和，并真诚地流露出些许忧虑。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q: 有女朋没？&lt;br/&gt;
A：这是个坑。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q: 哥/叔/伯/姨/姑/姐 给你介绍？&lt;br/&gt;
A：这是个更大的坑，连敷衍的余地都没有。“不用了”是比较伤感情的回答，遇到口味重一点的说不定会怀疑你的取向。但如果这时候你胆敢说“好”，那他们就会热情洋溢地为你数说手中的资源，并且马上安排见面时间地点，让你冷汗直流直骂自己嘴欠。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：抓紧啊，明年带回来给咱看个子，你看跟你一样大的那个XXX……  &lt;br/&gt;
A：如果顺利过渡到了这个议题，我都会感到十分庆幸。这说明这个话题终于要结束了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：毕业多久了？&lt;br/&gt;
A：“没多久，差不多半年。”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q: 没考研？&lt;br/&gt;
A：“恩。” 我挺不爱回答这个问题的，因为我觉得“不用考，不想上”是一个过于装逼并且超出他们认知范围的回答。而简单明了的“没考”经常会引出“哦，你XXX的XXX现在在XX大学读研究生……”的话题，这时候我除了作恍然大悟状并发出一个长长的“噢~”之外不知道该怎么接下去。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q: 没想过出国？  &lt;br/&gt;
A：“暂时没这么迫切的需求。” 这和上一小问套路是一样的，但能问出这个问题的提问者一般见识会略高一些，我也会认真地给出一个简洁的答案。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;h2&gt;曲线救国问题集&lt;/h2&gt;

&lt;p&gt;我的父母比较了解我的脾性，害怕我烦，问问题的方式方法比较隐晦。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Q：工作忙吗？觉得这个公司咋样？ &lt;br/&gt;
A：“还行，不太忙。环境挺好的，近几年业绩不好。”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：你们的合同是多少年一签的？&lt;br/&gt;
A：这个问题技术含量很高，不能按字面理解，他们真实想问的是“你的薪水是多久涨一次的”，我一般很诚实地说“据说一年一次吧，具体操作我也不是很清楚。”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：看报纸说你们公司最近比较动荡，要裁员，好多人都走了？&lt;br/&gt;
A：“没那么严重。IT行业本身跳槽挺频繁的，赶上公司不太景气，跳走也正常。” 回答到这里，其实没有完全切题。因为问题的言外之意是“你什么规划？”&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：你们公司女员工多吗？ &lt;br/&gt;
A：“……” 这个问题是state-of-art级别的，反映出我的父母对我的把妹能力的深切忧虑。但事实上，我对此问题的忧虑只停留在中学阶段。那时我除了读书外别无所长，其貌不扬，没有特长，更要命的还是个胖子，对此我感到十分悲观，倒是他们十分淡定。而现在他们却表现出不必要的忧虑，更是令我哭笑不得的。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：你们班过去那个XXX在干吗？发展怎么样？ &lt;br/&gt;
A：一般我会如实回答在某地/某国读书或者在某司工作。至于发展怎么样，当然“不是太清楚”。这个年龄段的父母，攀比心是很强的，不太容易懂得“人生没有最优解”这样的道理。我不可能告诉你他们都弱爆了，也不会简单的认为处在某个位置上的人要比另一处境下的人牛逼。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：你觉得和你们公司的研究生有差距吗？ &lt;br/&gt;
A：“因人而异吧。” 这是上个问题的延续，针对的是我不继续在学校读书的问题。我觉得对一个有自我学习能力与良好阅读习惯的人，遵从自己的判断选择如何接受教育，是一件非常轻松愉快的事情。人在不同的阶段会有不同的需求，我只是简单地顺应了这个需求。有一天需求变了，选择自然就会不一样。我没那么激进，更多的时候我是个优柔寡断的人，只是偶尔勇敢一点点而已。至于差距，有时候我看见个别的高中生，都会感觉差距很大。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;h2&gt;特别想回答但老没人问的问题集&lt;/h2&gt;

&lt;p&gt;看到他们（尤其是我的父母）一直得不到我的点，我也很着急——我的语言表达能力欠佳，方舟子老师和他的朋友们见了肯定会认定我的博客都是我爸写的——所以我觉得把自己关于若干重大问题的观点列出来，有利于他们理解我的思维方式。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Q：价值观问题 &lt;br/&gt;
A：起初我认为这个问题很复杂，我很难说清。但捋了一遍之后发现无非两点：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;公平正义 &lt;br/&gt;
简单来说，公平正义就是机会的公平与程序的正义；就是依法办事、以理服人；就是入学不需要走后门，报税不需要托关系；就是发生矛盾之后不再是家族人脉之间的“秀肌肉”，而是合情合理合法的仲裁……你不用怀疑我看不起小城市的公务员，我很尊重你的工作，我看不起的是不公平的制度和滥用的权力；也不必觉得我抵制某些奶制品是小题大做——我也不觉得一两罐奶能喝伤我久经考验的中国胃，但不愿意放任一个不知悔改的企业三番五次挑战道德底线。
如果把这些观点当真，在现在的社会环境下是很难“体面”地生存的，所以我很庆幸有程序员这个行业，有相对单纯的人际关系，一技傍身的工程师可以凭借技艺得到应有的回报与赞誉。如果让我去做你的职业，即放不下身段，也端不起架子，一定混得很惨。&lt;/li&gt;
&lt;li&gt;自食其力 &lt;br/&gt;
当下的现实环境，确实是要么拼爹，要么拼命。我从小就喜欢和自己较劲并以此为乐，很享受拼命的乐趣。况且真要拼你，你也是受不了的。所以，不用再整天忧心我的安身立命，我的生活不应该也不需要你来买单。就算你省吃俭用好几年，在伟大首都，你也是买不起一个厕所的。拿着钱有空可以去海外走走，看看不一样的生活状态和观念，否则日子该有多无趣。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q：审美观问题&lt;br/&gt;
A：你们这次春节期间对我个人问题极度的热心让我很不适应。但你们显然不了解我二十多年来逐渐形成的对女性的审美观。我的同事孟昕对于女性的外观有一套复杂缜密的评分标准，根据身高三围年龄服饰职业有不同的起评分和技术加分，比如黑丝袜要加5分，学生妹也要加5分等等。&lt;br/&gt;
相比之下，我的外貌审美标准简单的多，只有“顺眼”和“不顺眼”两档，而且及格线偏低。超出标准的锦上添花，好比&lt;a href=&quot;http://zh.wikipedia.org/wiki/%E9%98%BF%E5%A7%86%E8%BE%BE%E5%B0%94%E5%AE%9A%E5%BE%8B&quot; title=&quot;阿姆达尔定律&quot;&gt;Amdahl定律&lt;/a&gt;里对并行分量做的过度优化，对加速比影响不大。而作为瓶颈的“串行分量”，则是比较关键的：我欣赏很多类型的女性，有胆识有韧性的，比如&lt;a href=&quot;http://blog.sina.com.cn/chjguancha&quot; title=&quot;柴静&quot;&gt;柴静&lt;/a&gt;；有独立思考能力的，比如&lt;a href=&quot;http://www.drunkpiano-liuyu.net/&quot; title=&quot;刘瑜&quot;&gt;刘瑜&lt;/a&gt;；有点小才华的，比如&lt;a href=&quot;http://blog.sina.com.cn/jfz&quot; title=&quot;蒋方舟&quot;&gt;蒋方舟&lt;/a&gt;；温和隽永的，比如&lt;a href=&quot;http://zh.wikipedia.org/wiki/%E6%9D%A8%E7%BB%9B&quot; title=&quot;杨绛&quot;&gt;杨绛&lt;/a&gt;；聪明的让我惭愧或者勤奋的让我惭愧的，有一些，不举例；有逻辑讲道理的，比如……发现了记得叫我去围观；有情趣的，比如&lt;a href=&quot;http://www.tianyabook.com/xiandai/fushengliuji/index.htm&quot; title=&quot;浮生六记&quot;&gt;芸娘&lt;/a&gt;；谦逊有礼的，比如周美青……  &lt;br/&gt;
综上所述，喜欢读书、聪明、善良、如果有幽默感就更好了，比如文章如果写得像张佳玮或者马伯庸，那我肯定喜欢死了。所以，如果你们实在着急的不行，那请参考这个标准，满足任何一点都很难得。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Q: 人生规划问题&lt;br/&gt;
A：我不太善于规划人生，而且认为过于程式化的规划丧失了趣味性。而自从学习了Agile之后，更是让我觉得有了理论依据。我觉得人在某一阶段做某件事都是应该根据自身需求而定的，而需求本身需要经过仔细验证以保持一定的连续性。作为一个热爱计算机技术并且略有些文艺的工程师，验证需求的标准相对简单，只需要回答“是否切合自身实际？”“是否对实现自我价值有帮助？”“是否会工作/学习地很愉快？”  至于职业，我最喜欢的品种是程序员、作家、导演和教师。除了第一个正在做之外，其他的目前看来都不太靠谱。放心，我是个非常有理性而且非常胆小的人，对自己的斤两拿捏的比较准，不太可能头脑一热就出什么昏招。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

</content>
 </entry>
 
 <entry>
   <title>十点钟开始</title>
   <link href="http://blog.tomsheep.net/2012/01/14/begin-at-ten"/>
   <updated>2012-01-14T08:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2012/01/14/begin-at-ten</id>
   <content type="html">&lt;p&gt;年会很精彩，出乎我的意料。作为观众，我实实在在地被同事们的表演娱乐到了，但这同时让我有些难过——自己曾经不以为然或不屑一顾的东西被别人做的风生水起，在我的成长经历中并不新鲜，但每一次都会让我很震撼。每每在为他们挑起拇指的同时，也会暗地里把中指送给自己。&lt;/p&gt;

&lt;p&gt;马三立和王凤山早年有一段脍炙人口的相声《十点钟开始》，后来听得多了我都不好意思笑了，因为觉得自己受到了讽刺。好高骛远眼高手低是我众多臭毛病中最臭的几个之一，也是多年难以治愈的顽疾。从小我所接受的或主动或被动的教育中，role model都是些不食人间烟火、牛逼到快飞起来的不正常人类，他们每天思考的问题一定是原子弹而不能是茶叶蛋，仿佛说出“茶叶蛋”三个字就是一种亵渎。就连武侠小说里也到处都是忧国忧民并且坐拥大量来路不明现金的无业游民，他们打群架的借口也通常十分冠冕堂皇。这给我造成了很不好影响，在相当长的一段时间里，我坚持把一些具体而微的事情视作无意义的，关注它们变成一种掉价的行为。这条规则的无耻之处在于，我可以在“不屑”与“不能”的判定上上下其手，虚伪地维护一种莫名其妙的“尊严”。&lt;/p&gt;

&lt;p&gt;大学里阴差阳错地读了工科，接了不少地气，是大有裨益的。但积恶难改，经常把事情做得恶心到自己。做过大大小小不少项目，败多胜少，多数都是以“没意义、没意思”为由主动放弃的。这些经历有着类似的脚本：从一时兴起到遭遇困难，再到热情减退，再到自我怀疑，再到寻求台阶，最后全身而退。作为一个有追求的演员，我觉得于情于理都不应该再接这种狗血烂片了。&lt;/p&gt;

&lt;p&gt;年会中精彩的演出让我艳羡不已，我再次拷问自己，你是否像他们一样积极尝试？是否竭尽全力？是否敢于并勇于承担责任与后果？&lt;/p&gt;

&lt;p&gt;尽管每天仍旧嘻嘻哈哈，但我无时不深切地为自己以及团队的状态而担忧。执行力下降、沟通受阻、不被信任、被边缘化……我想大家嘴上不愿明说，心里应该一样忧虑。年会上Chen路过我们这桌时说“哦，我的老朋友们……”，虽然是新人，但我心中却顿时五味杂陈。我不希望为我冗长的失败记录添加新的案例，但更不希望因为没有尽力而为而留下更多的遗憾。作为团队一员，我有责任竭尽全力做到更好。这样，当回首往事的时候，就不会因为虚度年华而悔恨，也不会因为碌碌无为而羞耻；在临死……啊不是，临走的时候，就能够说：“我的这一段岁月，都已经献给世界上最三俗的事业——为Y! Messenger的解放而斗争。”&lt;/p&gt;

&lt;h2&gt;后记&lt;/h2&gt;

&lt;p&gt;这些思考是这场年会带给我的比奖品更有意义的礼物——当然，奖品也是不能忘的。尤其是抽到大奖的某些菜，你知道你需要做什么了吧？&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Goodbye 2011, Hello 2012</title>
   <link href="http://blog.tomsheep.net/2011/12/29/goodbye-2011"/>
   <updated>2011-12-29T23:13:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/12/29/goodbye-2011</id>
   <content type="html">&lt;p&gt;年初的时候我写博客语气凝重地说这一年对我很关键，这基本是一句废话，好像政府的年度工作计划，没有哪一年是不继往开来、不至关重要的。而我们这一代人普遍没有遭受过真正的考验，把气氛刻意搞得悲壮一点可以在一定程度上对自己起到一个鞭策的作用。如今眼看日历就要翻篇儿，又到了清算……不是，盘点的时候了。&lt;/p&gt;

&lt;h2&gt;Goodbye, 2011&lt;/h2&gt;

&lt;p&gt;即便是按照我一贯吹毛求疵的标准，我也觉得自己的2011年非常顺利并且收获良多。从毕业到工作，进展都很平稳，生活也没有和我开太多的玩笑，有时甚至还能有些小运气。能在这个时候心情愉快地打开Evernote、博客与豆瓣，看看这一年自己都发生了那些变化，本身就是一件值得纪念的事情。&lt;/p&gt;

&lt;h3&gt;技术转型&lt;/h3&gt;

&lt;p&gt;其实没有什么好转的，因为我自问没有什么特长，短板倒是很多。年初集中精力补习了计算机网络基础，成就感很强，好像习武讲究的练“罩门”，护住了弱点，无形中功力就精进了一层。作为一个曾经名义上的“系统研究人员”，我一直很惭愧，觉得自己从来都是个外行。现在加入互联网行业，从事端到端应用研发，更是白手起家了。因为本身就没什么积累，所以转型很“顺利”(XD)。我一贯也还算勤勉，所以也不至于刚下水就被拍死在沙滩上——我过去的导师陈海波老师曾经在邮件里用“self-driven”来描述我，我觉得是我至今得到的最中肯也是最受用的评价。基础强弱、天赋优劣都不是关键，不懂的可以学会，一知半解的可以变得精通，领域之间的壁垒，也显得不那么重要了。不过据说坏人总是比好人勤奋，从这个标准出发，我觉得我应该不是一个好人。所以，以后遇到的姑娘们，不要给我发卡了。&lt;/p&gt;

&lt;h3&gt;毕业&lt;/h3&gt;

&lt;p&gt;毕业总能勾起很多回忆，引发诸多感慨，像&lt;a href=&quot;http://blog.tomsheep.net/once_upon_a_time_in_fudan&quot;&gt;这些&lt;/a&gt;，还有&lt;a href=&quot;http://blog.tomsheep.net/i-miss-you-1&quot;&gt;这些&lt;/a&gt;，或戏谑，或伤感，或苦大仇深翻身农奴把歌唱，或搔首弄姿小资青年无病呻吟，总之，我毕业了。我常想大学带给我了些什么，每一次得到的答案都不一样：有时候是一门我热爱的技艺，有时候是一群出色的同伴，有时候是独立思考和自我学习的习惯……&lt;/p&gt;

&lt;h3&gt;Yahoo！&lt;/h3&gt;

&lt;p&gt;加入Yahoo! Messenger是我今年诸多的好运气之一。我第一次如此顺利地融入了一个团队，打消了我很多担忧。豪哥总有挖不完的坑，姜大师总能一眼看出tab和空格的区别，陈远总有新奇的东西和你分享，大凡一有机会就会秀一下空手劈砖的绝技，朱颢和孟昕总能在吃饭的路上实时播报几点钟方向有美女，并且潇洒地大手一挥，“撒下一万分”，神气活像“排出四枚大钱”的孔乙己……在一个江湖气很浓的团队中工作对我而言是很有帮助的，团队目前处在低谷，希望在明年能够逐渐恢复元气，在胜利的道路上越走越远。&lt;/p&gt;

&lt;h3&gt;在北京&lt;/h3&gt;

&lt;p&gt;北京和上海的差别，比吃大蒜和喝咖啡要复杂的多。技术地讲，我更喜欢上海并且可以列出一二三四具体的细节以供对比。但有趣的是在北京我却过得远比在上海时“舒适”，尽管交通很挤、空气很差、吃的很脏，每天心情却还不错，后来我觉得这和城市无关，只是我的心态变了。大脑其实是不怎么讲民主的，即便是你的胃和肺都表示抗议的时候。&lt;/p&gt;

&lt;h3&gt;读书&lt;/h3&gt;

&lt;p&gt;昨天在微博上看到热门的话题是推荐2011年读过的好书，我随便总结了一下：年初为了恶补网络基础，看了好多大部头《数据通信与网络》《Computer Networks and Internets》《TCP/IP详解第一卷》等等，质量都不错；《Unix编程艺术》和《浪潮之巅》都起到了开阔眼界的作用；文艺青年系列的是《北京法源寺》、《小径分岔的花园》、《月亮和六便士》以及《1988》；休闲娱乐系印象较深的是《三体》三部曲；社会政治方面比较好的是钱穆的《中国历代政治得失》和林达的“近距离看美国”系列四部——林达的书是很有启蒙价值的，在这个为了到底是要“暴力革命”还是“温和改良”吵得不可开交的冬天，讽刺的是，公平、正义、法治、自由这些最基本的诉求却远远没有成为社会共识。好像两个乞丐在争论有了鸡之后到底是油焖着吃好还是清蒸了吃好，而更多的乞丐困惑的可能是“你们说的‘鸡’到底是个什么东西？”&lt;/p&gt;

&lt;h2&gt;Hello, 2012&lt;/h2&gt;

&lt;p&gt;当然，这又将是继往开来的一年。在这里我愿意代表我自己许下一些具体而微的心愿：&lt;/p&gt;

&lt;h3&gt;职业发展&lt;/h3&gt;

&lt;p&gt;其实一直很明确，在可以预见的将来，我都会是一名工程师，不断鞭策自己变得更出色、更能委以重任。这是一份吸引我的事业，如果哪一天我对技术失去了热情，我也不会做过多留恋，到时一定会有我认为更有趣的事情。&lt;/p&gt;

&lt;h3&gt;教会我爸熟练地使用互联网&lt;/h3&gt;

&lt;p&gt;我的父母其实并不知道我确切的职业是什么，他们对“软件”和“互联网”的概念是模糊的。这一点我很歉疚，因为数年来我没有主动将我认识到的世界介绍给他们。中国东西部失衡以及城乡二元的畸形发展造成了事实上的文化鸿沟，不同生活环境和教育背景下的人之间很难有共同语言。中国互联网经过十多年发展，尽管先天不足而且后天畸形，但已经形成一个新的社会——至少是一个有进步意义的平台。把我接触到的互联网介绍给他，是我能想到的填补文化代沟的最便捷的方式了。但你知道这并不容易，目前我爸的互联网世界基本是这样的：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;用360浏览器打开hao123，跳到某股票忽悠专栏。&lt;/li&gt;
&lt;li&gt;打开PPS/土豆, 观看错过的央视一套8点档的电视剧。&lt;/li&gt;
&lt;li&gt;在安装完毕并且账号已注册好的情况下，登陆QQ游戏玩牌。&lt;/li&gt;
&lt;li&gt;能记住我博客的地址，隔三差五刷一下。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;你们看，其实是有难度的。&lt;/p&gt;

&lt;h3&gt;参与公益&lt;/h3&gt;

&lt;p&gt;这个要求很低。&lt;/p&gt;

&lt;h3&gt;Keep fit&lt;/h3&gt;

&lt;p&gt;有难度。&lt;/p&gt;

&lt;h3&gt;获得一项欠缺的技能&lt;/h3&gt;

&lt;p&gt;可能是英文、可能是一项技术、可能是一门乐器，不管是什么，选定后希望能够坚持做到。就像RPG迷宫里的箱子，里面是什么其实是次要的，玩家看重的是找箱子的快感。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>东厂仅一位</title>
   <link href="http://blog.tomsheep.net/2011/12/23/the-last-loyalist"/>
   <updated>2011-12-23T23:18:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/12/23/the-last-loyalist</id>
   <content type="html">&lt;p&gt;从保利剧院出来，我是带着一点遗憾的。其实相声瓦舍的表演已经足够精彩，现场效果也不错，只是我一向比较矫情，看什么东西都总觉得可以更好。&lt;/p&gt;

&lt;p&gt;《东厂仅一位》本来是十年前台湾相声瓦舍的旧作，以历史题材针砭时弊，对公民道德和政治纷争都有很精彩的反讽，段子间的关系组织的也比较巧妙，嬉笑怒骂的同时竟然还小文艺了一下——文艺青年和二逼青年之间的度实在很难把握，往往你觉得自己做了个很酷的feature，很有可能会被多数人认为是个渣到家的bug。能拿捏得准确，是一件很有技术含量的事情。这次改编后来大陆演出，我是比较期待的——其实不好说是期待，更多是好奇，因为在审查期比创作期还要长的现实情况下，你还能对一部文艺作品有什么期待。我更多的是好奇编导到底能聪明到什么程度，在小心避开雷区的前提下，还能尽量保持作品的内涵。&lt;/p&gt;

&lt;p&gt;上半场的演出是远远超出我的预期的，尽管都是旧作的翻新，但翻得实在是精彩，换掉引子后编剧的路数清晰依旧，可以看出是做了一番功课的，对大陆观众把握得比较到位——舞台剧比电影更难的地方是成功与否与现场观众有很大的关系。包袱节奏很好，对大家已经熟知的桥段，处理的也很有分寸，没有出现刻意洒狗血的情况。但遗憾的是，在吊起了我很大胃口之后，下半场显得过于平庸，匆匆接了两个比较经典却不太相关的段子，前半场编织出的脉络被抛弃了，改编的亮点也明显减少，让整场表演变成了热闹有余但回味不足的喜剧拼盘。&lt;/p&gt;

&lt;p&gt;我觉得这应该是一个很无奈的选择，既要让观众满意，还要让不想让观众太满意的人满意，总是很掣肘的。选择用既经典又安全的桥段拼接，是比较稳妥的处理方法。步子迈的太大，容易扯着蛋。如果10年后，这部戏还能再次翻拍来北京重演，我希望看到更有力量的作品。&lt;/p&gt;

&lt;p&gt;整体而言，这次在保利剧院的观感是比较满意的，对得起票价以及推迟两天回家的等待。也推荐北京、上海两地的朋友有兴趣前去现场观看。另外本场的观众也比较配合演出，这也让我相当欣慰：因为每次观看各种各样的演出时，如果其他观众有不文明的举止，我都会无端地感到十分羞愧与焦虑，仿佛犯错的是自己——其实这是有道理的，试想，如果我是来自CSDN的程序员，此刻最大的念头，除了掐死做用户认证的同事外，剩下的恐怕也是悲愤与羞愧了吧。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Reading All The Way</title>
   <link href="http://blog.tomsheep.net/2011/12/22/reading-all-the-way"/>
   <updated>2011-12-22T00:12:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/12/22/reading-all-the-way</id>
   <content type="html">&lt;p&gt;吃了这么久地沟油，还是头一次有不良反应——长假第一天从早上开始就上吐下泻，年假直接休成了病假。挨到中午想想还是出去活动活动促进消化，沐浴在帝都营养丰富的空气中，以毒攻毒说不定有意想不到的疗效。&lt;/p&gt;

&lt;p&gt;可能是想让这次出行更加具有探险性质，我决定找找周围的书店。这其实并不容易，因为现在开一家实体书店实在是个不赚钱的买卖，维持生计很难，硕果仅存的一些也越来越像白色恐怖时期我党的地下组织，没有点儿反特经验还真不容易发现。这和萎靡的市场需求有很大关系，我已经算是仍然比较喜欢读书的一小撮，但很惭愧，事实上接触互联网之后我很少买书。大学期间热衷于收集各种电子书，毕业时挥一挥衣袖，带走数百G的硬盘。阅读体验也越来越多的围绕电子设备展开——低成本毕竟是十分诱人的。仔细算来，我应该欠这些书的作者很多钱。&lt;/p&gt;

&lt;p&gt;在百度地图的指引下，我先后来到了两处被标为书店的地方，结果发现其中之一是个干洗店，而另一处则十分诡异，我拿端着手机来来回回巡逻了好几次，愣是没有发现有任何建筑物存在。后来几番周折，终于在一家打印店的地下一层找到了一个不大的书店，里面书的种类相对单一，多是一些口碑还不错的畅销书。在我停留的半个小时内，店里只有我一个读者，我觉得应该照顾一下生意，就根据标题和作者选了几本看上去合我胃口的。临走时随口问店主平时生意怎么样，他意味深长地说，还行。&lt;/p&gt;

&lt;p&gt;买来的书中其中一本是韩寒08年出版的《杂的文》，收录的基本是他06-07年的博客文章，平心而论，质量不高。而且作为一个从他出道就开始关注这个作家的读者，可以明显地发现在“韩寒”这个品牌下，以时间划分，是存在多个不同形象的。而《杂的文》所对应的时代，给我的感觉应该是韩寒作品无论文笔还是内容都比较差的一个阶段——既缺乏早期的幽默与灵气，也较少能看到后来为公众所熟知的睿智和启蒙精神。博文主题主要是个人生活的所见所感，还有一些“论战”的遗迹，针对的对象无非是白桦、郑钧、高晓松、郭敬明、赵丽华以及作协、央视等等——看上去似乎是把自己定位成了畅销书作者兼娱乐名人。文章风格十分直率，用词也不太讲究，观点的表达比较激烈，远没有后来文字和逻辑上的驾轻就熟之感。而08年中期以后的韩寒似乎有了一个不小的自我突破，博客也不再屑于停留在过嘴瘾式的个性表达上，更多地表现出公民意识和社会责任感。杂文的质量也越来越高，比较注意文章的逻辑与节奏——这对于一个有才气的作家来说其实不算很难。在读者看来，这样的转变是让人惊喜的。&lt;/p&gt;

&lt;p&gt;我2000年初开始读他的小说《三重门》，受了很深的影响。在初中之前我都不怎么喜欢读书，因为看上去很无趣，比起街机、PS2、电脑游戏来，简直乏味的一无是处。作文尤其头疼，每次都像便秘一样痛苦，个别时候还需要我妈来代笔（我还记得她在一篇写动物园的作文里用了一个成语“昭之于众”，被语文老师批了一个“好”）。韩寒的小说在当时其实起到了非常好的启蒙作用，让我突然发现文章居然可以写得这么有趣，文字可以被这么翻来覆去的把玩。后来他的作品我也基本上都拜读过，个人感觉水准一直不温不火，无法留下深刻印象，多数作品的主人公性格与经历都雷同，叙事脉络十分零散与随意，多表现出荒诞与不羁的风格，谈不到有太多“主题”一类的东西（也许是他不屑为的），似乎很多作品是由幽默感和文字游戏驱动的。在他的十余部作品中，给我印象最深的仍然是《三重门》与《长安乱》，也是我个人认为最经得起反复阅读的。《三重门》虽然是十多岁时的作品，却给人感觉相当老成。而《长安乱》过于特殊，让人觉得是基因突变的产品，和同时期的作品有相当大的反差。最近的《1988》质量也不错，不是十分出彩，但能感觉到韩寒在“小说”这个题材的把握上有很大进步。&lt;/p&gt;

&lt;p&gt;能看着一个作家的作品与其一同成长，是一件非常难得的事情。翻阅他不同时期的作品，就像回顾自己每个阶段的人生经历一样。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Think Async</title>
   <link href="http://blog.tomsheep.net/2011/12/16/think-async"/>
   <updated>2011-12-16T22:30:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/12/16/think-async</id>
   <content type="html">&lt;p&gt;前两天QE找到我，请我帮助完成这样一个需求：将项目框架中基于Ajax请求的JavaScript“跨页面调用”封装成同步形式，以便于写出“符合以往编程经验”的automation test。其中的核心在于将异步的“回调”转换为同步的函数调用。&lt;/p&gt;

&lt;h2&gt;背景&lt;/h2&gt;

&lt;p&gt;程序目前的架构类似于一个“承载多个Web页面的浏览器”，程序逻辑分散在各个页面中，使用JavaScript实现。不同页面间的通讯由“浏览器”转发，表现形式为异步的消息通知。举例说明：如果有这样一个transaction，页面A向页面B发送消息“ping”，期待页面B对消息进行处理，完成后向A发送消息“pong”，页面A受到“pong”后执行另一段逻辑。实现起来是这样的：&lt;/p&gt;

&lt;p&gt;页面A：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;step1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// 注册事件 &amp;quot;pong&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;pong&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;step2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// 通知 B&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;ping&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;step2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;removeListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;pong&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;step2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// resume working flow...&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// result就是B发回的结果&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// 触发整个流程&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;step1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;页面B：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;    
    &lt;span class=&quot;c1&quot;&gt;// 注册事件 &amp;quot;ping&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;ping&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;processPing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;processPing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// do some stuff...&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// 通知 A&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;pong&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这样实现问题在于，程序逻辑被回调函数拆得四分五裂，对与automation test这样需要清晰执行流的应用场景来说，是难以接受的。QE比较喜欢的同步写法是这样的：&lt;/p&gt;

&lt;p&gt;页面A:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;flow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// step 1&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;ping&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// step 2&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;doSomethingWithResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;nx&quot;&gt;flow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;页面B行为大致不变略去不写。这里的区别在于，step1中请求页面B并“同步”等待结果，然后恢复执行流。&lt;/p&gt;

&lt;h2&gt;尝试1： Fake sleep&lt;/h2&gt;

&lt;p&gt;一开始我没有太当回事，想当然认为按照C或者Java的编程经验，无非是一个“睡眠/唤醒”的问题，于是进行了这样的尝试：&lt;/p&gt;

&lt;p&gt;添加工具函数：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sleepService&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;http://localhost:1234?timeout=&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;msec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;xhr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;XMLHTTPRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// 利用XHR的同步调用&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;xhr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;GET&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sleepService&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;xhr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;transaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;targetPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;eventType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;waitFor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// self 即为调用者&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;retValue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            
            &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;retValue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;removeListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;// 为waitFor类型消息注册监听器&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addLisener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;waitFor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// 向targetPage发消息&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;targetPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eventType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// 循环等待&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;retValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// 每100毫秒检查一次retValue&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// 跳出循环&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;retValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;               
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这里的sleep调了一个webservice，是因为JavaScript生来就是单线程的，没有设计sleep/wait这样的东西，这里又不想用暴力的while循环来吃光CPU，所以试图借用XHR提供的同步方法调用来实现。Webservice很容易实现，就是收到连接，等待指定的时间然后释放连接：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;http&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;http&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;url&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        
    &lt;span class=&quot;nx&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// 读取参数&lt;/span&gt;
        &lt;span class=&quot;kr&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;parseInt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// 时间到，释放连接&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;writeHead&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;text/plain&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        
    &lt;span class=&quot;p&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;listen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1234&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;有了这两个工具之后，理想的执行流是:&lt;/p&gt;

&lt;p&gt;页面A：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;    
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;flow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// step 1&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;transaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;ping&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;pong&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// step 2&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;doSomethingWithResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;nx&quot;&gt;flow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;页面B仍然基本不变。看上去好像可行，但很遗憾，太simple太naive了，完全没有理解JavaScript。问题出在哪里呢？就在工具函数transaction最后的while循环等待上。事实上，这里永远不可能跳出循环，又是因为JavaScript是单线程的，而且执行单元最小粒度为一个function，在这个函数没有返回前，其他任何函数是无法“抢占”的，也就是说我们注册的callback在循环跳出前永远不会被执行，而讽刺的是循环跳出的前提是该callback被调用，这就成了一个“鸡生蛋蛋生鸡”的问题。所以，此路不通。&lt;/p&gt;

&lt;h2&gt;尝试2：Backend支持&lt;/h2&gt;

&lt;p&gt;看来一个“纯JavaScript”的同步实现是不太可行了，那就寻求“浏览器”——也就是我们的应用程序backend的帮助吧，即把刚才transaction工具改变成两个JavaScript与“浏览器”的交互接口，&lt;code&gt;ping(targetPage, eventType, args)&lt;/code&gt;，和&lt;code&gt;pong(transactionId, result)&lt;/code&gt;。他们的行为是：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;让“浏览器”将eventType消息转发给targetPage，后台生成一个transactionID，这个ID也是随着args一起发给targetPage。“浏览器”不马上释放调用者的链接，而是以transaction ID为键值保存这个连接。&lt;/li&gt;
&lt;li&gt;当targetPage处理完消息，调用pong返回结果。浏览器查找对应transaction ID的连接，把结果交还给transaction的发起者。&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;这样做看上去应该是行的通的，无非是实现的复杂并且丑陋一些而已。然而，又很遗憾，这个尝试也没能成功。瓶颈出在了我们“浏览器”的架构上。由于我们的“浏览器”目前是一个单进程模型，而且只有一个UI线程。不同页面的rendering都是跑在这个线程里的。而且由于不可抗因素的限制，在目前的引擎下，页面中的JavaScript（Web Worker另当别论）必须运行在UI线程里。这样就导致页面A在调用同步接口ping的时候，事实上会hang住整个UI线程，那么，页面B里的逻辑也就无从执行了。&lt;/p&gt;

&lt;h2&gt;尝试3：控制流伪同步&lt;/h2&gt;

&lt;p&gt;经过这样的折腾后，我终于放弃了在JavaScript里实现“&lt;strong&gt;同步transaction&lt;/strong&gt;”这样的逆天行为。在勉强说服QE接受“&lt;strong&gt;使用异步机制模拟同步控制流&lt;/strong&gt;”这样的解决方案之后，这个问题终于变得没那么复杂了。目前有很多完成类似工作的JS工具库，原理各有不同，我首先想到的是&lt;a href=&quot;http://blog.zhaojie.me&quot;&gt;老赵&lt;/a&gt;同志整天在微博上宣传的&lt;a href=&quot;https://github.com/Jeffreyzhao/jscex&quot;&gt;Jscex&lt;/a&gt;，扫了一眼介绍后被震住了，直觉告诉我太heavy了，在没有详细了解到底背后干了些啥之前还是别自找麻烦。为了尽快摆脱这个问题，选用简洁易懂的&lt;a href=&quot;https://github.com/willconant/flow-js&quot;&gt;flow-js&lt;/a&gt;交出一个workaround：&lt;/p&gt;

&lt;p&gt;工具：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;transaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;targetPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;eventType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;waitFor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
         &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
            
            &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;removeListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;// call back for flow-js&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;    
            &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;// 为waitFor类型消息注册监听器&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addLisener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;waitFor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// 向targetPage发消息&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;targetPage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;eventType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;执行流：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;case1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;flow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;define&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// step 1            &lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;transaction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;ping&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;pong&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;           
        &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// step 2&lt;/span&gt;
            &lt;span class=&quot;nx&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;bar&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;            
        &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// step 3&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// done&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;nx&quot;&gt;case1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;现在，工作流被定义为case1，&lt;code&gt;flow.define&lt;/code&gt;接受任意多个函数作为参数，这些函数即为这个工作流的不同步骤，后一个步骤依赖于前一步的返回值。步骤之间的分界点就是“异步任务”，比如，这里的transaction，但注意这次transaction里多了一个参数next，flow传实参的时候传的是this，这是&lt;a href=&quot;https://github.com/willconant/flow-js&quot;&gt;flow-js&lt;/a&gt;里做的封装，有点&lt;a href=&quot;http://en.wikipedia.org/wiki/Call-with-current-continuation&quot;&gt;call/cc&lt;/a&gt;的意思，有机会再详细说明。现在只要知道当异步工作完成后，是通过这个回调来使整个flow继续进行的。在case1里我多加了一个step，是为了说明一般地用&lt;a href=&quot;https://github.com/willconant/flow-js&quot;&gt;flow-js&lt;/a&gt;写一个异步任务的方式。foo的实现如下：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;javascript&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;setTimeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;foobar&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这样就把异步任务“嵌入”到了工作流当中。&lt;/p&gt;

&lt;h2&gt;Future Work&lt;/h2&gt;

&lt;p&gt;当然，这样虽然把工作流汇集到了一个貌似同步的序列里，但写法上仍然不是非常直观，而且“步骤”是被异步任务而非逻辑需要分割开来的，多少有些反直觉。在接下来一段时间里，我会持续关注这个问题，并把学习经验分享在这里和感兴趣的同学讨论。初步估计涉及的内容会涵盖回调，&lt;a href=&quot;https://github.com/kriszyp/node-promise&quot;&gt;promise&lt;/a&gt;，&lt;a href=&quot;http://en.wikipedia.org/wiki/Coroutine&quot;&gt;coroutine&lt;/a&gt;, &lt;a href=&quot;http://en.wikipedia.org/wiki/Call-with-current-continuation&quot;&gt;call/cc&lt;/a&gt;, &lt;a href=&quot;http://en.wikipedia.org/wiki/Continuation_passing_style&quot;&gt;CPS&lt;/a&gt;, &lt;a href=&quot;&amp;lt;http://en.wikipedia.org/wiki/Monad_(functional_programming)&gt;&quot;&gt;Monad&lt;/a&gt;等等，涉及的实现大致会有&lt;a href=&quot;https://github.com/willconant/flow-js&quot;&gt;flow-js&lt;/a&gt;, &lt;a href=&quot;https://github.com/creationix/experiments/blob/master/step.js&quot;&gt;Step&lt;/a&gt;, &lt;a href=&quot;http://github.com/creationix/conductor&quot;&gt;conductor&lt;/a&gt;, &lt;a href=&quot;https://github.com/randallmorey/javascript-fibers&quot;&gt;javascript-fibers&lt;/a&gt;, &lt;a href=&quot;https://github.com/Jeffreyzhao/jscex&quot;&gt;Jscex&lt;/a&gt;等等。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>刚刚好</title>
   <link href="http://blog.tomsheep.net/2011/12/05/just-in-time"/>
   <updated>2011-12-05T00:10:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/12/05/just-in-time</id>
   <content type="html">&lt;p&gt;最近一个多月有些用力过猛，打乱了入职以来稳定的节奏，直接后果是十分疲惫，漫长的地铁上也没有了看书的兴致。昨天和大学同学吃饭，她说学业很紧张，每一天都感觉过的很慢，我则表示自己的情况恰好相反，因为每周一一起吃饭时我和我的同事孟昕都会不约而同地感叹:“naona，又快到周末了。”而且在北京和在上海差别不大，除了空气差点儿公车挤点儿街道脏点儿外基本没什么区别，无非是换了个地方看书写程序而已，站在office里向窗外一眼望去，全国的城市都一个模样，鬼知道这是在哪儿。&lt;/p&gt;

&lt;p&gt;其实在互联网公司的生活还算有趣，自由度也相对较大，以至于时光飞逝也浑然不觉。更有趣的是我加入的团队很特殊，特殊到连我这样内向矜持的闷骚青年也很快被同化得臭不要脸起来，一有得瑟的机会便迫不及待地在yahoo messenger的状态栏里更新foosball和实况的“骄人战绩”。这样匪气十足团队让我感到前所未有的舒适。让人不太适应的是过于频繁的会议，思路总会被无奈地打断，转而进入漫长的讨论。“大家都是聪明人，谁也没办法轻易说服谁。”几个月里深深领教了这样的棘手的状况，讨论每每无疾而终，时日一长总会让人感到身心俱疲。所幸大家还都意志顽强，耐着性子愈挫愈勇。我也渐渐习惯在不同的环境下找到不同的姿态，无论顺境逆境都尽量挖掘可供学习的经验。&lt;/p&gt;

&lt;p&gt;最近想加速工作的进程，发力过猛，反而节奏紊乱，得不偿失。下午外出走走，呼吸一下不怎么新鲜的空气。顺手买了一本好多年不看的《大众软件》，喝茶时顺手翻翻，发现已经是移动应用和各种怪力乱神的网游的天下，感慨真是历史洪流浩浩汤汤顺之者昌逆之者亡。抬头发现不远处坐着一挺有气质的女孩，翻看一本看上去像模像样的书，顿时后悔怎么脑抽买了一这么没品的杂志。走到天通苑万达，决定去看场电影。这个地方我经常来，但奇怪的是不管什么时候观众都不多，完全无法从上座率看出一部影片的受欢迎程度。服务生问我要看啥，我头脑一热说我要看《鸿门宴》，我都觉得不可思议，因为旁边的海报烂俗到简直已经宣示这一个烂片胚子。结果很惊喜，因为发现这是类似题材的国产片里少有的能让人看得下去的影片，在今年众多烂片的印衬下形象甚至顿时光辉了起来。遗憾的是感情戏依旧很雷人，如果砍掉，应该效果更好。&lt;/p&gt;

&lt;p&gt;走出影院已经大雾弥漫，想到明天又是一周的开始，许诺全组的code base还没有组织好，隐隐担忧又有点拖延症的苗头了。还好一轮长假就在眼前，来得恰到好处。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>将复何及</title>
   <link href="http://blog.tomsheep.net/2011/10/18/too-late-to-regret"/>
   <updated>2011-10-18T00:10:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/10/18/too-late-to-regret</id>
   <content type="html">&lt;p&gt;从上海回来后看到大师的文章，想起自己数周前答应的约稿还没有完成，向刘斐敏同学道歉。工作已经有几个月了，期间很少写文章，和紧凑的生活节奏有关系，但更主要的原因是我发现和嬉笑怒骂的文字不同，把一些严肃的思考有条理的写出来是一件很有难度的事情。我一直希望能谈一些有关价值观的话题，和现在的朋友分享我的一些想法，同时结交更多志同道合的朋友，但都因为能力不够而从未如愿。希望这篇拙文是一个好的开始。&lt;/p&gt;

&lt;p&gt;“不只是公司，每个人都需要有自己的品牌。”我老板的老板有一次这样说。他所说的品牌是一个人在群体中赖以生存的“形象资产”，比如乔布斯几乎成了“个性而优雅的产品设计”的代名词、韩乔生总是伴随着让人啼笑皆非的解说段子出现、而提到冠希哥，你首先想到的就会是精湛的摄影技术。我时常会留意自己在周围人的眼中拥有怎样的“品牌”：在我的大学时代，那大概会是“勤奋的书呆子”（就像&lt;a href=&quot;http://hackerzhou.me/2011/10/essay.html&quot;&gt;hackerzhou&lt;/a&gt;的描述），这样的评价基本上是客观的——尽管我更希望拥有“阳光幽默聪明帅气正义的化身月亮的使者”一类的标签，而那就脱离了实际。&lt;/p&gt;

&lt;p&gt;一个人的品牌从侧面反映出他／她的行为准则和价值取向。有时候我觉得自己生错了时代，理由是我是一个很传统的人——当然不是说我是一个封建遗老，而是我的价值观念在很大程度上和传统文人“修齐治平”的个人理想是相契合的：通过个人修养的提升与个人价值的实现推动群体乃至社会的良性发展。我相信即便在当下，这样的观念也可以被普遍认同并成为社会进步的动力。毕业时和同学聊天，说起各自的终极理想，我记得当时自己的回答是“先得发达，然后做教育”。“发达”经常以“财富”为一种直观的衡量标准，但内涵并不止于此。如果非要找出一个更通俗的近义词，我觉得那应该是“影响力”——个人价值受到普遍认同的标志。以“教育”为归宿，则是信奉“社会的变革是自下而上的”观念的体现——每一个个体的行为都会对其所在的群体产生影响，当这一力量累积到不可忽略时，”things change.” 而教育即是传道，是通过个性影响群体最有效的途径。&lt;/p&gt;

&lt;p&gt;通过提升修养与增广学识来实现个体价值，是一个古老的话题。诸葛亮在临终前给儿子有一封简短的家书，很得要领。“夫君子之行，静以修身，俭以养德。非淡泊无以明志，非宁静无以致远。夫学须静也，才须学也。非学无以广才，非志无以成学。淫慢则不能励精，险躁则不能怡性。年与时驰，意与日去，遂成枯落，多不接世，悲守穷庐，将复何及？”这段话其实包含了三层意思，首先是“君子是什么样的”，然后是“这些品质是如何习得的”，最后，诸葛老先生觉得“君子之行”这根胡萝卜还得要大棒的配合才能让少不更事的小诸葛乖乖就范，于是便有最后“悲守穷庐，将复何及”苦口婆心的劝诫了——意思相当于“（不按爹说的做，）到时候买不起房，后悔哪里来得及呢？”（XD）&lt;/p&gt;

&lt;p&gt;这里核心的观点是，正确得法的学习是改变一个人的根本途径。而学习的方式与内容，则随着时代的发展而发生变化，具体到每一个人，就又不一而足了。我是一个不大有天分的程序员，我所能接受的学习方式中，读书是最有效的一种。如果读书是一剂药品，那它的疗效一栏里应该写的是获取技能、增广见识、了解世界、认知自我等等，而副作用也很容易发现，如果你愿意认识我的话。有一次乘出租车回复旦，司机用了半个小时的时间向我兜售“读书无用”的观点，他认为这是一个拼爹的时代，“读书改变命运”早已行不通，是骗人的把戏。我一时无法反驳，因为他说的是事实。读书作为借由改变一个人阶级属性与生活水平的途径，已经变得越来越窄，不再是受人追捧的成功模式，这是时代背景所决定的。但是，从另一个层面看，读书所带来的视角的迁移、兴趣的更替、价值观的变化，却切切实实地在改变一个人的生活方式与行为准则，从而改变了他/她的“命运”。这也是我热衷于此的主要原因。&lt;/p&gt;

&lt;p&gt;有很多人问我你年轻时不干这不干那韶华将逝岂不遗憾？我真不觉得遗憾——就像刘翔不会因为没拿过NBA总冠军而遗憾一样。正如上面所说，不同的价值观催生出不同的人生理想，不同的人生理想驱动着不同的个人行为。和每个人一样，我体验了很多东西，并且在不断尝试新的挑战，这些经历对我而言都是宝贵的财富。可能我们并不同路，但仍可以在各自的山头上遥相呼应。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>PyV8试用</title>
   <link href="http://blog.tomsheep.net/2011/08/07/pyv8"/>
   <updated>2011-08-07T23:03:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/08/07/pyv8</id>
   <content type="html">&lt;p&gt;v8是Chromium中内嵌的javascript引擎，号称跑的最快，拿着天文望远镜也找不着对手。它为应用程序员提供了接口，可以方便地将v8嵌入到自己的程序中，订制出自己的应用，使native程序和javascript互动，当下炙手可热的nodejs就是一个比较成功的应用。&lt;/p&gt;

&lt;h3&gt;Boost.Python&lt;/h3&gt;

&lt;p&gt;v8的文档非常稀缺，即便暴露给应用程序员用的API也几乎没有文档可循，v8.h中的注释大概是最珍贵的参考资料了。可能Google的工程师们认为，你丫都看不懂源代码，还玩什么v8……这严重伤害了像我这样的低智商码农的感情。不过还好，开源社区总会有一批蛋疼的人，喜欢把各种框架port到各种平台，胶水层上再加胶水，支持各种语言。看看他们写的框架，也算是曲线救国的一种。&lt;/p&gt;

&lt;p&gt;贵python界一向格外蛋疼，搜索之下，果然如此，pyv8就是这样的框架，利用v8引擎让python可以直接与javascript互操作。pyv8其实是一个很薄的胶水层，绝大多数的工作只是把v8的外部API包装了一个python壳，使用了Boost.Python中提供的机制，将C++模块导出为Python模块。Boost.Python的使用方法大致如下：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;cpp&quot;&gt;    &lt;span class=&quot;err&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boost&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;python&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hpp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;namespace&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boost&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;python&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Hello, World&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bar_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;foo_class&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;private&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;foo_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;I am foo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){}&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                      &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo_class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;I am bar&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;//定义名为boostpy的python模块&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;BOOST_PYTHON_MODULE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boostpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// 导出foo和bar两个模块全局函数&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;def&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;foo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;foo function&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;def&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;bar&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bar_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;str&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;n&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
    
          &lt;span class=&quot;c1&quot;&gt;// 导出foo_class类，类中选择性导出f成员方法和s_bar静态变量&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;class_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo_class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;foo_class&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;I have nothing to say&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;def&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;f&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo_class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;n&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;def_readwrite&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;s_bar&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;foo_class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;将这段程序编译为动态链接库，以windows的dll为例，将编译好的dll放入python include路径下（有很多方法，比较方便的是扔到&lt;code&gt;/path_to_python/Lib/site-packages&lt;/code&gt;里），把后缀改成pyd，因为python不认dll。然后就可以在python中import这个叫做boostpy的模块了。更多用法见这里&lt;a href=&quot;http://www.python-cn.cn/yuyanjichu/2011/0707/14106.html&quot;&gt;boostpy-usage&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;PyV8胶水层&lt;/h3&gt;

&lt;p&gt;刚才说pyv8其实就是一个wrapper，把v8中暴露给C++的数据结构与API通过Boost.Python这种机制wrap一下再暴露给了python。当然它做了很多语法糖的东西，让python用户用起来更顺手。pyv8的源码很少，分两部分，native部分向python导出了_PyV8模块，把v8中的Context（JS运行环境）、Isolate（v8实例）、Function（JS函数）、Script（编译后的js source）等等数据结构wrap一层导出；而PyV8.py这个文件在 _PyV8的基础在再wrap一遍，变为方便python程序员使用的数据结构，成为最终的PyV8模块。&lt;/p&gt;

&lt;p&gt;使用起来很方便，官方给的一个简单的例子：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;python&quot;&gt;    &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;__future__&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;with_statement&lt;/span&gt;
    &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;PyV8&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Global&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PyV8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;JSClass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;writeln&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arg&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PyV8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;JSContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Global&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctxt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;ctxt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;writeln(&amp;#39;Hello World&amp;#39;);&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这里JSContext就是v8::Context的一个wrapper，代表一个js运行环境，这里传入了一个JSClass对象给JSContext的构造函数，其实就是代表一个js运行环境中的“全局对象”（还记得当年大明湖畔的window对象吗？）JSClass定义在PyV8.py里，并非是v8数据结构的映射，那是如何注册到v8的Context中去的呢？奥妙在此：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;cpp&quot;&gt;    &lt;span class=&quot;n&quot;&gt;CContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CContext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;global&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;list&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extensions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HandleScope&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;handle_scope&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  

        &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;auto_ptr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ExtensionConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cfg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ext_names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ext_ptrs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Py_ssize_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PyList_Size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extensions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extract&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extractor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PyList_GetItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extensions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;check&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;ext_names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;push_back&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size_t&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ext_names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;ext_ptrs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;push_back&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ext_names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c_str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ext_ptrs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;empty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cfg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ExtensionConfiguration&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ext_ptrs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ext_ptrs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]));&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;m_context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cfg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Scope&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context_scope&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m_context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ptr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Py_None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;m_context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Global&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NewSymbol&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;__proto__&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CPythonObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Wrap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;最后一行就是答案，这里m_context是一个v8::Context的handle，这一句先把global也就是传入的JSClass对象（注意这是python object）包装成v8的Object，然后注入到m_context的global对象中去，作为&lt;code&gt;__proto__&lt;/code&gt;属性，这是javascript对象的隐式继承链，关于js的prototype机制就不多做解释了。&lt;/p&gt;

&lt;h3&gt;编译PyV8&lt;/h3&gt;

&lt;p&gt;编译pyv8需要一定的耐心，不过作为一个苦逼的码农，这点折腾问题不大。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;使用的编译环境：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;python（我使用2.7.1）&lt;/li&gt;
&lt;li&gt;scons&lt;/li&gt;
&lt;li&gt;VS2008&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;编译boost&lt;br/&gt;
如果没有Boost环境，那首先需要编译boost。源码载到后，按照官网的指示&lt;a href=&quot;http://www.boost.org/doc/libs/1_47_0/more/getting_started/windows.html&quot;&gt;boost-build&lt;/a&gt;，boost其实分为很多模块，可以分开编译，这里只用到了boost的智能指针和python模块，选择性编译就行了&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  bjam --build-type=complete --with=python --toolset=msvc-9.0
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;这里用的是vs2008环境编译的，complete是指build出静态链接、静态链接多线程、动态链接、动态链接多线程等多个版本&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;编译v8。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;载到v8的源码：
  svn checkout http://v8.googlecode.com/svn/trunk/ v8&lt;/li&gt;
&lt;li&gt;不要急着编译，pyv8有一个已知的issue，需要配置v8，打开Exception支持，我不知道不打开会是什么效果，但既然人家这么要求了，本着尽量少折腾自己的原则，还是照做为好。参考这里&lt;a href=&quot;http://code.google.com/p/pyv8/wiki/HowToBuild&quot;&gt;v8-build&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;用scons编译v8&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  scons mode=debug library=shared
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  shared表示编译为动态链接库，编译为静态链接库也行，但是体积庞大，外部程序link起来很费时&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;4.编译pyv8&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;首先要配置一些环境变量，使得编译连接时找得到对应的库，修改setup.py文件，顶部的一些变量换成自己的对应真实路径，包括python、v8、boost等等&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;开始build&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  python setup.py build
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;开始的时候会check你的源码是否是最新版的，需要pysvn支持，但坑爹的是一直打不开这个项目的主页，干脆把这一段注释掉好了。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;安装&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;  python setup.py install 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;  会使用easy_install自动打成egg包扔到site-packages目录中去，下面就可以使用pyv8了。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;源码中附带了一些demos，读起来方便很多，因为pyv8是对v8的封装，看python而知C++，也真是寂寞的蛋疼。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>佛祖在十三号线</title>
   <link href="http://blog.tomsheep.net/2011/08/06/god-in-line-13"/>
   <updated>2011-08-06T22:35:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/08/06/god-in-line-13</id>
   <content type="html">&lt;p&gt;来京半个多月，被挤成了孙子。&lt;/p&gt;

&lt;p&gt;很久以前，北京的英文名还叫做Peking，Peking Duck，Peking Opera什么的。后来统一口径都叫Beijing，西方人很难念。有人说是为了避讳“陪京”，听着丧气，解释的挺靠谱。直到后来自己身临其境，才发现是个误会，这其实是个现在进行时的短语，被挤ing。&lt;/p&gt;

&lt;p&gt;北京还算是一个让人感到亲切的城市，到处洋溢着它的热情——这一点从过街天桥上密密麻麻的小广告就可以看的出来。同样热情的还有这里的的哥，他们都很能侃，每次上车后我的台词就只剩下“恩。”“啊？”“哦~”“嗨！”“可不是么？”……我觉得长此以往，我很有希望成为一名出色的捧哏演员。五道口是一个码农的集散地，他们形色匆忙、目光呆滞，偶尔还捧一本《Effective C++》边走边翻，走在大街上很容易辨认。上周末和几个在北京的高中同学聚在一起，发现殊途同归，大家都成了同行，这真是个神奇的行业。&lt;/p&gt;

&lt;p&gt;也许是住的离公司太远，每天花很多时间在城铁里肉搏，我还没有踏入舒适的节奏。工作内容对我而言又是一个比较新的领域，需要一段时间找准自己的定位。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>只是当时已惘然(2)</title>
   <link href="http://blog.tomsheep.net/2011/07/12/i-miss-you-2"/>
   <updated>2011-07-12T21:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/07/12/i-miss-you-2</id>
   <content type="html">&lt;p&gt;SD坐在我的身旁，饶有兴趣地看着UFC各种血腥暴力的KO视频，有一搭没一搭地问我“十字锁知道不？巴西柔术知道不？泰拳？” 我心不在焉地摇摇头，事实上，《拳皇98》是我格斗知识的唯一来源。我在一旁用破笔记本听着相声，偶尔发出几次突兀的笑声——这是我们近几年见面的典型场景。&lt;/p&gt;

&lt;p&gt;他是我的初中同桌，现在是我的邻居。我们的父亲是同事，他高中毕业后当兵，回家后通过关系进入基层国税局。由于人生轨迹的不同，我们的共同语言越来越少：大约十年前，关注甲A/中超、听某位DJ的电台节目、以及讨论哪位老师最傻逼是我们的共同爱好。而现在除了扯扯不相干的时事外，彼此最大的交集可能就是玩一局蛋疼的红警。他开着自己所里的破车带我出去吃饭，半路上竟然没油了，欢乐的不行，听着他骂骂咧咧地嚷“这弄锤子哩”，依稀可以找回一些往昔的乐趣。吃饭时他向我抱怨无聊的工作和微薄的收入，我一边乐乐呵呵地听着，间或调侃一下自己的境况，却也找不到更多可以分享的话题。&lt;/p&gt;

&lt;p&gt;这种状况早已预见，也无可奈何。让我想起离开上海前和老贺的闲谈，他说时过境迁，不同的境遇带来不同的价值观、兴趣爱好和处世风格，复杂的社会关系可能也会带来理不清的利益纠葛，但回忆还在，情谊还在，这就很难得。我想这就像多结局的RPG，不同的人可以玩出不同的剧情。很多角色只出现在某个支线，更多的角色只是大号的NPC。主角身边的同伴常换常新，不同的技能组合出不同的配合。有些人在某个点上分道扬镳，人生轨迹从此分岔，像彼此正交的向量；而另一些人会阴差阳错地重新走入你的生活，就像脚本中预先写好的一样。&lt;/p&gt;

&lt;p&gt;这是一很更奇妙的事情，对于后一种，我更加期待。我甚至可以透过片花看到其中的部分剧情：曾经的高中同学，现在的同行，充满战斗力并且有些小文艺气质的程序员@buaastorm，我们很有可能成为未来的战友；未曾谋面、却在我最初入行时给予过点拨与指导的仁兄@张淼，这是一种很奇特的缘分；软院的师兄，未来的mentor，我曾经导师的室友@陈豪，未来会有很多东西要向你学习请教；失散多年的小学同学@景珍，我真想知道你现在的模样；曾经一同转专业的@Angelcui、大一的室友@周超、高中的同学@jiglingling……阵容华丽，我很期待这段故事。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>从一个bug看Linux启动原理</title>
   <link href="http://blog.tomsheep.net/2011/07/08/linux-boot"/>
   <updated>2011-07-08T18:53:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/07/08/linux-boot</id>
   <content type="html">&lt;p&gt;磨合久了就会产生默契。非但人是这样，机器也是如此。前几天刚刚复习过Linux的开机原理，今天我的ubuntu就很配合地卡死在了启动阶段，经过观察分析，活学活用战无不胜的爱谁谁的思想，成功排除了bug，幸甚至哉，歌以咏志。&lt;/p&gt;

&lt;h2&gt;Linux启动原理&lt;/h2&gt;

&lt;p&gt;如果按纪元来分划，系统的启动过程可以分为“kernel前”的蛮荒时代和“kernel后”的文明时代。kernel就是我们的操作系统内核，老强大了，一般以压缩文件的方式被放置在/boot分区下。所谓“kernel前”（我胡诌的），即kernel接管整个启动过程之前，主要经历了BIOS自检-&gt;bootloader-&gt;initrd几个阶段。而“kernel后”，则主要包括了init进程-&gt;相应runlevel的若干启动脚本等。&lt;/p&gt;

&lt;p&gt;BIOS在自检过后，一般会做这样一件事情，就是直接通过磁盘寻址加载磁盘的MBR（主引导扇区，512字节） ，而MBR里存放的就是bootloader程序，负责下一步的启动任务。Windows系统有自己的bootloader，没研究过不瞎说了，揣测一下就是系统分区根目录的ntldr（Win XP），boot.ini为其提供配置信息。 Linux中比较常见的bootloader有LILO和grub，grub更流行一些，我们主要分析它。grub0.98之前的版本被称为grub legacy，之后的版本统称为grub2，两者在指令、配置文件上有一些区别，我的ubuntu10.04使用的是grub2.&lt;/p&gt;

&lt;p&gt;刚才说了MBR只有512字节，除了bootloader还要存放分区表（64字节）和2字节的magic number，而bootloader的最终目的是加载kernel，要做的事情很多，放不下怎么办？针对Grub而言，它把自己分为了三个stage，MBR里的只是stage1，由它来加载后面的stage1.5。我们刚才说了linux的内核是放在文件系统中的，所以要加载kernel必须得有文件系统支持才行，stage1.5做的就是这个事情（/boot分区中你会看到很多的stage1.5模块，就是根据不同的文件系统支持来划分的）。在stage1.5之后，grub终于可以访问文件系统了，stage2就会读取相应的配置文件，找到kernel和initrd的位置，然后把控制权交给kernel。下面给出一段grub2的配置文件例子&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;menuconfig&quot;&gt;menuentry &lt;span class=&quot;s2&quot;&gt;&amp;quot;Ubuntu, Linux 2.6.32-26-generic&amp;quot;&lt;/span&gt; {
    insmod ntfs
    set root=&amp;#39;(hd0,6)&amp;#39;
    search --no-floppy --fs-uuid --set b094ce9194ce5a0c
    loopback loop0 /ubuntu/disks/root.disk
    set root=(loop0)
    linux /boot/vmlinuz-2.6.32-26-generic root=/dev/sda6 loop=/ubuntu/disks/root.disk ro   quiet splash
    initrd /boot/initrd.img-2.6.32-26-generic
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;其中linux指令指定了kernel文件的位置，root参数指明根目录对应的设备，你可能会问这不是和前面的set root重复了吗？其实没有，前面的set root是给grub的，让grub切换根目录到相应设备，而这里的root参数是给kernel看的，以让kernel正确地挂载根目录，loop参数比较特殊，这是因为我的ubuntu是wubi安装的，后面再介绍。&lt;/p&gt;

&lt;p&gt;initrd是一个临时的根文件系统，被kernel加载到内存中，然后进行一些列驱动的加载。它存在的目的是让kernel保持简洁，因为如果把所有设备驱动都编进kernel，那kernel就太臃肿了，而且不灵活。initrd机制就是在kernel中只保存少量最主要的设备驱动，系统安装时检测硬件，把实际启动需要的驱动编入initrd，这样kernel并不需要修改，保持良好身材。在initrd中的init脚本（就是加载驱动）完成后，kernel有能力挂载真正的根目录了，使出一招始乱终弃……哦不是，偷天换日，挂载刚才root参数指定的分区，把根目录换成它。&lt;/p&gt;

&lt;p&gt;后面的故事就是所谓的“kernel后”时代了，启动init进程，pid为1，这个进程是所有进程之祖。接下来就是检查runlevel（一般在/etc/inittab下，但ubuntu在），依次启动相应的脚本集，一般在/etc/rcX.d目录中 ，它们都是指向其他地方的软连接，按照名字中的数字从小到大运行，S开头的表示启动，传start参数，K开头的表示Kill，传stop参数。另外rcS.d目录下的脚本是不管那个runlevel都会运行的。“kernel后”时代的故事不展开说，和今天的主题没有太多关系。&lt;/p&gt;

&lt;h2&gt;ubuntu的wubi安装机制&lt;/h2&gt;

&lt;p&gt;ubuntu从8.04（？）版本后开始支持wubi安装模式，它的主要原理就是用文件镜像来模拟真实的磁盘（就是刚才loop里的root.disk），从而无须单独分区，即可把ubuntu安装到机器上。这个wubi系统除了磁盘是假的（宿主系统中的镜像文件），磁盘IO会有一些overhead外，其余设备都是“真”的，所以并不是什么虚拟机。&lt;/p&gt;

&lt;p&gt;那么它是怎么启动的？原理大致是一样的，首先从宿主系统入手，我的是WinXP，C:\boot.ini文件（相当于grub.cfg）中除了正常的WinXP启动项外，还有一项指向了C盘下的wubildr文件，这就是一个chainloader机制，因为windows的bootloader不能直接启动Linux系统，但可以把bootloader“链”到另一个bootloader，这个bootloader可能是其他分区的boot sector，也可能是一个镜像文件（就像这里的wubildr），然后wubildr再去扮演grub的角色，来启动Linux。&lt;/p&gt;

&lt;p&gt;要注意的是wubi用的是文件镜像来做磁盘，所以grub要额外做一些事情，上面的配置文件中有一句loopback指令，他就是用来把镜像文件加载为一个虚拟设备，叫做loop0，然后set root为loop0，这样grub就可以去读镜像磁盘中的文件了（比如kernel什么的），而下面linux指令中的loop参数作用是辅助kernel正确挂载根目录——因为/dev/sda6是拓展分区的第二个逻辑分区，再直白一点就是我的WinXP里的E盘，在wubi这个特殊的语境下，他只是存放镜像的分区，不是正确的根目录（正确的应该是E:\ubuntu\disks\root.disk），而loop参数就是进一步告诉kernel根目录在哪里。&lt;/p&gt;

&lt;h2&gt;解决开机错误&lt;/h2&gt;

&lt;p&gt;说了这么多，终于到正题了，我遇到的问题是开机后ubuntu启动卡在了grub中，直接进入grub命令行，其实问题不大，因为这说明启动已经到了stage2，问题多半是grub配置文件损坏。在命令行里输入相应的配置指令就可以了。ls一下发现loop0设备已经有了，想一下这也是正常的，因为loop0应该在stage1.5就被挂载好，这相当于添加文件系统支持。root=(loop0)设为grub的根目录，然后判断一下root.disk镜像是放在哪个分区的，ls命令就行，发现是/dev/sda6, 给linux指令和initrd指令配好正确的参数，然后键入boot，就欢乐地进入系统了。&lt;/p&gt;

&lt;p&gt;进入系统后执行update-grub2命令，会自动检测可启动的系统生成相应grub.cfg（这是grub2的特性，不用手动编写），修复grub，问题解决。做到这里突然想起来去年装好ubuntu后想把镜像文件移到另一个分区中，一直没有成功，现在了解了原理，是不是……没错，按照这个原理，随意把镜像文件放到哪里，都没有问题。&lt;/p&gt;

&lt;h2&gt;总结&lt;/h2&gt;

&lt;p&gt;本文从ubuntu10.04启动中由于grub配置损坏引起的一个bug出发，介绍了linux的启动原理以及wubi的特殊原理。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>只是当时已惘然(1)</title>
   <link href="http://blog.tomsheep.net/2011/07/01/i-miss-you-1"/>
   <updated>2011-07-01T18:33:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/07/01/i-miss-you-1</id>
   <content type="html">&lt;p&gt;以下来自我的微博。真诚是不是一定需要矫情？多半不是。可惜我境界不够，为了真诚，我宁愿变得矫情。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 大一过的挺扭曲的，起初对复旦对自己的专业都很抵触，急切地想要证明自己。那段时间其实不太使得上劲，药学院的基础课也相对简单。只觉得自己需要“do something different”，我在笔记本扉页上写，”从今天起做一只特立独行的猪“——回头看看，这几年确实是这样做的，却似乎又有点跑偏……&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 后来慢慢发现周围的同学都有很耀眼的闪光点，自愧不如。大一下学期自己买了电脑，同时在图书馆中发现计算机类的书籍特别能够吸引我，突然没想开，就决定放弃转数学的念头，要上cs/ss这艘贼船。在BBS上发帖问cs和ss应该去哪个，果然还是软院水人多了，一通猛侃就把我诓骗来了&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 于是开始阳光明媚的大一2.0， 现在真佩服那时的精神状态，自信，目标简单，信念坚定，从零开始，求知若渴。住在东区，每天上课在校门口买一份china daily——那个卖报的女生我至今记得她的名字，叫唐维盈，大二来张江后再没见过。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 当时学得兴起，还是有点小得意的（现在看来简直弱爆了），慢慢有一些同学经常来问自己问题，幸福指数极高。愈发努力学习，形成良性循环。当时和@Garfieldull 聊的很投机，突然觉得有人能在自己生命的这个时刻做自己的倾听者，这种感觉难以言喻，无法释怀。这也许就是宅男心底的悸动&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 当时有一点很遗憾，和同寝室友交流并不多，可以说并不太乐于与他们厮混。（反而是后来不在同一间寝室后，大家成为很好的朋友）当时心底很佩服豪哥的文学功底，但从不承认。做lab和project从不甘人后，还保有一些小孩脾性，哈哈。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 大二后来到张江，和全班汇合，一开始还是很小心翼翼的，因为不知道班里是否藏龙卧虎，有什么大牛。新寝室里的@hackerzhou 就十分生猛，我第一次见他敲代码的时候完全被镇住了……后来和班级同学都慢慢熟了起来，找到自己的平衡点，一切都还平稳&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 当时还挺看重GPA的，锱铢必较，后来挺后悔的，觉得应该把心思多花在务实的知识上。不过倒也有点好处，本身我不太善于交际，借此倒是被很多同学认识，大家也都很捧，后来我就变成了所谓“康神”，有时会比较有压力，盛名之下其实难副。再后来听着听着也就习惯了&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 大二最赞课是ICS，那本CSAPP非常精彩，lab也给力，还记得当初通宵拆炸弹的往事。整个软院的课程中可能这个是最有含金量的，后来也因此进入老大的实验室，颇为受益。记得当时因为制度对先做lab的人不公平，还在bbs上嘲讽过陈榕大爷，模仿的是金圣叹的《十三快哉》，不知道这个贴还在不在&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 对了，大二的时侯还跟着老猫老师一起做过一个项目，模拟RFID硬件的，做出一个初级版本后，大家都心猿意马，那时也刚刚被招进实验室，也就以此为由不再重构了。前几天答辩被分到老猫组，还是很虚的，没想到他对我相当nice，让人有点惭愧。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 老猫是个很强大的人，专业能力一流，更让我觉得不可思议的是他国学功力深厚，历史版资深版主，在一群科班出身的文人圈子里也很有威信，在精华区里时常看见他发的“北魏XX皇后XX考”之类的帖子。此外他还是戏剧、相声迷，据说越剧唱得不错——我一度想，这不就是我想要达到的状态么？&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 那时自己口头表达能力很弱（现在也很弱但相比之下好多了）在网络上倒是放的极开，BBS、Blog、QQ上到处扯淡、插科打诨。记得当时正是计算机学院成立的时候，我不懂其中派系斗争曲折原委，在bbs签名档里写了一则调侃的段子，被老大揪住，训斥一番。现在据传老大也要出走交大了，真是无比伤感&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 我一直觉得，自己对软院的认同感要高于对复旦的认同感。而如今山雨欲来，眼看软院分崩离析，自己虽将毕业，却不知若干年后回到母校，还能不能看到这个编制。顿时十分感慨，用豪哥很喜欢的一部电视剧名来说就是——我无处安放的青春。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 不得不说大二下真是一个关键的节点，那时对未来的路要怎么走充满疑惑，看着不同的人不同的成功轨迹，更是凌乱的一塌糊涂。对是否要出国摇摆不定，懵懵懂懂地进入实验室，渡过最困惑最压抑的一年。PPI的师兄们很牛，海波当然更牛，师生关系也比较和谐，非常感谢这些朋友对我的帮助&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 我在实验室主要在做Win32驱动在Linux下模拟的一个项目，当时比较浮躁，学习方法也欠妥，更加深了对未来的迷茫。当时一直担心自己会慢慢走向平庸，但越是担心，就越是难以遏制这种势头。逐渐开始怀疑自己，却又无计可施，那段时间非常痛苦。大三寒假我请假去香港参加一个冬令营，像是在逃亡&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 那个winter school是理论方向的，和OS不搭界，我也几乎不懂，海波还是很nice地放我去了。那里认识很多其他学校的同学，风格迥异（里面还包括后来一起去大摩实习的joyce），顿时发现其实不同人的未来各有分定，没有什么固定的标准，心情平稳很多。对了，我还跟着清华理论大牛混了个冠军奖状&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 回到家后我做出决定，退出实验室，找一个新的突破点。第二个学期中期我对海波提出这个想法，后来海波好像告诉了老大，老大据说去质问鼎哥是否是他来挖的墙角（好像有先例），我苦笑不得，正好赶上各家公司都来招实习生，索性决定那就出去工作好了，对自己可能是更好的锻炼。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 还挺顺利的去了摩根实习，当时一心想着努力工作，展现优秀的一面，可惜这么多年疏于社交能力的培养，尽管满怀善意，却总不知怎样表达，两个月过的有点别扭。后来没有拿到offer，有些失落，但心态还是很好，自信也一点不缺。这段经历也让我有很多思考，对自己的弱点看得更清楚了些&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 后来在CareerCup的一本书上看到面试官的“我会和这哥们一起喝酒”测试，哑然失笑，觉得自己确实没有表现出这一面。后来我还是没有选择直研或准备出国，觉得既然发现了自己的优势与不足，为什么不趁此机会去加以利用或改善呢？很多人都觉得我很有个性，我觉得有时候多一点坚持没什么不好。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 后来就是找工作了，心气儿还是很足的，回头看觉得这点很重要。拿到几个不错的offer，最终选了去Yahoo!北京，期待全新的挑战。说到这里，想起当初面雅虎时其实对这家公司极不了解，面完后面试官说“你有多大可能会来？”，我说一半一半吧，面试官比较失望，说“你回去可以多了解一下”，lol&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 求职期间被介绍给过两个创业团队，都是比较被动的接触，当时也没有太多这方面的想法，后来对行业对市场了解逐渐增多，也认识了不少有类似想法的朋友，心思也逐渐活路，憧憬未来某个契机自己和一帮志同道合的朋友能有所作为。niu总半开玩笑地说他在上海等我回来一起干一番事业，好吧我记着。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 大四其实技术上收获也不小，有点再次开窍的感觉，觉得和自己在其他方面阅历的增加不无关系，现在斗志饱满，只缺一个安定的工作环境和一颗专注的心。这几年一直把知识面铺的很开，但在专注度上就差了很多，这一点上@hackerzhou 一直是我的楷模，工作后我期待自己能在某一领域稳定高速地发展&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 最后一个学期进入了“毕组委”，参与了班级的几项重大的决议与活动，设计了毕业口号，拍毕业视频，参加基情毕业游，给毕业大戏写剧本……很有成就感，感觉这个集体空前的温暖。当然，还有我发起了最给力的&lt;a href=&quot;http://weibo.com/k/%25E9%259A%258F%25E6%2589%258B%25E6%258B%258D%25E8%25A7%25A3%25E6%2595%2591%25E5%25A4%25A7%25E9%25BE%2584%25E5%25B0%258F%25E8%2583%2596%25E7%258C%25AA&amp;amp;refer=miniblog_jing&quot;&gt;#随手拍解救大龄小胖猪#&lt;/a&gt; 活动，你们一个个积极响应啊！&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 虽然已经没什么作用，但最后一个学期GPA没有掉下来，我还是很欣慰的，唯一的好处就是以后简历里可以继续吹牛逼。毕业论文过的挺顺，感谢导师陈sir，我和老袁@strong_sm 答辩完一直感叹：“跟对一个人缘好的导师是多么重要！”——你懂的。只是Rudolf的课没有很认真地上，比较惭愧。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 毕业季有些伤感，即将到来的是数不清的散伙饭，我本就是很感性的人（虽然外表强悍），此时更是无限留恋。希望兄弟姐妹一帆风顺，前途似锦。哥们在北京，随时等着你们。——刷屏先刷到这里吧。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 昨晚上，不对，是前晚上，在王翔寝室通宵赶视频，他和我讨论背景音乐应该用哪首，他提到《凤凰花开的路口》，我说我没听过，他很诧异，说你肯定听过，后来他把这首歌反复放了半个多小时——我确实没听过，但真被打动了。“时光的河入海流，终于我们分头走。没有哪个港口 是永远的停留……”&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 散伙饭都喝多了，哭的一塌糊涂，互相抱着说一些平日里不愿说、不敢说的话，管他矫情不矫情的，我都记着。别看我醉了，心里也明白着呢。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 敬老大酒的时候，老大嗔道：“去什么雅虎，你小子这么有才，不就是性格内向点么，跟着我混，有可能成为billionaire，现在没这可能了。” 我有点想哭，人生中最让人感动的事莫过于得到自己所尊敬的人的肯定，我说：“老大没事，出去看一圈，我就回来了。”&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 敬豪哥、cj、zy酒时我说，“室友一场，和别人毕竟不一样，大家知根知底，我有什么毛病各位一清二楚……”喝完后对豪哥说：“欠你的香蕉我不打算还了，记着来北京找我要。”&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 昨天zy借着酒劲狠力拍我的后背，哭着说“好好混啊阿康！”，一点都不像平时的他。我比他哭的还厉害，说“放心，绝对不会让哥们失望。” 大家都有心中的隐痛，不必多说，全在泪里。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 范豪钧醉了后十分激动，拉着我一边哭一边喊：“你知道我多想你留下来？我多想在大摩有个依靠？”往事不堪回首，心中五味杂陈。我说，“大家都努力，别丢软院的人。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 抱着@Garfieldull 的时候，我不愿意放开，我不停的念：“你懂的，你懂的。” 可能我真是个太矫情的人。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 真诚是不是一定需要矫情？多半不是。可惜我境界不够，为了真诚，我宁愿变得矫情。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 在一阵阵乱抱过程中，我一侧的眼镜片被挤掉，后半夜就在半醉半醒、半虚半实的状态中度过。散伙饭后去ktv，我与二小、思博、小件、zy、高维在大部队旁边的一间小房间里，喊得声嘶力竭。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 今天收拾行李，翻出很多让人感怀的东西：PPI全体签名的生日贺卡，大一时的笔记，泡过水的硬盘，去当兵的初中同学的来信，@随缘如斯 德国寄来的明信片，去年实习时mentor签名的笔记本，三年爱尔兰班的金牌，院报的纪念奖状，某次院庆晚会发的复旦校徽……这就是我青春的缩影&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://weibo.com/k/%25E6%25AF%2595%25E4%25B8%259A%25E7%25BA%25AA%25E5%25BF%25B5&amp;amp;refer=miniblog_jing&quot;&gt;#毕业纪念#&lt;/a&gt; 行李打包好正赶上小胖考试回来，他看着说他有些难受，我嘻嘻哈哈地“捏死你”“养到300斤宰掉”一阵过去了。其实我更难受，看着他一身白花花的肉，以后不知何时才能再捏得到。希望他顺利毕业，小胖有潜力，十年、二十年，或者更久，我看着。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Sophia(5)</title>
   <link href="http://blog.tomsheep.net/2011/07/01/sophia5"/>
   <updated>2011-07-01T16:01:41+08:00</updated>
   <id>http://blog.tomsheep.net/2011/07/01/sophia5</id>
   <content type="html">&lt;h3&gt;第五幕 毕业季&lt;/h3&gt;

&lt;p&gt;[牛顿上，开始讲述。背景乐伤感一点，不要盖过独白的声音。可以用《青春无悔》]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;牛顿：时间过得真快，当年一个人拎着行李来到复旦，好像还是昨天。总以为毕业遥遥无期，有大把的青春年华可以挥霍，谁知道转瞬之间，大家就要分道扬镳、各奔东西。以前看席慕容的诗，只觉得很美，却不知竟能给人带来揪心的痛楚&lt;/li&gt;
&lt;/ul&gt;


&lt;blockquote&gt;&lt;p&gt;请再看&lt;br/&gt;
再看我一眼&lt;br/&gt;
在风中 在雨中&lt;br/&gt;
再回头凝视一次&lt;br/&gt;
我今宵的容颜&lt;br/&gt;
请你将此刻&lt;br/&gt;
牢牢的记住
只为&lt;br/&gt;
此刻之后&lt;br/&gt;
一转身&lt;br/&gt;
你我便成为陌路&lt;br/&gt;
悲莫悲兮&lt;br/&gt;
生别离&lt;br/&gt;
而在他年 在&lt;br/&gt;
无法预知的重逢里&lt;br/&gt;
我将再也不能&lt;br/&gt;
再也不能 再&lt;br/&gt;
如今夜这般美丽&lt;/p&gt;&lt;/blockquote&gt;

&lt;ul&gt;
&lt;li&gt;牛顿: 大四过的很忙碌，也很充实，为了前程四下奔走。意外的是居然还进入了毕组委，设计口号、班衫，组织party、激情四射的毕业游，拍DV，选礼品，编纂纪念册，（在说这几个短语的时候，没说一个，背景里要配合牛顿演一小段，几秒钟就行，就像曾经那个经典的单镜头广告的感觉：口号对应动作——拿张题板出来指一下；班衫——有人在照镜子试衣服；组织party——几个人围在一起三国杀，出两句经典台词；毕业游——搅基那段；拍视频——在镜头前摆pose；纪念册——拿笔在题板上涂鸦）能在大学结束之前为集体贡献一点绵薄之力，真是让人欣慰。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[跳进程序，毕组委开会，牛顿在一旁听，会场大约5人左右]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;辅导员：同志们，还有什么为毕业季献礼的东西，果断搞起来啊！&lt;/li&gt;
&lt;li&gt;龙套A：礼品蛮多了，我们是不是要设计一个容器来装啊&lt;/li&gt;
&lt;li&gt;龙套B：恩，肯定的，是不是设计得个性化一点，每个人的都有自己的标识啊&lt;/li&gt;
&lt;li&gt;冯诺依曼：好主意，这样吧，我们上点档次，用紫檀木做一个盒子，这么大（比划一下），很别致的，东西都装里面，是谁的就在外面贴一张那人的照片……&lt;/li&gt;
&lt;li&gt;辅导员：你说这是骨灰盒吧？说正事呢，别扯淡。对了，老冯，你程序写的漂亮，不如为毕业班设计一个软件吧。&lt;/li&gt;
&lt;li&gt;冯诺依曼：倒也不错，什么内容呢？&lt;/li&gt;
&lt;li&gt;辅导员：主题你自己定，这事就有你负责了，让Ada、牛顿、图灵协助你。&lt;/li&gt;
&lt;li&gt;冯诺依曼：行。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[牛顿继续讲述，其余人下]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;牛顿：这就是sophia诞生。Ada和图灵不会放过任何一个可以相互拆台的机会，&lt;/li&gt;
&lt;li&gt;Ada：Sophia做名字最合适了，大家都听得都，不像尼什么尼的&lt;/li&gt;
&lt;li&gt;图灵：净瞎说，太没有个性了，是吧牛哥？&lt;/li&gt;
&lt;li&gt;牛顿：还好啦，都不错&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[牛顿跳出继续讲述]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;牛顿：至于程序的事情，自然是冯大牛来搞定了。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[冯诺依曼忙碌的景像]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;冯诺依曼：ok，就是他了，原型完成。&lt;/li&gt;
&lt;li&gt;牛顿：赞啊&lt;/li&gt;
&lt;li&gt;冯诺依曼：万事俱备，只欠测试了。通知Ada和图灵吧，我们每天一起来修改程序&lt;/li&gt;
&lt;li&gt;牛顿：没问题&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[牛顿继续讲述]&lt;/p&gt;

&lt;p&gt;牛顿：（引出这次碰面）具体陈述语言待定。&lt;/p&gt;

&lt;p&gt;[软件楼第一会议室。]&lt;/p&gt;

&lt;p&gt;[图灵、冯诺依曼、艾达上。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：冯诺依曼大牛，你的prototype写好没有？酝酿这么久了，我们这都等米下锅呢。&lt;/li&gt;
&lt;li&gt;冯诺依曼：站着说话不腰疼，你来个试试？本尊花了好几个通宵呢，死了多少脑细胞，瞅
瞅，Sophia 0.01。[打开电脑]。&lt;/li&gt;
&lt;li&gt;图灵：Sophia，也不知谁起这名字，一听就是一柴火妞。照我的意思，就得叫尼莫西妮(Mnemosyne)[陶醉状]，古希腊记忆女神，多有品位，多有层次。&lt;/li&gt;
&lt;li&gt;艾达：图——灵！！！说什么呢？！[微怒] Sophia，多好听的女孩名字，而且你们不觉得和software发音很接近么？用来做我们07ss的回忆录程序名再合适不过了。&lt;/li&gt;
&lt;li&gt;图灵：Ada女王息怒，您说的极是。[岔开话题] 冯大牛，您的程序怎么跑啊？&lt;/li&gt;
&lt;li&gt;冯诺依曼：这是个回忆录框架，我们可以添加自己的程序片段进去，组成完整的故事。先别忙着运行，等牛顿来了一起搞。[看表] 诶？都几点了，牛顿这小子怎么还不来？&lt;/li&gt;
&lt;li&gt;图灵：别又是被树上掉下来的ipad2给砸晕了吧？&lt;/li&gt;
&lt;li&gt;艾达：别贫了，再等等吧。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[牛顿在门口，一直不愿走进去]&lt;/p&gt;

&lt;p&gt;[全剧终]&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Sophia(4)</title>
   <link href="http://blog.tomsheep.net/2011/07/01/sophia4"/>
   <updated>2011-07-01T15:59:08+08:00</updated>
   <id>http://blog.tomsheep.net/2011/07/01/sophia4</id>
   <content type="html">&lt;h3&gt;第四幕 暗恋罗生门之Ada版&lt;/h3&gt;

&lt;p&gt;[某男生寝室，图灵抱着吉他，牛顿和冯诺依曼埋头做自己的事]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Ada：（画外音）20XX年X月X日 星期X 晴
[图灵自弹自唱，《你给傻逼织毛衣》]&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[歌声停止]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;牛顿：图灵你搞什么飞机？这么苦逼，唱得快内伤了。&lt;/li&gt;
&lt;li&gt;图灵：你，不懂（失意装）&lt;/li&gt;
&lt;li&gt;冯诺依曼：张江五大歌手比赛早过了啊，我们班丘奇是冠军，你不赶趟啊。&lt;/li&gt;
&lt;li&gt;图灵：你，也不懂（失意装）。&lt;/li&gt;
&lt;li&gt;牛顿：有啥不懂的？又是那什么”朱安“？&lt;/li&gt;
&lt;li&gt;冯诺依曼：你昨天晚上梦里叫了“朱安”这个名字1024次，她一定欠了你很多钱。&lt;/li&gt;
&lt;li&gt;图灵：（悲催地）出师未捷身先死，长使英雄泪满襟。你们，是懂不了的。&lt;/li&gt;
&lt;li&gt;牛顿：至于颓废成这样么？这叫“朱安”的是什么人？哪个专业的？&lt;/li&gt;
&lt;li&gt;图灵：仿佛兮若轻云之蔽月，飘飘兮若流风之回雪……(哭腔)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[冯诺依曼拿书拍图灵的头]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;冯诺依曼：瞧你这没出息的，再哭哥把你剁了喂牛顿养的狗！&lt;/li&gt;
&lt;li&gt;牛顿：我的狗口味没这么重……&lt;/li&gt;
&lt;li&gt;图灵：(摸头)你们太不仗义了，落井下石啊。都不安慰一下。&lt;/li&gt;
&lt;li&gt;牛顿：矮油，别难过了，听说朱安不都送你礼物了吗？这不挺好吗？&lt;/li&gt;
&lt;li&gt;冯诺依曼：就是。(拿起桌上手套)瞧瞧这线条，这纹理，上面还有你的名字缩写呢，TL，多浪漫。&lt;/li&gt;
&lt;li&gt;图灵：浪漫什么呀，我昨天看见她给丘奇织了件毛衣，比这个好多了，胸前也秀了丘奇的缩写……&lt;/li&gt;
&lt;li&gt;冯诺依曼：说不定人那是腾讯QQ的文化衫呢。&lt;/li&gt;
&lt;li&gt;牛顿：就是，虽说我旦女生智障的可能性比较小，但保不齐就有那么几个不开眼的就看上你了呢，所以别灰心啊&lt;/li&gt;
&lt;li&gt;冯诺依曼：就是就是，小概率事件必然发生——严金海的概率论讲过的。&lt;/li&gt;
&lt;li&gt;图灵：你们这是安慰我么？&lt;/li&gt;
&lt;li&gt;牛顿：女生嘛，总归脸皮儿薄，不好意思点破的。你应该先从她的闺蜜入手，旁敲侧击一番。Ada是她中学同学，到时可以帮你。&lt;/li&gt;
&lt;li&gt;冯诺依曼：妥妥的啊。走，哥几个出去腐败一顿，给灵儿壮壮胆。&lt;/li&gt;
&lt;li&gt;牛顿：必须的啊。&lt;/li&gt;
&lt;li&gt;图灵：好吧。&lt;/li&gt;
&lt;li&gt;冯、牛：走！&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[三人下]&lt;/p&gt;

&lt;p&gt;[场景切换]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Ada：（画外音）20XX年X月X日 星期X 晴&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[校园某处休息区，图灵和Ada谈话]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Ada：你找我什么事啊？是和朱安有关吗？&lt;/li&gt;
&lt;li&gt;图灵：既然你都这么说了，那我就不卖关子了。就想让你帮我参谋参谋。&lt;/li&gt;
&lt;li&gt;Ada：恩，说吧。&lt;/li&gt;
&lt;li&gt;图灵：你说她送我手套，是不是对我有意思啊？&lt;/li&gt;
&lt;li&gt;Ada：你想多了，以我对她十多年的了解，绝对不会。&lt;/li&gt;
&lt;li&gt;图灵：可我总觉得她有点这方面的暗示啊，真让人看不懂。&lt;/li&gt;
&lt;li&gt;Ada：人生就像一个OS lab，有时只是为了拿到分数，你不必看懂所有的代码。&lt;/li&gt;
&lt;li&gt;图灵：我要是约她出来会被拒吗？&lt;/li&gt;
&lt;li&gt;Ada：当然了，我敢打赌。&lt;/li&gt;
&lt;li&gt;图灵：那我下一步还能采取行动吗？&lt;/li&gt;
&lt;li&gt;Ada：千万不要这样！&lt;/li&gt;
&lt;li&gt;图灵：你是想让我放弃？&lt;/li&gt;
&lt;li&gt;Ada：顺其自然吧，我看好你呦~&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[场景切换]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Ada：（画外音）20XX年X月X日 星期X 晴，他们约好在电影院见面&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[图灵上，站着等待，偶尔整理衣襟，不时看表]&lt;/p&gt;

&lt;p&gt;[卖花女上]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;卖花女：先生，您在等人么？&lt;/li&gt;
&lt;li&gt;图灵：(微笑)是啊。&lt;/li&gt;
&lt;li&gt;卖花女：买只花给您的男朋友吧？&lt;/li&gt;
&lt;li&gt;图灵：额……（楞）算了吧……。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[图灵买花，卖花女下。]&lt;/p&gt;

&lt;p&gt;[继续等待。办证男上。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;办证男：哥们儿，学计算机的吧？&lt;/li&gt;
&lt;li&gt;图灵：（惊讶）你怎么知道？&lt;/li&gt;
&lt;li&gt;办证男：一张苦瓜脸，一副猥琐样，IT民工都这么衰。&lt;/li&gt;
&lt;li&gt;图灵：这样啊……&lt;/li&gt;
&lt;li&gt;办证男：要办证么？微软、思科、oracle认证应有尽有，另外学生证、学位证、结婚证、离婚证、独生子女证、自行车停车证……200一张，价格公道童叟无欺，做出来比真的还真。&lt;/li&gt;
&lt;li&gt;图灵：复旦软院毕业证是不是得多加2块钱？&lt;/li&gt;
&lt;li&gt;办证男：内行啊，这你都知道。算你95折吧。&lt;/li&gt;
&lt;li&gt;图灵：我看还是算了吧……&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[办证男下。]&lt;/p&gt;

&lt;p&gt;[图灵手机响起。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：喂，是朱安么?我一直在这里等你。我右手戴着你送我的手套，左手……左手什么都没有。你在哪呢，我怎么没有看到你？(四处张望)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[朱安上。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;朱安：图灵，我在这！&lt;/li&gt;
&lt;li&gt;图灵：朱安……&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[慢步走近]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;朱安：真麻烦你了，这么远还专门来给我们送票&lt;/li&gt;
&lt;li&gt;图灵：嗨，必须的啊，那，3D imax《建党伟业》，两张。&lt;/li&gt;
&lt;li&gt;朱安：太谢谢你了。（回头）丘奇，我们走吧！&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[丘奇上，牵着朱安的手从另一侧下]&lt;/p&gt;

&lt;p&gt;[回到程序外]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：有意思么，大家关系这么铁，吐槽别太狠嘛。&lt;/li&gt;
&lt;li&gt;Ada：就知道你心虚，让你再YY。&lt;/li&gt;
&lt;li&gt;图灵：艺术来源于生活高于生活嘛……&lt;/li&gt;
&lt;li&gt;冯诺依曼：你们俩别掐了，看牛哥的吧。&lt;/li&gt;
&lt;li&gt;牛顿：恩，好，我来讲讲毕业季的故事吧。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[第四幕完]&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Sophia(3)</title>
   <link href="http://blog.tomsheep.net/2011/07/01/sophia3"/>
   <updated>2011-07-01T15:56:54+08:00</updated>
   <id>http://blog.tomsheep.net/2011/07/01/sophia3</id>
   <content type="html">&lt;p&gt;毕业大戏且写且拖，写到最后已经不是自己想要的模样，给导演和演员带来很多麻烦，实在过意不去。昨天演出的版本又做了很多修改，表达的主题和方式也有了很多改变。不管如何，也算是为班级最后尽了一点微薄之力。排练的同学很不容易，在短短几天里能把这个半成品剧本打磨成型并演绎出来，辛苦了。我把自己的原稿贴在博客里，聊表纪念。&lt;/p&gt;

&lt;h3&gt;第三幕 暗恋罗生门之图灵版&lt;/h3&gt;

&lt;p&gt;[某男生寝室，图灵抱着吉他，牛顿和冯诺依曼埋头做自己的事]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：（画外音）20XX年X月X日 星期X 晴&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[图灵自弹自唱，一首深情而甜蜜的歌曲]&lt;/p&gt;

&lt;p&gt;[歌声停止]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;牛顿：我怎么觉得有点冷啊，鸡皮疙瘩掉了一地，图灵你搞什么飞机？&lt;/li&gt;
&lt;li&gt;图灵：你，不懂（得意装）&lt;/li&gt;
&lt;li&gt;冯诺依曼：张江五大歌手比赛早过了啊，我们班丘奇是冠军，你不赶趟啊。&lt;/li&gt;
&lt;li&gt;图灵：你，也不懂（继续得意）。&lt;/li&gt;
&lt;li&gt;牛顿：有啥不懂的？春天到了呗——&lt;/li&gt;
&lt;li&gt;冯诺依曼：噢——（尾音）明白了，（坏笑）你昨天晚上梦里叫了“朱安”这个名字1024次，她一定欠了你很多钱。&lt;/li&gt;
&lt;li&gt;图灵：（陶醉状）梦魂惯得无拘检，又踏杨花过谢桥。你们，是懂不了滴。哈哈&lt;/li&gt;
&lt;li&gt;牛顿：至于得瑟成这样么？这叫“朱安”的是什么人？哪个专业的？&lt;/li&gt;
&lt;li&gt;图灵：仿佛兮若轻云之蔽月，飘飘兮若流风之回雪……&lt;/li&gt;
&lt;li&gt;[冯诺依曼拿书拍图灵的头]&lt;/li&gt;
&lt;li&gt;冯诺依曼：你大爷的，再犯贱哥把你剁了喂牛顿养的狗！&lt;/li&gt;
&lt;li&gt;牛顿：我的狗口味没这么重……&lt;/li&gt;
&lt;li&gt;图灵：(摸头)干什么呀，你们就是羡慕嫉妒恨，见不得我走桃花运。&lt;/li&gt;
&lt;li&gt;牛顿：（对冯诺依曼）诶，按说我旦女生不太可能有智障的啊？怎么就有看上咱灵儿的？&lt;/li&gt;
&lt;li&gt;冯诺依曼：小概率事件必然发生——严金海的概率论你翘课了吧？&lt;/li&gt;
&lt;li&gt;图灵：你们俩就说对口相声吧，哥心情好，8在乎~&lt;/li&gt;
&lt;li&gt;牛顿：矮油，跟哥几个说说，怎么个情况？&lt;/li&gt;
&lt;li&gt;冯诺依曼：我看就是你自己yy的&lt;/li&gt;
&lt;li&gt;图灵：什么yy？人家都送我礼物了~&lt;/li&gt;
&lt;li&gt;牛、冯：什么礼物？&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[图灵得意地拿出一副手套]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：看见没？人亲自织的手套。瞧瞧这线条，这纹理，上面还有我的名字缩写呢，TL，多浪漫！&lt;/li&gt;
&lt;li&gt;牛顿：可以啊，图灵！&lt;/li&gt;
&lt;li&gt;冯诺依曼：啧啧，按说这么心灵手巧的女孩早在白垩纪就已经绝种了啊，图灵你不会是遇见复活的恐龙了吧？&lt;/li&gt;
&lt;li&gt;图灵：恐你妹！你们啊，就是心里不平衡~&lt;/li&gt;
&lt;li&gt;牛顿：哈哈，灵儿，说说发展到哪一步了？&lt;/li&gt;
&lt;li&gt;图灵：女生嘛，总归脸皮儿薄，不好意思点破的。我准备进行全方位的战略部署，先从她的闺蜜入手，旁敲侧击一番。Ada是她中学同学，到时可以做我的内线。&lt;/li&gt;
&lt;li&gt;冯诺依曼：赞啊！牛哥你说一般这种情况下，男主角是不是一般都会请他的兄弟们大吃一顿以表庆祝？&lt;/li&gt;
&lt;li&gt;牛顿：必须的啊。&lt;/li&gt;
&lt;li&gt;图灵：没问题，想吃什么尽管说，妥妥的。&lt;/li&gt;
&lt;li&gt;冯诺依曼：那还等什么啊，哥几个走着？&lt;/li&gt;
&lt;li&gt;牛、图：走！&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[三人下]&lt;/p&gt;

&lt;p&gt;[场景切换]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：（画外音）20XX年X月X日 星期X 晴&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[校园某处休息区，图灵和Ada谈话]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Ada：你找我什么事啊？是和朱安有关吗？&lt;/li&gt;
&lt;li&gt;图灵：既然你都这么说了，那我就不卖关子了。就想让你帮我参谋参谋。&lt;/li&gt;
&lt;li&gt;Ada：恩，说吧。&lt;/li&gt;
&lt;li&gt;图灵：你说她送我手套，是不是对我有意思啊？&lt;/li&gt;
&lt;li&gt;Ada：当然了，我敢打赌。&lt;/li&gt;
&lt;li&gt;图灵：可我总觉得不太有把握啊，有时我觉得看不懂她。&lt;/li&gt;
&lt;li&gt;Ada：人生就像一个OS lab，有时只是为了拿到分数，你不必看懂所有的代码。&lt;/li&gt;
&lt;li&gt;图灵：我要是约她出来会被拒吗？&lt;/li&gt;
&lt;li&gt;Ada：你想多了，以我对她十多年的了解，绝对不会。&lt;/li&gt;
&lt;li&gt;图灵：你这么说我就放心多了，本来我还挺没自信的。&lt;/li&gt;
&lt;li&gt;Ada：千万不要这样！&lt;/li&gt;
&lt;li&gt;图灵：那我下一步应该采取什么行动？&lt;/li&gt;
&lt;li&gt;Ada：顺其自然吧，我看好你哦。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[场景切换]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：（画外音）20XX年X月X日 星期X 晴，我们约好在电影院见面&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[图灵上，站着等待，偶尔整理衣襟，不时看表]&lt;/p&gt;

&lt;p&gt;[卖花女上]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;卖花女：先生，您在等人么？&lt;/li&gt;
&lt;li&gt;图灵：(微笑)是啊。&lt;/li&gt;
&lt;li&gt;卖花女：买只花给您的女朋友吧？&lt;/li&gt;
&lt;li&gt;图灵：(微笑)好啊。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[图灵买花，卖花女下。]&lt;/p&gt;

&lt;p&gt;[继续等待。办证男上。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;办证男：哥们儿，学计算机的吧？&lt;/li&gt;
&lt;li&gt;图灵：（惊讶）你怎么知道？&lt;/li&gt;
&lt;li&gt;办证男：气质啊！昂首挺胸，龙骧虎步，IT精英都这么帅。&lt;/li&gt;
&lt;li&gt;图灵：这样啊……&lt;/li&gt;
&lt;li&gt;办证男：要办证么？微软、思科、oracle认证应有尽有，另外学生证、学位证、结婚证、离婚证、独生子女证、自行车停车证……200一张，价格公道童叟无欺，做出来比真的还真。&lt;/li&gt;
&lt;li&gt;图灵：额……有复旦软院毕业证吗？&lt;/li&gt;
&lt;li&gt;办证男：那得多加2块钱。&lt;/li&gt;
&lt;li&gt;图灵：有什么特别的吗？&lt;/li&gt;
&lt;li&gt;办证男：名牌大学啊，总得有点品牌价值吧。怎么样，要不要来个试试?赠送杨玉良校长亲笔签名照哦~&lt;/li&gt;
&lt;li&gt;图灵：我看还是算了吧……&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[办证男下。]&lt;/p&gt;

&lt;p&gt;[图灵手机响起。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：喂，是朱安么?我一直在这里等你。我左手拿着一只玫瑰花，右手戴着你送我的手套。你在哪呢，我怎么没有看到你？(四处张望)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[一剽悍男子上。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;剽悍男：图灵，我在这！&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[图灵打断程序，换场景]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：停，停！这是谁干的？改我的程序？我的女主角怎么变成这样了？&lt;/li&gt;
&lt;li&gt;Ada：从头到尾都是你在yy，我实在看不下去了。&lt;/li&gt;
&lt;li&gt;图灵：瞎说，虽说经过了艺术升华，故事还是很真实的吧&lt;/li&gt;
&lt;li&gt;Ada：哼，懒得驳斥你。事情根本就不是这个样子的，看我来还原真相，揭露你的本来面目。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[第三幕完]&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>LZSB</title>
   <link href="http://blog.tomsheep.net/2011/06/23/lzsb"/>
   <updated>2011-06-23T03:44:40+08:00</updated>
   <id>http://blog.tomsheep.net/2011/06/23/lzsb</id>
   <content type="html">&lt;p&gt;被蚊子骚扰醒了，起来呻吟一下。&lt;/p&gt;

&lt;p&gt; 前天答辩结束，胆战心惊。评审老师很照顾，尤其是老猫，出乎我的意料，一反常态问了一个很和谐的问题就放我过了，最后还给了我A，觉得实在是过意不去，真想回到大二把他的RFID项目再做一遍。&lt;/p&gt;

&lt;p&gt; 每次翻开urp我都很感慨，跟祥林嫂一样，悔恨自己在某些课程上打下的基础不牢靠。经常友情出镜扮演阿毛的有“计算机网络”、“编译原理”、OS、“计算机图形学”等等，最近又多了Rudolf的“计算理论”——亏自己的博客还一度装逼地叫做“Y(F) = F(Y(F))”。唯一值得欣慰的是，近几个月恶补了“计算机网络”，效果喜人，小黑网吧网管不再是梦想。多读了一年书，66门课，170学分，看上去挺美，暗伤无数。我一直想写这样一篇文章，大意是如果我是院方，利用现有的教学资源，怎么安排课程，才能帮助学生稳健、高效地进步。可惜一直被毕业季的活动牵绊，拖着拖着就没动力了。&lt;/p&gt;

&lt;p&gt; 毕业大戏的剧本卡壳，灵感就像蚊子，你睡着的时候总是在你耳边飞来飞去联合军演，醒来后想拍死丫的结果却怎么也找不到了。中午一票同学去聚餐顺带讨论剧本，被连续灌酒——我一直比较好奇喝比较多的酒后是什么感觉，以前以为是“晕”，今天发现不是——其实是“胀”。下午收到公司寄回的三方，发现由于户籍问题需要自己办搞不清楚的手续，真是麻烦，万分坑爹。几年前若是遇到这种状况，我大概会抱怨制度不够公平，现在我一般会感慨自己不够牛X，还达不到无视这些劳什子的洒脱境界。晚上了结另一桩纠结的事情，一天还真是充实。临睡前得到万niu的鼎力帮助，非常感谢。&lt;/p&gt;

&lt;p&gt;在被蚊子成功吵醒后，突然发现，我的“起床困难症”是有的治的：把闹钟的铃音改成蚊子叫。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Sophia(2)</title>
   <link href="http://blog.tomsheep.net/2011/06/13/sophia2"/>
   <updated>2011-06-13T05:16:46+08:00</updated>
   <id>http://blog.tomsheep.net/2011/06/13/sophia2</id>
   <content type="html">&lt;h3&gt;第二幕  冯诺依曼的故事：拐点&lt;/h3&gt;

&lt;p&gt;[大二，某张江男生宿舍，冯诺依曼在聚精会神地玩电脑游戏，不时传来“God like”等游戏音效。桌上摆着吃过的泡面盒。]&lt;/p&gt;

&lt;p&gt;[图灵上。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：老冯，ICS今天点名了，老大十连杀，你不幸阵亡了。&lt;/li&gt;
&lt;li&gt;冯诺依曼：[不回头] 恩。&lt;/li&gt;
&lt;li&gt;图灵：老大还特意提到你了，说快期末了，都没见过你。&lt;/li&gt;
&lt;li&gt;冯诺依曼：恩。&lt;/li&gt;
&lt;li&gt;图灵：你丫真够淡定的，ICS关人很厉害的，上一届巴贝奇、阿坦纳索夫都挂了。那时节，真个是尸横遍野，血流成河啊……&lt;/li&gt;
&lt;li&gt;冯诺依曼：恩。挂得多了，也不在乎再多一门。&lt;/li&gt;
&lt;li&gt;图灵：老冯阿，抽空还是看看书吧，这门课补考也不好过。什么存储器阿，CPU阿，指令阿，IO阿，也不知道哪个脑抽的搞出这么套变态的体系出来？&lt;/li&gt;
&lt;li&gt;冯诺依曼：恩。&lt;/li&gt;
&lt;li&gt;图灵：我说老冯，别老恩阿恩阿的，跟大便似的。行动一下，你游戏玩的这么好，脑子一定灵光，稍微上点心就搞定了。&lt;/li&gt;
&lt;li&gt;冯诺依曼：恩。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[图灵无语。]&lt;/p&gt;

&lt;p&gt;[牛顿上。一脸沮丧。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;牛顿：苍天啊，我曾经对你说我希望有一个酷毙的人生，你一定是听错了，是酷毙，酷毙！不是苦逼啊……&lt;/li&gt;
&lt;li&gt;图灵：牛哥怎么又怀疑人生了？你那点破人生有什么好怀疑的？&lt;/li&gt;
&lt;li&gt;牛顿：灵儿阿……哥苦阿……&lt;/li&gt;
&lt;li&gt;图灵：[寒颤]我了个去，叫的怪恶心的。有什么不开心的，说出来大家开心一下？&lt;/li&gt;
&lt;li&gt;牛顿：转专业悲剧了……&lt;/li&gt;
&lt;li&gt;图灵：嗨，有什么大不了的，SS多好阿，有空调，有机房，六一还发棒棒糖……&lt;/li&gt;
&lt;li&gt;牛顿：可是我不喜欢计算机阿……我的梦想是做一个数学家……&lt;/li&gt;
&lt;li&gt;图灵：得了吧你，还数学家，高数作业还总抄莱布尼兹的。&lt;/li&gt;
&lt;li&gt;牛顿：我那是不屑、不屑……我们家巷子口的王半仙给我算过的，说我天赋异禀骨骼精奇，一看就是数学奇才……[被打断]&lt;/li&gt;
&lt;li&gt;图灵：化解数学危机，维护世界和平的任务就交给你是吧？&lt;/li&gt;
&lt;li&gt;牛顿：你怎么知道？&lt;/li&gt;
&lt;li&gt;图灵：靠，他还说我是新一代计算机之父呢。这种江湖术士，就知道蒙世骗钱。&lt;/li&gt;
&lt;li&gt;牛顿：哥苦啊……&lt;/li&gt;
&lt;li&gt;图灵：你看你们一个个萎靡的样子，一会儿有美女要来，都精神点儿。&lt;/li&gt;
&lt;li&gt;牛顿：美女也不能抚慰哥受伤的心灵……哪个美女？&lt;/li&gt;
&lt;li&gt;图灵：Ada，不光聪明漂亮，还特有气质那个，听说她爸是个诗人，难怪阿。&lt;/li&gt;
&lt;li&gt;牛顿：你怎么勾搭上的？&lt;/li&gt;
&lt;li&gt;图灵：什么勾搭？哥可是正儿八经的浪漫主义文学青年，以文会友，懂么你？&lt;/li&gt;
&lt;li&gt;牛顿：扯吧你。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[Ada上。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Ada：Hi 图灵、牛顿，都在呢？&lt;/li&gt;
&lt;li&gt;图灵：可不是么，牛哥本来心情不好，一听你要来，都乐飞起来了，万有引力已经无法阻止他了。&lt;/li&gt;
&lt;li&gt;牛顿：少扯淡。&lt;/li&gt;
&lt;li&gt;Ada：哈哈。[目光转向冯诺依曼] 这位是……冯诺依曼吧，平时不怎么见你？&lt;/li&gt;
&lt;li&gt;冯诺依曼：[回头] 啊，是。&lt;/li&gt;
&lt;li&gt;Ada：听说你游戏玩得很好阿&lt;/li&gt;
&lt;li&gt;冯诺依曼：哪里……玩不好，瞎玩。&lt;/li&gt;
&lt;li&gt;Ada：我早听说有一位游戏技艺超群的冯大神，传奇事迹连老大都知道了，以为多彪悍呢，今天一见发现还挺秀气的，哈哈。&lt;/li&gt;
&lt;li&gt;冯诺依曼：惭愧，惭愧。&lt;/li&gt;
&lt;li&gt;Ada：你都不怎么去上课，有点太宅了吧？除了游戏你不喜欢别的么？&lt;/li&gt;
&lt;li&gt;冯诺依曼：这个……&lt;/li&gt;
&lt;li&gt;图灵：啊，那个，其实老冯也是小文艺小清新，喜欢朗诵个诗歌啥的……&lt;/li&gt;
&lt;li&gt;冯诺依曼：[诧异] 啊？没……&lt;/li&gt;
&lt;li&gt;[图灵打断，接着说]&lt;/li&gt;
&lt;li&gt;图灵：尤其是拜伦，对吧老冯？&lt;/li&gt;
&lt;li&gt;Ada：[惊奇] 是吗？我爸就特别喜欢拜伦，我也挺喜欢。&lt;/li&gt;
&lt;li&gt;图灵：恩恩，老冯在寝室经常跟我切磋。&lt;/li&gt;
&lt;li&gt;冯诺依曼：额……&lt;/li&gt;
&lt;li&gt;Ada：你最喜欢拜伦哪首诗？&lt;/li&gt;
&lt;li&gt;冯诺依曼：这……&lt;/li&gt;
&lt;li&gt;图灵：老冯最喜欢《希腊战歌》，对吧老冯？&lt;/li&gt;
&lt;li&gt;Ada：阿,看不出来阿！这首诗读起来挺热血澎湃的：&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[朗诵《希腊战歌》节选]&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;醒来吧，斯巴达！  &lt;br/&gt;
今天你怎能睡梦沉沉？   &lt;br/&gt;
同你的老伙伴雅典，  &lt;br/&gt;
联合成无敌的大军！   &lt;br/&gt;
唤列奥尼达回来。   &lt;br/&gt;
这历代讴歌的领袖，   &lt;br/&gt;
这刚强可畏的统帅，  &lt;br/&gt;
他曾把你们拯救。  &lt;br/&gt;
扼守在温泉险关，  &lt;br/&gt;
他英勇牵制敌寇，  &lt;br/&gt;
同波斯军队鏖战，  &lt;br/&gt;
让祖国得保自由；  &lt;br/&gt;
他率领三百勇士，  &lt;br/&gt;
战斗中，始终挺立。  &lt;br/&gt;
像威猛无敌的雄狮，  &lt;br/&gt;
在滔滔血海中沉溺。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;[冯诺依曼的程序结束，四位主角从故事中跳出，回到之前的上下文]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：大牛你挺能整啊，这小故事弄的，刚刚的，我的形象太tm光辉了，这是什么精神，阿？你瞧瞧，人格魅力……[兴奋状]&lt;/li&gt;
&lt;li&gt;Ada：哈哈，挺不错的，把我夸的都不好意思了……话说大牛你还真是奋发图强，和过去大不一样了。&lt;/li&gt;
&lt;li&gt;冯诺依曼：[微微摇头]呵呵。&lt;/li&gt;
&lt;li&gt;牛顿：靠，为什么就我是打酱油的阿。还有，我有那么苦逼么？&lt;/li&gt;
&lt;li&gt;冯、牛、Ada：[三人齐声] 有！&lt;/li&gt;
&lt;li&gt;Ada：不过我觉得让大牛因为美女一首诗就产生这么大动力，有点怪怪的。我想情节可以改成这样：大牛起初沉迷于游戏，十分孤僻，在一次车祸后得到了同学们的关怀，感受到了集体的温暖，从此一扫颓势，努力学习，成为大牛。然而无情的病魔终将夺走他的生命，在弥留之际与大家依依惜别……&lt;/li&gt;
&lt;li&gt;冯诺依曼：我去，你还把我给写死了阿。&lt;/li&gt;
&lt;li&gt;图灵：这也太狗血了，你韩剧看多了吧。&lt;/li&gt;
&lt;li&gt;Ada：哼，说我的不好，你自己写写看阿。接下来就你写好了。&lt;/li&gt;
&lt;li&gt;图灵：那有何难？哥给你来点额嘞金德的，走你——[敲击键盘]&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[第二幕完]&lt;/p&gt;

&lt;p&gt;(未完待续)&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Sophia(1)</title>
   <link href="http://blog.tomsheep.net/2011/06/13/sophia1"/>
   <updated>2011-06-13T04:41:18+08:00</updated>
   <id>http://blog.tomsheep.net/2011/06/13/sophia1</id>
   <content type="html">&lt;p&gt;为07ss毕业大戏拟稿，想的挺多，头脑中一直浮现《暴雨将至》《低俗小说》的圆形叙事结构，又想试试浪漫主义反讽的巧宗，搞得挺复杂，不好下手。再加上我本身并不善于编故事，写剧本真是很大的挑战。最后不一定写得完，也不一定会被用。权且记在这里。&lt;/p&gt;

&lt;h2&gt;Sophia&lt;/h2&gt;

&lt;h3&gt;剧情概要&lt;/h3&gt;

&lt;p&gt;毕业季，07ss的几位同学准备合写一段回忆录式的程序“Sophia”，用来再现自己的大学时光，他们一起用各自的视角讲述了几段风格迥异的往事，这些回忆中的片段有的相辅相成、有的彼此矛盾，拼接出一段近似完整的故事。剧中故事的讲述者图灵、冯诺依曼、艾达和牛顿同时也是故事中的主人公，冯诺依曼的故事是一段与学习有关的讨论，图灵则讲述了自己的罗曼史，艾达对图灵的故事进行了吐槽，并篡改成了腐女版本。牛顿的故事发生在毕业季，描述了“Sophia”诞生的始末，这个故事最终把剧情带回了起点，完成圆形叙事。&lt;/p&gt;

&lt;h3&gt;人物表&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;图灵 -- 男，喜欢插科打诨，却又有浪漫主义情结的文艺青年&lt;/li&gt;
&lt;li&gt;冯诺依曼 -- 男，曾经挂科无数但最终奋发图强成为大牛&lt;/li&gt;
&lt;li&gt;艾达 -- 女，不可多得的女程序员，文理俱佳，微腐&lt;/li&gt;
&lt;li&gt;牛顿 -- 男，不喜欢计算机但无奈进入这个专业，最后对这个集体产生极深的认同感。&lt;/li&gt;
&lt;li&gt;阿兰 -- 男/女，龙套，图灵和艾达故事中图灵的“梦中情人”&lt;/li&gt;
&lt;/ul&gt;


&lt;h3&gt;备注&lt;/h3&gt;

&lt;p&gt;文中主人公名字来源：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：计算机科学之父，英国数学家。计算机界的最高荣誉“图灵奖”就是以他命名的。&lt;/li&gt;
&lt;li&gt;冯诺依曼：现代计算机体系奠基人。现代计算机采用由存储器、CPU、IO总线、外设等部件组成的“冯诺依曼体系”&lt;/li&gt;
&lt;li&gt;巴贝奇：英国数学家，计算机先驱。&lt;/li&gt;
&lt;li&gt;莱布尼兹：德国数学家，和牛顿在微积分的发明权归属问题上存在争议。&lt;/li&gt;
&lt;li&gt;牛顿：英国物理学家、数学家&lt;/li&gt;
&lt;li&gt;艾达：拜伦之女，公认的第一位计算机程序员。Ada语言就是为了纪念她而命名。&lt;/li&gt;
&lt;li&gt;阿兰：图灵的名字&lt;/li&gt;
&lt;/ul&gt;


&lt;h2&gt;第一幕&lt;/h2&gt;

&lt;p&gt;[软件楼第一会议室。]&lt;/p&gt;

&lt;p&gt;[图灵、冯诺依曼、艾达上。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;图灵：冯诺依曼大牛，你的prototype写好没有？酝酿这么久了，我们这都等米下锅呢。&lt;/li&gt;
&lt;li&gt;冯诺依曼：站着说话不腰疼，你来个试试？本尊花了好几个通宵呢，死了多少脑细胞，瞅瞅，Sophia 0.01。[打开电脑]。&lt;/li&gt;
&lt;li&gt;图灵：Sophia，也不知谁起这名字，一听就是一柴火妞。照我的意思，就得叫尼莫西妮(Mnemosyne)[陶醉状]，古希腊记忆女神，多有品位，多有层次。&lt;/li&gt;
&lt;li&gt;艾达：图——灵！！！说什么呢？！[微怒] Sophia，多好听的女孩名字，而且你们不觉得和software发音很接近么？用来做我们07ss的回忆录程序名再合适不过了。&lt;/li&gt;
&lt;li&gt;图灵：Ada女王息怒，您说的极是。[岔开话题] 冯大牛，您的程序怎么跑啊？&lt;/li&gt;
&lt;li&gt;冯诺依曼：这是个回忆录框架，我们可以添加自己的程序片段进去，组成完整的故事。先别忙着运行，等牛顿来了一起搞。[看表] 诶？都几点了，牛顿这小子怎么还不来？&lt;/li&gt;
&lt;li&gt;图灵：别又是被树上掉下来的ipad2给砸晕了吧？&lt;/li&gt;
&lt;li&gt;艾达：别贫了，再等等吧。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[片刻之后，牛顿上。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;牛顿：Hi, girls！想死你们了。&lt;/li&gt;
&lt;li&gt;图灵：死鬼，这么晚才来？&lt;/li&gt;
&lt;li&gt;冯诺依曼：您可算到了，快来看看程序吧。&lt;/li&gt;
&lt;li&gt;牛顿：原型做好了？哇，大牛就是大牛，不如你也姓牛吧？&lt;/li&gt;
&lt;li&gt;冯诺依曼：一边凉快切。[操作键盘] 这是个回忆录框架，每个人可以在时间轴上添加自己的故事片段，也可以改别人的，框架对时空重叠的故事会做自动融合。现在只有我的程序，大家多提宝贵意见，提了我也不一定听。[坏笑]&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;[第一幕完]&lt;/p&gt;

&lt;p&gt;（未完待续）&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>《Unix编程艺术》笔记</title>
   <link href="http://blog.tomsheep.net/2011/06/05/unix-as-an-oral-history"/>
   <updated>2011-06-05T23:33:07+08:00</updated>
   <id>http://blog.tomsheep.net/2011/06/05/unix-as-an-oral-history</id>
   <content type="html">&lt;p&gt;凡是敢把自己的书叫做The Art of XXX的，来头都不小，光是作者这份自信就能把小民工们震得五体投地，比如Knuth大神啊、Knuth大神啊、还有Knuth大神啊……今天推荐的这本书叫《Unix编程艺术》，作者是ESR，Unix界叫得响的一号人物，开源运动的主要倡导者之一。这本书也是早已声名在外、好评如潮，不包邮也如潮。&lt;/p&gt;

&lt;p&gt;由于中途被迫去写毕业论文，这本书的阅读过程被分为两断，如果按照我一贯的读书习惯，再加上惨不忍睹的记忆力，那多半就会中途而废了。好在豆瓣前不久推出了一个新的“笔记”功能，回头翻翻之前的笔记，思路竟然又续上了，十分欣慰，什么是好的产品功能？这就是啊。&lt;/p&gt;

&lt;p&gt;虽然也叫“编程艺术”，这本书和Knuth大神的书完全是两个路数，讲的是文化和哲学、思想和体系。动不动还能蹦出几句禅宗偈语，还有《道德经》什么的， 一看就是文化银。序言中说“Unix is not so much an operating system as an oral history”，乍一看不容易明白什么意思，再一看阿，就……更不明白了。等到读完全书，或许对此能有一些感悟。全书分为4个部分，第一部分主要是历史，讲述了Unix家族悠久而辉煌的过去、近现代遭受的屈辱与压迫、以及改革开发以来的取得的伟大成就……我最喜欢看的就是历史八卦，尤其是派系斗争什么的，所以这部分看的最认真-,-。了解了不少Unix的传承脉络以及它与其他操作系统之间的关联，还 有后来的“自由软件运动”和“开源运动”两大思潮——原来一直混淆两者的概念，如今才知道他们的区别：“自由软件运动”的目标是让所有软件摆脱知识产权的 约束，由RMS发起；“开源运动”着眼于经济与技术价值，主张源代码的自由获取。前者更加疯狂，后者更加务实。一个主张自由软件因为它是自由的，另一个主 张自由软件因为它比专有软件工作的更好。第二部分是Unix文化中的设计经验与原则，阅读时对“文本化协议”、“微语言”、“分离进程”的印象颇深，受益 匪浅，对照自己以往的经验，有些是相背离的，但过去却很少意识到其中的问题。第三部分通过大量Unix中的工具来阐释Unix设计哲学，实话说这些工具一 多半我都没接触过，自忖不是合格的Unixer，羞愧难当，匆匆掠过，等日后经验丰富再回头来看应该会产生更多的思考。最后一部分的标题是 “Community”，主要介绍Unix社区中的约定和标准，包括可移植性、文档标准、开源协议等等，从这个侧面来彰显Unix文化中隐藏的无穷生命力。&lt;/p&gt;

&lt;p&gt;整本书字里行间处处都流露出对Win32阵营的鄙视与不屑，看的时候觉得作者一把年纪还真是挺可爱的。对于Unix/Linux程序员，这是一本值得反复阅读的佳作；虽然这是我第一次翻阅它，但已经可以肯定，如果在一段时间之后再次读这本书，一定会给我带来新的思考。虽然我曾经在学院的系统实验室混迹过一年，但到现在仍然不是一个Unix/Linux系统的深层次开发者或使用者，直到最近才重新发现它的优越之处，并作为自己未来主要的工作环境。今天早上为了vps的配置了解了一番debian的启动流程，从bios自检到grub到init到一系列的启动脚本，出乎意料的顺畅，没有过去印象中的晦涩感，看来随着岁月的积累，知识也是会触类旁通的。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>我所知道的Server Push</title>
   <link href="http://blog.tomsheep.net/2011/05/27/server-push"/>
   <updated>2011-05-27T02:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/05/27/server-push</id>
   <content type="html">&lt;p&gt;由于大一时web课上得实在纠结，对于web技术一直存在抗拒心理，导致常年处于白痴状态，半年前去SAP实习算是为我二次启蒙，让我发觉这个领域相当广阔大有可为实在是知识青年上山下乡接受再教育的不二之选。最近几天正好接触到服务器“推”，总结一下相关技术：&lt;/p&gt;

&lt;h2&gt;无连接的HTTP&lt;/h2&gt;

&lt;p&gt;HTTP协议是整个Web的基础，它是一个无连接协议，基于请求/响应模型，不具备类似TCP一样的全双工能力，为了实现服务器端向客户端实时推送数据，必须采取一些hacks，或避开HTTP，或建立在HTTP之上。前者主要依靠富客户端技术如Flash、Java Applet、Silverlight等提供的socket机制，通过浏览器插件给予支持。这种方式实现简单、较为可靠，但削弱了web应用的灵活性，而且可能会陷入跨平台的窘境，下图阐述了这个深刻的道理：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/flash.png&quot; alt=&quot;悲剧的闪电侠&quot; /&gt;&lt;/p&gt;

&lt;p&gt;所以，基于原生HTTP协议的解决方案更为靠谱。HTTP1.1版本中增加了“HTTP长连接”，利用同一个tcp连接处理多个http请求和响应，也叫HTTP Keep-alive, 为push技术的高效实现提供了重要的底层原语。&lt;/p&gt;

&lt;p&gt;轮询是一种简单粗暴的解决方案，客户端在一定的频率下向服务器发送请求，询问服务器“是不是想给我推点啥”，高频率的轮询会造成大量的无用traffic，而低频率的轮询又往往有数据延时之虞。严格地讲，传统的轮询并不能归入“推”的行列。&lt;/p&gt;

&lt;h2&gt;Comet&lt;/h2&gt;

&lt;p&gt;十月革命一声炮响，给我们送来了Comet技术。（我比较讨厌这些一眼看上去看不出究竟是什么的装逼名词，彗星，彗星你妹啊）和Ajax一样，Comet其实是一个umbrella term，是一篮子技术的统称，提供低时延的服务器到客户端浏览器的数据传送。现有的Comet技术可以笼统地分为两大类，一类是基于长轮询的，比如XHR loog polling和Script tag long polling（CometP）。另一类是流式的，主要有XHR Streaming，forever frame等。绝大多数的Comet技术依赖于long-lived HTTP连接，需要服务器的特殊实现，因此造成了技术普及推广的小小障碍。下面介绍几种主流的Comet技术：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Forever Frame&lt;br/&gt;
在页面加载之后，DOM中生成一个隐藏的iframe，通过其src与服务器建立持久连接。通常服务器向浏览器推送一系列脚本，通常是一些callback functions的调用，在浏览器中运行，服务器与浏览器通过HTTP1.1的chunked encoding机制（服务器可以在不知道整个response有多长的情况下就开始会送响应，响应数据呈chunk序列，包在不闭合的html文档中）进行数据传送，浏览器接收后对渐进地对chunk数据进行处理。经过观察人人网的在线聊天工具采用的就是这种技术。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;XHR long polling&lt;br/&gt;
和传统的轮询不同，长轮询并不以一定的频率向服务器发送询问请求，而是采取这样的策略：客户端发起一个连接，服务器不马上返回，而是hold住这个连接，直到有数据要“推”给客户端时才发送响应；客户端收到响应之后马上再发起一个新的请求，如此反复。减少了传统轮询的无谓开销，只在服务器有话说时产生流量。通常长轮询服务器端会设置超时，在一段时间内连接双发均表示沉默则强制发回响应，以免产生大量的死链接。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CometP&lt;br/&gt;
又叫做Script tag long-polling，名字起的这么没个性，一看就不是什么新鲜玩意儿。它是long polling和jsonp的结合，用来支持跨域（cross-domain）请求。浏览器的安全限制规定脚本只能和处在同一域的server进行交互，否则视为不安全的（这是不是地域歧视？），但这样的无差别攻击，在打击了一小撮不法分子的同时，严重伤害了淳朴善良的外地务工好青年们，合理的cross-domain请求应该被允许。为了达到这个目的，苦逼的web工程师们想出了各种蛋疼的方法，比如找北京人结婚……啊，不是，jsonp就是其中之一。他的原理是，script标签的src是可以跨域的，那我们让服务器发回一个可运行的javascript对象，通常是对客户端已注册的回调函数的调用，就可以实现跨域了（进个城容易么）。而所谓的CometP，就是long polling + jsonp.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;BOSH（Bidirectional-streams Over Synchronous HTTP）&lt;br/&gt;
这是我毕设中涉及到的一个部分，BOSH是XMPP的一个拓展协议&lt;a href=&quot;http://xmpp.org/extensions/xep-0124.html&quot;&gt;XEP-0124&lt;/a&gt;，通过HTTP支持XMPP的全双工连接。我不确定它是不是可以归为Comet技术，因为Comet这个坑爹的名词含义太广边界模糊，而BOSH本质上有何主要的Comet技术很相似，所以放在这里也无妨。首先BOSH的架构是这样的：&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;     &lt;span class=&quot;n&quot;&gt;Server&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unwrapped&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;streams&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;HTTP&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CM&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;HTTP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wrapper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;Client&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Connection Manager（CM）是Client和Server之间的桥梁。Client和CM通过HTTP交流，CM和Server通过各种各样可能的方式交流（有很多不同的实现），我们只关心Client和CM之间的HTTP连接技术。&lt;/p&gt;

&lt;p&gt;BOSH同时支持传统轮询和长轮询模式（我想这就是所谓的degrade gracefully设计吧），因此可以很好的兼容受限的运行环境（比如mobile浏览器等），这一点来说一般的Comet技术就不容易做到，此外，与Comet不同，BOSH的CM返回完整的HTTP response，完美兼容缓存代理。（协议原文如此，不过按照我的理解，如果Comet是一个比较宽泛的、为了解决同一类问题而提出的技术概念，具体的实现有很多种，甚至BOSH都可以算所其中之一。也许我主观把Comet放大了？其实我说了我压根没摸准这个概念的边界）&lt;/p&gt;

&lt;p&gt;其实，Comet现在仍然处于后娘养的状态，没有成为Web标准的一部分，因此推广起来有一定的阻力。眼看着Ajax登堂入室，自己这么多年还没捞着个名分，心里肯定着急啊。HTML5新加入了两个规范，可以原生支持服务器“推”，这就是Websocket和server-sent events：Websocket是一个支持在浏览器和服务器之间建立全双工连接的协议，据说目前各个浏览器支持的都不好，有空可以试试。Server-sent events被Comet拥趸们视为Comet的未来，它允许浏览器与服务器建立一个持久的连接，并且实时地从服务器接收“事件”，这些事件是和DOM API关联的哦亲。&lt;/p&gt;

&lt;h2&gt;总结&lt;/h2&gt;

&lt;p&gt;本文介绍了我所知道的主要server push技术：包括富客户端技术、传统轮询、Comet技术（XHR long polling、CometP、隐藏iframe等）、BOSH、以及还在发展的HTML5标准中Websocket和Server-sent events规范。&lt;/p&gt;

&lt;p&gt;其实，说了这么多，不得感慨于这样一个这样的事实：标准才是web的王道，其余都是扯淡。什么server push，什么cross-domain，什么Comet，什么Ajax（这个已经扶正了），全是蹩脚的hacks。我等屁民，箪食壶浆以迎HTML5。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>博客更新</title>
   <link href="http://blog.tomsheep.net/2011/05/25/learn-everything-the-hard-way"/>
   <updated>2011-05-25T02:50:50+08:00</updated>
   <id>http://blog.tomsheep.net/2011/05/25/learn-everything-the-hard-way</id>
   <content type="html">&lt;p&gt; 拥有一个独立博客但不愿更新它是种很微妙的心态。从右边的archives来看，这半年我的blog水流细若游丝，再下去就快赶上鄱阳湖了。一直找不到让自己坚持写作的理由，以前试过写周记，一度效果不错，可惜越写越像怨妇，怎么看怎么二，索性就断了；更要命的是脸皮儿还薄，技术上这半瓶水实在又不好意思拿出来现眼；昨天我还和周丰说我想写小说，想了十年了，但不幸难产，到现在连个提纲都没有。我很担忧，再继续下去可能有一天我会丧失写字的能力。为了改变这种局面，前天我又搬了一次站点，彻底告别虚拟主机，转移到vps。但悲剧的是，搬完后竟连写个“Hello LNMP/worldpress”的动力都没有，想想都对不起每月七美刀的开销。博客写到这份儿上也算是很奇葩了。&lt;/p&gt;

&lt;p&gt;值此危急存亡之秋，我觉得需要有所表示。今后我的博客会频繁但不定期地出现以下几个话题：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;无病呻吟。就像你们已经习惯了的那样。&lt;/li&gt;
&lt;li&gt;我在看或想看的书。&lt;/li&gt;
&lt;li&gt;学习到或感兴趣的技术。主要领域涉及编程语言、网络协议、Unix/Linux、Web技术、体系结构。大牛请自觉绕行，严禁吐槽。&lt;/li&gt;
&lt;li&gt;虚构的故事&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;正好，几天前和未来的mentor聊天，他说他很喜欢python，我厚颜无耻地说我也喜欢= =，事实上我确实喜欢，你看我的博客不就是……那个……php的么（不挨着）。python有一段时间我很感兴趣，并设想将它作为我的第一语言，但可惜从未真正使用过它。在未来一段日子里，我的博客中会出现比较多的python学习贴，估计会很二。我时常这样安慰自己：放手去做吧，你已经这么二了，难道还能比现在更二么？&lt;/p&gt;

&lt;p&gt;其实，我能。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>不尴尬与怕麻烦</title>
   <link href="http://blog.tomsheep.net/2011/05/12/no_trouble"/>
   <updated>2011-05-12T01:55:43+08:00</updated>
   <id>http://blog.tomsheep.net/2011/05/12/no_trouble</id>
   <content type="html">&lt;p&gt; 我爸今晚喝醉了，卷着发硬的舌头反复在电话里数落我“母亲节为什么不给你妈发短信”，我一如既往“呵呵呵呵”地回应，笑得跟二傻子似的。我总觉得跟最亲近的人没有什么客套的必要，反而显得生分，多尴尬；他们也知道我的秉性，最多开玩笑地抱怨一下。&lt;/p&gt;

&lt;p&gt;   母亲节那天我在连云港，07ss的毕业游，地方一般，但大家玩的很high，一路上爆出很多八卦和基情，最后相聚的日子，真是难得的回忆。&lt;/p&gt;

&lt;p&gt; 柯君、小胖和大师对我的八卦很感兴趣，几年来一直想挖出点什么，为此不惜运用各种排列组合来旁敲侧击，今天早上一打开人人网，汗都下来了。我是一个比较有娱乐精神的人，牺牲小我娱乐大众还是很乐意的。之所以几年来室友们的刑侦工作一筹莫展，寝室中有关女生的话题我也从来只是听众，一则因为我的生活平淡无趣没有什么猛料可报，二则是虽然这几年我的性格和心态有了很大变化，但骨子里仍然很内向，面对人情世故的行事准则无外乎“不尴尬”和“怕麻烦”两项；而大师和柯君又都属于大功率的gossip发射源和中继器，你懂的，我不想为自己、尤其是别人带来意外的尴尬与麻烦。&lt;/p&gt;

&lt;p&gt; 毕业游回来的晚上和翔子、真理、大师一块吃饭，又聊到这个话题，他们绝对算得上我的老师，尤其是翔子，在人情世故上总是游刃有余，我很佩服。我还是打了马虎眼，总归是怕麻烦。我没有什么给力的八卦，几年来不是图书馆就是实验室，岁月蹉跎，情何以堪。大一的时候为了拿到喜欢的女生的QQ特地2B地去机房查过登录缓存，大二时写过情书，被发卡（年深日久记不清是什么卡了-,-），然后故事就结束了。我至今觉得很尴尬，为了减轻尴尬我不再用QQ，慢慢地就习惯只挂着gtalk了，这个聊天工具还真是挺棒的（后来有朋友说我只用gtalk这么个性的IM真是潮人，说的我一时不知道怎么回答- -|||）。了解这段历史的人不多，知道的也很有默契地心照不宣，我不会刻意掩饰，只是不想添麻烦。这就是我所有的故事了，还是过去完成时的，围观群众可以心满意足地退散了，不要再信谣传谣了，党员同志，说的就是你。（PS：不要问主角是谁这样的问题，没有意义，而且我说过了，麻烦）&lt;/p&gt;

&lt;p&gt;最后，补一个“母亲节快乐”吧，根据我站点的IP访问统计，我爸妈应该是这个博客最忠实的读者，所以，你应该看得到。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>复旦往事</title>
   <link href="http://blog.tomsheep.net/2011/04/10/once_upon_a_time_in_fudan"/>
   <updated>2011-04-10T11:35:00+08:00</updated>
   <id>http://blog.tomsheep.net/2011/04/10/once_upon_a_time_in_fudan</id>
   <content type="html">&lt;p&gt;这是07ss毕业日志接力的第一篇。高导把这个任务交给我，我觉得责任重大，好比奥运会点火，基调务必积极，内容务必充实，感情务必真挚，寓意务必深刻……在我国悠久而璀璨的文学史上，这样的史诗巨著多半都会有一个振聋发聩的标题，然后伴随“今年是全面贯彻落实XX大提出的各项任务的第X年……”这样的一个发语句而娓娓道来。这对我来说无疑是一个挑战，我更希望这篇文章能成为晚会开始前的热场节目，起到抛砖引玉的作用。&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  复旦往事&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  Copyright (C) 2011  07ss-Kang Liu&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  This article is free: you can redistribute it and/or modify&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  it under the terms of the Software School Public License as published by&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  the Fudan 07SS Graduation Committee, either version 1 of the License, or&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  any later version.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  This article is distributed in the hope that it will be useful,&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  but WITHOUT ANY WARRANTY; without even the implied warranty of&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  Software School Public License for more details.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  You should have received a copy of the Software School Public License&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*  along with this article. If not, forget it.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;我的故事从06年开始。那时候，双核的CPU刚刚开始流行，vista还在微软的孕育中，facebook对于大多数的中国人来说还很陌生（当然，现在也很陌生）；那时候，上海满大街还都是8k一米的房子，猪肉也卖不到两位数，据经历过那个年代的老人们描述，当时，蛋饼居然是一块五一个的；那时候，韩寒仍在整天不痛不痒地和作协打嘴仗，李敖的精神也还算正常；不过，那时候黄健翔已经疯了，整个夏天满世界都是他和他的咆哮体……&lt;/p&gt;

&lt;p&gt;我的大学就开始于从这个纯真美好的年代。起初我的专业是药学，对这个领域我很难说喜欢或者不喜欢，只是由于自己是被调剂进来的，一直耿耿于怀。一年后我转系到07ss，开始另一段故事。降级转系其实是一件相对美妙的事情，相当于游戏中途挂掉然后读档重来，结果发现经验值居然被保留了，这似乎是个bug。在系统漏洞的帮助下，我越来越热爱这个专业，立志成为一名优秀的程序员。&lt;/p&gt;

&lt;p&gt;那时我和一同转系的zy、minqh、ciccino住在东区：zy比较活跃，表面玩世不恭，私下却很上进。善于制造话题，拥有很多独特唱段的专利，比如“你真是没什么良心，就这样把我抛弃”，唱得鬼哭狼嚎人神共愤，成为大家平淡生活中的点缀，也为黑白回忆中增添了一抹亮色。相比之下他的鞋就不太容易让人接受了，我浅薄的化学知识远不足以解释其中发生了什么复杂的反应。后来他自觉地把鞋摆在门外，祸害下风口的邻居们（你有日本血统？）。值得欣慰的是，zy对寝室内务贡献很大，那一年我们的评分一直很高，多半是他的功劳。&lt;/p&gt;

&lt;p&gt;minqh可能是我认识的人当中和我最像的，我们有很多重叠的爱好，性格和价值观也很接近。不过他比我温柔的多，更加随和善良，也没我这么固执。他比我小近两岁，但我一直坚持叫他“豪哥”，开始是为了装嫩，后来物换星移，“哥”在当代汉语里逐渐演变成一种尊称，和彼时的“子”差不多，用在这里倒是恰如其分了。豪哥是正经的文学青年，善感而不多愁，工于诗词歌赋——长调小令、律诗绝句、乐府古风，都有相当的水准，我着实佩服。时而会有一些很文艺的念头，比如曾经提议一起骑车去某地看日出。我们在一起谈论最多的话题可能是《仙剑》系列的游戏，他后来对类似风格的武侠RPG非常痴迷。我总记着欠他一串香蕉，起因是曾经我请他代为完成一个项目的文档，理由是我们“相交”多年，在毕业之前，我想应该兑现一下。（要不算了？）&lt;/p&gt;

&lt;p&gt;ciccino像是漫画里的人物，一表人才，长得像做过面膜后的杨致远。他的女友为此十分自豪，曾经让人发指地用“你们寝室最帅的”来指代他，这种严重伤害第三世界人民感情的行为应该永远遭到唾弃！ciccino处事比较淡定，有板有眼，没怎么见他特别着急过。如果听到一条出人意料的新闻，我一般会说“啊？”，豪哥会说“这……”并拉一个比较长的尾音，zy会上身后仰、眉毛上挑、两眼发光并吸溜一口冷气，而ciccino一般会幽幽地回复：“不知道了吧，其实……（此处略去若干字）”。他和zy都喜欢玩dota一类的游戏，每天都要切磋，乐此不疲，我对此一窍不通，只觉得代沟颇深。我们一起经历的故事并不多，印象最深的一次是我被一张恶作剧图片吓得魂不附体，把抽屉用手“劈”下来准备乱扔，幸好他及时把我摁住，奋不顾身地挽救了大量集体财产。&lt;/p&gt;

&lt;p&gt;大二后来到张江，整个世界清净了很多：没有了铺天盖地的社团活动，没有了各种各样的名家讲座，没有了3108，没有了志达书店，没有了曦园，没有了光草，就连校园里到处传教的mm都没有了，不能不让人伤感。不过张江实在是个幽静宜人的好地方，在这里07ss逐渐成型，大家开始拥有共同的集体记忆：ICS、 老大、离散、OS、实验室、deadline、deadline、deadline、deadline……&lt;/p&gt;

&lt;p&gt;与此同时我有了三位新室友，其中hackerzhou是个性最为鲜明的，技术突出，为人高调，喜怒哀乐写在脸上，永远充满战斗力，像一台功率永远开到最大的发动机。他热衷于把技术运用于任何可能的地方，享受成功带来的荣耀和快感。所谓“不疯魔，不成活”，我有时觉得，这才是合格的程序员。过去他最惯用句型是：“XXX，肾亏啊”，后来变成了“做XXX的都是SB”，由此我们看到了一个SSer的成长——后者显然更容易被形式化地表示为∀x: DO(x) → SB(x) ，教数理逻辑的李弋老师一定很欣慰。&lt;/p&gt;

&lt;p&gt;kejun是寝室中唯一的党员，认真负责，踏实靠谱，改变了我对党员的一贯看法。喜欢运动，足球踢得不错。后来脚受伤，运动转向室内，经常在床上做仰卧起坐。在寝室喜欢和hackerzhou相互挑逗，他们对话过程一般是这样的：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;kejun：波波~

hackerzhou：小ke——jun啊，今天XX了没有？

kejun：波波~你是大波波~

……

……

……

hackerzhou： XXX的都是SB。
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;这样的开局和结尾几乎出现在他们的所有会话中，逐渐形成类似于TCP一样的握手协议。&lt;/p&gt;

&lt;p&gt;小胖是寝室中最具悬念的成员，这不仅仅因为他喜欢《柯南》这样的侦探剧，而更重要的原因是，他的体重一直是一个谜。小胖很招人喜欢，人缘也很好。容易知足，过的很洒脱。小说和游戏是他生活中最重要的东西，在我的印象里，3年中，他应该在《三国志》里统一中国了七八次，《NBA20XX》里拿到5枚以上的总冠军戒指，《英雄无敌》通关若干次，每天晚上一边dota一边冲着隔壁大喊：“搞毛啊，张凯！”……我经常拿绕口令逗他，“花二百钱买一小猪，吱儿吱儿喝水嗝儿吧嗝儿吧吃豆，接墙头扔出去吱儿地一声您猜怎么着？死——了！”，后来他也学会了，不等我说完会自己接下句。夏天他几乎不穿衣服，我隔三差五为他拍一套写真，照片曝光后他很生气，胁迫我把相册删掉。不过最近他的作息越来越不规律，我觉得应该是人生缺少原动力，为此，我认为有必要开展“随手拍解救大龄小胖猪”的活动，你觉得呢？&lt;/p&gt;

&lt;p&gt;……&lt;/p&gt;

&lt;p&gt;还有3C，我们每次见面都要用最恶心的语言相互吹捧……&lt;/p&gt;

&lt;p&gt;还有老贺，我们每次见面都要用最恶心的语言相互嘲讽……&lt;/p&gt;

&lt;p&gt;还有zellux，我大学时代的偶像，让人自豪的是曾经我和他的差距只有一个cubicle……&lt;/p&gt;

&lt;p&gt;还有TD，我觉得这小子的领悟力可强可强了……&lt;/p&gt;

&lt;p&gt;……&lt;/p&gt;

&lt;p&gt;时光荏苒，白驹过隙（咳咳要结尾了），这些人和事终将不可避免地成为回忆录中的故事，它们慢慢模糊、扭曲、掉色，成为记忆中零散的二维碎片；主人公们各奔东西，各自习惯于另一段生活，也许不再会有交集，彼此成为对方Messenger中偶尔点开的图标……即便这样，这些故事仍然像一个个有side-effect的函数，你或许忘记了它的逻辑、它的签名、它的作者，但你发现事实就是：不知道在他娘的哪一行，就把哥的值给改了！&lt;/p&gt;

&lt;p&gt;@Next：认真阅读“小胖是寝室中……”自然段，回答段末提出的问题并试分析该方案的可行性。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>不是历史</title>
   <link href="http://blog.tomsheep.net/2011/03/24/not_history"/>
   <updated>2011-03-24T00:24:54+08:00</updated>
   <id>http://blog.tomsheep.net/2011/03/24/not_history</id>
   <content type="html">&lt;p&gt;“听相声听贯儿，听评书听赞儿。”老贺对此一直表示不理解——为什么有人会喜欢一遍又一遍地听一段笑点已经烂熟于胸的传统相声，这应该比玩星际时地图全开完全知道对手的一举一动还要无聊。上周末忽悠他一起去参加了一个相声沙龙，合作了一把《蛤蟆鼓》，入门级的段子。尽管加上老师一共才三个听众，也让我十分紧张。之后他终于认同了我的观点：听的不光是包袱，更重要的是节奏。&lt;/p&gt;

&lt;p&gt;我上一次说相声是在小学的班会上，说的是什么都忘了，那时也没有捧哏逗哏的概念，就是一通胡说八道。不过我印象中效果还不错，可能是因为那时我的体型还比较圆润，和又高又瘦的搭档一块站在台上就已经很有喜感了。而这次有机会表演实属意外，是我近一段时间在这座我即将离开的城市里有计划地四处乱逛的收获。&lt;/p&gt;

&lt;p&gt;我的博客停止更新了很久，之间有一段时间还被告知撤销备案，现在也不知道被搬到了哪个国家的服务器上。这都无关紧要，问题是我已经不太会写字了，尤其是140字以上的。前一段看到王小峰写文章感慨博客日渐式微，有些同感。昔日的改良派，一朝成了保皇党，一不留神就做了历史的炮灰，大概就是这个感觉。不过我相信传统博客的生命力依然旺盛，时代只是带走了本来就不适合写博客的一批人。为了表明我还没有没淘汰，只好再挣扎着呻吟几句：我觉得，我还可以再抢救一下。&lt;/p&gt;

&lt;p&gt;前一段时间看了几本书，一本是李敖的小说《北京法源寺》，另外是科幻作家刘慈欣的一个系列——《三体》。两本书风马牛不相及，压根不是一个类型，但都让我想到了历史。《北京法源寺》本身更像是李敖在自说自话自问自答，借历史人物之口，浇自己心中块垒——通篇看到的都是寂寞。“群体是健忘的，是非不定的，忘恩负义的，残忍的。愈是伟大的民族，愈有这些特色。所以，有一天，当你遭受了这种待遇，你可能变得更爱中国，但不爱中国人。”这句话不是全书的主旨，却让我印象深刻，并且联想到了同时在看的《三体》。如果把“中国”推广至整个人类社会，这种联系就更加明显了。《三体》无论从故事结构、人文关怀还是理论基础来说都是佳作，三部曲每一部都将前作的视界拓宽了一个层次，最终归结于宇宙历史的大循环。不过，还能续么？&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;八角鼓 岔曲《历史》&lt;/p&gt;

&lt;p&gt;词：溥心畬  唱：张卫东&lt;/p&gt;

&lt;p&gt;上世号三皇，岁月茫茫。定礼乐，正天常，五帝治世，德被遐方。&lt;/p&gt;

&lt;p&gt;唐虞揖让圣人邦，汤武争诛道已伤。周室东迁纲纪紊，五霸七雄各逞强。&lt;/p&gt;

&lt;p&gt;楚汉争秦归一统，汉鼎三分魏已亡。晋室平吴方颂武，纷扰中华五姓狂。&lt;/p&gt;

&lt;p&gt;更分东晋居江左，无非是转眼韶华梦一场。&lt;/p&gt;

&lt;p&gt;刘裕篡晋遂称帝，八代为君祚已亡。这正是忠臣徒叹袁开府，天命终归萧建康，&lt;/p&gt;

&lt;p&gt;石城谣，义气高传千载上，梁灭齐，陈灭梁，叔宝风流顷刻亡。&lt;/p&gt;

&lt;p&gt;元魏北朝称盛事，更有那一成一夏，两赵三秦，四燕并五凉。&lt;/p&gt;

&lt;p&gt;周齐灭后隋文起，溥天之下始尊王。曾几何时传唐室，八水皇都王气长。&lt;/p&gt;

&lt;p&gt;唐末相争分五季，天心眷顾宋家邦。辽金空自称雄武，会看白燕过长江。&lt;/p&gt;

&lt;p&gt;元明帝业归何处，玉垒浮云变不常。这正是，古今青史分明在，伤心人话旧兴亡。&lt;/p&gt;&lt;/blockquote&gt;
</content>
 </entry>
 
 <entry>
   <title>没那么简单</title>
   <link href="http://blog.tomsheep.net/2011/01/01/not_so_easy"/>
   <updated>2011-01-01T00:15:41+08:00</updated>
   <id>http://blog.tomsheep.net/2011/01/01/not_so_easy</id>
   <content type="html">&lt;p&gt;不久之前某著名社交网站YouKnowWho上有个投票，让选一首歌来总结一下自己的2010，我想了想选了标题这首。&lt;/p&gt;

&lt;p&gt;年初的时候很多事情看不懂想不明白，还特意躲去香港了一阵，可惜山上除了两条腿的教授就是四只眼的学生，没见着什么高僧。回来后把心一横，决定把自己卖了。为了卖出个好价钱，一个学期没上课，躲在寝室看电影，间歇性在阳台练个贯口。罗老师老说“只有偏执狂才能生存”，我得试试。后来果然混进摩根士丹利做实习生，还没等我想明白是怎么回事，他们就把我摘出来了，看来他们想明白了。 这个时候我已经开始迷恋函数式编程，不停找语言理论的书看，觉得要不是出来道上混了，真得去读个相关的PHD。喜欢的人都说这东西优美如诗，我觉得一点不假，玩多了都容易装X而且越装越深沉。招聘大军刚来的时候准备不足，紧张得出了一身汗。忙了两个月，雅虎愿意接盘，我挺高兴。有人说，怪不得这公司越混越惨。后半年的课也没怎么上，我挺心痛，虽然课水，但学费真的挺贵。&lt;/p&gt;

&lt;p&gt; 这是2010的大致经历，但事实上远没有这么轻描淡写，很多事我也记不住了。原先不懂的现在只能懂个大概，原先以为懂的现在发现懵懂的厉害。托应试教育的福，骂了这么多年，拿着不错的GPA，得了便宜还卖乖。有意思么？没意思，但未必一点意思都没有；应聘期间有一段时间挺恍惚，跟着起哄盯着起薪说事，后来觉得不对劲，当初决定出来做民工的时候挺大义凛然的，你丫不是理想主义么，理想都让狗吃了？有意思么？有意思，但也不是特别有意思；群体性事件越来越密集，以后可能也得划档期，还得分级。我一直大概算是个右愤，可渐渐觉得我越来越看不懂了，我身处的环境似乎既不像“他们”说的那样，也不像“他们”说的那样。看来我得我走走，围观能不能改变中国我不知道，宅在家里骂街肯定不能。&lt;/p&gt;

&lt;p&gt; 最大的收获也许是看了100多部电影，比头二十多年加一块还多，还真给培养出一个新的爱好。技术上深度没太多长进，广度是宽了不少，另外对互联网应用有了新的认识，开始喜欢前端技术，不再觉得技术本身有高下之分，也不再觉得技术是解决问题的本质。这需要感谢在SAP的实习。&lt;/p&gt;

&lt;p&gt; 明年应该是个拐点，左接波澜壮阔的2010，右临生死未卜的2012。我前几天不知道在哪个微博里写，我的愿望是能干成几件让自己觉得特牛X的事。这挺不容易的，时间凑个整算十年吧。上一个十年值得自豪的大概一个是几个星期减掉40多斤，还有就是一咬牙一跺脚学了IT。关于后面的故事，我很期待。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>记一次难忘的版聚</title>
   <link href="http://blog.tomsheep.net/2010/12/23/shaanxi-party-2010"/>
   <updated>2010-12-23T00:55:56+08:00</updated>
   <id>http://blog.tomsheep.net/2010/12/23/shaanxi-party-2010</id>
   <content type="html">&lt;p&gt;第一次参加版聚，心情激动，手表也很激动，直接后果是来得太早，只好独自欣赏了好一会大秦富贵墙壁上的名人留影，斯琴高娃就快在我的凝视之下变成蒙娜丽莎的时候，版二华丽地出现了（此处有掌声），彻底颠覆了我对女博士的认知，怎么可以这么年轻！&lt;/p&gt;

&lt;p&gt;人陆续到齐，比预想好像还多，不过基本都不认识，互通ID之后，发现坐我旁边的大哥就是传说中的ADMLN，我当时的感觉让金庸来写恐怕只有“心中一荡”这四个字堪堪可以描述；whitewater同学是整场的焦点，后来我们关于他父母的生日展开了激烈的讨论；旁边酷似任泉的帅哥huhao也相当亮眼，让人羡慕嫉妒恨，同是张江男，怎么差距就这么大？后来加入的几位美女让本次版聚的面貌焕然一新，本次论坛的两大主题，“寻亲找人”和“星座专题研究”也逐渐浮出水面……当然，你们、你们不觉得少了点什么吗？&lt;/p&gt;

&lt;p&gt;是的。&lt;/p&gt;

&lt;p&gt;niu。&lt;/p&gt;

&lt;p&gt;“你们多少人是来围观niu的？” 一个声音淡淡的说。&lt;/p&gt;

&lt;p&gt;沉默。恰似这寂静的夜。&lt;/p&gt;

&lt;p&gt;所有人都举起了手。&lt;/p&gt;

&lt;p&gt;niu推门的一瞬，整个画面先是出现了一个2秒的定格，随后就进入了一个令人窒息的长镜头，niu迈步走向座位，帧数降到16，宛如彼时的发哥。“niu？”“他就是niu？”“啊，niu？”“%……(#@”“niu、niu、niu不是女的吗？” 大凡传说中的人物，总是让人难以捉摸。niu选了离我只有一个座位地方坐下，随后我就再也不敢多说话，在niu的气场之下陷入了深深的思索……&lt;/p&gt;

&lt;p&gt;版聚继续围绕主题进行，吃的什么大致记不住了，只记得whitewater大放异彩，口吐珠玑，舌灿莲花，段子迭出，由于记不住父母生日又将气氛推向高潮，而niu则一幅大佬做派，儒雅，淡定。一个声音说：&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Nature and nature&#39;s laws lay hid in night.&lt;/p&gt;

&lt;p&gt;God says “Let niu be!”and all was right.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;后来大家玩杀人，两次都是杀手赢，每次杀手都有moniu。我做了一会警察，好激动，和whitewater一拨，可惜没有机会很风骚地在阳台上吹着风拿着枪指着他额头摆pose，“警察请睁眼……警察请睁眼……警察请睁眼……警察眼睛太小了……” whitewater，说你呢。&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;大哥，好像没反应。&lt;/p&gt;

&lt;p&gt;不急，让警察飞一会儿。&lt;/p&gt;

&lt;p&gt;我是警察，谁知道？&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;版聚在欢乐祥和的气氛中结束，大家在一楼合了影，定格，音乐起，出字幕。&lt;/p&gt;

&lt;p&gt;特别鸣谢：&lt;/p&gt;

&lt;p&gt;勤劳负责的sanren&lt;/p&gt;

&lt;p&gt;气场强大的niu&lt;/p&gt;

&lt;p&gt;诙谐幽默的whitewater&lt;/p&gt;

&lt;p&gt;秀色可餐的任泉huhao&lt;/p&gt;

&lt;p&gt;叱咤BBS的邻省友人ToT&lt;/p&gt;

&lt;p&gt;坐在niu身边、落落大方的orangebaby&lt;/p&gt;

&lt;p&gt;气质不凡的moniu&lt;/p&gt;

&lt;p&gt;星座达人TuTuHeimm&lt;/p&gt;

&lt;p&gt;同为星座达人的MengMeng&lt;/p&gt;

&lt;p&gt;秀气可爱的lilykaye&lt;/p&gt;

&lt;p&gt;拥有珍奇姓氏的chaner&lt;/p&gt;

&lt;p&gt;相对低调的tracycy&lt;/p&gt;

&lt;p&gt;花丛之中幸福的cccpu&lt;/p&gt;

&lt;p&gt;不知道在干啥的tomsheep&lt;/p&gt;

&lt;p&gt;&lt;em&gt;The End&lt;/em&gt;&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>穆赫兰道</title>
   <link href="http://blog.tomsheep.net/2010/12/15/hibernate"/>
   <updated>2010-12-15T19:03:55+08:00</updated>
   <id>http://blog.tomsheep.net/2010/12/15/hibernate</id>
   <content type="html">&lt;p&gt;电影究竟应该怎么拍才能让观众完全不知所云但看完后还得往死了夸：“太NB了。”去看《穆赫兰道》就知道了。&lt;/p&gt;

&lt;p&gt;在豆瓣文艺青年们的指点下，我终于明白这是一个怎样的故事，为此我又无聊地去看了一次弗洛依德的《释梦》，全书的中心思想是“梦是愿望的达成”——在刚入学的时候我的室友在上完某节心理学的课程后非常兴奋地向我描述书中的情节，大约的意思是一个曾经丧子的少妇梦到自己的侄女也死掉，是因为她想再次见到葬礼上的帅哥。作为一个闷骚青年我对此表示出了极大的兴趣，但后来发现这样的书对我来说催眠作用要更加明显一些——这次效果好一点，我从图书馆醒来的时候Kindle上的进度条写着21%。&lt;/p&gt;

&lt;p&gt;最近接连看了一批同类型的电影，结果是做了一批不同类型的梦，而且相当真切，有一个是这样的：我坐在复旦的教室里做高中语文的卷子，结果漏了好几题没答，但紧接着就公布成绩，老师说，你是最高分，我很激动，说不可能啊，抬头看她的脸，是yahoo的HR……这个梦过于强大，不仅杂糅了相当多的真实细节，而且用最简单的场景总结了一个典型中国少年在应试教育下畸形的成长经历。所以我更加觉得，我是有导演潜质的。&lt;/p&gt;

&lt;p&gt;为了让自己的精神状态恢复过来，我加长了自己的睡眠时间，并且用另一批喜剧来平复我脆弱的心灵——等等，相信以上的描述给大家造成了我很闲的错觉，事实上不完全是这样，因为我发觉，每到这个季节，我都很难集中精力在CS、SE的专业学习中有所进展，以前我都想方设法用各种刺激消费的手段让自己保持状态，但是无一例外会让我非常疲惫并且情绪低落，后来我发现，趁机看一些非工科书籍，降低网络使用频率，可能是更好的选择。张叫兽昨天说了，“真正的消费不是刺激出来的”。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Trying so hard to be an asshole</title>
   <link href="http://blog.tomsheep.net/2010/11/26/trying-so-hard-to-be-an-asshole"/>
   <updated>2010-11-26T07:24:35+08:00</updated>
   <id>http://blog.tomsheep.net/2010/11/26/trying-so-hard-to-be-an-asshole</id>
   <content type="html">&lt;p&gt;张罗了两个月，把自己卖了。当初走出这一步的时候大义凛然，现在心情很复杂。最后一轮选择中拒掉上海一份薪水颇高的工作，选择去北京。这再次让我觉得这么多年来我一直都很倔强。从昨天晚上漫无目的游荡一圈回来后，情绪变得非常低落，我开始努力回想这些年的经历，如果恰好手上有一本日记，估计可以再拍一部《蝴蝶效应》。&lt;/p&gt;

&lt;p&gt;几年前来到上海是从一次严重的挫折开始，后来发生在我身上的挫折就从来没有停止过。我对这件事情的基本看法是，我的前十多年太顺利了，出来混总是要还的。&lt;/p&gt;

&lt;p&gt;曾经我以为我会去北京，后来我来了上海。&lt;/p&gt;

&lt;p&gt;曾经我以为我会读物理，后来我做了IT。&lt;/p&gt;

&lt;p&gt;曾经我以为自己是半个文青，后来我是二手geek。&lt;/p&gt;

&lt;p&gt;曾经我以为我可以做好每一个project，后来竟然没有一个能让自己满意。&lt;/p&gt;

&lt;p&gt;曾经我以为我离大牛很近，后来发现确实很近，他们也经常去我喜欢的那家餐馆吃饭。&lt;/p&gt;

&lt;p&gt;曾经我以为自己天赋异禀头脑灵光，后来甚至记不住一串电话号码。&lt;/p&gt;

&lt;p&gt;曾经我以为我可以得到女孩的欣赏，后来觉得这个实在是可遇不可求。&lt;/p&gt;

&lt;p&gt;曾经我以为我会在实验室大有作为，后来我慎重地选择离开。&lt;/p&gt;

&lt;p&gt;曾经我以为我会成为一个兢兢业业的科学家，后来我成为一个兢兢业业的准民工。&lt;/p&gt;

&lt;p&gt;曾经我以为我会留在大摩，后来他们觉得不太合适。&lt;/p&gt;

&lt;p&gt;曾经我以为我会留在上海，后来我选择去北京。&lt;/p&gt;

&lt;p&gt;……&lt;/p&gt;

&lt;p&gt;每一段经历都会给我带来一些思考，学会控制自己的情绪、冷静地处理变局、保持积极的姿态、习惯性装X、一如既往地特立独行、标新立异、唾弃平庸……&lt;/p&gt;

&lt;p&gt;几个小时前，我在email里用极尽委婉的措辞推掉完美时空的offer，为这两个月的经历画上句号。每次拒绝offer我都毕恭毕敬，老贺曾经问为什么要这么谨慎，我觉得，一则为了尊重所有给予我认可的企业，二则希望不会影响到师弟师妹们的求职。看到了吧，学弟学妹们，尤其是学妹们，哥是很靠谱的。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>后悔的是孙子</title>
   <link href="http://blog.tomsheep.net/2010/11/14/never_regret"/>
   <updated>2010-11-14T19:56:45+08:00</updated>
   <id>http://blog.tomsheep.net/2010/11/14/never_regret</id>
   <content type="html">&lt;p&gt; “这个条件不读研可惜了。”今天不知是我第几次从面试官/HR口中听到这样的评价，一般这种时候我都会调出一个面部痉挛般的笑容然后装X地表示学历于我如浮云并且捎带脚BS一下国内的研究生教育，这个桥段我已经演练得烂熟于心以至于可以不假思索地背出下面的台词：&lt;/p&gt;

&lt;p&gt;“我认为个人能力与学历没有必然联系，同时我也认为我不需要一张文凭来带给我更多的自信。在高校的研究所里浑浑噩噩虚度光阴，还是在一家出色的企业中接受挑战，我相信后者可以让我变得更加优秀……”&lt;/p&gt;

&lt;p&gt;但说多了也会觉得反胃，何况众口铄金，再坚定的想法也得给整晕了。这个效果和恒源祥脑白金的广告是一样一样的。于是我在今天的演出末尾加了一个反问：“您认为grads比undergrads更有前途么？”HR给了一个很中肯的回答，我觉得很有诚意。&lt;/p&gt;

&lt;p&gt;实际上我在等自己回答，在电梯里我对着反光的墙问“你TM认为grads比undergrads更有前途么？”我得到一个很给力的回答，“有你妹。”&lt;/p&gt;

&lt;p&gt; I will never be a loser, dude.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>人各有病</title>
   <link href="http://blog.tomsheep.net/2010/11/03/everyone_is_patient"/>
   <updated>2010-11-03T01:57:17+08:00</updated>
   <id>http://blog.tomsheep.net/2010/11/03/everyone_is_patient</id>
   <content type="html">&lt;p&gt;陆续收了几个还算不错的offer，但情绪反而有些烦躁，压力越来越大，一些想法也不如过去那样坚定了。现实没有传说中的糟糕，也没有想象中的美好，每天承受着来自不同方向的冲击，思考不着边际的问题，我想我是有点累。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;总体而言，这一个多月感觉如何？&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;太复杂了，下一个问题。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;目前为止，你有哪些offer？&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;百度、Yahoo、淘宝&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;你对自己的表现满意吗？&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;差强人意，总会有很多遗憾。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;最遗憾的经历是什么？&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;被Google秒杀。我多么希望可以再来一次，尽管极有可能最终的结果仍然是被秒杀，那我认了。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;你自认为表现最好的面试是哪一次？&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Yahoo。题目有难度但做的很顺，运气也不错。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;如果现有的offer是你所能拿到的全部，你会选择哪家公司？&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;百度或者Yahoo，百度几率大些。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;你的选择标准是什么？&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Package。这真是一个英雄气短的答案，但这就是TMD现实情况。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;现在的状况和你当初预想的出入有多大？对此有何感触？&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;大致猜到了结果，但过程几乎全错。在同龄人中，我还算幸运，但这基本没能让我高兴起来。理想主义在这个社会里实在是件易碎品，我大概只是叶公好龙吧。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;后面的招聘中，还有哪些是你比较期待的？&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;不多了。我说了我很累，压力很大，看这满头的白……哦，没有？算了。现实一点，会重点关注个别待遇更高的企业。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;有何期许？&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;随缘吧。首先挺过这段时间，心态平稳下来，路还很长，我觉得还是有搞头的。稍微远一点，我希望至少在三五年后能对得起现在的选择。&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;最后，BTW，为什么当初没有offer的时候你那么亢奋，现在反而有很多忧虑？&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;人在不同境遇下会思考不同的问题，这大概是种病。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>沽之哉</title>
   <link href="http://blog.tomsheep.net/2010/10/23/sell_it"/>
   <updated>2010-10-23T22:24:15+08:00</updated>
   <id>http://blog.tomsheep.net/2010/10/23/sell_it</id>
   <content type="html">&lt;p&gt;突然事情变得多了起来，每天赶场一样参加各种笔试面试，实习和课程也得兼顾着，多少有些掣肘。&lt;/p&gt;

&lt;p&gt;进展的并不尽如人意，刚开始稍微有些托大，显得准备不足，运气也欠缺了一些，一些机会不知不觉就溜走了，拿到的offer也并不十分喜欢。和我一同找工作的同学或多或少都有类似的遗憾，闲聊扯淡的时候大家都有些人为刀俎我为鱼肉的感慨。更哭笑不得的是大摩的HR误将我认作正式员工阴差阳错地漏发了笔试邀请，也只好苦笑一声天意如此一切随缘了。&lt;/p&gt;

&lt;p&gt;虽然开局整体并不理想，但还是有很多收获值得珍惜:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;各个公司对人才的看法有很大差异，评价标准不一而足，并不像过去想象的那样简单。反过来，同样是IT企业，同样是出色的IT企业，由于术业专攻的不同，有时候并不是可以笼统进行比较的。和高考一样，优先选择行业往往比选择企业更为务实。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;多数优秀的企业并不很注重考察你当下的技术深度，而更在意你的基本功和发展潜力，所以做足基础知识准备是大有裨益的，剑走偏锋往往效果并不理想。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一个月前我以为《算法导论》是最好的IT求职手册，现在我觉得，《具体数学》似乎更好。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;结识了一批有才华有想法一起求职的朋友，尤其是研究生师兄师姐们。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;科学家、工程师、商务精英，无论那条道路，只要有充足的理由说服自己走下去，都可以走出精彩的轨迹。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;玉在椟中求善价，钗于奁内待时飞。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>就是这样</title>
   <link href="http://blog.tomsheep.net/2010/09/25/so_it_is"/>
   <updated>2010-09-25T23:56:35+08:00</updated>
   <id>http://blog.tomsheep.net/2010/09/25/so_it_is</id>
   <content type="html">&lt;p&gt;博客空了很长时间，终于想起来更新。一般每当我找不到合适话题的时候都会写书评，今天大致也是这样。&lt;/p&gt;

&lt;p&gt;前一段比较关注的书是《Hackers and Painters》，很可惜没有看完就中断了，按照我习惯短期内应该不会再捡起来了。这本书有个副标题，叫Big Ideas from the Computer Age，和Computer Science无关，更多的是关于生活、关于社会、关于科技的发展与使用等一系列的思考，有些地方我并不是完全明白他想说什么，我还是太连青了。&lt;/p&gt;

&lt;p&gt;阮一峰在博客中做过这本书的一部分翻译，有兴趣的也可以看看。&lt;/p&gt;

&lt;p&gt;上个周末没什么事干的时候看的书是余华的《兄弟》，他出这本书的时候我在上高中，当时看到书店外的海报，觉得一个作家把自己的书分成上下两部分别出版实在是一件很犯贱的事情。回过头来再看，发现这样安排还是有些想法的。《兄弟》和余华的其他小说的路数大致相同，文字简单、黑色幽默、对白处处透着不自然却总又觉得就应该这样，故事背景也必须是文革……虽然似曾相识，但也可以感觉的出《兄弟》的立意是有变化的，上下两部是两个完全不同但又都极度扭曲的时代，人性在极具变化的时代中会如何展现，余华的很多作品都有类似的思考，但角度都略有不同。小说有一个荒诞的结尾，有些突兀，但似乎也是最契合题意的处理了。总的来说，没有太让人失望。&lt;/p&gt;

&lt;p&gt;最近在读的大多是过去看过的一些技术书籍，发现很多地方都有新的理解，观念也大不一样了，甚至有些开窍的感觉。突然觉得技术学习真是一件酿酒的过程，不光是堆砌，得反复发酵才行。比如关于Lambda，关于闭包，关于Linq，过去我很喜欢说，到处说，但又总说不透彻，觉得欠了点什么。后来慢慢发现，原来不是这么回事，打根上就没整清楚，还得仔细琢磨。类似的例子还有很多。不过值得高兴的是，我再次对这个行业的方方面面充满兴趣与热情，就像转系时一样，甚至比那时更加看好它的发展。（我也遗憾如果几年来如果能一直有这样的状态，可能今天会是另外一个层次）弯路走过不少，但也算值得，我发自内心的觉得，哥快上路了。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>大哥何必苦苦相逼</title>
   <link href="http://blog.tomsheep.net/2010/08/27/are_you_kidding"/>
   <updated>2010-08-27T14:35:14+08:00</updated>
   <id>http://blog.tomsheep.net/2010/08/27/are_you_kidding</id>
   <content type="html">&lt;p&gt;本来以为终于可以放松一段时间了，每天晃悠晃悠，活动一下筋骨。今天被告知没有拿到offer，多少有些意外，因为我一直都比较自信。但所幸复旦这些年对我的挫折教育相当充分，失落感很快就消逝了。&lt;/p&gt;

&lt;p&gt;我不知道被拒的理由是什么，就像我不知道当初被选中的理由是什么一样。但我清楚企业寻找的不是最强的人，而是最合适的人。Morgan  Stanley是一家成熟的企业，选才的标准必然是遵从于自身文化和核心价值的。中午发了几封表示感谢的信，倒不是违心客气，两个月来确实有很多人给了我很多帮助，我可以感觉得到自己的变化。这让我离开时反而更加自信。&lt;/p&gt;

&lt;p&gt;前几天和我一起实习的同学向我诉说他的忧虑，觉得自己表现不好，担心最终拿不到offer怎么办，我当时安慰他说情况未必那么糟，即便不幸落选，这个市场仍旧很大，MS，还有another  MS，IBM，Inter&amp;hellip;&amp;hellip;如果我自己落选，那我会很乐意迎接即将全面开放的市场。同样这些话也毫不违心，我有足够的信心来处理这些变数。有趣的是竟被我言中，最终他收到了offer，而我收到了据信。就像阿甘说的，“Shit  happens.”&lt;/p&gt;

&lt;p&gt;再次回到起点，但心境已经大不一样——毕竟血都不是白流的。不过开弓没有回头箭，让我回头读研是决计不肯的了。看来是写剧本的那位Evil  Genius有意不要我有太多清闲日子过，接下来的几个月又埋了几段故事等着我，那还能有什么说的，除了学刚刚一起工作过的同事们揶揄几句“大哥何必苦苦相逼”，就只有磨好菜刀，刻上名字，等他出招了。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>穆斯林的葬礼</title>
   <link href="http://blog.tomsheep.net/2010/08/22/musilm_funeral"/>
   <updated>2010-08-22T05:12:14+08:00</updated>
   <id>http://blog.tomsheep.net/2010/08/22/musilm_funeral</id>
   <content type="html">&lt;p&gt;很长时间没有更新博客，主要是因为懒，想有更多休息的时间。前一阵每周都贴一些实习期间的tips，后来觉得自己心里清楚就得了，写出来也没多大意思——没意思的事就尽量免了吧。最近其实有很多有趣的、乏味的、开心的、不开心的事情，想到哪说哪。&lt;/p&gt;

&lt;p&gt;实习马上就要收官了，两个月感触不少。学到什么技术倒不是多么要紧，因为如果自学我完全可以学到更多。更多的收获在于如何在企业做事：在大多数时间里，我都在试图证明我有很高的技术素养，不遗余力地在project中加入更多有意义的feature，并加入自己的见解，但结果并不如想象中的好——很多的努力被轻描淡写地否决，idea被challenge，一次次重做，身心俱疲。我的manager不只一次告诉我，你必须准确地知道用户的每一个需求是什么，不要猜，不要埋头就做，要不停的去和他们check……也许我需要多一点时间来适应这种工作方法。&lt;/p&gt;

&lt;p&gt;前两天做了次presentation，又参加两次内部的面试，还算满意，面试时又无意扯到MapReduce的优劣、FP与命令式语言的优劣、Java提供过少语言特性的优劣等等，其实在面试中需要尽量避免这些存在争议、容易有个人倾向性的话题，因为坑太大，很容易拔不出来。还好没有被问的很深，challenge得不是很严重。&lt;/p&gt;

&lt;p&gt;在这之前还跟香港的boss做过一次1-1的交谈，他反馈给我一些对我工作的评价，我大体可以猜到。意外的是他提到当初我的组长选我做intern有一个很重要的原因是他在群面中觉得我是一个leader，但这两个月让他很惊讶，我是一个内向而太安静的人。虽然我很清楚他提到这些并没有任何负面的意思，但心情还是有些复杂：有些时候你甚至不知道别人为什么欣赏你，或者为什么不欣赏你，这些都可能以一种完全出乎你想象的形式出现，你想控制却无能为力。想到这些，一直绷紧的神经反而放松了，对一时的得失也看得轻了些。&lt;/p&gt;

&lt;p&gt;今天在校园瞎溜达了半天，权当是休息，找了个僻静的地方看完了《穆斯林的葬礼》。这本书本不在我的读书列表之中，只是几天前为了测试新买的Kindle，随手选了它进去。让人惊喜的是这是部绝对意义上的好书，从各个方面讲都是。故事很抓人，在时代背景推动下极富感染力，叙事技巧上佳，而且可能也是由于作者是女性的缘故，整部书都很感性。如果说有美中不足的地方的话，我个人觉得有些地方的行文略显拖沓，故事当中也有个别地方觉得有些费解，比如梁冰玉的情感转折，和韩子奇的恋情出现得过于突兀，也许是我无法很好理解女性的心理活动。晚上碰巧看到这部书的电影版出现在pt中，看了一遍，相较原著，真是大大不如了。&lt;/p&gt;

&lt;p&gt;即将开学，很多当初搁浅的事情又有机会继续了，并发编程的系统学习还只是皮毛，在 技术博客 里写心得写到半路，不想废掉；半年来对编程语言设计的兴趣日深，有意多接触一些编译方面的书籍；还有FP和计算理论……希望这些设想不会落空。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>我要反三俗</title>
   <link href="http://blog.tomsheep.net/2010/08/22/holy_crap"/>
   <updated>2010-08-22T00:07:09+08:00</updated>
   <id>http://blog.tomsheep.net/2010/08/22/holy_crap</id>
   <content type="html">&lt;p&gt;前一段一直闹”反三俗“，主要是反郭德纲，一度郭的音像制品全部下架，但匪夷所思的是起因居然是”郭的徒弟打了记者“，这让人不得不由衷的感慨中国人思维就是发散，闯红绿灯也可以按随地大小便治罪。一码归一码的事情总可以搅和搅和混进酱缸，认识的不认识的都跳出来”痛打落水狗“，连你小时候偷过邻居煤球都可以扯出来。过了这么多年，还是文革整人的套路，让人审美疲劳。&lt;/p&gt;

&lt;p&gt;后来网络的舆论风向开始逆转，原本倾向于指责”郭徒打人“的多数网民掉头挺郭，twitter上的”民%煮人士“也活跃地”反围剿“——这说明中国网民已经被锻炼得相当敏感，绝不愿自己少得可怜的话语权进一步紧缩。再后来郭在人指点下打了几次翻身仗，这声势浩大的运动也就偃旗息鼓了。&lt;/p&gt;

&lt;p&gt;我听了十多年相声，05年岁末开始听郭德纲，我非常清楚郭这样功底的相声演员有多么难得。我毫不掩饰对他的欣赏。郭德纲痞气很重，恃才狂傲绝不吃亏，之后有很多他的负面新闻发生，师承问题、圈内反三俗、藏秘排油、徐德亮出走……郭都通过嬉笑怒骂的反击以及草根的拥护渡过难关，并且颇让对手难堪，直到这次”反三俗扩大化运动“，起初也试图如法炮制，就地反击，但也是这些年名利过盛有些膨胀，对自己的能量和草根对自己的支持程度估计严重失误，局势失去控制。后来沉寂一段时间后高调复演，看得出经过精心酝酿，想必也有高人指点，北展的节目相当有”内容“： 选了《卖布头》和《八扇屏》，都是包袱少但极显功力的活，八扇屏里专挑了”莽撞人“，不露痕迹的现挂了几个，返场唱了《劝人方》和《大实话》（后者我很长时间没听他唱过），词都很应景，《劝人方》专选了”天为宝盖“版本，不能不说是有备而来的。&lt;/p&gt;

&lt;p&gt;对于我个人而言，倒是比较乐见这场风波的，倒不是希望郭能就此所谓”收敛“一些，那样反而失了性情，而是希望他能认清立身之本，收心于相声创作表演——08年后他几乎没有让人满意的新作品（几个单口还行）——长远来看于人于己都不失为一桩好事。&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;劝人方&lt;/p&gt;

&lt;p&gt;天为宝盖地为池   &lt;br/&gt;
人生世上浑水的鱼    &lt;br/&gt;
父母养儿鱼拴着水    &lt;br/&gt;
子孝孙贤水养鱼    &lt;br/&gt;
弟兄们要相和鱼儿傍着水    &lt;br/&gt;
妯娌们和美水傍着鱼    &lt;br/&gt;
人生在世非容易    &lt;br/&gt;
其死清风肉化泥    &lt;br/&gt;
龙游浅水遭虾戏    &lt;br/&gt;
虎落平阳就被犬欺    &lt;br/&gt;
得了势的狸猫它欢如虎    &lt;br/&gt;
落了魄的凤凰就不如鸡    &lt;br/&gt;
猛虎岂在当道卧    &lt;br/&gt;
困龙也有上天时    &lt;br/&gt;
攒下了金山催命的鬼    &lt;br/&gt;
交下了朋友是护身的皮    &lt;br/&gt;
伸出了十指有长有短    &lt;br/&gt;
树木狼林有高有低    &lt;br/&gt;
在这山上石头多玉石少    &lt;br/&gt;
世间人多君子稀    &lt;br/&gt;
我是劝诸位    &lt;br/&gt;
没有钱别卖您那看家的狗    &lt;br/&gt;
有了钱别娶这活人的妻    &lt;br/&gt;
屈死三分别告状    &lt;br/&gt;
宁饿死别做这犯法的    &lt;br/&gt;
三条大路当间走    &lt;br/&gt;
曲曲弯弯使不得    &lt;br/&gt;
阎王爷好比那打鱼的汉    &lt;br/&gt;
无常小鬼是钩鱼的食    &lt;br/&gt;
昨夜晚脱下了这鞋和袜    &lt;br/&gt;
不知道那今日清晨提不提    &lt;br/&gt;
花棺彩木量人的斗    &lt;br/&gt;
死后只剩下半领席    &lt;br/&gt;
空见那孝子在灵前奠了三杯酒    &lt;br/&gt;
谁见那死去的亡魂他把酒吃    &lt;br/&gt;
我是劝诸位，    &lt;br/&gt;
趁着胸前有口气儿在    &lt;br/&gt;
积点德，为点人，修点好来这是赚的    &lt;br/&gt;
我一言唱不尽劝人方一个古段    &lt;br/&gt;
我是愿诸位阖家欢乐，福寿天齐&lt;/p&gt;&lt;/blockquote&gt;
</content>
 </entry>
 
 <entry>
   <title>红拂夜奔</title>
   <link href="http://blog.tomsheep.net/2010/08/02/a_strange_love_story"/>
   <updated>2010-08-02T00:42:25+08:00</updated>
   <id>http://blog.tomsheep.net/2010/08/02/a_strange_love_story</id>
   <content type="html">&lt;p&gt;王小波的作品，之前只看过《黄金时代》和《我的阴阳两界》，还有一些杂文。文字很有技巧，幽默感很到位，完全符合我的审美观点。最近下班懒得费神，翻看了《青铜时代》中的《红拂夜奔》——据说《红拂夜奔》有两个版本，我看的应该是较长的那个。&lt;/p&gt;

&lt;p&gt;在我看过的书中，有少数一些是让你看过之后想要自己写一部出来的，《红拂夜奔》应该属于这一类。这部小说太不像一个历史故事了，通篇夹杂着作者天马行空的想像和讽喻。开篇就扯了一个淡，说洛阳的城墙是用陈年老屎做的，唬得我真的考证了一下——在熟悉了小说的风格后，对这样的扯淡就不以为意了。书中的作者是一个叫王二的数学家，在写李靖的故事，并且力图证明李靖证明了费尔马定理，我不厚道地猜想这是王小波有意无意在卖弄自己的理工知识——因为在他的杂文中就有很多卖弄的痕迹，为了支持一个论点经常不那么自然地引出许多典籍与事例来，而往往在逻辑上显得粗糙——但我还是很喜欢，因为我偏执的认为文字首先必须好看，然后再谈其他。而且卖弄也绝不是缺点，只要卖的出来就行。钱钟书在作品中也喜欢卖弄学识，但很少有人说这是装B。和他的其他小说一样（我看过的），王小波在《红拂夜奔》里围绕主人公的性能力展开了一系列的话题，并且安排李靖最终死于马上风。这几乎是他招牌中重要的一部分，写出来和其余作家大不相同。&lt;/p&gt;

&lt;p&gt;最后贴东东枪的一个经典段子：&lt;/p&gt;

&lt;p&gt;王朔，字小波，生于共和九年，卒于共和四十八年，北京人，曾于海军服役，后赴美国留学。其妻为社会学者李银河，后离异，与女明星徐某过从甚密。主要作品有《绿毛顽主》、《一只特立独行的空中小姐》、《一半是红拂，一半是夜奔》等……&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>FML</title>
   <link href="http://blog.tomsheep.net/2010/07/26/fml"/>
   <updated>2010-07-26T00:12:11+08:00</updated>
   <id>http://blog.tomsheep.net/2010/07/26/fml</id>
   <content type="html">&lt;p&gt;因为觉得用眼过度，所以买了一收音机，伪装成ipod shuffle的样子，处处散发出山寨的气息，符合哥一贯的气质。试听了一下，上海的电台质量超出我的预期，竟然没有在10点之后集体转向性病防治等技术性节目，颠覆了我对传统电台的理解。&lt;/p&gt;

&lt;p&gt;由于看电视的性价比太低，从初二到高三我一直是电台发烧友，常年戴着耳机看书做题，下一秒会跳什么广告我都了如指掌。当时正是陕广一批出色DJ的黄金时代，高凡、方言、王乐、力闻、杨凯、王静……特色鲜明，过耳难忘。我至今仍然可以模仿高凡用便秘一样声音播自己卫生巾冠名的节目片花。高中的时候熬夜比较多，所幸当时打酱油的咸阳台居然在11点到次日1、2点会联播近三个小时的评书，还不加广告，这是一种什么精神——当然在表示欣慰的同时我也对该台深表同情，这说明，就算你丫也放健康热线，也是不会有人听的……&lt;/p&gt;

&lt;p&gt;进入大学之后再没怎么听过广播，因为突然间的信息爆炸，你再也不会想到用电台这种低效的渠道来娱乐或者获取咨询。近几天突然感觉眼睛疲惫的厉害，听听电台调节一下。淘宝买了一调频收音机，看着挺好，火速给了好评，谁知充电器接触不良，后悔不已，痛苦得好像建国后的民煮党。所幸影响不大，效果尚可，晚上听着央广万年不变的片花，觉得时间仿佛在倒带。&lt;/p&gt;

&lt;p&gt;PS： 本文的标题是Frequency Modulation Life， 不是F××k My Life。本文说明了这样一个道理： 不要tm老用简写，plz。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>冷暖自知</title>
   <link href="http://blog.tomsheep.net/2010/07/18/feel_it"/>
   <updated>2010-07-18T04:24:31+08:00</updated>
   <id>http://blog.tomsheep.net/2010/07/18/feel_it</id>
   <content type="html">&lt;p&gt;前一阵子路上碰到肇国，他对我唏嘘说：“投行据说很累啊。”那时我还没有去实习，表示没有概念，说应该还好，朝九晚六吧。然后他笑得很猥琐——当时我也没太当回事，因为他笑起来一贯很猥琐。直到实习后第一次过双休日，我才抽出空来骂娘，”累，真tm累。“&lt;/p&gt;

&lt;p&gt;我的整体作息从2点到7点改成了0点到5点，但可惜这不是一次从上海到乌鲁木齐的愉快旅行。工作谈不上繁重，难度也未见的很高，但时刻都能让你感到压力，压抑。有时我想，万幸没换洋名，否则像我这样心智不健全的少年儿童过几天就搞不清自己是谁了。&lt;/p&gt;

&lt;p&gt; 今天一口气睡到中午，起来看了部扯淡的电影叫Clash of Titans，如果没有希腊神话背景的话估计就是部烂片了——我高中有一同学对希腊神话门儿清，我极佩服他居然能把这个斯那个斯分得那么清楚，经常眉飞色舞地跟我讲这个神和谁谁生了谁谁，又何谁谁的老婆生了另外的谁谁谁，神跟神生出来的还是神，神跟人生出来的就是英雄……让我有种印象就是希腊的神们没事净乱搞男女关系了。（那哥们还对西欧历史相当了解，希腊、罗马、中世纪、文艺复兴说起来如数家珍，后来学生物去了，我觉得真是浪费）&lt;/p&gt;

&lt;p&gt;下午突然想起来查了回成绩，发现裸考成果都还不错，我到底是该说”呵呵“还是该说“操”呢？既然说到这，那就简要总结一下这个学期吧：&lt;/p&gt;

&lt;p&gt;开学的时候我仍然不清楚自己要干什么，只知道我和奥巴马以及地铁口的乞丐一样都需要change——在这之前过年的时候情绪很差，初一甚至从亲戚家夺门而出——回到学校我想应该冷静一下，换个姿态会更有帮助。不久后我退出了实验室，尽管我自认为处理的足够低调但还是搞出很大动静，有一段时间不停有人问我为什么，一般我都会说不好玩或者怪累的，如果还要追问，我就只好说哥来例假了。其实多说无益，你没办法完全理解别人是怎么想的，反过来也一样。促使我作决定的理由很简单，但讲出来没有人会理解，那就是我骨子里很自负，我可以接受失败，但不接受平庸。当我发现自己正在无可挽回地走向平庸的时候，我宁愿放弃既有的好局，然后重来。&lt;/p&gt;

&lt;p&gt;这个举动的后续效果比我预想的略微严重了一点点，首先倒不是学院老师的压力，相反在这个层面我得到了最大的理解；最大的困难来自于周围环境的人情世故，人在处于不同状态下所接受的来自周围人的反馈微妙得像一出活剧——我很庆幸自己可以用如此小的代价得到这些经历，这笔财富来的过于及时。几个月里我都保持淡定，冷静地看着所有变化，这个过程很拧巴、很荒诞、很容易让人变得犬儒，我大概是老了十岁。&lt;/p&gt;

&lt;p&gt;关于到底继续深造做一个researcher还是迈入职场，我做了一个有些艰难的选择（我的观念里基本没有”继续深造然后迈入职场”这个选项），我觉得更像是妥协，向生活妥协，向家庭妥协，向充斥整个社会的主流价值观妥协。我没有能力逃开很多责任。&lt;/p&gt;

&lt;p&gt;为了有一口过得去的英文和中文接下来我看了两个月的电影，每天三部左右——过去二十年加一块估计都没有这段时期看得多。每天脑残一样看着电脑读新闻稿，在阳台上朗诵演讲辞，我相信如果我是个帖子，十个人里有八个想转到Joke。但成功的减肥经历让我相信这种看上去极傻逼的行为是会带来成效的，并且是很容易催生信念的（要不鞋教怎么有人信呢）。后来口语提高了多少不好说，信心涨了不少是真的。&lt;/p&gt;

&lt;p&gt;在这之后开始奔波于各个IT企业的实习招聘的前期活动：参观、宣讲、以及早期的笔试等等。这段时间其实也很艰难，我清晰的记得这样一个画面：晚上7点左右，参观一家企业回来的地铁上，车门“嘟嘟嘟”叫得很刺耳，人进人出，我抓着把手看着车窗里映出的自己模糊的影子，不断盘问：这个城市里哪里才能有你的立足之地？你好歹也算是个聪明人，怎么会落寞到这个地步？&lt;/p&gt;

&lt;p&gt;笔试面试大体都还算顺利，不久幸运地拿到最早申请的两家企业的offer，后面企业的面试就再没参加。当然我很高兴，但更多可能是庆幸，因为我不觉得我还有什么退路。剩下的一个多月其实我压根也没闲着，从早到晚在图书馆看书，当然心情很放松，并行编程，JVM，perl，python，scala，C#，C++……看了很多语言设计的书，发现对编程语言本身的研究非常感兴趣。这一段时间可能也是我近十年最放松的一段，我会想它的。&lt;/p&gt;

&lt;p&gt;回头看这个学期的故事，如果这局棋让我再下十次，可能没有一次会是今天这个局面。只能唏嘘，人生有太多变数，太多变数……&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>世界真小</title>
   <link href="http://blog.tomsheep.net/2010/07/06/small_world"/>
   <updated>2010-07-06T21:57:21+08:00</updated>
   <id>http://blog.tomsheep.net/2010/07/06/small_world</id>
   <content type="html">&lt;p&gt;我一直怀疑我的生活是一段二流编剧提前写好的脚本，狗血的戏剧化剧情过多，好像笛卡尔YY的，外部世界只是某个Evil Genius制造的幻像，你我都生活在的Matrix里。想起去年进PPI之前面试，海波问我一个问题，“怎样让OS知道自己是跑在真机还是虚拟机里？”我第一反应以为他想问一个哲学问题，差点说这是超验的，不可知的。忘了后来是怎么扯淡的。&lt;/p&gt;

&lt;p&gt;昨天去实习，熟人着实不少：我和范豪钧连同另一位研究生师姐，连续在几家不同公司的面试中分到同一组，最终又在这里汇合，大家普遍觉得，缘分呐。但如果故事就在这里结束，那这编剧也就一般狗血了，更有趣的是，和我分到同一team的另一位实习生，正是不久前在港中大Winter School里认识的北大同学。这世界太tm小了。&lt;/p&gt;

&lt;p&gt;吃饭时和同组的同事认识了一下，近些年我的记性变得很差，他们的名字忘了一半——之前简哥提醒我给自己起一英文名，我估摸着就叫Thomas吧，结果第一天发现摩根的CEO叫Owen Thomas，乐得不行，心想索性就别改了，Kang就挺个性的。&lt;/p&gt;

&lt;p&gt;第一天没什么事，介绍了大大小小的规矩，第一感觉约束比较大，任何软件都不能随便用。第二天请假回来考试，不知错过了些什么。我不知道接下来回有什么剧情，也有些疑惑这条路自己是否选对了——转念想，这都是吃饱了蛋疼，YY是最没用的，既然有了机会，就只管努力抓住，再无需顾虑其他，血可不能白流，过去的教训还少么。条条皆是通途，无论脚本如何继续，尽力而为便hang你不住，错过的东西或许精彩，眼下的也未必就被比了下去。我向来觉得写剧本的那位仁兄相当照顾我，总能让我在各种时期用最小的代价换来最大的历练，对此我深表欣慰。&lt;/p&gt;

&lt;p&gt; 可是，你丫为什么不给哥安排次艳遇呢？&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>伪球迷</title>
   <link href="http://blog.tomsheep.net/2010/07/04/pseudo_soccer_fans"/>
   <updated>2010-07-04T02:06:39+08:00</updated>
   <id>http://blog.tomsheep.net/2010/07/04/pseudo_soccer_fans</id>
   <content type="html">&lt;p&gt;本届世界杯开始的时候我决定支持阿根廷，在这之前我从来不是阿迷，02年他们被英格兰挤掉的时候我还偷着乐来着。只因很多年没有正经看球，原先熟悉的球员场上已经屈指可数，过去拥护的球队至今也面目全非，没有太多感情；看到老马带着一批才华横溢的bug球员，自然希望有性情有性格的人能走得更远。脚本和上次很像，但远没有上次纠结，这样也好，免得煽情。&lt;/p&gt;

&lt;p&gt;过去一直喜欢意大利——除了意甲的缘故之外，大致是因为2000年欧锦赛，一场半决赛，记住了两支球队，荷兰大约射飞了5个点球，还稍带了若干门柱，最终被无辜地意大利做掉。而神一样的托尔多在决赛里最后一秒崩溃，至今让人觉得是个传奇。似乎接下来那年意甲的冠军是罗马，托蒂、巴蒂、蒙特拉，犀利的不行，最后一场打帕尔马还没结束，罗马城的球迷就冲进场玩儿命庆祝，托蒂被扒得只剩下了内裤……后来意大利也不怎么出息，02被人阴，06阴别人。夺冠的那年我正值高考失利，整个世界杯就伤心地睡过去了。再后来就不怎么热心体育了，08欧锦赛意队连同法国一道被荷兰虐了个底儿掉，看着只觉得怪蛋疼的，到这届早早出局，却是一点感觉也没有了。&lt;/p&gt;

&lt;p&gt;随着老马出局，这届世界杯估计就看到这儿了，最后希望荷兰能拿一次冠军，尽管这是最不应该拿的一届。以后不知道会不会回来重新做个球迷，这都无所谓了。这个学期即将结束，后天开始实习，也许会开始另一段轨迹；还要搞定若干裸考，不得不说这学期的课无聊的可以；豆瓣里还列了偌长的书单没有来得及看，希望早日兑现……&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Coders at Work</title>
   <link href="http://blog.tomsheep.net/2010/06/30/coders-at-work"/>
   <updated>2010-06-30T18:11:00+08:00</updated>
   <id>http://blog.tomsheep.net/2010/06/30/coders-at-work</id>
   <content type="html">&lt;p&gt;离软实考试还有几个小时，依照惯例我不会睡觉。今天不断有同学来我这里取经，看我在复习些什么，其实我压根没有复习，而是在看这本书，Coders at Work，是若干大牛的访谈录，谈关于编程的理解、成长的轨迹、积累的经验等等，还是很有趣的。&lt;/p&gt;

&lt;p&gt;本来是冲着Knuth来的，在csdn上看到访谈片段后第一时间去找到完整电子版（原来实验室有哥们说我是“搜书达人”，我就当是在夸我了），看了几位神人的经历以及观点，有些甚至是相悖的，但不妨碍他们都是这个领域的翘楚，Knuth就是TAOCP的作者，书写到一半觉得排版不好，于是自己去开发了神一样的排版系统（没错就是Tex，汗……）90年代他提出Literate Programming（文学编程），恕我无知我第一次看到这个名词，十分新奇，加上自己对编程语言本身的研究十分感兴趣，大牛的东西岂可交臂失之，下了一坨paper留着考完试看。&lt;/p&gt;

&lt;p&gt;还有jwz的经历也让人印象深刻，几乎就是自学成才，Lisp大师，做过Netscape和Emacs，后来听说卖啤酒去了也不知真的假的，访谈里谈的大都是做程序时很烦人的经历，满屏的sucks，同时表示自己不喜欢也不善于理论，谦虚地认为自己是一匠人。他的主页很唬人
&lt;a href=&quot;http://www.jwz.org&quot;&gt;http://www.jwz.org&lt;/a&gt;
，第一感觉是黑客帝国……其实仔细看才发现他的博客、邮箱各种链接都隐藏在里面。&lt;/p&gt;

&lt;p&gt; 还有许多大牛，没能一口气看完，留着以后再看，如果你像我一样蛋疼，推荐这本书。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>哥信你们全部</title>
   <link href="http://blog.tomsheep.net/2010/06/24/i_believe_it"/>
   <updated>2010-06-24T13:38:44+08:00</updated>
   <id>http://blog.tomsheep.net/2010/06/24/i_believe_it</id>
   <content type="html">&lt;p&gt;昨天下午摩根的mentor打来电话进行简单的交代，他是我当时第二轮的面试官，那时我就觉得这位同学语速快的吓人，每隔两分钟我就得问一次“Pardon?”。但万没想到他的中文居然说得比英文还要变态，电话那头机枪扫射一样，我几乎抓不到他的点。接完电话我擦一把汗，表示压力很大。&lt;/p&gt;

&lt;p&gt;在简单的交谈中他告诉我他们使用最多的技术.Net，也会涉及一些Java的成熟企业框架，这都是我最薄弱的方面——其实在软院的三年里，我一直在不停的思考究竟应该侧重哪些方面的学习，计算机技术已经发展得如此庞大，一不留神就会迷失方向。在不断的试错和碰壁之后，我渐渐觉得，计算机的本科学习应该着眼于基础，算法、数学、逻辑、OS、network、编程思维培养如OOP、FP等，他们看起来都很老很out，十几年来似乎也没有什么翻天覆地的变化。我的室友技术潮人周大师经常喜欢说“这些东西不赚钱的”，其实我的判断恰好相反，这些是计算机技术的根基，不管花里胡哨的技术再怎么变来变去，都不太可能跳出这里。我不敢断言自己的判断一定是对的，有时看着大师搞各种很潮的技术，我也会对自己的选择产生怀疑，当别人已经登堂入室你还在门口扎马步，到底你还想不想混了？但我还是坚持这样去做，并且相信这是对的——或许我们都没错，只是选择了通往同一目标的不同道路而已。&lt;/p&gt;

&lt;p&gt;至今我仍然对企业级应用所知甚少，现在流行什么框架也没有太多概念。不过我相信当需要去了解这些东西时，我可以很快上手。希望暑假的实习可以证明这一点。算法、数学、OS、OOP、设计模式……哥信你们很多年了，你们给哥露回脸吧。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>伪球迷</title>
   <link href="http://blog.tomsheep.net/2010/06/20/enjoy_haldly"/>
   <updated>2010-06-20T18:56:04+08:00</updated>
   <id>http://blog.tomsheep.net/2010/06/20/enjoy_haldly</id>
   <content type="html">&lt;p&gt;这些天闹世界杯，原先的计划都撂下了。实际上高中以后，我就已经沦为伪球迷，欧洲联赛基本没条件看，新闻也没空瞧，这么耽误几年，对体育就不那么上心了。现在我的意识里存留的球星仍然是维埃里因扎吉比埃尔霍夫这批，看C罗卡卡都觉得是新人。所以现在看世界杯和玩实况对我来说基本没什么差别，无非是找借口偷懒而已。&lt;/p&gt;

&lt;p&gt;为了补一些脚本知识最近接触好几门脚本语言，python，scala，perl，练得不多，就当是留了个念想，以后捡起来方便。其实语言这东西，看多了就审美疲劳，觉得大同小异，你行我也行，OReilly等几个出版社也真省心，连教程路数都一样：Learning XXX, Programming XXX, Effective XXX, XXX Cookbook，找几个小动物往封面一帖就齐活了。 这些天看了不少，其实效果一般，因为贪图速度，基本上都是扫过去的。比较喜欢scala，一来就在JVM上，Java兼容不是问题，二来是虽然是OOP和FP混血，但混的一丝不苟，OOP和FP程序员应该都能很快接受。而且从Erlang里借来了actor模型，真是编程语言里的潮人。&lt;/p&gt;

&lt;p&gt;其实原来的计划是多线渐进作战，并行编程、脚本、金融、算法、英语几个分支里每天各一个topic，循序渐进。可惜还是老毛病，随意性太强，受不惯太严苛的约束，没有掌握好平衡，效果不如预期的理想。又赶上世界杯，那自然是废了。&lt;/p&gt;

&lt;p&gt;转眼又期末了，这学期的无聊课程基本没去听过，project多亏抱到了大师的大腿，感动得泪流满面……期末估计又得rush一下，作为一名考试型选手，我表示情绪稳定。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Java Concurrency(4)</title>
   <link href="http://blog.tomsheep.net/2010/06/13/java-concurrency-singleton"/>
   <updated>2010-06-13T19:45:00+08:00</updated>
   <id>http://blog.tomsheep.net/2010/06/13/java-concurrency-singleton</id>
   <content type="html">&lt;p&gt;线程安全前传之Singleton&lt;/p&gt;

&lt;h2&gt;寂寞的Singleton&lt;/h2&gt;

&lt;p&gt;如果你是一名OO程序员，Singleton的名字对你来说就不会陌生，它是GoF设计模式的一种，江湖人称“单例”的便是；即便你不是OO程序员，中国人你总该是吧？那么下面一段你应该也会背：“世界上只有一个敏感词，敏感词是敏感词的一部分，敏感词是代表敏感词的唯一合法敏感词，任何企图制造两个敏感词的企图都是注定要失败的。”说的多么好！一语道破Singleton的真谛。但是，为了让帖子存活下去，为了更好地娱乐大众，下面我们从“敏感词系统”转到“世界杯系统”，我们来看：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这就是一个极为简易的Singleton范例，但是雷米特同学看到这个类估计哭得心思都有了：这里的instance是eager initialization，也就是说作为世界杯的发起人，雷米特小朋友必须在提出“世界杯”这个概念的时候，就自己掏钱铸一座金杯撂那，这赛事成不成还两说。搁谁谁也不乐意。那这事咋整？雷米特老婆温柔地说，“你个完蛋败家玩意，那就等破世界杯板上钉钉，第一届举办的时候再造呗！”真是一语惊醒梦中人，雷米特立刻打开IDE，敲出下面的代码：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(){&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//A&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//B&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;雷米特长出一口气，这回lazy initialization，总高枕无忧了吧～&lt;/p&gt;

&lt;h2&gt;当Singleton遇见多线程&lt;/h2&gt;

&lt;p&gt;这时，温柔贤惠的老婆又发话了：“你傻啊？倒霉玩意你想造多少个破杯啊？杯具啊，我～不～活～了～～我错了，我从一开始就错了，如果我不嫁过来……”雷米特表示理解不能，这么NB的代码错在哪了？&lt;/p&gt;

&lt;p&gt;观众朋友们来分析一下，是什么让雷米特的老婆如此伤心欲绝呢？绝大部分朋友应该已经知道了，那就是多线程的问题。在A和B之间存在一个时间差，可能有t1，t2两个线程，t1检测instance为null，没有继续执行B而是被切走，t2又检测到instance为null，这下，两个世界杯就被造出来了。Singleton名不副实。那应该如何？你可能已经对我的傻逼描述烦不胜烦了，加锁呗：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// A&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// B&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;问题解决，不是吗？对，但不那么完美。我们知道，加锁/放锁是很费的操作，这里完全没有必要每次调用getInstance都加锁，事实上我们只想保证一次初始化成功而已，其余的快速返回就好了。&lt;/p&gt;

&lt;h2&gt;又见DCL&lt;/h2&gt;

&lt;p&gt;那也不难，用传说中的“双检锁”（Double-Checked Lock）即可：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//C&lt;/span&gt;
                &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// A&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// B&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;新加的C操作过滤掉了大量的“快速返回”，让程序只有在真正需要加锁时才去加锁，效率大涨。雷米特大喜过望，终于可以和老婆交差了。但是，结束了么？&lt;/p&gt;

&lt;h2&gt;安全发布&lt;/h2&gt;

&lt;p&gt;“结束了么？”一段时间之前的一次电话面试中，面对同样的问题，面试官不怀好意地问。我立刻深深地觉得我被这两个臭不要脸的家伙彻底调戏了，万分纠结地败下阵来。相信雷米特再次面对他老婆时，也会有相同的感受。那么，看似精巧的DCL，会有什么问题呢？我们要从“安全发布”谈起。&lt;/p&gt;

&lt;p&gt;所谓对象的“发布”（publish），是指使他能够让当前范围以外的代码使用。为了方便理解，列举几种发布对象的常用方法：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;把对象的引用存到公共静态域里。&lt;/li&gt;
&lt;li&gt;把一个对象传递给一个“外部方法”，所谓外部方法是指其他类的方法或者自身可以被子类重写的方法（因为你不知道这些方法会有些什么动作）&lt;/li&gt;
&lt;li&gt;发布一个Inner Class的实例。这是因为每个Inner Class实例都保存了外部对象的引用。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;另外需要记住的规则是“当发布一个对象时，实际上隐式地发布了他的所有非私有域对象”。&lt;/p&gt;

&lt;p&gt;发布对象并不可怕，可怕的是错误地发布对象。当一个对象还没有做好准备时就将他发布，我们称作“逃逸”（escape）。举一个简单的例子：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Argentina&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isMessiReady&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Argentina&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Runnable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
                &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;tell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//Argentina.this&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;isMessiReady&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;tell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Is Messi Here?:&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isMessiReady&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;阿根廷队队伍还没组建好就开新闻发布会，这时Messi到底在不在呢？老马可能在放烟雾弹。这里的对象发布属于我们上面提到的第三种，即发布内部类，因为这里的Thread其实是用一个匿名内部类Runnable实现的，新线程可以访问到外部类，在我们加注释的那一行其实隐含的访问了外部类Argentina.this。这属于臭名昭著的“this逃逸”，常见情景包括了“在构造函数中添加listener，启动新线程或者调用可重写方法”。&lt;/p&gt;

&lt;p&gt;其实说白了，所谓逃逸，&lt;strong&gt;无非是对象“发布”和另一个线程访问该对象之间没有正确的Happens-before关系&lt;/strong&gt;。&lt;/p&gt;

&lt;p&gt;回过头来看我们上面的DCL，他虽然不是“this逃逸”，但也属于肇事逃逸的一种。一个线程t1的B操作和另一线程t2的C操作之间没有HB关系，也就是对instance的读写没有同步，可能会造成的现象是t1-B的new WorldCup()还没有完全构造成功，但t2-C已经看到instance非空，这样t2就直接返回了未完全构造的instance的引用，t2想当然地对instance进行操作，结果是微妙的。&lt;/p&gt;

&lt;p&gt;看到这里，结合上一次的讨论，可能你已经明白了，“说了这么久，原来还不是劳什子的可见性问题，翠花，上volatile～”&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;volatile&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//C&lt;/span&gt;
                &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// A&lt;/span&gt;
                        &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// B&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;“这下，你，们，该，满，足，了，吧？”&lt;/p&gt;

&lt;h2&gt;Yet another 解决方法&lt;/h2&gt;

&lt;p&gt;恭喜你，成功了。但是，其实我还想说，恭喜你，你out了。随着时代的发展JVM的进步，DCL这样的技巧已经逐步被淘汰了，而lazy initialization holder这样的新秀在效率上和DCL已经没什么差别：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;WorldCupHolder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCup&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WorldCupHolder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;instance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;同样是“惰性初始化”，这个是不是更好看？&lt;/p&gt;

&lt;p&gt;在这里我们回过头来看看我们最初的eager initialization，你这时可能会反过来思考，他不是volatile，会不会有escape问题？不会。因为Java保证了域初始化段落对其余操作的HB关系。好了，这下，雷米特家的河东狮估计可以休矣。&lt;/p&gt;

&lt;h2&gt;讨论的延续&lt;/h2&gt;

&lt;p&gt;关于上面阿根廷的例子，写的时候我发现一点疑问，把自己的理解拿出来和大家讨论。那就是如果我把isMessiReady = true（记做A）放在新线程start（记做B）的前面，在这里新线程不就可以保证HB关系了么？因为有IntraThread原则，A hb B，而我们又有start操作hb于任何该线程的动作，比如tell（记做C），那么不就有A hb B hb C了么？可以保证新闻发布会上梅西肯定在场。那么，为什么几乎所有看到的资料里都警告说“即使是构造函数的最后一个操作，也不要启新线程、加listener、调可重写函数”云云？我的理解是，是为了防止这种情况：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SuperArgentina&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Argentina&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;isDiegoReady&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;SuperArgentina&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;isDiegoReady&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;tell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;tell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Is Diego Here?:&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isDiegoReady&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;我们拓展阿根廷为“超级阿根廷”，加入老马的状态，这样一来，老马自己在不在场就成问题了。关于上面的这段分析，我的把握并不是特别大，希望大牛们能够提点一下。&lt;/p&gt;

&lt;h2&gt;主要参考资料：&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;JavaWorld文章：Double-checked locking: Clever, but broken&lt;/li&gt;
&lt;li&gt;Java Concurrency in Practice&lt;/li&gt;
&lt;li&gt;GoF设计模式&lt;/li&gt;
&lt;/ul&gt;

</content>
 </entry>
 
 <entry>
   <title>Java Concurrency(3)</title>
   <link href="http://blog.tomsheep.net/2010/06/10/java-concurrency-visibility"/>
   <updated>2010-06-10T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2010/06/10/java-concurrency-visibility</id>
   <content type="html">&lt;h2&gt;过期数据&lt;/h2&gt;

&lt;p&gt;我们在前面讨论JMM时便已提出“同步之道，外炼‘互斥’，内修‘可见’”的法门。过去，我不注意内存可见性的时候，程序里长满了小红疙瘩：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RedPimple&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//A&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//D&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;RedPimple&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RedPimple&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//B&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//C&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;上面的代码有什么问题？即使运行它千百遍，你可能也察觉不出有什么问题。但是，问题确实存在。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;病灶一：r线程理论上存在无限循环的可能（这里有两个线程，main线程和r线程）。因为没有任何同步的措施，main线程中C动作的效果何时对于r线程的A可见是不可知的。他肯能在done值已经被改之后的一段时间里仍然读到过期数据，最极端的情况，A一直读到的都是过期数据false。&lt;/li&gt;
&lt;li&gt;病灶二：理论上可能打印出0。这就更匪夷所思了，main线程里不是有 B hb C么？没错，是有B hb C，但是不管是B还是C，都和A、D没有hb关系，理论上存在这样的执行序列C A D B， 它是合法的，C依旧可以宣称看到了B的效果。（这是从JMM理论上论证是允许的，实际情况取决于JMM掩盖之下的你的机器的MM）&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;这就是“过期数据”的隐患。尽管在这个例子里，问题好像还没那么严重，无非皮肤上出点小丘疹而已。但在实际的编程中，过期数据的危害是不容小视的。&lt;/p&gt;

&lt;h2&gt;锁的可见性&lt;/h2&gt;

&lt;p&gt;后来，我用了“锁牌香皂”，小红疙瘩真的就不见了！看这里看这里……&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NoRedPimple&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;tmp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//A&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//D&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;NoRedPimple&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NoRedPimple&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//B&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//C&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;正如这个例子所示，锁不仅仅有“互斥”的功能，而且还保证了内存可见性。运用我们在JMM里提到的理论，被标号的三个操作这次有了明确的HB关系，这下就不会有小红疙瘩了。&lt;/p&gt;

&lt;p&gt;更进一步看锁的可见性：如果有两个线程t1，t2，t1有动作序列A B C U，其中U为放锁操作，t2有动作序列L D E F，L为加锁操作（同一锁），那么在执行中如果有U tb L，那么这两个线程的执行序列必为 A B C U L D E F，再无其他可能。这就保证了“&lt;strong&gt;在放锁前对t1可见的值，B获得锁后同样可见&lt;/strong&gt;”。&lt;/p&gt;

&lt;h2&gt;Volatile&lt;/h2&gt;

&lt;p&gt;虽然上面用锁解决了过期数据的问题，但似乎有些大材小用了吧？代码不那么好看，治好了疹子，却留了一脸麻子。Java早已为消费者考虑到了这一点，volatile就是一种轻量级的同步，它可以保证“可见性”，但不保证“互斥”。&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NoRedPimple&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;volatile&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;volatile&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//A&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//D&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;NoRedPimple&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NoRedPimple&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//B&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//C&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;是不是简洁很多？结合JMM中对volatile读写的规定（SW第二条规则），上面的代码完全符合我们的要求，没有过期数据。那么，什么时候可以用volatile呢？必须同时满足以下三条：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;不依赖自己：写变量时并不依赖变量的当前值，或者：可以保证只有一个writer&lt;/li&gt;
&lt;li&gt;不依赖别人：变量不与其他状态共同组成invariant。&lt;/li&gt;
&lt;li&gt;访问变量时，没有其他原因需要加锁。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;只解释一下第一条，可能很多人对“不依赖自己的当前值”不太理解，举个简单的例子：count++， 这个就叫依赖当前值。为什么要有这样的限制？因为，volatile不保证count++是原子的，即我们所说的“互斥执行”，虽然我们过去的例子都把一条代码当作一个动作，但相信你知道，一条代码在CPU那里多半不会是一条指令，比如count++其实会分解为load-modify-store三个更小的动作，如果这样的操作有多个线程在做，是极易出错的。（鉴于这个问题过于经典，就此打住）。所以，第一条规则实际的意思就是“要么只有一个writer，怎么写随你便；要么可以多个writer，但不能是count++这种依赖当前值的写”。&lt;/p&gt;

&lt;h2&gt;原子变量&lt;/h2&gt;

&lt;p&gt;Java 1.5 一声炮响，给我们送来了java.util.concurrency包，这个包并行功能强大，工具齐全，我们以后讨论会经常用到。原子变量也是此包提供的工具之一。顾名思义，原子变量，即支持“原子更新”，它更多地被用在“非阻塞算法”和“lock-free算法”中，其实我很想现在讨论非阻塞算法，两次面试都被考到，但抬头看看标题已经写了“可见性重访”，还是不跑题了，以后有机会再和大家讨论这个topic。&lt;/p&gt;

&lt;p&gt;而除了“原子更新”的好处外，原子变量还提供了与volatile相同的内存语义，所以volatile所能保证的可见性，在原子变量这里同样可以。&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.concurrent.atomic.AtomicBoolean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.concurrent.atomic.AtomicInteger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NoRedPimple&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AtomicBoolean&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AtomicBoolean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AtomicInteger&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AtomicInteger&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//A&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//D&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;NoRedPimple&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NoRedPimple&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//B&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//C&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;当然，我们这里使用原子变量，也是“大材小用”了的，原子变量的NB之处在于其原子性的CAS（compare-and-set）操作，由此可以完成volatile所不能的“check-and-act”动作，“可见性”只不过是其稍带脚支持的功能而已。我们以后再讨论他的CAS、由他构建的“非阻塞算法”以及“非阻塞算法”和用一般锁构建的“阻塞算法”的比较。&lt;/p&gt;

&lt;h2&gt;主要参考资料：&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;JSL 第三版&lt;/li&gt;
&lt;li&gt;Java Concurrency in Practice&lt;/li&gt;
&lt;/ul&gt;

</content>
 </entry>
 
 <entry>
   <title>笨鸟慢飞</title>
   <link href="http://blog.tomsheep.net/2010/06/09/dull_but_diligent"/>
   <updated>2010-06-09T15:23:11+08:00</updated>
   <id>http://blog.tomsheep.net/2010/06/09/dull_but_diligent</id>
   <content type="html">&lt;p&gt;最近看了不少Java并行的资料，之后尝试去把自己了解的东西写出来——以前我极少做学习笔记，即便做也不过东一脚西一脚摘抄一些tips而已，最终都没有什么价值，随着时间推移多数都会被忘掉。而针对一个主题有条理的把前因后果写给别人看，实在是一件很有难度的事情：即便是自认为已经掌握很好的知识，一旦要把自己的理解讲给别人，不异于重头学一遍，而且必须保证逻辑更加严谨，对细节掌握更加精准，这样一来，所下的功夫就何止十倍了。&lt;/p&gt;

&lt;p&gt;这几天每天晚上都坚持写一个主题，白天贴到博客和BBS里让版友们检验，虽然都是很基础的内容，对大牛们来说不值一哂，但每天都会让我纠结很长时间。不停的查阅wiki，jsr，被迫去看乏味的原始规范，以求严谨。这样的收获甚至比自己学的候要来的更多些。&lt;/p&gt;

&lt;p&gt;还好这学期课程相当之空，正好挥霍这段时间来养成这个习惯。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Java Concurrency(2)</title>
   <link href="http://blog.tomsheep.net/2010/06/09/java-concurrency-monitor"/>
   <updated>2010-06-09T01:30:00+08:00</updated>
   <id>http://blog.tomsheep.net/2010/06/09/java-concurrency-monitor</id>
   <content type="html">&lt;p&gt;Monitor其实是一种同步工具，也可以说是一种同步机制，它通常被描述为一个对象，主要特点是：&lt;/p&gt;

&lt;h2&gt;Monitor&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;对象的所有方法都被“互斥”的执行。好比一个Monitor只有一个运行“许可”，任一个线程进入任何一个方法都需要获得这个“许可”，离开时把许可归还。&lt;/li&gt;
&lt;li&gt;通常提供singal机制：允许正持有“许可”的线程暂时放弃“许可”，等待某个谓词成真（条件变量），而条件成立后，当前进程可以“通知”正在等待这个条件变量的线程，让他可以重新去获得运行许可。&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Monitor对象可以被多线程安全地访问。关于“互斥”与“为什么要互斥”，我就不傻X兮兮解释了；而关于Monitor的singal机制，历史上曾经出现过两大门派，分别是Hoare派和Mesa派（上过海波老师OS课的SS同学应该对这个有印象），我还是用我的理解通俗地庸俗地解释一下：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Hoare派的singal机制江湖又称“Blocking condition variable”，特点是，当“发通知”的线程发出通知后，立即失去许可，并“亲手”交给等待者，等待者运行完毕后再将许可交还通知者。在这种机制里，可以等待者拿到许可后，谓词肯定为真——也就是说等待者不必再次检查条件成立与否，所以对条件的判断可以使用“if”，不必“while”&lt;/li&gt;
&lt;li&gt;Mesa派的signal机制又称“Non-Blocking condition variable”， 与Hoare不同，通知者发出通知后，并不立即失去许可，而是把闻风前来等待者安排在ready queue里，等到schedule时有机会去拿到“许可”。这种机制里，等待者拿到许可后不能确定在这个时间差里是否有别的等待者进入过Monitor，因此不能保证谓词一定为真，所以对条件的判断必须使用“while”&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;这两种方案可以说各有利弊，但Mesa派在后来的盟主争夺中渐渐占了上风，被大多数实现所采用，有人给这种signal另外起了个别名叫“notify”，想必你也知道，Java采取的就是这个机制。&lt;/p&gt;

&lt;h2&gt;Monitor与Java不得不说的故事&lt;/h2&gt;

&lt;p&gt;子曰：“Java对象是天生的Monitor。”每一个Java对象都有成为Monitor的“潜质”。这是为什么？因为在Java的设计中，每一个对象自打娘胎里出来，就带了一把看不见的锁，通常我们叫“内部锁”，或者“Monitor锁”，或者“Intrinsic lock”。为了装逼起见，我们就叫它Intrinsic lock吧。有了这个锁的帮助，只要把类的所有对象方法都用synchronized关键字修饰，并且所有域都为私有（也就是只能通过方法访问对象状态），就是一个货真价实的Monitor了。比如，我们举一个大俗例吧：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Account&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Account&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;withdraw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deposit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;synchronized关键字&lt;/h2&gt;

&lt;p&gt;上面我们已经看到synchronized的一种用法，用来修饰方法，表示进入该方法需要对Intrinsic lock加锁，离开时放锁。synchronized可以用在程序块中，显示说明对“哪个对象的Intrinsic lock加锁”，比如&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deposit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;等价于:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deposit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这时，你可能就要问了，你不是说任何对象都有intrinsic lock么？而synchronized关键字又可以显示指定去锁谁，那我们是不是可以这样做：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Account&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Account&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;withdraw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deposit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;不用this的内部锁，而是用另外任意一个对象的内部锁来完成完全相同的任务？没错，完全可以。不过，需要注意的是，这时候，你实际上禁止了“客户代码加锁”的行为。前几天BBS上简哥有一贴提到的bug其实就是这个，这个时候使用这份代码的客户程序如果想当然地认为Account的同步是基于其内部锁的，并且傻X兮兮地写了类似下面的代码：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Account&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;account&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Account&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;//some threads modifying account through Account’s methods...&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;account&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//blabla&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;自认为后面的同步快对account加了锁，期间的操作不会被其余通过Account方法操作account对象的线程所干扰，那就太悲剧了。因为他们并不相干，锁住了不同的锁。&lt;/p&gt;

&lt;h2&gt;Java中的条件变量&lt;/h2&gt;

&lt;p&gt;正如我们前面所说，Java采取了wait/notify机制来作为intrinsic lock 相关的条件变量，表示为等待某一条件成立的条件队列——说到这里顺带插一段，条件队列必然与某个锁相关，并且语义上关联某个谓词（条件队列、锁、条件谓词就是吉祥的一家）。所以，在使用wait/notify方法时，必然是已经获得相关锁了的，在进一步说，一个推论就是“wait/notify  方法只能出现在相应的同步块中”。如果不呢？就像下面一段（notify表示的谓词是“帐户里有钱啦～”）：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deposit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;或者这样：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deposit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这两段都是错的，第一段没有在同步块里，而第二段拿到的是lock的内部锁，调用的却是this.notify()，让人遗憾。运行时他们都会抛IllegalMonitorStateException异常——唉，想前一阵我参加一次笔试的时候，有一道题就是这个，让你选所给代码会抛什么异常，我当时就傻了，想这考得也太偏了吧，现在看看，确实是很基本的概念，当初被虐是压根没有理解wait/notify机制的缘故。那怎么写是对的呢？&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deposit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;lock&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;或者（取决于你采用的锁）：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt; &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deposit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;notify&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;这就够了吗？&lt;/h2&gt;

&lt;p&gt;看上去，Java的内部锁和wait/notify机制已经可以满足任何同步需求了，不是吗？em…可以这么说，但也可以说，不那么完美。有两个问题：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;锁不够用&lt;br/&gt;
有时候，我们的类里不止有一个状态，这些状态是相互独立的，如果只用同一个内部锁来维护他们全部，未免显得过于笨拙，会严重影响吞吐量。你马上会说，你刚才不是演示了用任意一个Object来做锁吗？我们多整几个Object分别加锁不就行了吗？没错，是可行的。但这样可能显得有些丑陋，而且Object来做锁本身就有语义不明确的缺点。&lt;/li&gt;
&lt;li&gt;条件变量不够用&lt;br/&gt;
Java用wait/notify机制实际上默认给一个内部锁绑定了一个条件队列，但是，有时候，针对一个状态（锁），我们的程序需要两个或以上的条件队列，比如，刚才的Account例子，如果某个2B银行有这样的规定“一个账户存款不得多于10000元”，这个时候，我们的存钱需要满足“余额+要存的数目不大于10000，否则等待，直到满足这个限制”，取钱需要满足“余额足够，否则等待，直到有钱为止”，这里需要两个条件队列，一个等待“存款不溢出”，一个等待“存款足够”，这时，一个默认的条件队列够用么？你可能又说，够用，我们可以模仿network里的“多路复用”，一个队列就能当多个来使，像这样：&lt;/li&gt;
&lt;/ol&gt;


&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Account&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BOUND&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Account&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;withdraw&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InterruptedException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;wait&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// no money, wait&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;notifyAll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// not full, notify&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deposit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InterruptedException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BOUND&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;wait&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;//full, wait&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;balance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;notifyAll&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// has money, notify&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;不是挺好吗？恩，没错，是可以。但是，仍然存在性能上的缺陷：每次都有多个线程被唤醒，而实际只有一个会运行，频繁的上下文切换和锁请求是件很废的事情。我们能不能不要notifyAll，而每次只用notify（只唤醒一个）呢？不好意思，想要“多路复用”，就必须notifyAll，否则会有丢失信号之虞（不解释了）。只有满足下面两个条件，才能使用notify：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;只有一个条件谓词与条件队列相关，每个线程从wait返回执行相同的逻辑。&lt;/li&gt;
&lt;li&gt;一进一出：一个对条件变量的通知，语义上至多只激活一个线程。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;strong&gt;我又想插播一段&lt;/strong&gt;：刚才写上面那段代码，IDE提示抛InterruptedException，我想提一下，这是因为wait是一个阻塞方法，几乎所有阻塞方法都会声明可能抛InterruptedException，这是和Java的interrupt机制有关的，以后我们有机会再说。&lt;/p&gt;

&lt;p&gt;既然这么做不优雅不高效不亚克西，那如之奈何？Java提供了其他工具吗？是的。这就是传说中的java.util.concurrency包里的故事，今天也不说了，有机会在和大家讨论。&lt;/p&gt;

&lt;h2&gt;主要参考资料：&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Wiki&lt;/li&gt;
&lt;li&gt;Addison Wesley, &lt;em&gt;Java Concurrency in Practice&lt;/em&gt; ,Brian Goetz&lt;/li&gt;
&lt;/ul&gt;

</content>
 </entry>
 
 <entry>
   <title>Java Concurrency(1)</title>
   <link href="http://blog.tomsheep.net/2010/06/08/java-concurrency-jmm"/>
   <updated>2010-06-08T02:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2010/06/08/java-concurrency-jmm</id>
   <content type="html">&lt;p&gt;JMM即Java Memory Model，设想有这样一条赋值语句：&lt;code&gt;int a = 1;&lt;/code&gt; 而a为诸多线程所共享， JMM所关注的问题就是：“读取a的线程在何时会看到值为1的这个写入？”&lt;/p&gt;

&lt;h2&gt;为什么关注JMM？&lt;/h2&gt;

&lt;p&gt;在多数情况下，即使是并发程序的程序员，也并不特别关心JMM，因为Java语言与JVM用更高抽象的“同步”语义隐藏了JMM的语义，使得程序员即便对JMM一无所知，也可以写出优雅的并发程序。许多介绍Java同步机制的资料也并不对JMM做过多的介绍。那么你可能会问，“那一上来就讨论JMM有毛用啊？”相信我，是有毛用的。虽然我对Java并不是十分精通，Java下的并发编程更是新上手的菜鸟，但近一段时间的学习经验告诉我，所谓同步，无非关注于两点，一是互斥性，二是可见性。结合自己过去的认识，对并发的理解过多侧重于“互斥性”，而对“可见性”一知半解，影响了对同步更精细的理解。JMM则对此有十分清晰的阐述。&lt;/p&gt;

&lt;h2&gt;JMM从何而来？&lt;/h2&gt;

&lt;p&gt;这就要从盘古开天辟地开始说起了……话说冯诺依曼童鞋当年提出经典的体系结构时，打死他想不到现代的计算机体系结构会发展到这个鸟样子。冯诺依曼模型是一个顺序化的计算模型，可见性不是什么问题，而今天的多处理器架构已经很少再使用顺序一致化模型，而且处理器和编译器的一些优化都会对内存的可见性产生影响：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;处理器乱序执行&lt;/li&gt;
&lt;li&gt;存储在处理器本地的缓存，对其他处理器不可见&lt;/li&gt;
&lt;li&gt;作为优化，编译器可能把变量存在寄存器而非内存&lt;/li&gt;
&lt;li&gt;聪明的编译器可能改变生成指令的顺序&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;更棘手的是，江湖之大，各门各派对这些行为并没有达成统一的共识，不同架构的处理器提供了不同级别的cache coherence，而所谓一种架构的Memroy Model，即是说在该架构中，Memory的行为对应用程序做出怎样的担保。而不同架构中memory barrier这样特殊的指令，正是为了获得memory协调性而引入的。而JMM则隐藏了这些不同架构MM的差异性，千秋万载一统江湖斯密达。&lt;/p&gt;

&lt;h2&gt;Happens-before关系&lt;/h2&gt;

&lt;p&gt;在介绍JMM之前，我们先来了解一些比较重要的概念:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;如果我们把程序看成一个“动作”的集合U，在一个程序的一次执行中，所有这些动作都会在时间上（注意是时间上）有一个次序关系，我们记做“tb”(time-before)关系，显然tb是一个“全序关系”（反对称，传递，并且任意两个动作可比）&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在这个“动作”集合中，有一些动作被称作“同步动作”，包括上锁/解锁，读写volitile变量，线程开始/结束等。在这个同步动作子集S上，有一个全序“sw”（synchronize-with）关系。详细的SW定义：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;对同一个锁，有上锁动作A，解锁动作B，如果B tb A， 则B sw A&lt;/li&gt;
&lt;li&gt;对同一个volatile变量，有写动作A，读动作B，如果B tb A，则B sw A&lt;/li&gt;
&lt;li&gt;对于一个线程，start动作记做A，B为任一该线程中的动作，则A sw B&lt;/li&gt;
&lt;li&gt;对于一个线程，检测到线程终结的动作记做A（包括join返回，isAlive返回false等），B为任一该线程中的动作，则B sw A&lt;/li&gt;
&lt;li&gt;线程t1调用线程t2的interrupt动作记做A，t2检测到中断（抛出InterruptedException，或者检测到interrupt状态更改）记做B，则 A sw B&lt;/li&gt;
&lt;li&gt;对一个变量默认值赋值（0，false，null）动作记做A，对它的任意操作记做B，则A sw B&lt;/li&gt;
&lt;li&gt;一个对象的构造函数结束动作记做A，该对象的finalizer开始记做B，则A sw B&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&lt;strong&gt;SW一致性含义&lt;/strong&gt;：在全序SW中，任一个读操作读到的值是在它之前最后一个写操作写入的值。
3. 在动作集合U上，有一个偏序（自反，反对称，传递，但不是任意两个元素可比）“hb”(happens-before)关系，而他和sw关系有着千丝万缕的关系：那就是如果把sw关系从S集合拿到他的超集U中，求传递闭包，再加上“intra thread原则”——单一线程中，如果动作B在程序中出现在动作A之后，那么A hb B（这很好理解，相当于顺序模型运用在了每个线程内部）。即有：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;HB = t(SW) + IntraThread.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;OK，现在我们已经对HB关系做出了定义。之所以要把它用离散数学的语言写出来，不单单是为了装逼，而是我深感在一些概念性的解释中，数学语言的描述是最简洁、歧义最小、最易于理解的。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HB一致性的含义&lt;/strong&gt;：对于一个变量，有读操作R，写操作W，如果不存在R hb W，并且也不存在另一个写操作W’，使得W hb W‘，并且W’ hb R，那么，W所写的值对于R来说，是“可能”看见的。（这好像法律条文——凡是没有禁止的，都是可能做的）&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;注意1&lt;/strong&gt;：这里需要提出的一点是，HB关系和TB关系是没有必然联系的，也就是，如果A hb B， A不一定tb B， 反过来也一样， 如果A tb B， 不一定就有 A hb B， 这是通常容易混淆的。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;注意2&lt;/strong&gt;：从我们的定义中就可以发现，tb、sw的某些规则（前两条）、hb的某些规则（从sw演化而来的）都是依赖于某次特定的执行（execution）的，在这些情景下，脱离了这个前提，单纯的提A hb B还是C sw D都是没有意义的。&lt;/p&gt;

&lt;h2&gt;JMM现身&lt;/h2&gt;

&lt;p&gt;做了这么多铺垫，主角到现在还没有出现，作为导演鸭梨很大。前面已经介绍了HB关系模型，您可能认为这就是JMM了，其实是有微小差别的——JMM是一种更严格的HB模型。严格在哪里呢？&lt;a href=&quot;http://jcp.org/jsr/detail/133.jsp&quot; title=&quot;JSR 133 - Java Community Process Program&quot;&gt;JSR133&lt;/a&gt;中有一大段形式化描述，看得犯晕，即使我个人再喜欢装逼也万难再描述一遍，我用我的理解来做出简单的解释，请大牛们检查。我们看一个例子：&lt;/p&gt;

&lt;p&gt;初始条件：x = y = 0&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//A&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//B&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//C&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//D&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//E&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//F&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;看上去有点paradox的意思，你可能认为最终a = 0， b = 0是唯一的结果。但是，在HB模型中，不是这样的。让我们来看上面这个例子：我们没有对两个线程做任何同步，对于a，b，x，y的读写都是可能存在data race的。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;插播一条data race的定义&lt;/strong&gt;：对同一变量的两个操作A、B，如果至少有一个写操作，并且A、B不存在HB关系，则我们说两操作存在data race。&lt;/p&gt;

&lt;p&gt;这里，我们把六个操作分别编号（其实6个操作可以再细分为很多个小操作，但这里不需要），我们从HB的定义中可知，同一线程中，A hb B，B hb C，D hb E， E hb F，但是，这个例子中，F和A并没有HB关系，根据HB一致性原则，那么A可以读到F的写入；同理，D可以读到C的写入——这是违背直觉的，但我们并没有违反HB的法律。所以在HB模型中，这是被允许的。&lt;/p&gt;

&lt;p&gt;在JMM中，上述情景是被禁止的。而JMM是通过什么新的条文做到这一点的？我的理解是，只用了下面一条规则：&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;JMM附加规则&lt;/strong&gt;：如果某一动作的发生与否不取决于任何data race的发生与否，那么，这个动作是可以被early committed的。&lt;/p&gt;

&lt;p&gt;带着这条规则，我们再来看上述例子，显然，这样一来，F不能在A之前commit，因为他依赖于对y读写data race的发生，y又依赖x，绕回来了，总之，如果不发生竞争写入，则F不可能发生。如此一来，上述情景被禁止了。为了更好理解，我们再来看一个例子：&lt;/p&gt;

&lt;p&gt;初始条件：x = y = 0&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//A&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//B&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//C&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//D&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;看上去跟刚才那个例子差不多，但如果我告诉你在这个例子中，a = 1， b =1 就是可以被JMM接受的，你会不会感到惊讶？让我们再来检查我们的规则：同样，D和A没有HB关系，B和C没有HB关系，而且，对于附加规则，B、D动作的发生不依赖与任何data race， 即是说，有没有data race，我都可以发生，那么，所有限制性规则再次全军覆没，a = 1， b = 1 可以接受。&lt;/p&gt;

&lt;p&gt;最后一个例子：&lt;/p&gt;

&lt;p&gt;初始条件：x = y = 0&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//A&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//B&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//C&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//D&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//E&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;这个例子就没有刚才那么直观了，现在的问题是a = b = c = 1是JMM可以接受的结果吗？直觉上说，你可能脱口而出，不可能，因为违反了附加规则：操作B依赖于x的data race，x依赖y……B不能提前commit。你很聪明，但是，遗憾的是，编译器比你还聪明。我们看，在B执行的时候，a的取值可能有哪些？没错，无非是0或者1，那么，作为一个比你还聪明的编译器，看出“B操作的本质无非是b = 1，这个操作不依赖于data race发生与否”这一事实，应该是情理之中吧。那么它就会做出优化，把上述代码变为：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;    &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//A&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//B&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//C&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//D&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//E&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;现在，你还说他违反附加原则吗？因此这个情景是被JMM接受的。&lt;/p&gt;

&lt;h2&gt;总结&lt;/h2&gt;

&lt;p&gt;上述是我对JMM一点皮毛的理解，主要参考资料：&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://jcp.org/jsr/detail/133.jsp&quot; title=&quot;JSR 133 - Java Community Process Program&quot;&gt;JSR133&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Addison Wesley, &lt;em&gt;Java Concurrency in Practice&lt;/em&gt; ,Brian Goetz&lt;/li&gt;
&lt;li&gt;各路网文&lt;/li&gt;
&lt;/ul&gt;

</content>
 </entry>
 
 <entry>
   <title>不是人民怕美帝</title>
   <link href="http://blog.tomsheep.net/2010/06/03/people_beat_us"/>
   <updated>2010-06-03T13:02:57+08:00</updated>
   <id>http://blog.tomsheep.net/2010/06/03/people_beat_us</id>
   <content type="html">&lt;p&gt;之前一直用室友的代理上网，集翻墙技术之大成，蕴内网外网于一身，很是方便。但最近速度不是太好，而且并不是所有软件都支持代理，于是我换了铁通帐号——但广受关注的“弱智大学生翻墙难”的问题就出现了，我对自动代理脚本不了解，也没兴趣了解，发现实现同时兼顾复旦局域网、大中华局域网和传说中的Internet的”骑墙”战术真是一件费劲的事情。经过一番纠结，我终于祭出天才的解决方案，那就是……那就是……用三个浏览器。&lt;/p&gt;

&lt;p&gt;其实，我翻墙的目的很单纯，我没有闲的蛋疼非要在Google上搜“胡萝卜”的癖好，也没兴趣看轮[GFW威武]子、民[GFW威武]运等人士的言论，我只不过想偶尔瞄一眼twitter、看看youtube，满足一下作为一名傻逼知道分子的基本的装逼需要而已。而我们的D认为，这是不对的，墙外是危险的，美帝是邪恶的，你需要我的保护。作为一个宇宙大党，这其实是很掉价的做法，而且只能说明其智商的低下和管理方面的无能。这么多年过去了，难道自信心反而越来越差了？&lt;/p&gt;

&lt;p&gt;后来我又想，也许我误会D了，我们正义的化身、月亮的使者、集美丽与智慧于一身的D，真正意图是维护世界网络的和平——因为中国人民是极其剽悍的，拳打南山敬老院，刀砍北海幼儿园，给个二手冲锋枪就能把法院端了，这要走出国门，还不得把美国人祸害死？作为一个负责任的大国，一定要肩负起世界和平的使命。所以，不是人民怕美帝，而是美帝怕人民。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Foxconn</title>
   <link href="http://blog.tomsheep.net/2010/05/30/foxconn"/>
   <updated>2010-05-30T16:15:00+08:00</updated>
   <id>http://blog.tomsheep.net/2010/05/30/foxconn</id>
   <content type="html">&lt;p&gt;起初看到这个名字我以为是“萝莉控”(lolicon)的衍生词，用来描述一批热爱动物热爱自然热爱全人类的“狐狸控”，或者是鄙视IE鄙视chrome鄙视opera的“Firefox控”。后来发现不是这么回事，这是传说中的“富士康”——在经过一番网络科普过后，我终于分清了“富士康”和“富士通”是两个不同的企业，而且，虽然他们都叫“富士”，但没有一个是卖苹果的。&lt;/p&gt;

&lt;p&gt;富士康的员工在不停的往下跳，各地也纷纷传出罢工的消息——一方面我比较担忧，社会的问题越来越多的被暴露出来，说明是在是河蟹不下去了，阶级矛盾（或者阶层矛盾）愈演愈烈，连中国人这样全宇宙最耐操的品种都受不了了。而且我对某党不太有信心，大大小小的2B官僚们未必会觉得死几个P民跟自己有什么关系。另一方面，这些抗争或许会在推动社会进步方面有所裨益，让下层能够越来越多地发出自己的声音，争取自己应得的权利。&lt;/p&gt;

&lt;p&gt;在进入大学后不久我就认识到这是一个操蛋的社会，年轻人生存空间太小，猪一样的各级官僚欲壑难填并掌握话语权和最终解释权，社会上下层流动管道越来越窄，要想出头必须付出常人千百倍的努力。我每天只睡5个小时，日复一日地啃没人愿意碰的专业书籍，玩命地写各种代码……几年来没有精神分裂或者从光华楼上跳下去已然是一种幸运。如果连这个国家的一流大学的top student需要这样的付出才可以在这个社会上勉强立足，那这该是一个多么让人绝望的社会。当然我很庆幸我有奋斗的机会，更多优秀的同龄人甚至无权奋斗。就像他们。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>迷宫</title>
   <link href="http://blog.tomsheep.net/2010/05/27/maze"/>
   <updated>2010-05-27T14:32:28+08:00</updated>
   <id>http://blog.tomsheep.net/2010/05/27/maze</id>
   <content type="html">&lt;p&gt;自从用了ZBlog之后就一直抱怨首页怎么是全文显示，而不是摘要，傻叉的不行，还特地把源码D下来检查了一遍，都没有看出端倪。今天在Google百度的联袂支持下，终于明白，只要轻轻点一下WLW底栏的下拉菜单，摘要区就“biu”地一声出现了——看来是我犯2了……&lt;/p&gt;

&lt;p&gt;前天去杨浦分局取临时身份证，去的时候坐过了3站，凭借强大的脚力在平凉路附近兜了一个让人费解的圈。并且更加行为艺术的是，千辛万苦跋山涉水终于来到公安局的招牌不到5米的地方，我神奇的视力又诱导我2B地去问身旁的行人“杨浦分局在哪”，更神奇的是那哥们在错愕了近10秒之后一脸无辜地回答我：“不知道。”后来我想这哥们是不是刚从里面放出来……&lt;/p&gt;

&lt;p&gt;回来之后在五角场迷路了，这不是第一次，综合我一向的表现可能也不是最后一次，只好装嫩一路问过来。在来到复旦的四年后，我终于明白五角场这个大巨蛋把一条高架蛋疼地分成了两段，而传说中的复旦，就在蛋的那一头。&lt;/p&gt;

&lt;p&gt;我很诧异为什么我玩了这么多年仙剑，搞定了那么多变态的迷宫，却仍然会被上海的路段搞的找不着北，而且，在RPG里，即使走了冤枉路，也会安慰性地拿一个宝箱或者开一段支线，可在大街上迷了路，就只剩下各种没有营养的NPC对话了……&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>女老生</title>
   <link href="http://blog.tomsheep.net/2010/05/24/opera_actress"/>
   <updated>2010-05-24T20:49:38+08:00</updated>
   <id>http://blog.tomsheep.net/2010/05/24/opera_actress</id>
   <content type="html">&lt;p&gt;昨天凌晨督战欧冠决赛，结果让人遗憾。我不是拜仁的球迷，但一则我喜欢AC米兰，二则我喜欢巴萨，所以，本着敌人的敌人就是我们的朋友的原则，我希望拜仁夺冠。但事与愿违，国米还是赢了。&lt;/p&gt;

&lt;p&gt;下午睡醒去兰心戏院看京剧——似乎我每年的这个季节都会拿到两张票，去年拉隔壁的哥们一起去，在天蟾，好像是《李陵碑》，那哥们坚持一个小时后表示对杨继业10个字要唱3分钟的做法“不能忍”，提前退场南京路上溜达去了。对此我很无奈，我了解在这个年龄段里京剧属于非主流爱好，因此尽管今年又拿到2张票，我毅然决定独自前去，看一张撕一张，想坐左边坐左边，想……&lt;/p&gt;

&lt;p&gt;昨天的演出是上戏的京剧学院汇报演出，没有什么角，也不是连本折子戏，很多个小段，演员都很年轻，平均不到20，但我觉得很好——我听戏一点都不专业，只要能把我唱高兴了我就会喜欢。其中印象最深的是一位自拉自唱的女老生，本身我就对男旦或是女老生很是赞赏（跨性别演出在我看来是很难的事情），而且这位姐姐还自拉自唱，乐队的钱都省了。她唱的是《大保国》中的一段，我很感慨，大一时和同班女生一起来看的就是《大探二》（大保国+探皇陵+二进宫），弹指两年岁月蹉跎，世界与我变化真多。&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;《大保国》杨波唱段&lt;/p&gt;

&lt;p&gt;(二黄慢板)&lt;/p&gt;

&lt;p&gt;臣不奏前三皇后代五帝&lt;/p&gt;

&lt;p&gt;奏的是大明朝一段华夷&lt;/p&gt;

&lt;p&gt;太祖爷初登基南京立帝&lt;/p&gt;

&lt;p&gt;四路里反贼寇要谋华夷&lt;/p&gt;

&lt;p&gt;湖广贼陈友谅兴兵起义&lt;/p&gt;

&lt;p&gt;在南京打破了采石矶&lt;/p&gt;

&lt;p&gt;只杀的有田有马无人耕地&lt;/p&gt;

&lt;p&gt;只杀的经商店旅买卖稀&lt;/p&gt;

&lt;p&gt;只杀的妻寻夫来兄找弟&lt;/p&gt;

&lt;p&gt;只杀的父在东来子在西&lt;/p&gt;

&lt;p&gt;老王爷坐江山非同容易&lt;/p&gt;

&lt;p&gt;十八年改国号臣不能全知&lt;/p&gt;&lt;/blockquote&gt;
</content>
 </entry>
 
 <entry>
   <title>自我诊断</title>
   <link href="http://blog.tomsheep.net/2010/05/22/self-diagnose"/>
   <updated>2010-05-22T10:08:33+08:00</updated>
   <id>http://blog.tomsheep.net/2010/05/22/self-diagnose</id>
   <content type="html">&lt;p&gt;昨天下午杀回本部补办各类证件，轻车熟路……&lt;/p&gt;

&lt;p&gt;邯郸路的农行仿佛做了load balancing，效率高了很多——以往的经验让我本来打算领号后先吃个饭晒会儿太阳南区溜达一圈再回来等着叫号，没想到这次只等了10分钟就轮到我了，激动的泪流满面……挨个视察了保卫处、财务处、银行、派出所等战略要地之后，居然还剩出了不少时间让我去了趟图书馆。不得不感慨一下：理图的信息技术类的书真是坚挺，当前我入学的时候就是这些，如今我都快毕业了还是这批元老在坚守岗位，我不知道是不是若干年后我的儿子上复旦的时候，我可以随手翻开一本Fortran程序设计，指着上面的字迹欣慰地对他说：“看，这是老子当年记的笔记……”我没有考古的癖好，于是在数学分类里乱翻了一阵离开。&lt;/p&gt;

&lt;p&gt;今天早上突发奇想Google了一下早晨不停打喷嚏是怎么回事（我纳闷为什么这么多年都没google过），凭借多年患病经验以及二手药学出身，自我诊断了一下，估计是组胺过敏，引发过敏性鼻炎，让人郁结的是之后还有一句“目前没有有效的根治手段”……之前有过轻微的天热发痒的症状（我一直把这当作“人是由猴进化的”的佐证），经查证这叫“胆碱能性荨麻疹”，这些病症共同之处在于都是由于组胺过敏引起的……OK，哥表示淡定，今后忌口，有空去找点抗组胺的药。谁要是认识什么300年临床经验的老中医或者老军医之类的，也欢迎介绍给哥……&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>RP果然守恒</title>
   <link href="http://blog.tomsheep.net/2010/05/21/rp-conservation"/>
   <updated>2010-05-21T01:59:55+08:00</updated>
   <id>http://blog.tomsheep.net/2010/05/21/rp-conservation</id>
   <content type="html">&lt;p&gt; 今天中午悲剧地发现钱包丢了，遍寻无果。各方人士纷纷发来慰问电并致以幸灾乐祸的沉痛哀悼，但截至本人发稿，还没有任何组织和个人宣称对此事件负责。作为不明真相的群众，我只能表示情绪稳定。&lt;/p&gt;

&lt;p&gt; 记得上次丢钱包也是这个季节，丢的东西也差不多：身份证、银行卡、现金200+……整整一年过去了，真是岁月如飞刀，刀刀催人老啊（怎么拐到这儿的……）我恍惚觉得我穿越了。这次我表示比较淡定，因为我越来越觉得：人生，就是一……不是一盒巧克力，谢谢……就是一出RP守恒的悲喜剧，当你志得意满，觉得春天就要来了的时候，他就要搞点插曲恶心你一下——这样可以让心情函数向理性收敛。今天下午我就明显感觉我又可以坐到电脑前认真地看书了。这样很好，唯一让人不爽的是又得回去补办各种卡。ORZ&lt;/p&gt;

&lt;p&gt;下午据掉了ebay的offer，我不太懂如何拒绝别人，尤其是委婉地拒绝。跟HR姐姐扯谎说学校暑期有任务，结巴地解释了一阵终于让她明白我的意思。我终于明白RP是怎么败掉的了。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>RP守恒</title>
   <link href="http://blog.tomsheep.net/2010/05/19/rp-balance"/>
   <updated>2010-05-19T02:59:57+08:00</updated>
   <id>http://blog.tomsheep.net/2010/05/19/rp-balance</id>
   <content type="html">&lt;p&gt;今天收到大摩offer的时候我正在吃晚饭，“一条沟”里人声嘈杂，电话那头HR姐姐刚做完自我介绍，我拎着手机就窜上了“好又多”二楼。回到座位上后我的手已经握不住筷子了。接下来整个晚上我都不知道要干什么，这通常是兴奋的表现——几个月里，一如既往的倔强收到了回报，我很欣慰；傻逼一样的英文训练最终没有掉链子，我很欣慰；耐着性子调出微笑所承受的所有白眼与非议没有白费，我很欣慰。&lt;/p&gt;

&lt;p&gt;这三天连着跑了三趟交大，每一次都让人匪夷所思：第一天是腾讯的笔试，这是我所做过的最简单的笔试题，2个小时的考试40分钟就做完了，剩下的时间我都在考虑到底应该什么时候出去——时间过半我忍不住离开考场，心里还不住犯贱地暗叹“寂寞啊寂寞”。晚上，面试名单中没有我。我确实被震惊了一把，价值观小小地挣扎了一下。旋即指着自己说：“让你丫拽吧，遭报应了吧。”第二天是IBM的宣讲会，我吃饱撑的也跟着去了，部门经理们讲了些什么基本没记住，倒是对他们好玩的宣传片印象深刻。今天下午去微软参观，环境挺好，产品很赞，但这些不是关键，此行对我最大的启发是：在IT企业，女性，尤其是有些姿色的女性，生存下来要容易得多。&lt;/p&gt;

&lt;p&gt;在我终于悲痛地认识到“就算你丫现在变成女的，也得被男员工们拿板砖拍死”这一残酷事实的几个小时后，我接到大摩的offer。看到了吧，其实RP是守恒的。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>卖T的同学们</title>
   <link href="http://blog.tomsheep.net/2010/05/17/tee-sellers"/>
   <updated>2010-05-17T11:32:06+08:00</updated>
   <id>http://blog.tomsheep.net/2010/05/17/tee-sellers</id>
   <content type="html">&lt;p&gt;今天通过Matrix67大神的博客，看到GeekPower推出的系列geek创意衬衫，感觉很好，尤其是大神原创的“心之函数”，穿上一定很装逼。还有部分Dr. Sheldon Cooper 系列，不用说，穿上一定很2B。&lt;/p&gt;

&lt;p&gt;我对创意衬衫感兴趣应该是从王小峰开店开始，三表哥推出的首批衬衫我极为喜欢，尤其是那款惊艳的“All need is U”，胸前FCK三个字母巍然耸立，抬头伞兵骤降，伞包下赫然系着醒目的大U，让我感觉这是近年来看到的最牛X的T-shirt图案。唯一让我不能理解的是三表推出这个系列的时候时值寒冬，我无法想象大冬天买件T-shirt是什么感觉。也许王小峰童鞋在这种方法测试他到底有多少铁杆粉丝。&lt;/p&gt;

&lt;p&gt;BTW，我是生活白痴，为什么都是T-shirt，三表卖的价格咋就高这么多？恩，大概是三表请了那么多美女模特，挑费大啊……&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>TAOCP</title>
   <link href="http://blog.tomsheep.net/2010/05/15/taocp"/>
   <updated>2010-05-15T19:17:11+08:00</updated>
   <id>http://blog.tomsheep.net/2010/05/15/taocp</id>
   <content type="html">&lt;p&gt;写下这个标题我压力很大，这说明我再次决定开始看这本天书，并且把笔记贴在我的技术博客里。(又胡吹。——tomsheep 2013-03-21按) 这本书有过多的让人放弃的理由，比如大量让人抓狂的数学符号，不知所云推理，以及让人绝望的厚度。我在大二的时候试图读过它，在图书馆的角落里坚持了一个礼拜之后，我深情地对着它封面上Knuth的大名说：Fuck you.&lt;/p&gt;

&lt;p&gt;后来我想，其实每当遇到那些让人讨厌的部分，只要跳过他们就好了，去读其他部分——然而我又马上悲观地发现，这样一来这部书就不剩下什么了。&lt;/p&gt;

&lt;p&gt;现在我再次开始读它，因为我实在觉得作为一个长期标榜“数学能力出众，热爱算法理论”的计算机2B，没有读过或者说压根读不懂TAOCP，实在是一件很跌份的事情。当然，我确信它将带给我受用不尽的财富。至于多久可以将它读完，1年？3年？10年？我不知道。我希望是有生之年吧。&lt;/p&gt;

&lt;p&gt;我可以想象出这样一幅画面：夕阳的余辉下，公园长椅上，推镜头，中景，一位年过七旬的老人和他的孙子。老人面部特写，深陷的眼窝，上海交通地图般的脸。近景，老人摩挲着身边半米多高的书堆，特写：The Art of Computer Programming (Volumn 1~4)， Donald Knuth. 切镜头，老人仰望天空45度，泪流满面，30秒，缓缓低头，意味深长地对孙子说：“At Least I tried.”&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>继续学习</title>
   <link href="http://blog.tomsheep.net/2010/05/14/learn-more"/>
   <updated>2010-05-14T02:38:38+08:00</updated>
   <id>http://blog.tomsheep.net/2010/05/14/learn-more</id>
   <content type="html">&lt;p&gt;感谢SB会给了我长达半个月的休假。这些天过得过于舒适了，以至于我觉得应该再放半个月。
  最近的一批笔试面试告一段落，未来的一批还遥遥无期，这几天倒是清闲，看书灌水攒RP等offer——当然等来的也有可能是据信，但不管怎么说都是令人振奋的：哥长这么大发情书收过据信，发简历还没有过，也算填补人生阅历的一项空白。&lt;/p&gt;

&lt;p&gt;花了四天时间去看了《Learning Python》，今天完成——之所以选一们简单易学的脚本语言和一本和谐的入门书作为近日的主要工作，而没有继续学习C++的纠级特性，主要是为了突出节日的气氛，不要让坏了哥的兴致。关于Python，以前断断续续了解过一些，可惜没过多久就会忘掉，前功尽弃。可见学一项新技术最好还是一鼓作气的好。关于Python的进一步学习，我的计划中有一列书单，列出来我看着都晕——这是我的风格，实话说我不怎么有天分，学习方法也比较传统，技术都是靠成堆成堆的书砸出来的，Zellux大神看几页文档手册环境配一下代码敲几句就可以触类旁通的东西，我必须得找十来本可以当作凶器的书（有时还有误人子弟的）从ABC到XYZ爬一遍，这中间有些还难免会忘掉——这就是懂甲骨文的和只懂白话文的区别。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>世博见闻</title>
   <link href="http://blog.tomsheep.net/2010/05/09/my-expo"/>
   <updated>2010-05-09T22:52:33+08:00</updated>
   <id>http://blog.tomsheep.net/2010/05/09/my-expo</id>
   <content type="html">&lt;p&gt;昨天和高中同学去世博，他听说沙特馆很牛X，非得看看，于是乎我们就大义凛然地加入沙特馆的外环。。。再于是乎悲剧就开始了：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;半小时后，我们成功地挺进六环。&lt;/li&gt;
&lt;li&gt;45分钟后，数位身手矫捷的大妈施展跨栏绝技，瞬间经验暴涨，等级飙升；周围群众 受到鼓舞，竞相效仿；有人嘀咕：“中国人素质真差。”我瞬间条件反射，此帖若出现 光滑牛屎版，必然被送吴美芬雅号，并立即遭人诘难，“你丫一土鳖，又没出过国，咋就知道洋大人素质比中国人高？”所以，我谨慎地认为还是这样说比较得体“你们地球人素质真差。”&lt;/li&gt;
&lt;li&gt; 1个半小时后，开始下雨，排在我们后面的人退散了一多半，我们很难过，觉得近两个小时白等了。。。这是一种怎样的猥琐心理？&lt;/li&gt;
&lt;li&gt; 2个小时后，我们终于进入三环内，这时发生各种状况，拐角处护栏被大无畏的群众强拆，人民在恶劣的内部和外部环境下不屈不挠地杀出一条血路，瞬间局部发生骚动；10分钟后保安与武警增援，局势稍微稳定。&lt;/li&gt;
&lt;li&gt;期间各种摩擦不断，有小规模切磋武艺的情况出现。&lt;/li&gt;
&lt;li&gt;2个半小时后，队伍进入长时间停滞状态，群众纷纷喊出了“傻X”“退票”“领导来了” 等爱国口号。但可惜无组织无纪律，没有形成统一战线。申花球迷还不服人家北京国安拿冠军呢，看看吧，这就是差距，人家球迷喊“傻X”都比你们喊得整齐。&lt;/li&gt;
&lt;li&gt;我身后的阿姨不停埋怨我不奋力往前挤，让人家都超越了。我这个委屈。。这又不是F1排位赛，抢半个身位有嘛用啊。。。&lt;/li&gt;
&lt;li&gt;3个小时后，我体能达到一次极限，这时候前有堵截后有追兵，想退出门儿都没有，我咬牙切齿地对自己说，这时候就是馆里面有十来个沙特公主哭着喊着要嫁给哥，哥也……哥也……哥也会极其慎重地考虑一下的……&lt;/li&gt;
&lt;li&gt;间隙我问身边的游客为啥这么多人往沙特馆奔，他说好像沙特王子来了吧……靠，哥才不要看沙特王子，哥来看的是沙特公主～啥？没公主？叫沙特国王给哥速度生一个……&lt;/li&gt;
&lt;li&gt; 将近4个小时的等待后，我们终于到了入口。4分钟后，我们出现在出口。&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;PS:沙特馆内容还是不错的。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>博客备案</title>
   <link href="http://blog.tomsheep.net/2010/05/01/tomsheep-net"/>
   <updated>2010-05-01T08:23:09+08:00</updated>
   <id>http://blog.tomsheep.net/2010/05/01/tomsheep-net</id>
   <content type="html">&lt;p&gt; 昨天睡的比较早，主要因为比较高兴，看不进书。下午收到博客备案成功的消息，然后又接到大摩的面试通知。感觉相当良好。
 其实大摩的几轮表现不是很让我满意，在笔试结束后，我一直祈祷，这次发挥欠佳，给我电面的机会，我一定会表现得很好；电面结束后，我又开始祈祷，发挥失常，给我面试的机会，我一定会让你们满意……结果还真是一步步都过来了，估计上帝都无奈了：“哥们儿，我够意思了，再掉链子我也帮不了你了……”&lt;/p&gt;

&lt;p&gt;上个月申请的空间与域名，今天终于备案结束，在贵国就是这样，绑个域名也得党同意才行。这样一来，现在哥也是玩独立博客的主了，有朝一日我会正式把博客搬到那里 &lt;a href=&quot;http://tomsheep.net&quot;&gt;http://tomsheep.net&lt;/a&gt; ，当然，老是搬家让人很无语，但我想这应该是最后一次了。(Are you sure? ——tomsheep 2013-03-21按)毕竟那是哥花了160RMB/YEAR 买的地方，不住白不住，也能监督我经常更新，否则都对不起物业税。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Damn it</title>
   <link href="http://blog.tomsheep.net/2010/04/25/when-in-doubt-just-fuck"/>
   <updated>2010-04-25T06:06:27+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/25/when-in-doubt-just-fuck</id>
   <content type="html">&lt;p&gt; 下午参加了微软的笔试，感觉比大摩笔试时要好得多。最后一个大程序想出了很好的解法，还算满意，唯一可惜的是最后的testcase没时间写。签了协议不许透题，那就到此为止。&lt;/p&gt;

&lt;p&gt; 前天大摩电话面试，紧张的很，表现有些差，本来装逼地在简历里写了Skilled in Design Patterns，没想到上来逮住就问了个设计模式和contention结合的问题，其实不难，但事实上我没有理解清楚题意，瞎扯了一通。最后的时候被那个老外问题了个逻辑智力题，脑子一片混乱，他还不停的催”Are you listening?”，纠结了一两分钟后放弃。感觉表现的过于紧张，估计被BS了。总结的经验是，如果短时间内做不出来，应该及早放掉，让他问更多的问题，这样表现的机会会更多一些。&lt;/p&gt;

&lt;p&gt; 最近神经比较紧张，经常会把脑子里闪过的东西不自主大声喊出来，比如“Fuck”，“damn it”， “你大爷”，“这他妈他太牛逼了”等等， 不过这样也挺好，挺过瘾的。有一本书叫Language Most Foul，翻译叫《脏话文化史》，看过一点，很有意思，本来离开PPI时准备送一份电子版给王肇国，后一想怕他误以为我在讽刺他，也就算了。留着自己有空看。&lt;/p&gt;

&lt;p&gt; 刚才看了部经典电影Scent of a Woman，感觉是近期看过的最好的电影，标题就是那个老中尉的台词，“When in doubt, fuck”. 当时好像是对自己养的猫说的。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>独自等待</title>
   <link href="http://blog.tomsheep.net/2010/04/19/waiting-is-awful"/>
   <updated>2010-04-19T15:35:50+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/19/waiting-is-awful</id>
   <content type="html">&lt;p&gt;Today one of my classmates came to tell me that he just got the phone interview permission of Morgan Stanley. I felt great pain in my heart because I got nothing yet. I admit that I did a really bad job in the written test, but it still hurt when I got the news that someone around me passed it.&lt;/p&gt;

&lt;p&gt;Well, I don’t know whether I will get the the permission later. I hope I will be lucky enough to get an opportunity to express myself in next round, but if not, I will accept anyway and go on to fight for the future.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>长路漫漫</title>
   <link href="http://blog.tomsheep.net/2010/04/19/long-way-to-go"/>
   <updated>2010-04-19T01:59:40+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/19/long-way-to-go</id>
   <content type="html">&lt;p&gt;Finally I finished the book C++ Primier 4ed as expected. I found that C++ is a so complex language, just like a federation of many sub-languages. But it is powerful anyway, and I think I will deperately fall in love with it.&lt;/p&gt;

&lt;p&gt;I came to realize that only a primier book was far from enough, so a few hours ago I searched the Internet and got quite a few ebooks on C++, all of which are considered as classic tutorials or even Bibles in this field. Hmmm…you see, it is still a long way to become a practitioner of C++.&lt;/p&gt;

&lt;p&gt;Acctually, at the very beginning I was just eager to get a brief knowledge of C++, in order to deal with the forthcoming written tests and interviews. However, now I have decided that I will step into this fascinating language and try hard to be a master in it. Well, that will take quite a lot of time and I must not be too hurry.&lt;/p&gt;

&lt;p&gt;On the other hand, I would not stop the preparation as planned, including C#, Python, Network and so on.&lt;/p&gt;

&lt;p&gt;PS. Almost forget to say, I bought a 1TB-hard disk today for my exploding resourses, most are ebooks, video clips and softwares. :)&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>一切正常</title>
   <link href="http://blog.tomsheep.net/2010/04/16/all-going-well"/>
   <updated>2010-04-16T00:59:42+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/16/all-going-well</id>
   <content type="html">&lt;p&gt;I learned some mechanisms in C++ like templates and polymorphism today, which are elements of this language and certainlly challenging to understand. And it was a little bitter to find that I had done some subjects totally wrong in the written test once I come to know these techniques. Hmm…haha.&lt;/p&gt;

&lt;p&gt;Well, I will finish the book C++ Primier tomorrow, if everything goes well, as today. I must do some preparation for the interview things, such as getting familiar with the company I want to join and the position I want to apply. It is really important to make a good prepraration before the interview or written test. Although this lesson I learned from the written test last week is costly indeed, I think it is beneficial for me and it will never be too late to realise it.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Joe Wong</title>
   <link href="http://blog.tomsheep.net/2010/04/15/joe-wong"/>
   <updated>2010-04-15T00:40:02+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/15/joe-wong</id>
   <content type="html">&lt;p&gt;C++ on the way. The topic for today is operator overloading. It is tricky and I have found lot of fun in it.&lt;/p&gt;

&lt;p&gt;Just two hours ago I watched a video clip on youku.com, a famous video sharing website like youtube.com, that is a talkshow performed by a Chinese American whose name is Joe Wang (Huang Xi in Chinese). He has got a weird Chi-English accent but I really found his talk funny and marvelous. Many Americans also love his jokes very much, including their president Obama. I realise that it is whether you can speak out that really matters, rather than how fluently you speak or how close your pronunciation is to the standard. People care who you are, what you say, what you do and what you can do, while the language is only a tool for communication. It doesn’t matter to make mistakes, just speak out.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Que sera, sera</title>
   <link href="http://blog.tomsheep.net/2010/04/13/whatever-will-be-will-be"/>
   <updated>2010-04-13T22:47:03+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/13/whatever-will-be-will-be</id>
   <content type="html">&lt;p&gt;I am making progress everyday.&lt;/p&gt;

&lt;p&gt;Today I reviewed some subjects in JAVA , including JAVA exceptions, threads, and I also get to learn some C++: container is today’s subject. Some of my friends just think it ridiculous that I, who is one of the top students in the class, am doing such…kind of naive staff. They think these techniques are simple and I am supposed to deal with some really challenging problems.&lt;/p&gt;

&lt;p&gt;Well, I think in another way. I don’t find it stupid learning these fundamental techniques. They are basic, but not naive. Every time I read such classic books, I attain some new knowledge or feelings that I never have got. I will keep doing such “stupid”things over and over again.&lt;/p&gt;

&lt;p&gt;This afternoon I watched a moive named Marry and Max. The story moves me indeed and I really love the interlude
 Whatever will be, will be,which is also known as Que Sera, Sera in ancient Spanish.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Whatever Will Be, Will Be&lt;/p&gt;

&lt;p&gt;When I was just a little girl   &lt;br/&gt;
I asked my mother what will I be      &lt;br/&gt;
Will I be pretty, will I be rich   &lt;br/&gt;
Here&#39;s what she said to me&lt;/p&gt;

&lt;p&gt;Que sera, sera   &lt;br/&gt;
Whatever will be, will be      &lt;br/&gt;
The future&#39;s not ours to see    &lt;br/&gt;
Que sera, sera    &lt;br/&gt;
What will be, will be&lt;/p&gt;

&lt;p&gt;When I grew up and fell in love    &lt;br/&gt;
I asked my sweetheart what lies ahead      &lt;br/&gt;
Will we have rainbows day after day    &lt;br/&gt;
Here&#39;s what my sweetheart said&lt;/p&gt;

&lt;p&gt;Que sera, sera   &lt;br/&gt;
Whatever will be, will be      &lt;br/&gt;
The future&#39;s not ours to see      &lt;br/&gt;
Que sera, sera     &lt;br/&gt;
What will be, will be&lt;/p&gt;

&lt;p&gt;Now I have children of my own     &lt;br/&gt;
They asked their mother what will I be      &lt;br/&gt;
Will I be handsome, will I be rich    &lt;br/&gt;
I tell them tenderly&lt;/p&gt;

&lt;p&gt;Que sera, sera    &lt;br/&gt;
Whatever will be, will be   &lt;br/&gt;
The future&#39;s not ours to see     &lt;br/&gt;
Que sera, sera    &lt;br/&gt;
What will be, will be&lt;/p&gt;&lt;/blockquote&gt;
</content>
 </entry>
 
 <entry>
   <title>面试题(2)</title>
   <link href="http://blog.tomsheep.net/2010/04/13/interview-q2"/>
   <updated>2010-04-13T04:42:41+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/13/interview-q2</id>
   <content type="html">&lt;p&gt;依然是周六摩根的笔试题，还是时间原因，比上一道更可惜，是到简单的高分题，给出两个已排序的array，设计算法找出将两个array合并以后的中位数。若算法为O(log(n))时间得满分，O(n)时间给半分。最后做时只剩5分钟，仓促地写了一个O(n)的傻瓜算法，就是mergesort的合并过程。&lt;/p&gt;

&lt;p&gt;其实O(log(n))算法更加简单，当时着急想都没想。下面给一个解：&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.Random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Median&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; 
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Median&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;arr1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;arr2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;arr1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;nextInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;arr2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;nextInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Arrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// O(log(n))&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getMedain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;];&lt;/span&gt;

        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getMedain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; 
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getMedain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;l1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;h2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;median&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getMedain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;printArrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot; arr1: &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot; arr2: &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arr2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Median&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Median&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printArrays&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot; median: &amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;median&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;



</content>
 </entry>
 
 <entry>
   <title>面试题(1)</title>
   <link href="http://blog.tomsheep.net/2010/04/13/interview-q1"/>
   <updated>2010-04-13T04:33:23+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/13/interview-q1</id>
   <content type="html">&lt;p&gt;周六摩根的笔试，状态一般，有一些应该拿分的题目时间太紧没来得及做，有点可惜。&lt;/p&gt;

&lt;p&gt;下面是其中之一：给定两个String，找出后一个在前一个中的所有“顺序匹配”。举例如str1为“abcabc”，str2为“abc”，则所有匹配应为&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;（0,1,2, (0,1,5), (0,4,5), (3,4,5). 要求给出非递归算法。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;下面是回来后写的一个解，包含递归和非递归版本。其中非递归算法有些讨巧，其实就是把递归的操作用显式的栈来模拟，起码名义上满足了题目要求。&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.Stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StringMatch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;StringMatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; 
        &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;cset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()];&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;recursiveMatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;match: &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt; 
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;charAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;charAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;recursiveMatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;recursiveMatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;nonRecersiveMatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Solution&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()]);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sol&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isEmpty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;Solution&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;match: &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;++)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;charAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;charAt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;clone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()));&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cur&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;clone&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()));&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;StringMatch&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringMatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;abcabc&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;abc&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;recursive&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;recursiveMatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Non recursive&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;nr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;nonRecersiveMatch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Solution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; 
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Solution&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;pos2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;buf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;当时时间利用有些失误，放掉了这道题。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>考试复盘</title>
   <link href="http://blog.tomsheep.net/2010/04/12/test-review"/>
   <updated>2010-04-12T21:09:07+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/12/test-review</id>
   <content type="html">&lt;p&gt;Today I reviewed some subjects of the written test last Saturday, and redid them.&lt;/p&gt;

&lt;p&gt;In the past I usually resisted to review subjects of examinations I had taken, because I thouht that it had already gone and any review was just useless and stupid.&lt;/p&gt;

&lt;p&gt;But things changed. Now I believe it will figure out in which aspect I need to improve, and remind me of never being lazy and arrogant. This will be a new convention of me and is supposed to do me good in the long run.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>还好</title>
   <link href="http://blog.tomsheep.net/2010/04/11/so-far-so-good"/>
   <updated>2010-04-11T21:37:02+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/11/so-far-so-good</id>
   <content type="html">&lt;p&gt;Yestday I took the written test held by Morgen Stanley. Actually the examination paper did not make me feel happy. The questions were not very difficult but I realised that I just had not been prepared for it. I definely believe that I should have done better.&lt;/p&gt;

&lt;p&gt;Well, optimistically speaking, I don’t think that there are many candicates doing a much better job than mine. I believe, or just hope that I am supposed to step into next round.&lt;/p&gt;

&lt;p&gt;These days I will review some courses and techniques that I have learned for these years, such as Java, C++, OOP, etc. I think I will benefit for the application.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>无字幕</title>
   <link href="http://blog.tomsheep.net/2010/04/08/no-subtitles"/>
   <updated>2010-04-08T21:42:41+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/08/no-subtitles</id>
   <content type="html">&lt;p&gt;These days I have watched a lot of American movies and TV series to improve my English listening comprehension, and it works.&lt;/p&gt;

&lt;p&gt;At the very begining, I had to follow the Chinese subtitles to make sure what the characters were talking about. And a few days later, the subtitles went to be Chinese-English ones. While as time went by, it was the pure English subtitles that I needed to follow. What a fantastic progress!&lt;/p&gt;

&lt;p&gt;And today I just went along with an American comedy, Step Brothers for its name, without subtitles! The fact is I did not find any proper subtitles for it, but it was really cool that I finally made it! God!&lt;/p&gt;

&lt;p&gt;Today is also a big day for my roomate, little piggy, it is his 21st birthday, and we guys went out for dinner to celebrate it. That’s great.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>重来</title>
   <link href="http://blog.tomsheep.net/2010/04/07/start-over"/>
   <updated>2010-04-07T00:31:00+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/07/start-over</id>
   <content type="html">&lt;p&gt;I quitted the Parallel Processing Institute offically today, and that means I become free and alone again. Now I am preparing for the written test in Saturday.God bless me, come on!&lt;/p&gt;

&lt;p&gt;It’s time to start all over.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>逝者如斯</title>
   <link href="http://blog.tomsheep.net/2010/04/05/once-it-is-gone-it-is-gone"/>
   <updated>2010-04-05T11:29:16+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/05/once-it-is-gone-it-is-gone</id>
   <content type="html">&lt;p&gt;One of my roomates got a bad news that his beloved uncle had passed away. I feel really sorry about it but I don’t know how to comfort him. I have never experienced such sadness so I don’t know how it suffers, and I will never want to know. I wondered whether it is proper to say something like “Let it be” or “Once gone it is gone”, finally I said nothing. He sobbed the night long in bed and got up early this morning. When I woke up he has already gone away. I sent an email to him with a poetry attached, which is written by Shi Zhi and I have loved it for years. The poetry reads,&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;相信未来(食指)    &lt;br/&gt;
当蜘蛛网无情地查封了我的炉台     &lt;br/&gt;
当灰烬的余烟叹息着贫困的悲哀     &lt;br/&gt;
我依然固执地铺平失望的灰烬     &lt;br/&gt;
用美丽的雪花写下：相信未来     &lt;br/&gt;
当我的紫葡萄化为深秋的露水     &lt;br/&gt;
当我的鲜花依偎在别人的情怀     &lt;br/&gt;
我依然固执地用凝霜的枯藤     &lt;br/&gt;
在凄凉的大地上写下：相信未来     &lt;br/&gt;
我要用手指那涌向天边的排浪     &lt;br/&gt;
我要用手掌那托住太阳的大海     &lt;br/&gt;
摇曳着曙光那枝温暖漂亮的笔杆     &lt;br/&gt;
用孩子的笔体写下：相信未来     &lt;br/&gt;
我之所以坚定地相信未来     &lt;br/&gt;
是我相信未来人们的眼睛     &lt;br/&gt;
她有拨开历史风尘的睫毛     &lt;br/&gt;
她有看透岁月篇章的瞳孔     &lt;br/&gt;
不管人们对于我们腐烂的皮肉     &lt;br/&gt;
那些迷途的惆怅、失败的苦痛     &lt;br/&gt;
是寄予感动的热泪、深切的同情     &lt;br/&gt;
还是给以轻蔑的微笑、辛辣的嘲讽     &lt;br/&gt;
我坚信人们对于我们的脊骨     &lt;br/&gt;
那无数次的探索、迷途、失败和成功     &lt;br/&gt;
一定会给予热情、客观、公正的评定     &lt;br/&gt;
是的，我焦急地等待着他们的评定     &lt;br/&gt;
朋友，坚定地相信未来吧     &lt;br/&gt;
相信不屈不挠的努力     &lt;br/&gt;
相信战胜死亡的年轻     &lt;br/&gt;
相信未来、热爱生命&lt;/p&gt;&lt;/blockquote&gt;
</content>
 </entry>
 
 <entry>
   <title>tomsheep.net</title>
   <link href="http://blog.tomsheep.net/2010/04/04/a-notebook"/>
   <updated>2010-04-04T20:27:15+08:00</updated>
   <id>http://blog.tomsheep.net/2010/04/04/a-notebook</id>
   <content type="html">&lt;p&gt;Today I registered a virtual space with a independent domain name tomsheep.net, which costs me 160 RMB more or less. I can not tell exactly what urged me to do so, but I know very well it will benefit me by driving me to keep writing everyday.&lt;/p&gt;

&lt;p&gt;BTW, I am really fond of this theme of blog, a cute and clear notebook.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>娱乐时间</title>
   <link href="http://blog.tomsheep.net/2010/03/22/party-time"/>
   <updated>2010-03-22T08:36:08+08:00</updated>
   <id>http://blog.tomsheep.net/2010/03/22/party-time</id>
   <content type="html">&lt;p&gt;It is a pleasure to meet some old friends and talk about anything and nothing. Today some classmates and I got together again to have a dinner in a Xinjiang restaurant, with some of them just having returned from aboard. I tried to speak a lot in the dinner, which appears to be a challenge for me. Most of them found it unbelievable that I had become so “outgoing”, and I was also excited that I can behave this way. It makes me feel great.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>博客恢复</title>
   <link href="http://blog.tomsheep.net/2010/03/21/diary-resumes"/>
   <updated>2010-03-21T06:08:29+08:00</updated>
   <id>http://blog.tomsheep.net/2010/03/21/diary-resumes</id>
   <content type="html">&lt;p&gt;From this day onwards, I will keep a diary in English on my blog, in order to improve my writing technique.&lt;/p&gt;

&lt;p&gt;These days I spent a lot of time on the opengl stuff, and I find it fascinating to program in the manner of Computer Graphics. If I choose to stay in Fudan for my master’s degree, I think I will take it as my direction of research. As I love programming as well as math, they have a prefect marriage in CG.&lt;/p&gt;

&lt;p&gt;Mogan Stanley is recruiting for summer interns. Sounds very attractive, isn’t it? I wound like to have a try, though I hardly believe I can make it. Sometims I wonder, if I had not taken the wrong way from the very first and wasted so much time, I wound have been strong enough and I wound be more confident. This morning I read a weblog of my classmate, he just felt regret for his sluggish as a freshman. I know very well that he is a great guy, smart, cute, talented in Computer Science… Well, you see, to err is human. What can I complain about any more? Just do the best, prepare for the worst.&lt;/p&gt;

&lt;p&gt;I will practice my public speaking and programming skills hardly, for gods sake.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Google依赖</title>
   <link href="http://blog.tomsheep.net/2010/03/12/google-man"/>
   <updated>2010-03-12T08:17:02+08:00</updated>
   <id>http://blog.tomsheep.net/2010/03/12/google-man</id>
   <content type="html">&lt;p&gt;阅读只订Google Reader&lt;/p&gt;

&lt;p&gt;写信只用Google mail&lt;/p&gt;

&lt;p&gt;微博只推Google Buzz&lt;/p&gt;

&lt;p&gt;聊天只选Google talk&lt;/p&gt;

&lt;p&gt;地图只看Google map&lt;/p&gt;

&lt;p&gt;音乐只听Google music&lt;/p&gt;

&lt;p&gt;编辑只靠Google docs&lt;/p&gt;

&lt;p&gt;浏览器只有Google chrome&lt;/p&gt;

&lt;p&gt;……&lt;/p&gt;

&lt;p&gt;我看出来了&lt;/p&gt;

&lt;p&gt;哥就差一Google offer&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>白驹过隙</title>
   <link href="http://blog.tomsheep.net/2010/02/21/time-flies"/>
   <updated>2010-02-21T10:21:49+08:00</updated>
   <id>http://blog.tomsheep.net/2010/02/21/time-flies</id>
   <content type="html">&lt;p&gt;我的Google Reader每天稳定地产生900多条未读资讯，不出意外，他们其中让我眼前一亮的只有几十条，或者更少。这不仅是一个成本问题，更是一个心态问题——不仅是去阅读数百条乏善可陈的博文简讯事是否值得的问题，更是是否相信自己有能力在海量的讯息中找到有用的信息，并且坚信这样的训练终将与我有益的问题。想明白这一点，近一年来悲剧的症结也便找到了。&lt;/p&gt;

&lt;p&gt;我的QQ和MSN已经宣布作废，这件事本身并没什么意思，因为如果已经开着一个聊天工具（比如gtalk），那再多开两个IM软件的边际成本微乎其微，几乎不会对工作效率和个人精神状态有任何附加影响。但我仍然坚持不再使用它们：我尽管经常后悔，但绝少反悔。况且我已经习惯了每天只要打开gmail和google reader就可以完成所有网络工作的简单生活。&lt;/p&gt;

&lt;p&gt;这个假期的大部分时间都在睡觉，但仍然觉得疲惫，年过的不怎么称心。抽空看了几本书，唯恐忘记，简记一下：&lt;/p&gt;

&lt;p&gt;《动物农庄》——乔治奥威尔的政治寓言，名头很大，导致很多年来我一直假装自己读过，后来装着装着自己都快信了，假期找了中译的电子书，特别留意了一下是1944年成稿的，1944年。以后有机会读读原著。其实我更感兴趣的是他的另一本著作《1984》，同样假装读过很多年，我都不好意思了。&lt;/p&gt;

&lt;p&gt;《牛奶可乐经济学》——其实我特想了解经济学，可又对大部头的学究书十分畏惧，总想找点脍炙人口的、深入浅出的、不用自宫也能成功的秘籍速成。结果是，一两年前去读风靡一时的《货币战争》，结果网上网下的“专家”都说这是本烂书，搞得无趣。寒假随便找了这本写得颇有趣的小书，结果专家们又说，这还是本烂书。烂就烂吧，哥的品味也就这样了。以我的审美标准，这本书还是颇可读的，至少提起了我对经济学的兴趣。今年一定去读曼昆的《经济学原理》，这笔时间我相信是值得花的。&lt;/p&gt;

&lt;p&gt;《天龙八部》——好长啊~&lt;/p&gt;

&lt;p&gt;《觉后禅》——他还有一个广为人知的名字好奇的同学自己去搜，没错，就是明朝的那本艳情小说，不得不说，比《金瓶梅》差远了。我认为中国古代的小说一大通病就是故事太差，都偏重于人物刻画，所以人物塑造功底一个比一个厉害。但凡故事上也过得去的都成了名著，《儒林外史》故事不见得多好，甚至写散架了，但也成了一派风格，我也极喜欢；故事扯蛋担架不住文笔好人物好因此流传的也不少，像《莺莺传》到《西厢记》这个系列，多么狗血的剧情，文人们竟然整了一版又一版，比翻拍金庸还勤快。&lt;/p&gt;

&lt;p&gt;《战争与和平》——唉，唉，唉~别以为我叹气是被这史诗巨著给震撼的，这上下两册书在我的书架上躺了8年以上，至今可以拿出去当新书卖。这个假期我想咱也感受一下上档次的感觉吧，结果压根没有翻超出5页，就被5、6个公爵，7、8个夫人的名字搞得彻底崩溃。若干年前看《红楼梦》的时候也有类似人物过多的困扰，但所幸中国古人取名很有规矩，名字写出来一望便知是哪个辈分的，一丝不差。无奈俄国人法国人英国人没有这个优良传统，不知道这部书我什么时候有兴趣再翻一翻。&lt;/p&gt;

&lt;p&gt;马上又要开学了。&lt;/p&gt;

&lt;p&gt;时间是有限的，知识是无尽的。企图大包大揽只能得不偿失。套路有很多种，没有哪一种至高无上。如果你觉得不值，那就做些值得做的。如果不知道怎么分辨值不值得做……那你是得学点经济学了。别浪费时间。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>南方周末</title>
   <link href="http://blog.tomsheep.net/2010/01/31/weekly"/>
   <updated>2010-01-31T11:45:50+08:00</updated>
   <id>http://blog.tomsheep.net/2010/01/31/weekly</id>
   <content type="html">&lt;p&gt;keywords：人间蒸发&lt;/p&gt;

&lt;p&gt;香港呆了一周，电脑几乎断网，手机基本停机，终于有些轻松的感觉。除了冷不丁有个别港中大女生突然冒出来一本正经地问你“对输精管结扎有什么看法”之外，基本没有受到任何干扰。&lt;/p&gt;

&lt;p&gt;中大的安排是早上听课，下午做题，并且有一个competition——尽管我主观上也存有别太掉链子给母校抹黑的念想，但无奈我和算法实在没打过什么交道，认识停留在最短路径，mst，pattern matching等白痴算法上，教授们嘴里动不动就蹦出来的拉格朗日、切比雪夫总能整的我一愣一愣的，而个别清华的理论大牛在一边频频点头，“oh，that&#39;s easy”，我只能随声附一句“操”。不是咱的强项，该低头时就低头，该打酱油打酱油，和我同行的信安哥们比我还淡定，指着海报不停地强调“joy，joy of computer science”。我只能耐着性子，不发言，不表态，不作为。&lt;/p&gt;

&lt;p&gt;接触了一些不同学校的学生，风格果然大相径庭，几所“综合性大学”水得不相上下，连“杀人”这样的游戏都没人家玩得专业，以至于交大的哥们不经意脱口而出“你们文科学生XXXX”，我等连同北大浙大一干人集体飙汗。我庆幸没有告诉他其实我当天早上才知道什么是FPT algorithm。不过后来欣喜地发现，一批清华哥们居然在教室后排万分纠结地补做OS lab，我顿时觉得很欣慰。&lt;/p&gt;

&lt;p&gt;最后的比赛很有喜感，PKU凭借所有session中最简单的一道题拿到亚军，他们的主讲mm一口流利的英文估计把旁边坐的港大教授迷晕了，居然提问了一个弱智问题，mm欣然作答，圆满得一塌糊涂。而最传奇的却不是他们：当初分组时我们和清华中的几个（清华来了很多人）分到一起，大家若干天各打各的酱油，丝毫没有群策群力集体做题的意思。最后一天11：30，我看了看身后的信安哥们，他想了想来了句“要不我们give up吧……”；12:30, 刚睡醒的一只大牛从酒店赶来，瞬秒掉一道hard中极有难度的题目，1：30，大牛做ppt；2：30，大牛在走廊里背英语；3：30，大牛操着蛋疼的英文上台做presentation。两小时后，我们是冠军。当时就是这样。莫名其妙从姚期智手里接过写着“First Place”的奖品时，我觉得这世界真他妈荒诞。&lt;/p&gt;

&lt;p&gt;最后一天被导游带着到处跑，所谓观光也就是照相，“青马大桥摄影棚”，“杜莎夫人照相馆”，“太平山彩扩部”，“浅水湾图片社”，一圈下来，除了几张模糊的照片，什么都没留下。倒是口齿伶俐的导游本人更为有趣一些，不过他似乎对香港何某人有四个老婆很是不忿，一路上“一恶三四”念叨了很多次。&lt;/p&gt;

&lt;p&gt;That it is。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>不好玩了</title>
   <link href="http://blog.tomsheep.net/2010/01/21/weekly"/>
   <updated>2010-01-21T05:50:09+08:00</updated>
   <id>http://blog.tomsheep.net/2010/01/21/weekly</id>
   <content type="html">&lt;p&gt;keywords：你丫力大么&lt;/p&gt;

&lt;p&gt;结束一段拙劣而无意义的rush。我已出仓，感觉良好。&lt;/p&gt;

&lt;p&gt;有点被马甲绑架的感觉，整理了一下自己冗杂的对外接口，保留以下：&lt;/p&gt;

&lt;p&gt;1.tel： 137XXXX6683&lt;/p&gt;

&lt;p&gt;2.email：
tomsheep.cn@gmail.com&lt;/p&gt;

&lt;p&gt;3.blog:
http://tomsheep.blogbus.com/&lt;/p&gt;

&lt;p&gt;备注：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;除（1）之外，我不会在非必要的情况下使用任何其他IM软件，包括MSN，QQ（尽管我曾经异常喜欢这个即时通讯工具），etc。移动联通大小灵通用户找我可直接通过手机，我尽量养成随身携带手机的习惯。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;email 长期活跃，无论您是想求神问卜、交流技术、找茬骂街还是查天气预报，是谈人生谈理想还是谈经济谈党史，都请通过这个地址。只要我坐在电脑旁，10分钟内会给予回复（Gtalk is welcome）。多个信号走一个信道，这就是“多路复用”，有朝一日要是被人考了这道题，你们得记得bg哥。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;不会维护除（3）外任何博客、微博客、SNS社区空间，不保证使用任何论坛的任何ID，gh的马甲已基本清理，有一个仍在版主任期，那就留着它吧。不过不要试图通过它联系我。使用大量的马甲是因为好玩，现在不好玩了。&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当然你还可以通过在我家楼下蹲点的方式逮到我本人，不过你要是没在我18岁后见过我，我觉得这也挺不靠谱。&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;由于外出的原因，几天后我就可以提前和这个季度告个别了，正好有一段较为宽裕的时间以供重新审视自己的方向。眼见耳闻了太多别人的轨迹，希望走出自己的路来。没有值不值，只有愿不愿意。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>继续等待</title>
   <link href="http://blog.tomsheep.net/2010/01/16/weekly"/>
   <updated>2010-01-16T10:36:00+08:00</updated>
   <id>http://blog.tomsheep.net/2010/01/16/weekly</id>
   <content type="html">&lt;p&gt;Google说要撤了，这次像是要玩真的。网民很激动，屁民很稳定。其实对真正依赖google的群体影响不会很大，没了.cn,还有.com，要是中南海的大爷们脑子不好非得墙了.com和gmail，那兄弟我就买一vpn。但不得不说这事Google办得挺操蛋的，我也想能随时随地就这么帅到掉渣地双手一摊：“爷不干了”。
 最近一直在考试，没什么动力复习，对漂亮的成绩已经兴趣不大，现在只想能有个调整的间隙，让我喘口气，看清自己的方向。这个学期就快要过去了，真让人期待。学期初给自己了一个很不错的计划，执行了两个月后废掉了，想的太多太杂，被自己搞拧巴了。几年前刚来这里时我的目标很单纯，就是Overall GPA要有3.8，终于几乎就要做到了，却突然觉得没意思，真没意思。我连自己想要什么都没有准主意。太多的机会遇上一个缺乏决断的主，也是白费。什么都略懂一点，其实挺悲剧的。实验室的东西做的也不是很来劲，主要也是因为斗志不高，对计算机也逐渐丧失前些年的激情。最近脑子比较混沌，估计也不会有什么好的进展。
 实验室有一东北哥们，平时每三句话里有要有两句“我操”，过去我一直挺费解的，人生在世白驹过隙，哪有那么多可以操的？后来我发现，这挺过瘾。&lt;/p&gt;

&lt;p&gt;刘群虎同志生日快乐。&lt;/p&gt;

&lt;p&gt;陈海波同志生日快乐。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>先得忍着</title>
   <link href="http://blog.tomsheep.net/2010/01/05/weekly"/>
   <updated>2010-01-05T21:38:06+08:00</updated>
   <id>http://blog.tomsheep.net/2010/01/05/weekly</id>
   <content type="html">&lt;p&gt;keywords:这真是有意义的一周啊&lt;/p&gt;

&lt;p&gt;拒绝在标题里拓展一个“10”之类的标志位以表示与时俱进，这种既二且傻的行为太像Intel。&lt;/p&gt;

&lt;p&gt;本来打算这周就停一期，挺无趣的，但一想还是不要开这个先例。&lt;/p&gt;

&lt;p&gt;子曰，少壮不努力，老大光看ppt。随时有被关掉的危险，这么多年还是头回在考试前心虚。期中后就几乎放掉了所有的课程，别的方面也没什么进益，比较混乱。也许无形中已经葬送了部分前程，不过也好，总算理清了一些拧巴看法，有点晚，也不算太晚。二十天后，我会再赌一次。&lt;/p&gt;

&lt;p&gt;不少兄弟姐妹考研的日子要到了，诸君好运。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>淡定淡定</title>
   <link href="http://blog.tomsheep.net/2009/12/28/weekly"/>
   <updated>2009-12-28T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/12/28/weekly</id>
   <content type="html">&lt;p&gt;keywords: 哥想骂人，爷要崛起，老子要奋斗&lt;/p&gt;

&lt;p&gt;这祖孙仨挺哏，改天咱四个一块吃个饭。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>你丫真狠</title>
   <link href="http://blog.tomsheep.net/2009/12/19/weekly"/>
   <updated>2009-12-19T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/12/19/weekly</id>
   <content type="html">&lt;p&gt;王小峰老师是个一流的记者和乐评人，但是个几流的导演就不好说了。用一帮业余的演员捣鼓出一个意义不大但很好玩的故事，我也曾有这样的梦想。即使拧巴，也拧巴的让人喜欢。对此我只能借用他的标题来评价：你丫真狠。&lt;/p&gt;

&lt;p&gt;这周花了很多时间去搞OS lab中的DMA操作，很无聊，对着硬件规范望眼欲穿，每一句代码都填得拧巴至极，仿佛小时候照着说明书把玩具拆了再把螺丝一个个拧回去，有时候运气好还能富裕几个螺丝出来，惊喜无比。很无聊，我再强调一遍。&lt;/p&gt;

&lt;p&gt;最近发现自己体质突然好得不可理喻，平时稍不注意就得“小恙”一下，而如今却在甲流肆虐周围人病倒一圈人人自危的情况下，任凭昼夜颠倒迎风冒雨都居然嘛事没有，这让我很不适应，好比排队等着枪毙的犯人，等得久了，不住嘀咕，怎么还不到我，还不到我？&lt;/p&gt;

&lt;p&gt;昨晚看了相声瓦舍的二十周年时的作品《邓力军》，中间自创的配乐不错。他们的作品我在两年间看了不少，其实，大部分都有一个共同的特点，就是“作”——原则上我很烦装X的人，因为我自己就很装X，大家都是老中医，别整那些没用的——但我确实比较喜欢相声瓦舍，即便“作”，也“作”的不讨人厌。&lt;/p&gt;

&lt;p&gt;在我看来，这些特点无非都是马甲。我有很多个马甲，每个都有不同的特点，不同的性格，有的让人印象深刻，以为这张面具下的便是我本人了，其实都不尽然。有时我自己都会分辨不清，比如，在政.治.坐标中,我是偏左多一些还是偏右多一些？换句话说，我的理想是更多的平等还是更多的自由？我的不同马甲可能会就此掐起来。（当然后来我想明白了，这是扯淡，因为现实情况是，既没有平等，也没有自由。这个问题脑抽得好比去问李毅大帝：下次世界杯，你是喜欢拿金球奖多一些，还是金靴奖多一些？）&lt;/p&gt;

&lt;p&gt;也许是某个马甲过于显眼，实验室中一旦出现任何有关文史哲不务正业的勾当，都会被误以为是我干的，对此，如果我还有个马甲叫罗永浩或是韩寒，估计会毫不犹豫地用一七和发花两道辙问候他，并且为了烘托气氛优雅地竖起中指。但可惜没有。我的马甲腼腆地笑了笑：“呵呵，不是我。”&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>分段错误</title>
   <link href="http://blog.tomsheep.net/2009/12/13/weekly"/>
   <updated>2009-12-13T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/12/13/weekly</id>
   <content type="html">&lt;p&gt;之所以把这个每个程序员都耳熟能详并恨之入骨的名词翻译成这个鬼样子，除了向新华社的翻译部门致敬外，多半是为了凑字数。没人规定标题必须是四个字，就像没人规定代码必须从“Hello
World”写起一样，但似乎也没有必要让它就此错位。&lt;/p&gt;

&lt;p&gt;这周过的相当快，感觉什么都没来得及做就又是周末了。忘了打电话回家，碰巧手机没电，不想竟一度造成父母的恐慌。这其实让我略微感到欣慰，至少不至于尴尬得发现，即使胜利，也不会有谁在乎。有时我想告诉他们我的压力、我的困境以及一些不乐观的想法，但最终觉得让他们坚定地认为自己有个牛X的儿子比较好。可除此之外似乎很难找到倾诉的对象。我已经记不清为何会在周围的朋友里树立起强势的形象，我一直告诉他们，你高估我了。我没有那么厉害，虽然我希望是，但至少目前不是。因此前一阵拓鑫最终没能保研到复旦，我才会如此遗憾——少了个可以聊的哥们。&lt;/p&gt;

&lt;p&gt;没兴致拿自己开涮。&lt;/p&gt;

&lt;p&gt;说点这周看的书。花了两天去看《linkers &amp;amp;
loaders》，只为了项目中的一个bug，看完的感受是，你大爷的，早知道直接看最后一章了。海波总说要学会在不完美的世界里生存，我深以为是，可往往还是改不了这样的习惯。花了这么多时间去搞清来龙去脉，bug却没来得及去de。&lt;/p&gt;

&lt;p&gt;因为寒假的一个交流活动，昨天下午去办赴港签注。人多得让人有不良反应，等了一个500人的序列之后，却发现自己没有领表——我一直以为在自己的国家里走动就像进图书馆需要刷卡一样简单。领表后悲剧地发现还得等800多人。结果就是在剩余两个小时里，我几乎看完了多半本《别闹了，费曼先生》，这个物理奇才的故事很精彩，但我不希望有第二次这样的阅读经历。回来的时候天已见黑，迎春路边卖cd的小贩放的音乐很好听，不知道是什么。&lt;/p&gt;

&lt;p&gt;还有，这周我用了一个系列的签名档：&lt;/p&gt;

&lt;p&gt;第一天， &lt;code&gt;#whereis lk&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;第二天， &lt;code&gt;#cat tom* &amp;gt;lk&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;第三天， &lt;code&gt;#chmod +x lk&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;第四天， &lt;code&gt;#./lk &amp;amp;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;……&lt;/p&gt;

&lt;p&gt;结果大家都知道了，segmentation fault.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>各种拧巴</title>
   <link href="http://blog.tomsheep.net/2009/12/05/weekly"/>
   <updated>2009-12-05T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/12/05/weekly</id>
   <content type="html">&lt;p&gt;坦白说，一大早看到南非世界杯的分组，我大吃一惊，不是冷门太多太冷，而是，居然没有冷门！一切都很美好，这让我恍惚觉得主办这次抽签的不是FIFA而是我d.a.n.g：法国被取消种子资格但仍然享受了种子待遇，东道主得了面子但没捞着好处，三四档的二流强队被和谐地安插在各个小组，不遗余力地保证各列强的既得利益——再不争气你丫就别怪哥们不仗义了。&lt;/p&gt;

&lt;p&gt;这种安排可以让这场游戏变得更好看，取悦最多的观众，大片里的强者当然是要生存到最后的。我自然也没有意见：毕竟如果仙5的boss被设计成一个HP100的小怪，估计我也无法接受。说了归齐，这都是游戏，游戏有游戏的玩法。但有些事不是游戏，不要认为小人物的利益是可以被随意操弄的。&lt;/p&gt;

&lt;p&gt;类似的问题似乎也出现在《2012》，但我对这样的大片一向看过就忘，唯一记住的有效信息是：奥巴马连任了。&lt;/p&gt;

&lt;p&gt;最近有本新书异常畅销，叫《我们台湾这些年》，王三表老师在他的博客里推荐好几次，我一年前有幸在天涯看过廖信忠先生的原帖，现在整理成书，也算不易。大略翻了一下，似乎很多章节被摘到了，我印象中又不少有关影视文艺在民间流行发展，以及一些生活琐碎的细节内容，没有见到，比较可惜，这些内容其实更能反映时代的变迁。于是内容显得过于偏重政治d.a.n.g争对台湾社会的影响。有些地方被出版方搞得比较别扭，比如原文中应该是“中美断交”与“中美建交”，被硬生生改成“台湾当局与美国断交”与“中美建交”，这样政治正确的改动比比皆是，少了很多趣味。总体看来仍然不错，着眼基层民众的生活，平实地描述，这样的文字可能比连篇累牍的研究论文更能体现社会的原貌。&lt;/p&gt;

&lt;p&gt;这周依旧很累。平均睡眠时间在三个小时左右，并且方差很大，比如上文的“一大早”其实已经是下午一点。这样的状态估计得持续一段时间。其实做的事情不多，主要是烦。一大堆压根不感兴趣的课程，没空应付更懒得应付，但总得有个面子上过得去的成绩。这很矛盾也很低效，让人难以认真做好一件想做的事情。每一次我认为自己进入个人最困难的时期，最终都会被证明不是什么大问题，所以后来我不再相信这样的判断，因为，肯定有更困难的。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>忙成马了</title>
   <link href="http://blog.tomsheep.net/2009/11/29/weekly"/>
   <updated>2009-11-29T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/11/29/weekly</id>
   <content type="html">&lt;p&gt;其实，越是忙碌的生活，往往更为精彩，更有话要说，可惜，这是个悖论，因为没时间，更没心情。所以博客大多内容就成了有一搭没一搭的闲扯淡，真正值得纪念的东西往往留不下来。很遗憾。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>握紧刀锋</title>
   <link href="http://blog.tomsheep.net/2009/11/14/weekly"/>
   <updated>2009-11-14T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/11/14/weekly</id>
   <content type="html">&lt;p&gt;我四年里第三次写这个标题。古龙应该也喜欢这个不知所云的短语，只可惜写完就死了，而我依旧可以一年一度地把这个蛋继续扯下去。&lt;/p&gt;

&lt;p&gt;这周有很多事，但可以谈的并不多。这和政治郑智郑智化都没有关系，只是因为，我一件都没有做。我故意打乱了作息，然后下一步努力恢复——我的智力很稳定，也没有吃得太多，这样做只是因为经验告诉我，如果进入一种舒适的稳态，那将很难不断地有所收获——每想到这里，我都会对满大街铺了挖挖了铺或是拆了盖盖了拆的行为表示万分的理解：很明显，zf也是这么想的。&lt;/p&gt;

&lt;p&gt;为了达到这个目的，通常我会选择很忙的时候做一些乱七八糟事情，而在最后一秒rush deadline，其实我不喜欢这样，但确实往往获益更多，喜欢三国无双的黎叔一定会管这个叫“蓄力攻击”，而我更倾向于把它比作京剧中的“嘎调”，精彩在突兀的高音中展现的淋漓尽致。当然，前提得是，你知道deadline是哪一天。&lt;/p&gt;

&lt;p&gt;与此同时我在努力克服莫名其妙的阅读障碍——一旦有一天你突然发现不论中文英文吐火罗文你一概很难再读下去，这这种感觉真是很要命——众多可以防身的书籍资料和不断累加的reader feeds一如既往出现在你面前，而你读不懂它。不久前我说过，“在这样一个知识廉价信息爆炸的时代，绝少有人愿意做serious的阅读，在关掉网页之后，很少会有人记得你说了什么，但多半会对你所扯得某个蛋记忆犹新。serious的作家与作品必须能够适应这样的现状。无论有没有人在意，认真地扯好每一个蛋。”就在几天后我就不安地发现，我已经成为浮躁的牺牲品。&lt;/p&gt;

&lt;p&gt;周中还有一个小插曲，我在外教的课上演习了“非暴力不合作”行为，他很意外，我也很意外，我不确定自己为什么会轻易被不明显的无理逻辑和言辞激怒，尤其是在天朝生活了二十年的前提下。之后一小撮群众认为我是愤青，其实不是，我相当理智，包括在愤怒的时候——我甚至仔细的推演了我是否要当场叫板以及后果如何，最终放弃，不是因为成本太高，而是我的英文实在差得可以。事后我一直反思自己进来日益凸显的“破坏欲”，这和整体的状态有很大关系，未必坏事，但至少应该被自己控制。&lt;/p&gt;

&lt;p&gt;写到这里，读者大概会希望有一个轻松的幽默的欢乐的甚至荒诞的扯蛋的结局，那么，我有责任告诉大家，中国队和黎巴嫩的亚预赛即将开始，今晚23:00，你不会失望。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>一东二冬</title>
   <link href="http://blog.tomsheep.net/2009/11/07/weekly"/>
   <updated>2009-11-07T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/11/07/weekly</id>
   <content type="html">&lt;p&gt;关于这两个字为什么是两个韵部，借助任何一款搜索引擎你都可以找到长篇累牍的学究文章来给出解释。简而言之，就是，古人的发音不一样。若干年前有人这么告诉我，我欣然地接受规则并且若干年后继续把它告诉其他的人。可为什么古人的发音非要我来遵守？很难讲。如大多数的规则一样，格律的发展不会停滞，但在新的规则尚未成型或是未能服众时，遵守既有的规则往往是推动其改革的前提。就好像如果你想改造zf，那首先最好你是他们的一分子。&lt;/p&gt;

&lt;p&gt;这样的开头也许会让你感觉本文很严肃，无蛋可扯，从而感到失望万分。其实，大可不必焦虑烦躁心慌失眠，因为我们的话题马上要转入北京国安。永远争第一的国安终于夺冠了，从上个世纪起我就有一个奇幻的念头：如果国安的老板像许多江南的父亲一样，在俱乐部创建之初满怀期待地在自家后院刨坑埋一坛二锅头，有朝一日国安问鼎时是否会有后人或者后人的后人收获一坛经常在雷人电视剧里出现的“上百年的女儿红”。&lt;/p&gt;

&lt;p&gt;我无意指责国安夺冠的不道德，在这样一个环境下要求球队本身的素质是一件不公平的事情。但同时，我仍然强调自己对在恶劣环境下坚持原则的球队（如果有）的尊敬。比如我的父亲，一个为人相对正派而敬业的公务员（当然你可能认为这是一个病句），当然在这样一支队伍里相对正派基本等价于相对没有前途，我无法过多指责这个行业的从业者，但同时我会对他这样的作风表示更多的敬仰。&lt;/p&gt;

&lt;p&gt;事实上我也很久不再关注中超。我对中国联赛唯一的美好回忆停留在十年前辽宁队的一帮小帅哥身上，而上一次看联赛则要回溯到六七年前的省体育场，几万陕西球迷不加排练异口同声地合唱
“贼你妈”——这和国安球迷的口号本质相同却更有气势，西北剽悍的民风也导致球迷从来都直抒胸臆而不会像四川球迷略一样带含蓄地喊“雄起”——多年来我一直佩服当值裁判的心理素质。这一点很有意思，在中国的体育赛场中，文雅健康积极向上八荣八耻的口号从来不会得到好的效果，而市侩的粗口很容易引起巨大的共鸣。这本身并没有修养问题，我相信很多买票的观众都是满怀生活的压力冲着骂娘而来的。&lt;/p&gt;

&lt;p&gt;这周考了一个试，扯了很多蛋。考完后监考的实验室师兄们都说我春风满面，认为我考得很好，其实不是，我高兴是因为我感觉自己心态很好，这在我看来比多考几分有价值的多。今天两个小时看了20集的大胡子版倚天屠龙记，我平时不喜欢看电视剧，但我对这部书很有感情，在高一的时候权衡之下甚至没有去看给我带来无限欢乐的中国男足。张某某拍的很见功力，我惊叹于其竟然能成功地匪夷所思地避开所有能够成为精彩的可能，就好像一份100道选择题的考卷，竟然神乎其技地做了0分，要知道这有时其难度不亚于拿到满分。逻辑正常一点，女演员漂亮一点，音乐自然一点，很难么？&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>流氓九段</title>
   <link href="http://blog.tomsheep.net/2009/10/31/weekly"/>
   <updated>2009-10-31T18:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/10/31/weekly</id>
   <content type="html">&lt;p&gt;左 右 左 左 右 左 右 右
。。。&quot;这不是美国大兵在巡逻，而是软件楼以及二教的男厕分布示意图。设计人员过去一定是搞摩斯电码的，这样的迷宫要是仙剑的设计师看见估计得羞愤而死。我这周就走错了三次，所幸没人。。。怎么就没人呢？&lt;/p&gt;

&lt;p&gt;继续过敏。这比走错女厕所更让人纠结——前者只需要主观的镇定，而后者显然需要全身心的投入。尽管臭不要脸的古代诗人们给鼻涕起了很浪也很漫的名字叫“白玉箸”，但每天老泪纵横涕泗横流真不是什么雅观的表现。并且同时我惭愧地发现我冤枉了善良无辜的小羊以及它的毛。所以说任何时候都不要轻易相信自己的判断，尽管我经常这么做——这很无奈，或者更具体一点说这个句型很无奈：“不要如何如何，但经常如何如何”。比如，我内心极抗拒帮人debug，但事实上却经常帮人debug。再比如，我极不喜欢听课，但事实上却每次都欠揍地坐在最显眼的位置上。你很难简单的将其归结为理想与现实的矛盾，或者强迫症。过敏原仍旧未知，医生建议我带个口罩，实践了几天果然异常有效，唯一的副作用是实验室的同仁一致认为我在cosplay《生化危机》。&lt;/p&gt;

&lt;p&gt;我逐渐有意识地让自己变得aggressive，至少看上去aggressive一些，其实无论过去还是现在，我的很多导师对我都有同样的建议，但之前我并不十分认可，虚心接受但坚决不改。因为我一贯生活哲学告诉我“君子极高明而道中庸&quot;，敦厚崇礼，与人为善。但后来发现这样的原则已经束缚了自己的思维与创造性，神童愣是给憋屈死了。至少现在，aggressive一些是符合生产力发展需要的。然而“有侵略性”实践起来是比较难以把握的，火候稍差可能就和流氓一个量级了。作为一个有品位的流氓，你的言行还是得顾及身份的。&lt;/p&gt;

&lt;p&gt;这周翘课的时候与老师擦肩而过，但我还是毅然决然大义凛然的走出去了。其实我不是故意挑衅（一般我很少翘课，尽管我也很少听课），况且这老师的水平不错。但我确实不喜欢，相反我倒是喜欢德志同志这种风评很差实际比风评还差的老师，因为他们上课时完全打扰不到我的思路……而且我经过多年研究发现，中国教师与外教的一大区别在于：如果是中国教师上课，那你最好给足他面子，否则很可能他会神经质地诘难你的“道德”；而对于外教，你越是认为他就是个傻叉，他就越是认为你很牛叉……&lt;/p&gt;

&lt;p&gt;最近几天大师的心情很不好，大约是失恋了。不过这让我突然发现，他很温柔。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>小爷乐意</title>
   <link href="http://blog.tomsheep.net/2009/10/24/weekly"/>
   <updated>2009-10-24T18:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/10/24/weekly</id>
   <content type="html">&lt;p&gt;这周真的患了感冒，我很欣慰。在过去的无数个日日夜夜里，我一直认为自己感冒，遍访中西巫医久治不愈，也许是感冒自己也看不下去了，跳出来骂娘：“你丫才感冒了，你们全家都感冒！”并且为了证明自己的清白，为我生动了讲述了什么才是感冒，而我也终于迟钝地发现，原来，我只是对羊毛过敏。之后，我更加迟钝地发现，我竟然长期处于吃错药的状态。&lt;/p&gt;

&lt;p&gt;同时，这周开的一门新课让我久久不能平静——这是一门关于哲学与逻辑、形式化与可计算性的课程，而我依稀记得我是在上周起突然对哲学感兴趣并有意进行阅读——这让我再次怀疑自己就是上帝，整个世界影像的流动只不过是我的臆想。这令我顿时对伯克莱肃然起敬。上课的Tony喜欢着满教室溜达，搞得我颈椎生疼并且整节课都在判断：他下一秒会绕着教室顺时针，还是逆时针转悠？&lt;/p&gt;

&lt;p&gt;这节课后，我又把自己的日程表里的早起时间提前了半个小时，并且加入演讲练习一项。这样的决定源于我多年来对自己的归纳总结：我可以用精彩的文字把事实上无聊乏味的生活描述得波澜壮阔，却甚至说不出一个完整的句子——我坚信在人的大脑中，语言和文字绝不躺在同一条沟壑里。我在第二天就将计划付诸行动，在校园的某个角落里，当我无比忧郁吐出“分别的时刻已经来临，我将赴死，你们去活，那条路更好，只有上帝知道”时，我分明看到推垃圾车的大妈惊诧的表情。我知道这样的行为显得出离傻叉并且未必会有成效，但是，爷乐意。就在四年前我的朋友们还深信终此一生我都将会是个猥琐的死胖子，而今天我告诉身边的所有人我曾经有170斤，没有人相信——从那时起我就相信，只要爷乐意，没有什么是不可能的。&lt;/p&gt;

&lt;p&gt;今天见到了来上海生科院实习的高中同桌，仍旧质朴而有理想，我很欣慰，大受鼓舞。我也依旧认为自己仍旧坚守理想，尽管在过去的两年中完成了漫长的一次螺旋式的上升。没有虚无化，也没有最终妥协于犬儒的思绪——这对于理想主义者是多么困难。说到我的同桌，我不得不想起我传奇高中的另一位传奇同桌，人又聪明，长的又漂亮，有事没事整一半中不西的黑色风衣双手插兜耍帅，每次看到他满面春风黑里透红的坏笑，我都忍不住想上去掐死他——都是出来混的，还让不让人活了！这个小变态，现在在干什么呢？&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>奉旨扯淡</title>
   <link href="http://blog.tomsheep.net/2009/10/17/weekly"/>
   <updated>2009-10-17T18:36:21+08:00</updated>
   <id>http://blog.tomsheep.net/2009/10/17/weekly</id>
   <content type="html">&lt;p&gt;最近的作息极为紧凑并且规律，原因只是我在床头贴了两张表，白纸黑字，赖也赖不掉。除了这种古老而有效的手段，我还真是对自己的任性没有太多的办法。豪哥提到刚转系那年我的疯狂状态仍然很唏嘘，每天只睡2、3个小时，魔怔了似地，搞得我也很唏嘘。想那时真是憋足了一口气，硬是把自己从一电脑白痴拔苗助长成二手程序员。我一本正经地告诉他这是因为“信仰”，他报以猥琐的笑容，表明他认为我压根在扯蛋——尽管我经常扯蛋，但我绝对保证我所扯的每一个蛋都珠圆玉润童叟无欺。&lt;/p&gt;

&lt;p&gt;没有信仰的时候，还是规则的约束来的实在。&lt;/p&gt;

&lt;p&gt;同时我不得不承认我的记忆力有了较大幅度的下滑，这带给我巨大的困扰，我不得不用其他的方法加以弥补。我中学的时候政史地成绩一直很好，因为每次考试前我都可以把课本背下来并且记住某个恶心的人说的某段恶心的话是在某节的某个部分。这些我再也做不到了，这是年龄增长必然经历的。这样的事情并不单是发生在我的身上，比如大雄，自从某年上完高数课之后，他每次见到我都会不厌其烦地问同一个问题：“诶，你们班那个经常背着绿色书包的女生叫什么名字？”我告诉他了一万多次，酒但下一次见到他依旧会问，无一例外。后来他很少再问，倒不是他的记忆力有了长足的进步，而是因为，我很少再见到他。&lt;/p&gt;

&lt;p&gt;最近闲暇的时候在看一本有关哲学的书，苏格拉底说“最聪明的人是明白自己无知的人”，我切实地感到这句话完全是在扯蛋——无论是“无知”还是“明白自己无知”，我都无一例外并且完美地做到了，但丝毫没有聪明起来的迹象。柏拉图将世界分为感官和理型两个部分，前者是流动的事物，后者是永恒的灵魂。《理想国》中描述了一则“洞穴神话”，看到洞穴石壁上影像的洞穴人之悲哀在于永远认为世界除了影像之外再无他物，拒绝探索影像之后的根源。这则故事告诉我们，如果看到美女的照片，不要满足，一定设法要找到真人。&lt;/p&gt;

&lt;p&gt;亚里士多德尽管他也同意感官的事物是变化的，内在的形式是不变的；但他反对老师柏拉图“先有鸡的理型，后鸡本身”的“物为形影”理论，相反他认为，存在于人意识中的理型是来自于感官世界对事物特征的归纳。也就是说，在程序员柏拉图的系统中，所有class都是内建的，而OOP程序员亚里士多德的眼中class是自定义的。&lt;/p&gt;

&lt;p&gt;关于哲学，我自然是没有太多前途，因为我早已经习惯沉默，第一，这可以无限度地可以掩盖我的无知；第二则是源于对环境的习惯乃至麻木，顺理成章地接受既有的事实，这让我逐渐变得迟钝，丧失了哲学家必备的好奇与敏锐。当我想要做一些事情的时候，突然发现这样的习惯让我无所适从。希望有所改观。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>剑阁闻铃</title>
   <link href="http://blog.tomsheep.net/2009/10/11/weekly"/>
   <updated>2009-10-11T04:36:21+08:00</updated>
   <id>http://blog.tomsheep.net/2009/10/11/weekly</id>
   <content type="html">&lt;p&gt;最近喜欢京韵大鼓。&lt;/p&gt;

&lt;p&gt;起因是在某辫子戏里偶然听到张国立山寨至极的《剑阁闻铃》，实在忍不住去找来骆玉笙的原声以正视听。音调自然悦耳，一唱三叹又不失之于哀怨，“剑阁中有怀不寐唐天子，听窗外不住的叮当连连地作响声……”悲剧如此演绎，更觉回味十足。之前只喜欢少马爷反串的《探晴雯》，只因善用鼻音，韵味非凡，而且唱词精炼，嵌在相声中恰到好处——因此不曾关注京韵大鼓的长篇作品，几日听来，《红梅阁》、《剑阁闻铃》、《击鼓骂曹》，不觉入迷。也许是年纪渐长，沉得住心了吧。&lt;/p&gt;

&lt;p&gt;周末早晨又偶然发现了相声瓦舍08的作品《战国厕前传》，牺牲了整个早晨去看完。风格依旧，这让我感觉很好。倒不是相声十分好，反而是一如既往的风格让人欣慰，如老友相逢，一切都变了，人没变，真不错。&lt;/p&gt;

&lt;p&gt;当大家都在猛翻ULK的时候，我却要去看劳什子的windows
internels，大脑不停的在linux和windows之间，驱动和硬件之间切换，这真是一场悲剧。爷要是发达了，造出的硬件全不含糖水果味，不用教自己跑，想上五楼上五楼，一口气，不费劲。&lt;/p&gt;

&lt;p&gt;至于伟大的《吉米多维奇》，那真是一场更大的悲剧。我不学高数已经很久了，今天被新入学的高中校友问到，直接说不会真是英雄气短，只能。。。&lt;/p&gt;

&lt;p&gt;所以，经过这样的解释，回顾本周周记的关键词，你会发现，尽管他们风马牛不相及，竟然冥冥中有着同样的特点，全是悲剧。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>PPI对联</title>
   <link href="http://blog.tomsheep.net/2009/07/12/promise"/>
   <updated>2009-07-12T00:12:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/07/12/promise</id>
   <content type="html">&lt;p&gt;PPI PROMISE是复旦大学并行处理研究所的系统组(现上海交通大学IPADS)。当年因为这个帖子后来成为Arch_Compiler的版主。每次再看这几幅对联，都有种沧桑的感觉。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;花飞相思地，酴醾无心葬冰雨 （臧斌宇） 

鸥渡离恨天，精卫有意陈海波 （陈海波） 

知秋冷雨，千载深山凋大叶 （大爷） 

射戟温侯，百步辕门挂小枝 （肖之） 

蜀江魏河，哪及吴溪美 （吴曦） 

唐粉汉脂，不似宋香醇 （宋翔） 

白莽西京侵汉祚，王肇国 （王肇国） 

赤子东辽戍明门，袁立威 （袁立威） 

举贤凡三陈，二刘谁领荆州牧 （三陈二刘） 

托孤只一勋，三公独赖太宰周 （周逸勋) 

黄粱梦醒，新曲病琴愁易见 （黄弋简） 

青釭锋折，老将强弓势难张 （张逢喆） 

陈桥兵变，海内羁民思近土 （陈进） 

武陵莺飞，槛外骚客忘远喧 （王远轩） 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;PS：仿佛少了朱盛凯和邢伟超，对这两位同志提出口头批评，取名字不好好取，影响某的兴致……&lt;/p&gt;

&lt;h2&gt;掌故:&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;上联取意《红楼梦》，葬花典与“开到酴醾花事了。下联精卫填海，“陈”字为机巧，做姓氏，亦作动词&lt;/li&gt;
&lt;li&gt;  上联化用“山僧不解数甲子，一叶落知天下秋”。下联辕门射戟，吕布牛X的桥段之一，百步帐外，正中小枝。温侯对冷雨，小枝对大叶，百步对千载。&lt;/li&gt;
&lt;li&gt;非强自用典，主要是将人名化进去，上联三朝，下联三朝，各朝事物成机巧。&lt;/li&gt;
&lt;li&gt;上联王莽，下联袁崇焕，赤子对白莽，东辽对西京。此联平仄不太好。&lt;/li&gt;
&lt;li&gt;上联刘表让荆州，不过没有“三让”，三为虚指。下联指周公旦。&lt;/li&gt;
&lt;li&gt;上联取意黄粱梦，下联典在“青釭剑”，赵云光天化日拦路抢的那把。黄对青，新对老，病对强，易对难。&lt;/li&gt;
&lt;li&gt;上联赵匡胤造反，下联取意桃源，“槛外”典自《红楼梦》。槛外对海内，骚客对羁民，忘远对思近。&lt;/li&gt;
&lt;/ol&gt;

</content>
 </entry>
 
 <entry>
   <title>等等等等</title>
   <link href="http://blog.tomsheep.net/2009/07/04/and-so-on"/>
   <updated>2009-07-04T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/07/04/and-so-on</id>
   <content type="html">&lt;p&gt;终于结束了。这个学期很不寻常，以至于我翻遍字典也找不出一个合适的词来加以概括。唐人仙三的出现终于给了我灵感：“剧情狗血，逻辑雷人，结局荒诞。”&lt;/p&gt;

&lt;p&gt;GPA不可理喻地没有掉下来，这几乎颠覆了我的世界观。出成绩时我正在实验室里梦游，看到它第一眼后我意识到还得继续睡。这波谲云诡的半年若真的就被这一干漂亮的字母一笔带过，那该有多么悲哀。&lt;/p&gt;

&lt;p&gt;事实上我没有做好任何一件份内的事情，包括长久以来带给我虚荣与满足的各种考试。唯一的收获是学会了各种各样的妥协和放弃：专业素养没有任何进益；学业也荒疏的厉害；吉他班不了了之；很多书没有坚持读完；猫老师的项目半途退出——我万分歉疚，尽管当初加入也并非出自本意，但临阵脱逃肯定是一种极不仗义的举动，我鄙视这种行为；网络课很狼狈，很遗憾我没有学好它，以后也许也不再有机会弥补，老师给了很出格的好成绩，这只能让我更加惭愧；笔记很糟，日记中断；还有暗恋的女孩，半途而废的英语，无疾而终的python……&lt;/p&gt;

&lt;p&gt;我很惊讶以我的性格可以一口气放弃这么多，而精神却没有崩溃，诡异得仿佛A股的走势。看来我高估了自己的底线。周围的同学依旧很给面子，遇到问题时常来寻求帮助，尽管我很想继续装B，但更多的时候真的无能为力。抱歉。不要叫我“神”，这很刺激哥。&lt;/p&gt;

&lt;p&gt;进入实验室给了我些许安慰，其实面试时表现得异常糟糕，但最终还是被录用，我想多半是因为我的成绩单看上去很美。其实这很不靠谱。实验室里的师兄们优秀得让人自惭形秽，之前一直觉得自己锉，但没料想竟然这么锉。来到实验室几乎等于确定了事业的定位，我甚至没有做好准备。做系统很艰涩，很枯燥，我不知道自己可以走多远。既然方向已经明确，那继续懈怠就有些矫情了，我只有尽己所能，朝着大爷和吴总一般货真价实的大牛努力发展。其实，我一直想拥有的是老贺那样的状态，快乐洒脱又有追求，有事没事骚情地仰望天空45度高喊“智慧的高度”，然后自恋的叹口气“浮云，都是浮云”。过去我们在一起时喜欢互相讽刺嘲弄对方的智商，其实，他真的比我聪明。&lt;/p&gt;

&lt;p&gt;暑假预计不能回家，继续朝八晚九两点一线的实验室生活，父母在电话那头仍然是“吃好喝好睡好别累着”，我也依旧千年不变的“恩啊对知道放心”。母亲越来越琐碎，父亲渐显苍老，和童年记忆中军姿飒爽魁梧健硕的形象渐行渐远，我不只一次暗地里许愿，再给我十年，我把欠你们的儿子还给你们。可是鬼知道十年后会怎样。&lt;/p&gt;

&lt;p&gt;拓鑫说他有意外推来复旦，这几乎是我三年来得到的最振奋人心的消息，我丝毫不掩饰自己的喜悦，我太需要一个久违的哥们。其实我的周围一直有许多出色的朋友，他们的存在让我切实的感到自己的猥琐与不足：温文儒雅，不如周丰；意志坚韧，不如塔锭；专业素养探索精神，比不上刘然；而才智思辨细腻体贴，也不及阿豪。这让我随时都有脚踏实地的感觉。&lt;/p&gt;

&lt;p&gt;上次见到拓鑫是两年前，而我记忆中的他却仍然是七八年前的样子。不知他现在是怎样一番模样。&lt;/p&gt;

&lt;p&gt;我很期待，不要放我鸽子。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>纲举目不张</title>
   <link href="http://blog.tomsheep.net/2009/04/21/wondering"/>
   <updated>2009-04-21T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/04/21/wondering</id>
   <content type="html">&lt;p&gt;我决定写一段严肃的文字。&lt;/p&gt;

&lt;p&gt;事实上我每一次都很严肃。幽默只是手段。有朋友说很喜欢我不着调的行文风格，很好玩，并不时催我更新。其实他们不知道，基本上，我只在失落和无聊的时候写字。一点也不好玩。&lt;/p&gt;

&lt;p&gt;用扯淡的语言逗漏伤感的情绪，这项技术我无偿使用了很多年，有很多好处，读者不会轻易捕获我真实的心情，只当我在扯淡；而且事实上到最后，我往往也无法分辨自己是否真的在扯淡。我决定严肃一次。同时你可以选择读下去或者出门奔邮局买一张《人民日报》。&lt;/p&gt;

&lt;p&gt;再次回到原点，我已经厌倦了这样的桥段：韬光养晦——信心积累——推倒重来，若干年来我循环往复地做着同样的事，一如中国历史的单机版。对于这一点我心知肚明，却又无可奈何。懒得调侃。&lt;/p&gt;

&lt;p&gt;凌晨三点，校园的路灯亮得暧昧，斑斓地映出两旁营养不良的梧桐——我并不认识梧桐，同理也不认识别的树，但梧桐长在马路两边仿佛是天经地义的事情，因为书上都这么写——这才是悲哀。&lt;/p&gt;

&lt;p&gt;我就这样在校园里漫无目的地兜着圈子，偶尔思考一下“我为什么会在这里”等一系列看上去很哲学的问题。但答案一点也不哲学：一个酷爱京津文化的人之所以会不可理喻地来到上海，只是因为在那一刻能够录取他的学校里，“复旦”这个名字是最好听的。这很荒诞，但有时这样的历史才是真实的。&lt;/p&gt;

&lt;p&gt;深更半夜不去睡觉也不学鸡叫，而是在校园里散步，若干年后我的记忆中这一定是一个唯美的画面，充满艺术气息，而当初伤感的情绪和阴森的氛围，都将被自动过滤。回忆录便是这样神奇的东西。而倘若当时值勤的保安凑巧也记了一笔“一形容猥琐之灰衣男子深夜潜入校园图谋不轨”，并且为了达到更好的宣传效果，添油加醋地写上“当场将其擒获并进行说服教育两小时”云云，那么，没错，这个就应该叫做历史了。&lt;/p&gt;

&lt;p&gt;静的骇人。走过教学楼前的拱桥时我神经质地加快了脚步，这个时候倘若有个把活物突然冒出来，那结果只可能是我被他当场吓死或者他被我当场打死。由此可见，做一个艺术家，尤其是一个行为艺术家，往往是要随时准备好为艺术献身的。&lt;/p&gt;

&lt;p&gt;黎明渐近。各种不知名的鸟开始乱叫。一直以来我都想证明自己叫的更好听，至少叫的与众不同。可惜我妈生我的时候没有梦见五爪金龙或者五香鸡爪，当年也没有火山、地震之类的自然灾害，估计房顶也没有祥云，而我的童年生活在塞北漠边，没多少大河小溪，自然没有机会看看小鱼儿逆流而上的励志情景……看来没什么希望成为大牛，但我想让人觉得有性格。&lt;/p&gt;

&lt;p&gt;好像又是原点，每次的剧本都差不多，这次我想让它不太一样。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>灯如昼(3)</title>
   <link href="http://blog.tomsheep.net/2009/01/29/just-like-sunshine-3"/>
   <updated>2009-01-29T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/01/29/just-like-sunshine-3</id>
   <content type="html">&lt;p&gt;齐达内谢顶的秃头在那个激情似火的夏天熠熠发光的时候，我搬进了在陕北最后的一片根据地。那是当地武警支队的大院，横断西沙，坐南朝北，里面办公区与家属区浑然一体，倒也少了些拘泥。&lt;/p&gt;

&lt;p&gt;院子里有一拨年龄参差不齐的孩子，平日里追逐嬉闹，斗鸡走狗，爬树上房，倒也热闹。大家性格各异，来自五湖四海，却总能在各个时期找到共同的喜好，这多半要归功于与时俱进不断推陈出新的日本动漫。&lt;/p&gt;

&lt;p&gt;小龙姓张，但没人在意这个。其实他并不是这一章的主角，而只是这个特色集体在我记忆中的一个代表。之所以对他印象深刻，很大程度上是因为我并不怎么喜欢他。我给出的理由是他自以为是并且心眼极多，但后来发现这不太站得住脚，因为我自己也是这样的人。唯一不同的是他的狂妄锋芒毕露，而我的狂妄神藏在骨子里。后来我跟他打了一架。当时一定是《足球小将》热播的年代，因为整个事件的导火索是我在踢球时铲倒了他。&lt;/p&gt;

&lt;p&gt;我极少和人动武，这倒不是因为我脾气好，而是因为我记住了毛主席众多语录中的两条：一是“不打无把握之仗”，二是“保存自己，消灭敌人”。于是多数情况下，在一番敌我实力的粗略对比之后，我往往会毫不犹豫地选择和平解决。小龙是个例外。小我一岁的他站在我面前整整矮了一头，以我当时的吨位应该是他的一个半还有富裕。但后来他拉了他姐姐出来骂我，于是局势瞬间发生了逆转，因为主观上我向来对女人缺乏基本的抵抗能力，而客观上我又没有姐姐，否则至少可以达到一种军事制衡的效果，而且看女人吵架也不失为一件惬意的事。这次战役过后，我明白了一个道理：难怪毛主席不搞计划生育，独生子女真TM吃亏。&lt;/p&gt;

&lt;p&gt;大院里曾经流行过一阵发射塑料子弹的玩具步枪，当时大大小小的孩子人手一支，个别威力大的可以震碎电灯泡。节假日成群结队，上蹿下跳，所幸始终也没闹出什么乱子。我还有一支做工比较考究的铁质手枪，可以打火药，但几乎从来没成功过，因此我并不很喜欢。后来有一天居然打响了，震得我虎口发麻，吓得再也没动过，临走时送给了别人。&lt;/p&gt;

&lt;p&gt;后来四轮驱动的玩具车风靡一时，院子里到处都是电动马达高速转动的嘶嘶声。其实这车普遍让大家失望，因为它远没有动画里表现得那么智能。这样的车我先后有过两部，但平均寿命没有超过一个礼拜——对此我并不感到讶异或惋惜，因为无论什么玩意到了我的手上，做旧率一向高的出奇。我在对它们进行了解剖并重新组装之后，惊喜地发现手中竟多出了许多零件。&lt;/p&gt;

&lt;p&gt;我离开的那年流行的动漫是《灌篮高手》，于是支队院子里的篮球架在无辜地充当了若干年的球门之后终于恢复了它的本来面目。炊事班应该为此感到庆幸，至少食堂的玻璃不再会因为突如其来的一脚世界波而齐刷刷地碎掉了。&lt;/p&gt;

&lt;p&gt;也不知道这帮小子，后来都玩些什么。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>灯如昼(2)</title>
   <link href="http://blog.tomsheep.net/2009/01/19/just-like-sunshine-2"/>
   <updated>2009-01-19T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/01/19/just-like-sunshine-2</id>
   <content type="html">&lt;p&gt; 坊间流传，给体弱多病的小孩认一门干亲可以使之逢凶化吉。于是，田靖的父亲变成了我的干爹。而且，为了表达一种良好的愿望，我的名字被改成了现在这样。&lt;/p&gt;

&lt;p&gt;田靖比我大一岁，但我从来不管他叫哥哥。他个性天真，毫无心眼，痴迷于红白机与各种卡通人物。关于我们的名字我一直颇有微词，因为这像极了金庸某部脍炙人口的武侠小说。他为此颇为得意，常以正义自居，双手摆出一个黑猫警长的造型，然后就要代表谁谁谁来枪毙我。&lt;/p&gt;

&lt;p&gt;当时他住在靖边，暑假偶尔来玩。我们最主要的娱乐项目是把扑克牌分红黑整齐地码在地上，然后各领一路大军以千奇百怪的方式互相厮杀。这几乎当时可以找到的
最有趣的游戏，可见人民的精神生活是多么的匮乏。尽管我们都对红白机怀有无比的热爱，但在两双管教甚严的父母面前，这个愿望几乎不可能实现。当时大人们的
主流借口是“变压器烧坏了”，于是经常会出现周围所有小孩的红白机变压器一夜之间全军覆没的壮观景象。我很失望，怀疑大人们为此特地召开了秘密会议并且统
一了口径，连借口都这么整齐划一而毫无创意。其实后来我一直期望听到一次“手柄坏了”之类富有新意的解释，可惜始终未能如愿。&lt;/p&gt;

&lt;p&gt;我对田靖的记忆有些混乱，因为我一度将父亲另一个战友的孩子认作是他，同样的游戏，同样的动画，这种状况持续了整整一个夏天。我已经无力严格区分记忆中他俩，更讽刺的是，我至今也不知道这位替身演员的真实姓名。&lt;/p&gt;

&lt;p&gt;我迄今最后一次见他是12岁。他住在西安近郊，当时已经长得粗壮结实，和我记忆中的形象严重不符。见到他时他正在家里玩业已过时的红白机，听他母亲说，他已经不再去上学了。临走时我邀请他有空来我家玩，他很高兴，天真地如同七八岁时的模样。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>灯如昼(1)</title>
   <link href="http://blog.tomsheep.net/2009/01/09/just-like-sunshine-1"/>
   <updated>2009-01-09T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2009/01/09/just-like-sunshine-1</id>
   <content type="html">&lt;p&gt;总的来说，这是纪传体。&lt;/p&gt;

&lt;p&gt;从我记事起就认识她。&lt;/p&gt;

&lt;p&gt;我的邻居。我父亲同事的女儿。我的玩伴。考虑到同时期我的心智水平，这三个社会属性中只有最后一个是有意义的。&lt;/p&gt;

&lt;p&gt;她是我学龄前最主要的玩伴。我已经丝毫记不起当时的游戏项目，但对这个伙伴的真实存在确信不疑。在之后的各个时期里，她的样子似乎从来都没有变过，因为无论时隔多久，我总是可以在第一时间辨认出这张熟悉的脸。&lt;/p&gt;

&lt;p&gt;上学后很少再见。因为我搬家了——
我至今也很诧异为什么我住的地方总是搬来搬去——目的地的北边是一处公安干校，与其毗邻的是一片武警新兵轮训的营地。当时经常萦绕在我心头的一个想法是如
果这两拨人干起仗来，哪边会更生猛一些。遗憾的是，直到我再次搬走，他们也没能打起来。&lt;/p&gt;

&lt;p&gt;关于上学我妈一直有一个津津乐道的版本，就是我哭着喊着非要上学并且在阎瑞等几个大一点的孩子上学之后徒步尾随到学校门口隔着栅栏眼泪汪汪（注意这个镜头
要特写）……我认为这纯属杜撰：一则我确信自己从来没有那么高的觉悟，二则打死我也不信形如我这样的路盲可以游刃有余地来回穿梭于曲折迂回的大道小巷。要
是真的如此，若干年后我也不至于痛苦地徘徊于五角场，眼泪汪汪地望着光华楼而找不到回复旦的路。&lt;/p&gt;

&lt;p&gt;后来我被送去另一所学校，离新家不远。在这之后的几年里我只见过她寥寥数面。她后来家搬得离我家不远，但我很少去拜访。让我惊讶的是她居然有个年轻三四岁的弟弟，而有趣的是，在我之前的记忆中却没有任何
可寻的痕迹。&lt;/p&gt;

&lt;p&gt;初一时我们在同一所学校，教室比肩而立。她成绩不错，相当文静——至少看上去是的——并且改了个我怎么也记不住的名字。与此同时她搬入我所在的部队大院，
但仍然不常见面，偶尔迎面遇到我总是怀疑她是否能认出我来。因为如果两个月照一次镜子，我一定会诧异面前这个猥琐的胖小子到底是从哪来的。&lt;/p&gt;

&lt;p&gt;初二我离开陕北，几乎与童年所有的朋友失去了联系。六年后我回去了一趟，当时她在西安读军校，现在想想，应该毕业了吧。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>我的骄傲无可救药</title>
   <link href="http://blog.tomsheep.net/2008/11/02/incurable"/>
   <updated>2008-11-02T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2008/11/02/incurable</id>
   <content type="html">&lt;p&gt;只在看球之后发文已经成为一种行为准则，而无论涉及的内容是诲淫诲盗，还是八荣八耻，是鲁迅曹霑李小胖，抑或是正龙冠希周大师。这些都无关紧要，就好 比一只再怎么内急的狗，也得等找到一个类似树桩的标的物才肯就范——一切都只 为表明，咱是有讲究的。&lt;/p&gt;

&lt;p&gt;足球比赛不是推动历史前进的动力，就像树桩不能作为生物进化的标志一样，在生物学家耐心地对我进行扫盲之前，我只能将上述的行为都归结为，行为艺术。本文亦非球评，发现上当的同志可随意骂娘并及时挥一挥衣袖带走无数的板儿砖。 不过我愿意人道主义地播报一遍我所见证的比分，陕西1：4申花，国青6：0哈青，巴萨4：1马拉加，国足9：0荷兰。当然，依次来自于sina、五星体育、cctv，还有，实况足球。&lt;/p&gt;

&lt;p&gt;屏幕里的电子书酒后驾车一般一页页在我眼前高速划过，我不能确切知道这些诡异的文字会在我的脑袋里产生什么化学反应，多数情况下满足感来自于在每份copy末画上“已阅”的一瞬。这真是一种简单并且原始的快感，好比兽群用粪便标注自己的领地，精神世界无懈可击。&lt;/p&gt;

&lt;p&gt;宿舍的蚊子生命力顽强并且喜好独特，即便有喜欢赤膊的小胖在场也不能将其从我的身边诱开，何况今夜落了单，我的脚踝自然成了众矢之的。北航学计算机的赵龙同志很专业地从天文学推断我是O型血，所以招蚊子待见，其实不是，多年来我一直认为自己是B，并且一直装B，天知道，我是不是B。&lt;/p&gt;

&lt;p&gt;相声瓦舍是暑假时发现的台湾团体，很有风格，段子很有文化层次，和郭德纲是两个路数。这不妨碍我同时接受并且欣赏，就像我既喜欢看米兰德比，也不排斥陕沪争霸。各有各的玩法。柯君很喜欢《东厂仅一位》，我表示很欣慰，虽然这段子跟我压根没有关系，但这就好像文摘中的读者推荐，即便不是自己写的，也能有获得稿费的便宜。&lt;/p&gt;

&lt;p&gt;BBS是一个伟大的地方，因为逛久了你会发现你的语文水平会有一个质的飞跃，re~@@ - - XD 赞~ 大赞~ 怒赞 ~ 狂赞~ momo~ sp~ wave~ 当我把这些语言融会贯通并活学活用之后，仿佛年轻了20岁。&lt;/p&gt;

&lt;p&gt;软苑的院报我都忘了是动了什么邪念就加入了，可见人民还是盲动的，需要伟大光荣正确的向导。深夜写稿，断章取义，胡说八道，惶惶如网特。恍然发现，原来好的记者是要有够厚的脸皮才可以胜任的。&lt;/p&gt;

&lt;p&gt;西甲贺炜的解说辞一遍遍的传达着这样的讯息：博洋是个好同志。爱学习，求上进，五讲四美，三个代表……我内心掀起一阵阵敬仰的波澜，想要出去找匹惊马 拦下来。有多条道路选择真是一桩美事，左右逢源。但你必须有所选择，并且有笃 定的目标，因为理论上你不是三位一体的上帝，分身乏术。高导语重心长地教育我要早做打算，语气一如对待少教所的失足青年。我深刻认识到自己的错误，几日里在意淫式地把所有可能的未来一一幻演一遍之后，得出的结论是，我需要若干个参 谋以及一个参谋长。这很正常，因为即便你是上帝，三位一体，打牌还是得再拉一个的。&lt;/p&gt;

&lt;p&gt;前天本来想说点什么，最终没有，可能是忘了，也许是来不及，要么就是不愿意，抑或是权衡后放弃了，不知道，我不能轻易揣测出自己脑袋中央少数掌权的细胞是怎么个想法。当机立断总是好的，标点划得再多也不会有额外的稿费。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>昨日重现</title>
   <link href="http://blog.tomsheep.net/2008/02/07/yesterday-once-more"/>
   <updated>2008-02-07T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2008/02/07/yesterday-once-more</id>
   <content type="html">&lt;p&gt;熟悉我的朋友一定清楚我的标题和正文一向没什么联系，所以您不用猜测笔者有什么深刻用意，大可跳过这一段，直入主题吧。&lt;/p&gt;

&lt;h3&gt;一&lt;/h3&gt;

&lt;p&gt;在举国上下一片和谐的大好日子里把电视锁定在二十多个老爷们踢球上，实在是一 种不雅的举动，但我并没有任何良心上的不安——春晚每年都有，而国家队四年才踢一 次世预赛，于情于理应该予以照顾，况且主观上我更希望前者是四年一届的。 我曾经虔诚地向耶和华、释迦牟尼以及我养了六年的那条狗一并许愿，我愿意用新 年所有的rp来换取中国队除夕的一分，但转念想那就没什么希望了，一则自己素来人品 极差，二则他们仨看起来都没有这项业务。&lt;/p&gt;

&lt;h3&gt;二&lt;/h3&gt;

&lt;p&gt;中午，同组澳大利亚和卡塔尔的比赛便开始进行，墨尔本灿烂的阳光强劲地仿佛可 以穿过电视屏幕，照射着房间右首的窗扇，上面结满的冰花功德圆满，饶有兴致地伴着 尘土在玻璃上肆意横行，写下他们预测的比分。回头瞥一眼窗外尚未消尽的积雪，我只 好对着南半球MM们清凉的夏装艳羡地咽一口唾沫。&lt;/p&gt;

&lt;p&gt;澳大利亚不愧是畜牧大国，绿的发亮的草皮茂盛得让人不禁怀疑，这座球场在没有 比赛的时候就是用来放羊的。我把这一猜想用短信发给一哥们，他回了一句“I 服了 Y ”。这实在让我费解，因为我不能确切地知道他想表达的意思到底是“I 服了 You”还 是“I 服了丫的”。而看着卡塔尔的门将一次次地把球从网里取出来，我更担心的是不 久后中国队到来时，这里除放羊之外会不会还添加屠宰场的一条龙服务。&lt;/p&gt;

&lt;p&gt;下半场卡塔尔踢得很有想法，不过我的工作重心已经从看球转移到用短信和上文那 哥们为中国队找出晋级的最优解：我的想法是主场争取两胜一平，客场伊、澳能拿一分 是一分，死磕卡塔尔；他却坚持澳洲袋鼠在本命年一统天下，攒满18分高调走人，中国 队两灭卡塔尔，而与伊拉克平分秋色，最终以净胜球优势挤掉对方。我们最终的统一结 论是：中国球迷就是贱，总是还没踢呢，就开始做梦。&lt;/p&gt;

&lt;h3&gt;三&lt;/h3&gt;

&lt;p&gt;我承认出于各种原因，我已经有一段日子不关注体育赛事，尤其是中国足球，我不知该说庆幸还是不幸。当父亲指着镜头里年轻的宗垒问我是谁时，我愣了许久，然后倒吸一口气说：“这是门将。”&lt;/p&gt;

&lt;p&gt;比赛一如既往没有技术含量，迪拜球场的机位也不能给人丝毫的视觉享受。也许摄像师也觉得太对不起观众，所以镜头以不同的角度反复对准看台上一位惊艳无比的巴比伦美女，真是人性化。&lt;/p&gt;

&lt;p&gt;新科亚洲冠军很配合，主动以各种无厘头的方式损兵折将。我恍惚觉得这是一场“实业救国”运动，因为阿联酋的球场内到处摆的都是“恒源祥”的牌子，伊拉克兄弟的身上披的队服甚至写着“PEAK”。&lt;/p&gt;

&lt;h3&gt;四&lt;/h3&gt;

&lt;p&gt;对手的点球以一种优美的姿态穿过宗垒的头顶后，父亲用一种询问的眼光看了我一眼，我知道那意思是我们是否应该换台了。我摇头，尽管每次都了解最终难逃一死，但每次还是想知道他是怎么死的。我想这也是为什么香港的九流编剧到现在还有饭吃的原因。&lt;/p&gt;

&lt;p&gt;落后之后，刘建宏的解说也越来越有韩乔生的特色：&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;“孙祥这个球恰好传到了没有中国队员接应的这一点。”&lt;/p&gt;

&lt;p&gt;“中国队目前有两个敌人，一个是对手，一个是时间，还有一个是自己。”&lt;/p&gt;

&lt;p&gt;“这是中国队本场吃到的第，第……嗯……又一张黄牌。”&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;就在刘大数学家还在高谈阔论的时候，郑智进球了。平局。这是我期待的。事后大家都喜欢用“如果……那么……”造句，比如“如果后二十分钟我们再坚决些，那么我们完全可以反超，吃掉对手。”而我的作品是：“如果朱挺没打偏，如果杜震宇没打偏 ，如果曲波再生猛些，如果冯潇霆不掉链子……那么……我X，那还是中国队吗？”&lt;/p&gt;

&lt;h3&gt;五&lt;/h3&gt;

&lt;p&gt;“郑智是上帝！”而前一秒钟我还在喊“郑智是SB”。由此可见上帝就是SB或者上帝和SB是可以置换的。我无法解释我为何如此激动，这样的比赛我看了不知多少，但现在的我已经不再对着屏幕指指点点战术阵型，不再看着回放挑裁判的毛病，不再客观，不再矜持，不再冷静。两年来我已经压抑的太多，我需要血性！需要刺激！需要过去那样的骄傲与不羁！原来我一直都还在为高考失利而介怀，这是我两年来最大的动力，也是最大的阻力 ，现在我才明白。&lt;/p&gt;

&lt;p&gt;我累了，需要休息。&lt;/p&gt;

&lt;p&gt;我累了，需要刺激。&lt;/p&gt;

&lt;p&gt;无论是饺子还是片儿汤汆丸子，只要有皮儿有馅儿，煮成什么样我都爱吃。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>静夜思</title>
   <link href="http://blog.tomsheep.net/2007/09/30/dark-night"/>
   <updated>2007-09-30T02:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2007/09/30/dark-night</id>
   <content type="html">&lt;p&gt;感谢李白同志的版权支持。&lt;/p&gt;

&lt;p&gt;记得一个月前我说要闭关百日，弄得不少亲朋好友以为我要加入什么邪教，企图反党反社会主义。其实当时的想法是要抵御一切外来干扰，全身心地投入到软件的学习中。当时的第一个动作就是让父亲带走了整整一箱的经史子集、话本小说等附庸风雅的劳什子，正式结束本“文豪”的艺术生涯，书架上独剩一部《红楼梦》在众多教辅教参的围追堵截下负隅顽抗。（作者按：不久前，隔壁寝室的一哥们突然说他想看《红楼梦》，找我来借，我很欣慰，于是这本硕果仅存、唯一能标识我文豪身份的巨著也从书架上撤下，从此java与离散千秋万载，一统江湖）&lt;/p&gt;

&lt;p&gt;既然言及至此，那就不得不再说点题外话：就在父亲带着偌大一箱战利品回家的当天，我就惊讶地发现新寝室一位小兄弟俨然一副文学青年的模样，说话的语气每每让我忍俊，而且其健硕的身材也让我回想起几年前的自己。笑~不知我当时是否也是这样一副作派，如果是，那真是罪过，罪过……由此不禁感叹“天道有常，轮回不爽”。其时年17，不知2年后是否也会如我今日一般？&lt;/p&gt;

&lt;p&gt;回归正题。虽说对外宣称闭关炼气，其实这几十天过的出奇的平静，我也从未感到如此安宁过。每天紧凑而充实，越是知道还有很多知识需要填补，我便越是兴奋——等等，我必须无奈地辩解一下，因为不知为何，尽管我自认为整日忙碌而充实，但在我们老大眼里我却清闲得紧。他的主要论据是我在高数和物理课上看别的书，并且在课后不是看电影就是编播放器玩。&lt;/p&gt;

&lt;p&gt;其实看电影一来是陶冶情操，二来是为美育课打好基础。而所谓“播放器”只不过是我用来练习编程的小玩意，再正经没有了至于上课，那我只能说，如果我认真去听这些已然学过一遍的内容，那才是真的不务正业。笑~好，我就用老大自己的话总结一下：我看不是这样。XD&lt;/p&gt;

&lt;p&gt;比之一年之前，现在的状态真是让我欣慰。同时我有两点很奇特的发现：一是越有好的心情，却越是没有幽默感。一年前虽然抑郁烦闷，却极喜调侃自嘲，经常能攒好若干小包袱，在夜战之时伺机抖将出来，效果之好，令人难忘。而现在心情大有改观，却再也没有那样敏锐的神经了——这便好像几年前一直想看到《红楼梦》的影印版，越是无处寻觅，心中越是渴求。&lt;/p&gt;

&lt;p&gt;而现在各种古本的影印悉数存于电脑之中，触手可及，而自己却没有当年那样一种兴奋了。（也许是纸媒有其独特的魅力？好，那就继续期待吧……）其二便是我表达不同心情的方式极为特别：郁闷时，我经常会在莫名其妙的时候发出一些莫名其妙的声音，有时是“啊”，有时是“咦”，还有时是“阿姨”……而相反若是心情愉快，我却多半会比平时更沉默（他们叫低调 ），耐心地听别人讲话，并且伴随着十分诡异的微笑（我自己觉得很自然，但他们都说很诡异）。&lt;/p&gt;

&lt;p&gt;现在就来解释一下本大仙为何会在修炼之时突然现身于此。其实“闭关”一说，从来就是子虚乌有，为的只不过是给自己一个心理暗示：这是一个新的开始。如是而已。而今晚毫无睡意，思绪连篇，始有此文。失眠真是一件有意义的事情——啊，我的思维又发散了，让我想想，过去的我失眠时会写些什么？回忆回忆——&lt;/p&gt;

&lt;p&gt;小学二年级：&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;今天，我又去看那帮战士训练了，他们跑了一圈，两圈……很多圈。&lt;/p&gt;

&lt;p&gt;我很高兴。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;初中二年级：&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;夜。  &lt;br/&gt;
深沉。  &lt;br/&gt;
一缕光闪在夜幕中。  &lt;br/&gt;
那是一盏灯。   &lt;br/&gt;
他的主人失眠了。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;[我没有模仿古龙的意图，只是那时觉得这样写很有味道。]&lt;/p&gt;

&lt;p&gt;高中二年级：&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;夜阑独坐倚重门，月射寒江星渐昏。   &lt;br/&gt;
孤灯两盏窗前点，秃笔一枝卷里沉。  &lt;br/&gt;
五谷不分无谁管，四更未起有人问。   &lt;br/&gt;
罗衫轻舞人弗寐，半为秋风半销魂。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;[难得我还记得这首蹩脚的诗，现在看来，一眼便知是抄林黛玉的，呵呵，忘了当时是否就是照着写的，XD~真是一段有趣而酸腐的历史……]&lt;/p&gt;

&lt;p&gt;现在：&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;今天，我又去听张德志的课了。   &lt;br/&gt;
他又讲了很多笑话。  &lt;br/&gt;
不好笑。   &lt;br/&gt;
我很欣慰。&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;[随意一些吧，我想这样才更自然……]&lt;/p&gt;

&lt;p&gt;哎，还是睡不着。为什么呢？今天干了些什么呢？早上张德志，下午程设，对，完成了所谓播放器的升级，晚上……和老大及软院老师群聊……还有……下午给家里打了电话，对，应该是它了：我和家里的联系相当频繁，但其中我主动打过去的却屈指可数。我总是忘记在必要的时刻主动和父母联系，有时即使记得，他们的电话也总是先我一步拨出。他们总是在千里之
外向我传达上海的天气预报，并提醒我生日是哪一天，而在电话那头他们所能听到的声音无非是“啊”“是”“没有”“挺好”“不错”“嗯”……我极不习惯与人嘘寒问暖，即使和父母也是一样。所以每次我都找不到合适的话题。我想我需要有所改变，事实也确是如此：今天我只是在下课后主动拨通了家里的电话，只是随口问了句“天气怎么样，家里好不好”，结果母
亲说到最后都快哭了……&lt;/p&gt;

&lt;p&gt;对，就是这个……&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>归心四剑</title>
   <link href="http://blog.tomsheep.net/2007/08/15/pal4"/>
   <updated>2007-08-15T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2007/08/15/pal4</id>
   <content type="html">&lt;h3&gt;序言&lt;/h3&gt;

&lt;p&gt;不知不觉日历已翻至八月中旬，暑期将尽，本欲撰一短文以示总结，提笔却发现整个假期所做有意义的事无非两件：一则等待仙剑，一则品味仙剑。既如此，那就换个标题吧。&lt;/p&gt;

&lt;p&gt;其实在复杂的心情下不宜动笔，抱歉我无法将它写得诙谐。&lt;/p&gt;

&lt;h3&gt;第一章  于等待中接受&lt;/h3&gt;

&lt;p&gt;8·1 首发，这意味着假期2/3的时间都将陷于漫长的等待。没关系，我有耐心。其间也做了两件事，一是回了趟陕北，二是重玩仙3。前者……暂时埋在心里。仙3是这款游戏的转折点，有人评论说这是仙剑重获新生的力作，也有声音叹它是仙剑精神沦丧的起点。我是个怀旧的人，一直以来对于续作都有天生的排斥。尤其是仙3 世界观的改变让我一度有些伤感，我曾戏称仙1是“以人为本”的，而仙3则有些“怪力乱神”。即便如此，我也从未否认这是一款极好的游戏，庞大而坚实的故事结构，恢宏的场面，出色的美工，明显提升的游戏性……在这次等待仙4的过程中，我也渐渐地抛开了对续作固有的界防。&lt;/p&gt;

&lt;h3&gt;第二章  仙剑，何也？&lt;/h3&gt;

&lt;p&gt;关于这个问题我想了很多年，究竟是什么让我对一款游戏如此推崇？如此难以释怀？剧情？美工？人物？……或者只是对童年记忆的留恋？好像都不是，却又都是。都不是，是因为单独把这些因素拎出来和其他大牌游戏单挑，仙剑未见得会占得上风，我寝室的一位强辩曾经搬出一大堆我闻所未闻的游戏来证明仙剑的中庸，道剧情不如X本的什么什么，画面不及霉国的哪个哪个。当时我无力反驳，因为自己都不知道为什么钟爱仙剑。好吧，如果现在仍有人问及，那我只能回答：文化。XD。这不是一句冠冕堂皇的套话。&lt;/p&gt;

&lt;p&gt;仙剑是一个根植于民族理想与文化武侠梦。古朴的画风，历史的底蕴，似曾相识的传说，古典文艺的气息，加之传统背景下的悲欢离合，耐人寻味的价值取向，以及一代代中国人的神话般的梦想……将他们孤立出来显然是不明智的。成就仙剑的不啻游戏本身。&lt;/p&gt;

&lt;h3&gt;第三章  第五把剑&lt;/h3&gt;

&lt;p&gt;说实话，仙4给我的第一印象并不太理想，大部分原因玩过的朋友应该有一些了解，拿到joyo订货后的两天里我都在想怎样能让它顺畅的运行，最后得出的结论是重做系统。能让我下次决心的游戏恐怕也只有仙剑了。即便如此，我还算主流的配置在它面前仍旧只能疲于应付——每次切换地图是我都在考虑是否要先睡一觉。&lt;/p&gt;

&lt;p&gt;还有小部分原因来自于操作的不习惯与开局阶段的平庸。还好，我在最短时间内研究出了用手柄来玩仙4的方法，更让人欣喜的是，后面的游戏渐入佳境，越发引人入胜，让我颇感欣慰。论坛一位仙友说：“前面很烂，后边很精彩。”虽然带有情绪，但还算有些共鸣。&lt;/p&gt;

&lt;p&gt;我对这部游戏的评价比较高，甚至高于我的预期，无论剧情、画面、文字功底、人物刻画……都没有给仙剑抹黑。至于加密的事，我想与设计人员无关吧。&lt;/p&gt;

&lt;p&gt;最近网上在热烈讨论结局到底是什么意思，那些年主角们到底经历了什么，梦璃是否嫁给了那个路人甲，菱纱什么时候死的，梦璃看见的野人是真的还是幻象……因此有人抱怨结局过于隐晦。其实，这些又有什么关系？把一切事一件件说清楚反而味同嚼蜡。我非常欣赏这个结局，并且不赞同把它归入悲剧，它的动人之处在于人生的沧桑……另外，看到还有朋友指摘仙4与仙剑系列的人物、地点、故事瓜葛甚少，难以再叫做“仙剑”，这就要回到第二章“什么是仙剑”的问题了。&lt;/p&gt;

&lt;h3&gt;第四章  门户之见&lt;/h3&gt;

&lt;p&gt;关于这个问题，我不想再多说，就把半个月前在百度法的一个帖搬到这吧，虽然此时的认识比当时更进了一步，但基本政策还是一样的：&lt;/p&gt;

&lt;p&gt;你们的比法不公平&lt;/p&gt;

&lt;p&gt;一直以来很多仙迷同志都大喊仙3（或者其他版本）已经超越了仙一，并罗列诸多证据。这样纵向的对比是不公平的，更客观的比法应该是横向比较，拿各个版本在当时创作环境下在整个游戏界（就说国内吧）的地位与影响力相比——一代在当时无论从哪个方面讲几乎都可以称得上国内游戏的翘楚，领军一时（我个人至今仍然偏爱那种古朴而精致的画面）；而后续版本很少有能够做到的（或许在有些方面做到了，但整体绝难称作当时中国游戏最高作品）&lt;/p&gt;

&lt;p&gt;我想这样的争论本来就是没有意义的，我一直持这样的观点，你最喜欢哪一部，那它就是最好的那部，狂顶3、4的大多是90+朋友，而始终推崇1的大都是经历过那个时代的，这两群人、或者几群人是有代沟的，在这个问题上谁都不会妥协。所以，喜欢续作的朋友不要整天叫嚣谁超过了谁（这在我看来是种故意挑事儿的行为），最爱1代的同志也不要动不动就一副老革命的姿态，要来教训刚入伍的新兵蛋子，要知道他们玩3、3a或者4的感觉是和你们（应该说我们）当初玩DOS或者柔情版的感觉是一样的。大家各玩各的，相安无事。&lt;/p&gt;

&lt;p&gt;我喜欢青菜，你喜欢萝卜，你说萝卜比青菜好吃，我没有任何意见，但你非要强迫我喜欢吃萝卜，并且说喜欢吃青菜的都是猪，那我就要削（xue）微地抗议一下了。&lt;/p&gt;

&lt;h3&gt;第五章  工长君&lt;/h3&gt;

&lt;p&gt;由于担心透剧，所以几天前一直在闭关玩游戏，没有去个大论坛瞎逛，因此游戏监制工长君离职的消息直到前天通关后才看到，我有些伤感。大宇真是一家让我好奇的公司，为什么每次都能网罗到精英而之后又每每逼走骨干？从狂徒的解散到后来的王世颖、张毅君……这次工长君的离开无疑意味着仙剑又将更换一个大脑，尽管我相信大宇辉找到同样出色的人才来接替他，但之后的作品会怎样，谁都无法臆测。&lt;/p&gt;

&lt;p&gt;工长是一个低调的台湾人，一心致力于民族游戏的发展，六年来带领上软坚持打造仙剑，他的离开让人除了惋惜还是惋惜……再次翻开仙4，看到他写的序言，如此真诚……叹叹。这一系列的事情让我对上软这个团队肃然起敬，而对大宇的做法渐感失望。利欲熏心的高层已经一门心思想搞网游，甚至到了拿单机来养网游的地步！我已无法奢望姚仙“仙剑会做到18代”的浪漫承诺会得到兑现。&lt;/p&gt;

&lt;p&gt;艺术品终究敌不过商品。&lt;/p&gt;

&lt;p&gt;用工长惯用的语言：笑~&lt;/p&gt;

&lt;p&gt;我第一次萌发出要去做游戏的冲动，为了仙剑这块民族游戏硕果仅存的瑰宝。而现在的自己显然差得很远，为此，学好软件，学好历史，学好文学……笑~&lt;/p&gt;

&lt;h3&gt;后记&lt;/h3&gt;

&lt;p&gt;仙4是让我第一次买正版的游戏，也让我第一次知道了买正版的重要性。如果仙剑仍有续作（单机），我也定会去买正版，为了上软，为了仙剑，为了自己的梦，为了民族游戏的梦……&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>5比1</title>
   <link href="http://blog.tomsheep.net/2007/07/13/5v1"/>
   <updated>2007-07-13T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2007/07/13/5v1</id>
   <content type="html">&lt;p&gt;中国男足的表现一如既往地让人心存遗憾，但这与本文无关。这个疑似炒作的标题只是为了证明一下我有转行干记者的潜力。&lt;/p&gt;

&lt;p&gt;闲言少叙。本文的中心思想是：通过对志德书院336各成员的描写，展现了国内大学生猪狗不如的生活，揭示了复旦学院没吃饱还撑着了的本质，表达了作者对即将解散集体的提前怀念与沉痛哀悼……&lt;/p&gt;

&lt;p&gt;话说志德书院336寝室有舍员六人，全是男的（也不知道学校怎么分的，一点儿也不合理）。龙生九子，各有不同。看官却倒这六位各是何方妖人？待贫僧细细道来——&lt;/p&gt;

&lt;h3&gt;钱行&lt;/h3&gt;

&lt;p&gt;猥琐且无“琐”不能的寝室长。这个名字实在是十足的败笔——本来姓钱就够失败了，孰料又叫“行”，叹叹……当然，我们要唯物的看待一个人，不能因为一个低级趣味的名字就否定一个人的价值。钱行用自己的行动告诉我们：人的名字是有限的，而人的猥琐却可以入滔滔江水连绵不绝……&lt;/p&gt;

&lt;p&gt;其最大的特点是在每天11：30熄灯之后有一段“发情期”，平时积累的一肚子歪理邪说在这一刻发挥威力，逮谁和谁辩论，骂遍全寝无敌手，飞扬跋扈，为祸一方。后期被笔者降伏——我素来不喜与人争辩，也从不和他正面交手，只是总在其与他人激战正酣之时突然有针对性地抖一两个小包袱，便足以挽狂澜于既倒，将局面彻底搅乱。在此笔者“闷骚”的特质得到了充分地展现，后期钱行对这种折磨已然无可奈何。自从其离校之后，336的夜生活顿时乏味了许多，笔者的一身本领也失去了用武之地 。大家不由得对钱行同志生发出无限的怀念之情。&lt;/p&gt;

&lt;p&gt;此人现在已然退学，不久将远赴美利坚，求学于达特茅斯，用他极富特色的歌喉去感化美国人民……&lt;/p&gt;

&lt;p&gt;经典语录：我当然知道狗是什么感觉！！！&lt;/p&gt;

&lt;p&gt;评语：￥%%……—￥#·）（……&lt;/p&gt;

&lt;p&gt;综合评定：宋祖德 &amp;lt; 钱行 &amp;lt; 芙蓉姐姐&lt;/p&gt;

&lt;h3&gt;周超&lt;/h3&gt;

&lt;p&gt;安徽方言传播大使。336共有三人来自外省，但只有安徽方言在寝室生根发芽，成为继普通话与上海话之后的第三官方语言，周超之功大矣。“花的了”、“凤的了”、“格有”在寝室的使用频率直逼“人品”、“SB“与“我X“。&lt;/p&gt;

&lt;p&gt;除此之外，周同学还是中国电信的忠实拥趸，其3个半小时的通话记录至今无人能破。为了方便起见，周同学还特地买了一条5到10米的电话线，以备深夜作战使用。前一段这位政治系的帅哥迷上了S.H.E的一首不知道叫什么的歌，一会儿“为什么为什么”，一会儿“完蛋了完蛋了”，其唱法之婉转令人过耳难忘，成为336解散之前的一大亮点。&lt;/p&gt;

&lt;p&gt;经典语录：你们男生就是粗心。&lt;/p&gt;

&lt;p&gt;评语：虽然这句话并非周同学的典故，但笔者窃以为从他嘴里复述出来的感觉胜过原版百倍，这就是翻唱的魅力。&lt;/p&gt;

&lt;h3&gt;沈陆峰&lt;/h3&gt;

&lt;p&gt;德语系的浪人。336常驻网吧大使。上个学期疯狂地迷恋《魔兽世界》，经常在一个月黑风高的夜晚潜入志德书院，在没有保安的情况下破门而入，无限暧昧地来一句：“同志们，我60级了！&quot;从他嘴里还可以经常听到的另一句话是：”我要看德语了！“这句话光荣地入选《336搞笑对白集锦 》。&lt;/p&gt;

&lt;p&gt;第二个学期小沈同学大义凛然地卖掉了自己的魔兽号，一时传为佳话。但大家不久后发现它将过去 玩网游的时间全部奉献给了自己的床铺，光荣地成为全寝室睡得最早起得最晚的人，笔者唤之曰“猪峰 ”。&lt;/p&gt;

&lt;p&gt;经典对白：&lt;/p&gt;

&lt;p&gt;[沈陆峰躺在床上。]&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;王孟：啊……我要强奸你！！&lt;/li&gt;
&lt;li&gt;沈陆峰（不屑地）：放心吧，你肯定未遂的。&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;评语：怎么可以这样打击未成年人……&lt;/p&gt;

&lt;h3&gt;乐云&lt;/h3&gt;

&lt;p&gt;睡在上铺的兄弟。非典型性童心未泯。喜欢喝乐百氏，收藏小熊图片，与其高挑的身材极 不相符。整个语言体系由若干个基本句型构成，最喜用“小”字造句，比如“短信小能手”、“CS小弱手“ 、“爱心小电话”等等等等。笔者曾按照他的语言习惯将钱行封为“最佳小辩手”，遭到了钱同学的强烈
抗议。&lt;/p&gt;

&lt;p&gt;还值得一书的事，乐云同志还是本寝室唯一的游戏集大成者，涉猎之广泛令人叹为观止。在336， 周超是CS 与帝国的拥趸，沈陆峰乃网游的追随者，笔者与钱行则属于柔情RPG的受众。而乐云同志大 小通吃，魔兽、CS、帝国、星际、三国、FIFA、仙剑……无论战棋、RPG还是网游无一不玩，并且无 一不通，对细节的掌握程度每每让人自叹不如。前一阵笔者下了个FC红白机的模拟器，他也竟玩得不 亦乐乎，我的汗……&lt;/p&gt;

&lt;p&gt;经典语录：有问题……&lt;/p&gt;

&lt;p&gt;评语：这句话一定要说得三分诡异、三分铿锵，再加若干暧昧成分，方才有乐云特色。&lt;/p&gt;

&lt;h3&gt;王孟&lt;/h3&gt;

&lt;p&gt;336唯一的未成年人。继承了河南人的敏感与较真儿，曾经一度是在夜间与钱行叫板的主 力干将，后来性情小有变化，退居二线，促使钱行完成了从吕布到独孤求败的转型。&lt;/p&gt;

&lt;p&gt;第一个学期喜欢唱歌，第二个学期喜欢读英语，曾经以一首惊天地泣鬼神的《香水有毒》力压笔者 与钱行，荣膺“寝室第一杀手”。后来在舆论的压力下难得一唱，转而对读英语产生了浓厚的兴趣，照这样发展，将来去俄罗斯当个外交使节还是很有希望的。&lt;/p&gt;

&lt;p&gt;经典语录：你身上有她的香水味……&lt;/p&gt;

&lt;p&gt;名家点评：&lt;/p&gt;

&lt;p&gt;李菁：我滴妈呀，太刺激了~~&lt;/p&gt;

&lt;p&gt;周星驰：……所以呢我就抓住苍蝇挤破它的肚皮把它的肠子扯出来再用它的肠子勒住他的脖子用力
一拉，呵－－！整条舌头都伸出来啦！我再手起刀落哗－－！整个世界清净了。&lt;/p&gt;

&lt;p&gt;郭冬临：胃胀，腹胀，不消化，用江中牌健胃消食片。&lt;/p&gt;

&lt;h3&gt;???&lt;/h3&gt;

&lt;p&gt;按理第六条就应该是笔者本人了，但小可不才，所学到的溢美之词不足以表达我对自己的敬佩，姑且暂付阙如，况且笔者自信笔法足够阴损，5位同志在写类似文章之时定然不会手下留情，那就不妨先给读者留下充分的想象空间吧，到那时再来了却这段5：1的公案。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>闲读白鹿原</title>
   <link href="http://blog.tomsheep.net/2007/03/04/bailuyuan"/>
   <updated>2007-03-04T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2007/03/04/bailuyuan</id>
   <content type="html">&lt;p&gt;在大学里浑浑噩噩的度过半年后，我不得不懊丧的承认自己已经基本丢弃了闲时读书和读闲书的习惯。这个现象的直接后果是我在半年内竟然从未执笔作文，这在之前几乎是不可想象的。以至于今日重温旧梦，却痛苦得半天也写不出一个字来。&lt;/p&gt;

&lt;p&gt;“灵感与信手拈来本领的‘走失’未必是件坏事，”我只能这样乐观地想，“缺少了粉饰与掌故的文字也许更加酣畅淋漓。”&lt;/p&gt;

&lt;p&gt;《白鹿原》一书从书店里搬回来已经有一些年月了，却一直连扉页也没翻开过。当时几乎是头脑一热就买了，后来丢哪都记不清了——我的很多书都曾遭到过这样的冷遇，直到现在仍有许多从未被“宠幸”。&lt;/p&gt;

&lt;p&gt;早就风闻此书多有涉黄描写，当属“限级”作品，（这或许是当初买书的动机之一？现已无从考证）曾经有一个哥儿们还假惺惺的佯作愤怒说“这样恶心的作品怎么会或茅盾文学奖？”多重“铺垫”让我对这部作品充满期待。春节期间读罢发现，在这个层面上，舆论其实“过誉”了。《白鹿原》中的限级描写与其他许许多多名著中的程度并无二异，甚至不及同样获过茅奖的《尘埃落定》，与被禁的《废都》和村上春树的《挪威的森林》更是无从比起。看来舆论有时真的未必靠得住。&lt;/p&gt;

&lt;p&gt;这的确是一部出色的作品。&lt;/p&gt;

&lt;p&gt;首先，文字的风格与叙事的手法让我十分受用，处处显示着作者深厚的功底与多端的技巧。之前我一直有一个偏执的想法，总觉得用文字将陕西的方言（无论是陕北还是关中的）表现出来多少有些不舒服，即使是《平凡的世界》这样优秀的作品也曾让我感到过些许的别扭，可《白鹿原》在这一点上却宛如天成：笨拙的土语不但没有妨碍对不同阶层不同性格人物的刻画，反而使一个个角色更加鲜灵活现。不得不佩服作者扎实的文字功底和卓越的语言天赋。&lt;/p&gt;

&lt;p&gt;从内容上讲，这绝对是一部深刻的作品。它的指向并不单一。白灵的死法，黑娃的结局，“锅盔鏊子”的比喻，白氏祖传有进无出的钱匣，白嘉轩直挺挺的腰杆，晶莹剔透透着灵异的白鹿，立了又破、破而又立的“乡约”，朱先生一句妙似一句的谶语……所有的这些让你最终合上书时没有喜悦，没有哀伤，也没有多余的喟叹，甚至没有一丝带有任何色彩的情绪，只有无边无际并且厚重异常的思考，而思考的是什么，却又难以说清道明。&lt;/p&gt;

&lt;p&gt;全书描写的最深刻的人物，不是刚毅稳重的族长白嘉轩，不是才识卓绝感情质朴的朱先生，也不是时刻保持沉稳姿态的冷大夫，而是拥有波诡云谲传奇经历的白孝文。这个人的遭遇以及转变，引起了我最多也最为长久的思索。如果没有破窑里的变故，这将是一个怎样的人？他的腰会像父亲一样挺直，他会继承所有白氏优良的作风与习性，他会成为比弟弟孝武更为胜任的族长。人往往在一个个微妙的时刻“一念成魔”，而其“成魔”的孽根却又似乎是早已藏匿于体内，注定要在某个瞬间喷薄而出的。经历了狗一般生活的他，在吃过生平最辉煌的一顿舍饭后走上了另一条“狗”的道路。“当着朱先生的面我不好出手。”一个冷血狡诈、睚眦必报的白孝文从此脱生。而深刻的作者并没有让它的传奇在此完结，&lt;/p&gt;

&lt;p&gt;小说的结尾并没有“解放了”的欢愉与喜悦，而是安排了投机革命的白孝文县长的一次精彩演出，处死鹿兆谦的凄冷枪声所折射出的，该是多少个举起红旗的白县长……&lt;/p&gt;

&lt;p&gt;写下以上的文字，放下笔时终于发现，原来有些文字，并不是棱角分明的键盘敲得出的。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>孤家寡人的春节</title>
   <link href="http://blog.tomsheep.net/2007/03/03/lonely-spring"/>
   <updated>2007-03-03T20:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2007/03/03/lonely-spring</id>
   <content type="html">&lt;p&gt;“有些事总不如想象中的完美。”&lt;/p&gt;

&lt;p&gt;总结出一条有哲理的话是需要付出代价的。眼看着行李中一包数量可观的教科书，想到它将在24小时候被原封不动地运回上海，我也只好发出两声自嘲的轻叹。而我依然清晰地记得将它带回来时自己踌躇满志的豪言。
整个春节也和预想中的大不相同。期待中的亲朋好友嘘寒问暖的场景无一兑现，连到处游历一番这样单纯的梦想也没有经得起实践的检验。整个节日在一种平淡得有些孤寂的气氛下度过，而我只能用鼠标与键盘配合下发出的“嘀嗒”声将这种气氛做最大程度的淡化。&lt;/p&gt;

&lt;p&gt;我不幸地发现，在这片故乡的土地上，我连一个亲密的朋友也没有了。 这个可怖的消息最初来自于堂哥的那双已经长满老茧的手，那十只曾经光滑修长的手指现在正熟练的操纵着一台遍体油污的车床，他们的主人至今还不满二十岁。不久前的一封来信彻底证实了我上述的判断，因为信封上赫然印着“北京市海淀区新兵一中队”的字样——又一个当兵的。&lt;/p&gt;

&lt;p&gt;我开始怀念以前的日子了。这种情绪促使我在高中同学聚会的当天迫不及待地登上了开往学校所在地的班车，事实证明我比大家早到了两个小时。聚会在无组织无纪律的状态下开始、进行并且结束，我们在市政府对面的公园里示威似的绕了一个偌大的圈子。回到原点后，这场一撮堆谈话为主要内容的会议宣告结束。会后，包括本人在内的部分与会人员慰问了母校。老师接待我们的笑容依然熟悉而亲切，唯一陌生的是寒暄过后匆忙的脚步——他们已经在为下一茬的“庄稼”而奔忙了。&lt;/p&gt;

&lt;p&gt;第二天清晨，一个路途与我南辕北辙的哥儿们坚持把我送到了回家的车站，我满腹感慨地回头望了望他，发现那张已经没有地方供新生青春痘成长的脸依然消失在出站的一端。&lt;/p&gt;

&lt;p&gt;归家的一路上全是回忆。感谢不断绕圈的司机给了我充分的时间以供怀念。&lt;/p&gt;

&lt;p&gt;我开始频繁的梦到过去认识的人：喜欢的和不喜欢的，漂亮的和不漂亮的，长青春痘和不长青春痘的……一个个熟悉的面孔就这样与我擦肩而过了。&lt;/p&gt;

&lt;p&gt;“人生总有一些东西要错过。”&lt;/p&gt;

&lt;p&gt;看见了吧，哲人就是这样炼成的。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>意识流</title>
   <link href="http://blog.tomsheep.net/2006/08/23/stream-of-consicousness"/>
   <updated>2006-08-23T22:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2006/08/23/stream-of-consicousness</id>
   <content type="html">&lt;p&gt;昨日应邀去参加一位同学的升学宴，一如既往地尴尬。宴讫又随同一起去KTV——我一直想知道这个名词的英文全称是什么。TV想是television无疑了，那K呢？key?kick?kiss?总不会是kaif吧？！&lt;/p&gt;

&lt;p&gt;对于流行音乐，我一向是无可无不可的。虽然并不排斥，并且若是果真出色，也会照例欣赏，但若要坚持不懈地耗上数个时辰，难免有些审美疲劳。&lt;/p&gt;

&lt;p&gt;其间走神得厉害。万没料到我的发散思维居然可以达到这样的境界，若是高考时有如此状态，何至于……&lt;/p&gt;

&lt;p&gt;起初思绪的漂移是由几位的走调引起的。一般来说，走调是再正常不过的了，但让我费解的是：在聒噪的伴奏下，几位高人何以能够先由准音转入游离状态，再逐步进入自定义情境，然而在经历漫长的探索之后居然又集体步入正轨！正在疑惑，恍惚间捕捉到：“……要拐几个弯才来……”——原来如此！&lt;/p&gt;

&lt;p&gt;起初的歌曲全是“夏天”，这一点很有意思。钱钟书说“春天是要嵌在窗子中看的”，我不知他是否还说过“夏天是要放在KTV里唱的”。夏日连连未免单调，我意识中立刻跳出郭德纲唱的《白蛇传》：“那杭州美景盖世无双/西湖岸奇花异草四了季的清香/春有苏堤桃红柳绿/夏赏荷花映满了池塘/秋观明月如同碧水/冬看瑞雪铺满了山冈……”&lt;/p&gt;

&lt;p&gt;忽然屏幕上的“宁夏”字样又将我的思绪引至另一端：这个名字很容易让人有地理方面的联想，这让我想起海涅的《德国，一个冬天的童话》，在未读此书时光看名字会以为这是一个浪漫的故事，读完后发现全然不是这样。所谓“冬天”系指寒冷，而“童话”乃是“荒诞”的昵称！韩寒同志说得对啊：“看女人一定得看真人，而且得卸妆。”&lt;/p&gt;

&lt;p&gt;屏幕上映出《曹操》，我与此曲颇有渊源。记得第一次听一哥们唱时，我曾卖弄地向他兜售历史知识：“长坂坡的故事发生在刘备弃走新野、被曹操追杀的时候，此时刘琮小子已纳降归顺，荆州已然落入曹贼之手，况且小云同志七进七出时也没听说是在晚上……”对此，那哥们做出了很温柔的回复：“死去！！！”于是这次我学乖了，一言不发地“以艺术的态度欣赏艺术”。&lt;/p&gt;

&lt;p&gt;也许是发觉我有些走神，女主人礼貌地问我是否较少接触流行音乐，我轻描淡写地敷衍，脑中浮出京剧唱腔：“我本是卧龙岗散淡的人……”她随即问我是否觉得冷，我习惯性地摇头——十余年来我已养成这样的习惯：只要得到的是一般疑问句，我便会毫不犹豫地摇头。这一点让我苦闷不已。譬如这次，我确实冷得异常，以至双腿不住地战抖。（不知他们是否理解为我在击节助兴）因此摇头后便后悔不已，好在不久后空调便被关了——显然其余人没有这样的恶习。于是我决心对头部动作进行监控，否则后果相当严重。果然，她不久后便问我中午是否吃饱，我很机警地点头——万幸，要是继续摇头就不好玩了。&lt;/p&gt;

&lt;p&gt;继续神游。不知为何，老是听到“栀子花”这个意象，老实讲，我不知道这是个什么东西，更没见过。但它让我马上想到高三的同桌以及两年前于西北大学的那场培训，那时他的经典唱段便是这个花开啊开的。&lt;/p&gt;

&lt;p&gt;不知何时起，MV里已是周X伦的天下了，弹琴的他热得一件件地脱掉上衣，让我明白弹钢琴真是件体力活。“黑色幽默”这个名字很不错，（可惜内容没有听懂）让我条件反射地想到《第二十二条军规》以及那颇为讽刺的飞行时间……&lt;/p&gt;

&lt;p&gt;思绪愈飞愈远，女主人提出集体唱《朋友》以作结束，这将我的注意力再次拉回到屏幕上——MV里周华健与一帮人在玩橄榄球，让我纳闷的是竟没有一个人戴头盔——这样容易出人命啊！&lt;/p&gt;

&lt;p&gt;在几十分钟后，此行终于结束。离开座位时惊讶地发现四个多小时以来我竟连姿势都未曾换过——想我若是那车迟国的妖道，唐僧那厮定是要输的。&lt;/p&gt;

&lt;p&gt;走出KTV，想来今天收获真是不少，认识了好多繁体字。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>八四纪实</title>
   <link href="http://blog.tomsheep.net/2006/08/04/timeline"/>
   <updated>2006-08-04T23:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2006/08/04/timeline</id>
   <content type="html">&lt;h3&gt;丑——卯：这个时段照例仍在梦中。&lt;/h3&gt;

&lt;p&gt;梦境支离破碎：起初仿佛天阴得厉害，头顶的云层黑得糁人；不知何时场景又切换到一处阳光明媚的地方，四周布满各式各样的鲜花——有喇叭花、喇叭花、喇叭花、喇叭花、喇叭花……五彩缤纷，好看极了。还有山石溪流、飞禽走兽，或许还有美女，可惜记不清了。&lt;/p&gt;

&lt;h3&gt;辰——午中：一天伊始。&lt;/h3&gt;

&lt;p&gt;“一日之记在于晨。”在这个具有重大意义的时段，作为一个有理想、有抱负的热血青年，应该去做一些有利于国计民生、有助于祖国和平统一的工作，所以我决定去上网。&lt;/p&gt;

&lt;p&gt;此番按下不表，且说几日前去拜访一位表叔——一个有些孤傲的小学老师。当得知我清晨上网的良好作息习惯后，他严厉地指出这是极其损害身心健康的行为。怎见得好劝？有赞为证：&lt;/p&gt;

&lt;p&gt;其声铮铮，可比黄钟大吕；其势汤汤，有若四合八荒；其言谆谆，一如晨钟墓鼓；其理昭昭，胜似武侯过江。闻讫醍醐灌顶，听罢四肢犹凉。自古也有渡厄曲，不似今日蓬莱章。&lt;/p&gt;

&lt;p&gt;一席话惊醒梦中人。于是我下定决心，为了我的身心健康，从此以后——再也不去表叔家了。&lt;/p&gt;

&lt;h3&gt;午时三刻——未：与初三的同桌一起看电视。&lt;/h3&gt;

&lt;p&gt;从纪连海的专访到周汝昌的生平再到故宫的专题，受到了良好的文化熏陶和爱国主义教育。&lt;/p&gt;

&lt;h3&gt;申：照例去学书法。&lt;/h3&gt;

&lt;p&gt;今天学写了五十个字，每个字写一遍，分别是：学、学、学、学、学……&lt;/p&gt;

&lt;h3&gt;申末酉初：从学习班出来，突然想把头发整理一下。&lt;/h3&gt;

&lt;p&gt;在拐角的街口遇到一位表姐，告诉我该街是本地有名的红灯区，各发廊基本没有理发的业务。&lt;/p&gt;

&lt;h3&gt;酉：&lt;/h3&gt;

&lt;p&gt;前几日联系到了陕北几位小学同学，却一直拨不通初一时哥们的电话。今日再试，竟毫无障碍！欣喜万分。（用时下泛滥的减肥茶广告翻译便是：起初我也不敢相信耶！我用了很多种联系方式，都没有效果。于是我抱着试一试的态度再打了一遍，结果真的拨通了耶！）&lt;/p&gt;

&lt;h3&gt;戌：去医院看望住院的姨妈。&lt;/h3&gt;

&lt;p&gt;第一次到这来，条件比想象中的好。其间的插曲让我心情沉重：起初听到病房外的走廊里有歇斯底里的喊声，以为是院方请来的秦腔剧团，俄而听出喊声中带有哭腔，便出门观望。声音的源头是蜷缩在墙角的一个女孩，约莫十三四岁，旁边的病房内人头攒动，显然有重伤号正在抢救。拐角的电话旁，一位头缠绷带的幸存者在向亲友叙述车祸的经过……那女孩的哭声让我很不平静。其实这样的声音在新闻中时常可见，但从未让我产生过任何不安的情绪。顿时明白了为什么有人宁可不远万里、买高价票去现场看球，也不愿守在家里看直播——不一样的。&lt;/p&gt;

&lt;h3&gt;亥——子：与堂兄在街区游荡。&lt;/h3&gt;

&lt;p&gt;夜景并不漂亮，但很有意思。堂兄只比我大一岁，却已有了丰富的生活阅历和社会经验。在夜色中，他仅凭发动机的轰鸣声便能辨认出驶来的汽车是哪个品牌的什么型号，并把它们分为三六九等。这让我十分佩服，因为我只能在有车顶标志的情况下将眼前的四轮代步工具分为“出租车”和“非出租车”。&lt;/p&gt;

&lt;h3&gt;子末：事实证明，我的分类方法更为实用。&lt;/h3&gt;

&lt;p&gt;我们乘坐了一辆顶部有“TAXI”的车回家。&lt;/p&gt;

&lt;p&gt;写下以上的文字。&lt;/p&gt;

&lt;p&gt;努力回想昨夜梦中的美女，期待今晚再次见到。&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>杂</title>
   <link href="http://blog.tomsheep.net/2006/08/04/summer"/>
   <updated>2006-08-04T23:00:00+08:00</updated>
   <id>http://blog.tomsheep.net/2006/08/04/summer</id>
   <content type="html">&lt;p&gt;不知如何开始  &lt;br/&gt;
文字已连缀成篇  &lt;br/&gt;
六月的梦魇  &lt;br/&gt;
光景不会再重演  &lt;br/&gt;
这个夏天  &lt;br/&gt;
得志的露出笑靥  &lt;br/&gt;
——万岁，毕业！  &lt;br/&gt;
失意的声嘶力竭  &lt;br/&gt;
——妈的，毙了耶！  &lt;br/&gt;
只有知了依旧  &lt;br/&gt;
拨弄着琴弦&lt;/p&gt;

&lt;p&gt;考试不再上纲上线  &lt;br/&gt;
却难摆脱桎梏锁链  &lt;br/&gt;
十余年访道求仙  &lt;br/&gt;
岂为塞责、免受罪愆？  &lt;br/&gt;
只求将离龙坎虎修炼  &lt;br/&gt;
孰料潜水遭难、平阳遇险  &lt;br/&gt;
读书几卷  &lt;br/&gt;
毕业高中名叫实验&lt;/p&gt;

&lt;p&gt;世事难料风云变幻  &lt;br/&gt;
不知谁是导演  &lt;br/&gt;
教书法的先生抵触公元  &lt;br/&gt;
说——落款要写丙戌年&lt;/p&gt;

&lt;p&gt;中东战火频仍不断  &lt;br/&gt;
黎巴嫩也不能幸免  &lt;br/&gt;
台湾岛内唇枪舌剑  &lt;br/&gt;
蓝军高喊——滚蛋，阿扁！  &lt;br/&gt;
赖昌星仍未遣返  &lt;br/&gt;
人民币泰山压顶不动弹  &lt;br/&gt;
中央说  &lt;br/&gt;
经济增长要放缓&lt;/p&gt;

&lt;p&gt;男篮欧洲拉练  &lt;br/&gt;
女足战胜朝鲜  &lt;br/&gt;
舒马赫风光不似从前  &lt;br/&gt;
加特林也难逃药检  &lt;br/&gt;
意大利柏林夺冠  &lt;br/&gt;
德国人却把荷包装满  &lt;br/&gt;
齐达内未能完美谢幕演  &lt;br/&gt;
C罗与鲁尼翻脸&lt;/p&gt;

&lt;p&gt;野广告俯仰可见  &lt;br/&gt;
不是办证就是人寿保险  &lt;br/&gt;
电台全是健康热线  &lt;br/&gt;
韩剧依旧天天上演  &lt;br/&gt;
刘心武毁誉参半  &lt;br/&gt;
易中天粉丝过万  &lt;br/&gt;
80后叫嚣  &lt;br/&gt;
——文坛，全是扯淡！&lt;/p&gt;

&lt;p&gt;这一切  &lt;br/&gt;
与我无关  &lt;br/&gt;
惟有宵衣旰食只求百尺竿  &lt;br/&gt;
才不枉空度这十八年  &lt;br/&gt;
读小说追求古典  &lt;br/&gt;
开篇净是盘古辟地、女娲补天  &lt;br/&gt;
欣喜相声回归经典  &lt;br/&gt;
郭德纲头功一件  &lt;br/&gt;
游戏依然喜欢《仙剑》  &lt;br/&gt;
只为欧公词炼——  &lt;br/&gt;
人间自是有情痴  &lt;br/&gt;
此恨无关风与月&lt;/p&gt;

&lt;p&gt;可见我本未变  &lt;br/&gt;
众人目下口吃  &lt;br/&gt;
女生面前红脸  &lt;br/&gt;
呜呼！  &lt;br/&gt;
惟有——天维阙、地陷绝、赤县颓、黄河竭  &lt;br/&gt;
那时节  &lt;br/&gt;
才敢泯灭鸿鹄  &lt;br/&gt;
学那蜂麻燕雀！&lt;/p&gt;
</content>
 </entry>
 
 
</feed>